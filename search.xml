<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[å¼€å‘ä¸€ä¸ªAndroid App]]></title>
    <url>%2FAndroid%2F%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AAAndroid-App%2F</url>
    <content type="text"><![CDATA[ä»Ž0åˆ°1ï¼Œæ­å»ºä¸€ä¸ªç®€å•çš„Android Appã€‚ä¸­é—´ä¼šå¤¹ç€æŸäº›çŸ¥è¯†ç‚¹çš„å…¨é‡å†…å®¹ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å¼€å‘æ—¶ç›´æŽ¥åœ¨è¿™é‡Œæ ¹æ®è‡ªå·±å½“æ—¶çš„æ€»ç»“ç¿»æ‰¾å›žé¡¾ï¼ˆå®˜æ–¹çš„æ–‡æ¡£å…¶å®žä¹Ÿå·²ç»å¾ˆå…¨å¾ˆæ–¹ä¾¿ç¿»é˜…ï¼‰ã€‚å› ä¸ºæœ¬äººæ˜¯iOSå¼€å‘å‡ºèº«ï¼Œæ‰€ä»¥ä¸­é—´ä¹Ÿä¼šå¤¹ç€äº›å’ŒiOSç›¸ä¼¼æ¦‚å¿µçš„ç±»æ¯”ï¼Œä¸¾ä¸€åä¸‰åœ°æ€è€ƒï¼ŒåŠ å¼ºè®°å¿†ã€‚ Androidåº”ç”¨æž„æˆ ä¸»å¹² AndroidManifestï¼šåº”ç”¨çš„é…ç½®ï¼Œç³»ç»Ÿéœ€è¦æ ¹æ®é‡Œé¢çš„å†…å®¹è¿è¡ŒAPPçš„ä»£ç ï¼Œæ˜¾ç¤ºç•Œé¢ï¼› Activityï¼šå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè§†å›¾æŽ§åˆ¶å™¨ï¼Œåœ¨MVCæ¨¡å¼ä¸‹å……å½“Cè¿™æ ·çš„è§’è‰²ï¼› Fragmentï¼šè¡¨ç¤ºActivity ä¸­çš„ç‰‡æ®µï¼Œå¯ç»„åˆæˆ–é‡å¤ä½¿ç”¨ï¼Œå…·æœ‰å®ƒè‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸå’Œè¾“å…¥äº‹ä»¶ï¼› Serviceï¼šåœ¨åŽå°æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œæ“ä½œè€Œä¸æä¾›ç•Œé¢çš„æœåŠ¡ï¼› ContentProviderï¼šå†…å®¹æä¾›è€…ï¼Œåœ¨è¿›ç¨‹é—´è¿›è¡Œæ•°æ®äº¤äº’å’Œå…±äº«ï¼Œå³è·¨è¿›ç¨‹é€šä¿¡ BoardcastReceiverï¼šå¹¿æ’­æŽ¥æ”¶å™¨ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€çš„ç›‘å¬å™¨ï¼Œç›‘å¬æŽ¥æ”¶åº”ç”¨å‘å‡ºçš„å¹¿æ’­æ¶ˆæ¯ï¼Œå¹¶åšå‡ºå“åº” å››è‚¢ Viewï¼šAndroidé‡Œçš„å›¾å½¢ç•Œé¢éƒ½æ˜¯ç”±Viewå’ŒViewGroupä»¥åŠä»–ä»¬çš„å­ç±»æž„æˆçš„ï¼Œæˆ–å¯ç›´æŽ¥å°†XMLå¸ƒå±€çœ‹ä½œæ˜¯Viewï¼› Adapterï¼šä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å¦ä¸€ä¸ªæŽ§åˆ¶å™¨ï¼Œä»‹äºŽActivityå’ŒViewä¹‹é—´ï¼Œé…åˆé›†åˆæ€§çš„Viewä½¿ç”¨ï¼› Modelï¼šæ˜¯æŒ‡åº”ç”¨é€»è¾‘å±‚ï¼ˆä¹Ÿå«é¢†åŸŸå±‚ï¼‰çš„å¯¹è±¡ï¼Œå¦‚ Accountã€Order ç­‰ç­‰ï¼Œè¿™äº›å¯¹è±¡æ˜¯åº”ç”¨ç¨‹åºä¸­çš„ä¸€äº›æ ¸å¿ƒå¯¹è±¡ï¼Œè´Ÿè´£åº”ç”¨çš„é€»è¾‘è®¡ç®—ï¼Œæœ‰è®¸å¤šä¸Žä¸šåŠ¡é€»è¾‘æœ‰å…³çš„æ–¹æ³•æˆ–æ“ä½œã€‚ä»…ä»…åªæœ‰getterã€setterçš„ç”¨æ¥ä¼ é€’æ•°æ®çš„å¯¹è±¡ï¼Œåªèƒ½å«Value Objectï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„Modelå±‚ï¼› AsyncTaskï¼šè½»é‡çº§å¼‚æ­¥ç±»ï¼Œå®žçŽ°å¤šçº¿ç¨‹ã€å·¥ä½œçº¿ç¨‹ä¸Žä¸»çº¿ç¨‹ï¼ˆUIçº¿ç¨‹ï¼‰ä¹‹é—´çš„é€šä¿¡ï¼› è¡£æœï¼ˆResï¼‰ layoutï¼šé¡µé¢çš„å¸ƒå±€ valuesï¼šå­˜æ”¾å±žæ€§å€¼ï¼Œä¾‹å¦‚é¢œè‰²ã€é—´éš”ã€æœ¬åœ°åŒ– drawableï¼šå­˜æ”¾å›¾ç‰‡ xmlï¼šå­˜æ”¾è‡ªå®šä¹‰çš„é…ç½® animï¼šåŠ¨ç”»æ•ˆæžœ mipmapï¼šå­˜æ”¾iconå’Œlaunchå›¾ menuï¼šèœå•é€‰é¡¹ å†…è„ aarï¼šå«èµ„æºçš„åº“åŒ…é›†åˆ jarï¼šçº¯ä»£ç åº“åŒ… moduleï¼šæºç çº§çš„Libraryï¼Œåœ¨åŒä¸€ä¸ªå·¥ç¨‹ä¸­ä¾›ä¸»é¡¹ç›®ModuleåŽ»å¼•ç”¨ä¾èµ– åº”ç”¨é…ç½®æ–‡ä»¶ AndroidManifestå…·ä½“åŒ…å«çš„å†…å®¹æœ‰ï¼š ä¸ºåº”ç”¨çš„ Java è½¯ä»¶åŒ…å‘½åï¼› æè¿°åº”ç”¨çš„å„ä¸ªç»„ä»¶ï¼ŒåŒ…æ‹¬æž„æˆåº”ç”¨çš„ Activityã€æœåŠ¡ã€å¹¿æ’­æŽ¥æ”¶å™¨å’Œå†…å®¹æä¾›ç¨‹åºã€‚å®ƒè¿˜ä¸ºå®žçŽ°æ¯ä¸ªç»„ä»¶çš„ç±»å‘½åå¹¶å‘å¸ƒå…¶åŠŸèƒ½ï¼Œä¾‹å¦‚å®ƒä»¬å¯ä»¥å¤„ç†çš„ Intent æ¶ˆæ¯ã€‚è¿™äº›å£°æ˜Žå‘ Android ç³»ç»Ÿå‘ŠçŸ¥æœ‰å…³ç»„ä»¶ä»¥åŠå¯ä»¥å¯åŠ¨è¿™äº›ç»„ä»¶çš„æ¡ä»¶çš„ä¿¡æ¯ï¼› ç¡®å®šæ‰˜ç®¡åº”ç”¨ç»„ä»¶çš„è¿›ç¨‹ï¼› å£°æ˜Žåº”ç”¨å¿…é¡»å…·å¤‡å“ªäº›æƒé™æ‰èƒ½è®¿é—® API ä¸­å—ä¿æŠ¤çš„éƒ¨åˆ†å¹¶ä¸Žå…¶ä»–åº”ç”¨äº¤äº’ã€‚è¿˜å£°æ˜Žå…¶ä»–åº”ç”¨ä¸Žè¯¥åº”ç”¨ç»„ä»¶äº¤äº’æ‰€éœ€å…·å¤‡çš„æƒé™ï¼› åˆ—å‡º Instrumentationç±»ï¼Œè¿™äº›ç±»å¯åœ¨åº”ç”¨è¿è¡Œæ—¶æä¾›åˆ†æžå’Œå…¶ä»–ä¿¡æ¯ã€‚è¿™äº›å£°æ˜Žåªä¼šåœ¨åº”ç”¨å¤„äºŽå¼€å‘é˜¶æ®µæ—¶å‡ºçŽ°åœ¨æ¸…å•ä¸­ï¼Œåœ¨åº”ç”¨å‘å¸ƒä¹‹å‰å°†ç§»é™¤ï¼› å£°æ˜Žåº”ç”¨æ‰€éœ€çš„æœ€ä½Ž Android API çº§åˆ«ï¼›ï¼ˆåœ¨build.gradleä¹Ÿèƒ½æŒ‡å®šï¼‰ åˆ—å‡ºåº”ç”¨å¿…é¡»é“¾æŽ¥åˆ°çš„åº“ã€‚ï¼ˆ3.0çš„ASä¹‹åŽç”±build.gradleæŒ‡å®šï¼‰ å®ƒå°±å¥½æ¯”iOSä¸­çš„Info.plistï¼ŒåŒ…å«å„ç§åº”ç”¨è¿è¡Œå‰æˆ–è¿è¡Œæ—¶æ‰€éœ€çš„é…ç½®é¡¹ åœ¨&lt;manifest&gt;æ­¤å…ƒç´ çš„å±žæ€§ä¸­ï¼š packageè¡¨ç¤ºåº”ç”¨çš„åŒ…åï¼› android:versionNameè¡¨ç¤ºå•†åº—ä¸Šç»™ç”¨æˆ·æ‰€çœ‹çš„ç‰ˆæœ¬å·ï¼› android:versionCodeè¡¨ç¤ºå¼€å‘è€…å†…éƒ¨çš„ç‰ˆæœ¬å·ï¼Œä¸€èˆ¬ä½œä¸ºæ ‡è¯†æ¯æ¬¡ç”Ÿæˆçš„åŒ…çš„å·ç ï¼› &lt;manifest&gt;ä¸­çš„å…ƒç´  &lt;uses-feature&gt; å°†APPæ‰€ä¾èµ–çš„ç¡¬ä»¶æˆ–è€…è½¯ä»¶æ¡ä»¶è¿›è¡Œå£°æ˜Žï¼Œéœ€åœ¨å•ç‹¬çš„&lt;uses-feature&gt;å…ƒç´ ä¸­æŒ‡å®šæ¯ä¸ªåŠŸèƒ½ï¼› android:name æŒ‡å®šçš„åŠŸèƒ½åã€‚ android:required æ˜¯å¦å¿…é¡»åŠŸèƒ½ã€‚ android:glEsVersion éœ€è¦çš„Opengl ESç‰ˆæœ¬ã€‚ &lt;uses-permission&gt; å£°æ˜Žéœ€è¦ä½¿ç”¨çš„æƒé™ï¼Œä¸€èˆ¬åªè®¾ç½® android:name= å±žæ€§ï¼Œå¯é€‰çš„æƒé™æœ‰ android.permission.INTERNET android.permission.WRITE_EXTERNAL_STORAGE &lt;application&gt; æè¿°åº”ç”¨çš„é…ç½®ï¼ŒåŒ…å«å¤šä¸ªå­å…ƒç´ æ¥æè¿°åº”ç”¨ä¸­çš„ç»„ä»¶ï¼› android:allowBackup æ˜¯å¦å…è®¸APPåŠ å…¥åˆ°å¤‡ä»½è¿˜åŽŸçš„ç»“æž„ä¸­ã€‚ android:fullBackupContent æ˜¯å¦æ”¯æŒRTLï¼ˆRight To Leftï¼‰å¸ƒå±€ï¼ŒtargetSdkVersionåœ¨17ä»¥ä¸Šèµ·æ•ˆã€‚ android:icon APPçš„å›¾æ ‡ï¼Œä¸€èˆ¬å°±ä½¿ç”¨mipmap(-hdpi)ä¸‹å¯¹åº”çš„ic_launcheå›¾ç‰‡ã€‚ android:label ç”¨æˆ·å¯è¯»çš„æ ‡ç­¾ï¼Œæ ‡ç­¾å¿…é¡»è®¾ç½®æˆä¸€ä¸ªå­—ç¬¦ä¸²èµ„æºçš„å¼•ç”¨ï¼Œä½¿å…¶ä¸ºå¯é…ç½®å¯å®šä½ã€‚ android:theme åº”ç”¨ä½¿ç”¨çš„ä¸»é¢˜ï¼ŒæŒ‡å‘styleèµ„æºçš„å¼•ç”¨ï¼Œå„ä¸ªactivityä¹Ÿå¯ä»¥ç”¨è‡ªå·±çš„themeå±žæ€§è®¾ç½®è‡ªå·±çš„ä¸»é¢˜ã€‚ android:name Applicationå­ç±»çš„å…¨åï¼Œéœ€åŒ…æ‹¬å…¶æ•´ä½“è·¯å¾„ï¼Œå½“åº”ç”¨å¯åŠ¨æ—¶ï¼Œè¿™ä¸ªç±»çš„å®žä¾‹è¢«ç¬¬ä¸€ä¸ªåˆ›å»ºï¼Œè¿™ä¸ªå±žæ€§æ˜¯å¯é€‰é…ç½®ã€‚ &lt;activity&gt; æ˜¯&lt;application&gt;ä¸­çš„å…ƒç´ ï¼Œå£°æ˜Žä¸€ä¸ªå®žçŽ°åº”ç”¨å¯è§†åŒ–ç•Œé¢çš„Activityï¼Œä»»ä½•æœªåœ¨è¯¥å¤„å£°æ˜Žçš„Activityå¯¹ç³»ç»Ÿéƒ½ä¸å¯è§ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼› android:name activityçš„åç§°ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ç‚¹ï¼Œå°±éœ€è¦åŠ ä¸ŠåŒ…åã€‚ android:label åŒapplication android:configChanges åœ¨è¿è¡Œæ—¶å‘ç”Ÿé…ç½®æ›´æ”¹æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå…³é—­ Activity ç„¶åŽå°†å…¶é‡æ–°å¯åŠ¨ï¼Œä½†ä½¿ç”¨è¯¥å±žæ€§å£°æ˜Žé…ç½®å°†é˜»æ­¢ Activity é‡æ–°å¯åŠ¨ï¼Œå¹¶ä¿æŒè¿è¡ŒçŠ¶æ€ï¼Œç³»ç»Ÿä¼šè°ƒç”¨å…¶ onConfigurationChanged()æ–¹æ³•ã€‚ orientation è®¾å¤‡æ—‹è½¬ keyboardHidden é”®ç›˜æ˜¾éš android:launchMode å¦‚ä½•å¯åŠ¨Activityçš„æŒ‡ä»¤ï¼Œä¸€å…±æœ‰å››ç§æŒ‡ä»¤ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯standardã€‚ standard å¯ä»¥å¤šæ¬¡å®žä¾‹åŒ–ï¼Œéµå¾ªå…ƒç´ è¿›æ ˆå‡ºæ ˆçš„ç‰¹æ€§ï¼Œå¯ä½äºŽActivityå †æ ˆä¸­çš„ä»»ä½•ä½ç½®ã€‚ singleTop å¯ä»¥å¤šæ¬¡å®žä¾‹åŒ–ï¼Œä½†å¦‚æžœè¦å¼€å¯çš„activityåœ¨ä»»åŠ¡æ ˆçš„é¡¶éƒ¨å·²ç»å­˜åœ¨ï¼Œå°±ä¸ä¼šåˆ›å»ºæ–°çš„å®žä¾‹ï¼Œè€Œæ˜¯è°ƒç”¨ onNewIntent() æ–¹æ³•ã€‚é¿å…æ ˆé¡¶çš„activityè¢«é‡å¤çš„åˆ›å»ºã€‚ singleTask å•ä¸€å®žä¾‹æ¨¡å¼ï¼Œå¦‚æžœè¦æ¿€æ´»çš„activityï¼Œåœ¨ä»»åŠ¡æ ˆé‡Œé¢å·²ç»å­˜åœ¨ï¼Œå°±ä¸ä¼šåˆ›å»ºæ–°çš„activityï¼Œè€Œæ˜¯å¤ç”¨è¿™ä¸ªå·²ç»å­˜åœ¨çš„activityï¼Œè°ƒç”¨ onNewIntent() æ–¹æ³•ï¼Œå¹¶ä¸”æ¸…ç©ºè¿™ä¸ªactivityä»»åŠ¡æ ˆä¸Šé¢æ‰€æœ‰çš„activityã€‚ singleInstance å•ä¸€å®žä¾‹æ¨¡å¼ï¼Œæ•´ä¸ªæ‰‹æœºæ“ä½œç³»ç»Ÿé‡Œé¢åªæœ‰ä¸€ä¸ªå®žä¾‹å­˜åœ¨ï¼Œä¸åŒçš„åº”ç”¨åŽ»æ‰“å¼€è¿™ä¸ªactivityå…±äº«å…¬ç”¨çš„åŒä¸€ä¸ªactivityï¼Œè¿è¡Œåœ¨è‡ªå·±ç‹¬ç«‹çš„ä»»åŠ¡æ ˆé‡Œé¢ï¼Œå¹¶ä¸”ä»»åŠ¡æ ˆé‡Œé¢åªæœ‰å®ƒä¸€ä¸ªå®žä¾‹å­˜åœ¨ã€‚ android:theme åŒapplicationçš„theme &lt;meta-data&gt;ä¸€èˆ¬æ˜¯&lt;activity&gt;ä¸­çš„å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ªname-valueå¯¹ï¼Œæä¾›ç»™å…¶çˆ¶ç»„ä»¶ï¼Œæ•°æ®ä¼šè¢«ç»„æˆä¸€ä¸ªBundleå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡PackageItemInfo.metaDataå­—æ®µä½¿ç”¨ï¼› android:name android:resource android:value &lt;intent-filter&gt;ä¸€èˆ¬ä¹Ÿæ˜¯&lt;activity&gt;ä¸­çš„å…ƒç´ ï¼ŒæŒ‡æ˜Žactivityå¯ä»¥ä»¥ä»€ä¹ˆæ ·çš„æ„å›¾(intent)å¯åŠ¨ï¼Œå…¶å­å…ƒç´ åŒ…æ‹¬ &lt;action&gt;å…ƒç´ ï¼Œè¡¨ç¤ºactivityä½œä¸ºä¸€ä¸ªä»€ä¹ˆåŠ¨ä½œå¯åŠ¨ï¼Œandroid.intent.action.MAINè¡¨ç¤ºä½œä¸ºä¸»activityå¯åŠ¨ &lt;category&gt;å…ƒç´ ï¼Œè¡¨ç¤ºactionå…ƒç´ çš„é¢å¤–ç±»åˆ«ä¿¡æ¯ï¼Œandroid.intent.category.LAUNCHERè¡¨ç¤ºè¿™ä¸ªactivityä¸ºå½“å‰åº”ç”¨ç¨‹åºä¼˜å…ˆçº§æœ€é«˜çš„Activityã€‚ ç¤ºä¾‹ï¼š &lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.test.app"&gt; &lt;uses-permission android:name="android.permission.INTERNET"/&gt; &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt; &lt;application android:name="com.test.app.TestApplication" android:networkSecurityConfig="@xml/network_security_config" android:allowBackup="true" android:icon="@mipmap/ic_launcher" android:roundIcon="@mipmap/ic_launcher_round" android:supportsRtl="true" android:theme="@style/AppTheme"&gt; &lt;service android:name="com.test.app.service.TestAidlService" android:exported="true"&gt; &lt;intent-filter&gt; &lt;action android:name="com.test.app.service.TestAidlService"/&gt; &lt;category android:name="android.intent.category.DEFAULT"/&gt; &lt;/intent-filter&gt; &lt;/service&gt; &lt;activity android:name="com.test.app.activity.MainActivity" android:theme="@style/AppTheme.NoActionBar"&gt; &lt;intent-filter&gt; &lt;action android:name="android.intent.action.MAIN" /&gt; &lt;category android:name="android.intent.category.LAUNCHER" /&gt; &lt;/intent-filter&gt; &lt;/activity&gt; &lt;activity android:name="com.test.app.activity.DetailActivity" android:parentActivityName="com.efn.testapp.activity.MainActivity" android:theme="@style/AppTheme.NoActionBar" &gt; &lt;!-- The meta-data tag is required if you support API level 15 and lower --&gt; &lt;meta-data android:name="android.support.PARENT_ACTIVITY" android:value="com.test.app.activity.MainActivity" /&gt; &lt;/activity&gt; &lt;provider android:name="android.support.v4.content.FileProvider" android:authorities="com.efn.testapp.fileprovider" android:exported="false" android:grantUriPermissions="true"&gt; &lt;meta-data android:name="android.support.FILE_PROVIDER_PATHS" android:resource="@xml/file_provider"/&gt; &lt;/provider&gt; &lt;/application&gt; &lt;/manifest&gt; UIæŽ§åˆ¶å™¨ Activityå®˜æ–¹æ–‡æ¡£ Androidä¸­çš„Activityï¼Œåœ¨MVCä¸­å°±å¯ä»¥ç›´æŽ¥çœ‹ä½œæ˜¯Cï¼Œå³Controlerï¼Œä¸ŽiOSçš„ViewControlerçš„å®šä½ä¸€è‡´ã€‚ä½†MVPæˆ–MVVMä¸­ï¼Œå¯èƒ½å°±éœ€è¦æ”¹è§†ä¸ºVï¼Œå³Viewæ›´å¤šä¸€äº›ï¼Œå› ä¸ºå®ƒçš„ä¸šåŠ¡é€»è¾‘ä¼šè¿›ä¸€æ­¥è¢«åˆ†åŒ–åˆ°Presenteræˆ–è€…ViewModelä¸Šï¼Œåªæ˜¯ä¿ç•™ç®€å•åœ°ç®¡ç†Viewçš„éƒ¨åˆ†ï¼Œä¸‹é¢åœ¨è®¾è®¡æ¨¡å¼ä¸€èŠ‚å†è¯¦è°ˆã€‚ å¼€å‘Activityçš„åŸºæœ¬æ­¥éª¤ï¼š åˆ›å»ºActivityï¼Œæœ€ä¸»è¦çš„æ˜¯å®žçŽ°onCreate()ï¼Œåˆå§‹åŒ– Activity çš„å¿…éœ€ç»„ä»¶ï¼Œå…¶å®ƒç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•å¯ä»¥æŒ‰éœ€è¦å®žçŽ° å®˜æ–¹æ–‡æ¡£ï¼› onCreate åˆ›å»º onStart å³å°†å¯è§ onResume å·²ç»å¯è§ onPause èšç„¦åœ¨å…¶ä»–activityä¸Š onStop ä¸å†å¯è§ onDestroy å‡†å¤‡é”€æ¯ åœ¨onCreate()ä¸­å¿…é¡»è°ƒç”¨ setContentView() ï¼Œä¼ é€’å¸ƒå±€çš„èµ„æºIDä»¥å®šä¹‰Activityç”¨æˆ·ç•Œé¢çš„å¸ƒå±€ã€‚ åœ¨æ¸…å•æ–‡ä»¶ä¸­å£°æ˜Ž Activityï¼ŒæŒ‡å®šä½ è¦çš„æ„å›¾è¿‡æ»¤å™¨intent-fliter å¯åŠ¨Activity åˆ›å»ºæ„å›¾ Intentå¯¹è±¡ï¼Œä¼ å…¥å°†è¦æ‰“å¼€çš„å­Activityçš„class ä¸éœ€è¦å›žè°ƒçš„è°ƒç”¨ startActivity() éœ€è¦å›žè°ƒçš„è°ƒç”¨ startActivityForResult()ï¼Œå¹¶å®žçŽ° onActivityResult()ï¼Œé€šè¿‡requestCodeå‚æ•°æ ‡è¯†æ¥æºï¼ŒresultCodeå‚æ•°æ ‡è¯†å¤„ç†ç»“æžœ éœ€è¦é¢å¤–å‚æ•°çš„ï¼Œå¯¹intentè°ƒç”¨ putExtra(â€œkeyâ€, â€œvalueâ€)è¿›è¡Œè®¾ç½® ç»“æŸActivity finish() ç»“æŸå½“å‰Activity finishActivity() ç»“æŸä¹‹å‰å¯åŠ¨çš„å¦ä¸€ä¸ªActivity åœ¨startActivity()æˆ–finish()åŽè°ƒç”¨overridePendingTransition()ï¼Œä¼ å…¥è¿›å…¥åŠ¨ç”»å’Œé€€å‡ºåŠ¨ç”»çš„èµ„æºIDï¼Œå³å¯è‡ªå®šä¹‰å¯åŠ¨Activityçš„åŠ¨ç”»æ•ˆæžœã€‚ Activityä¸€èˆ¬ç»§æ‰¿AppCompatActivityå°±èƒ½å¸¦æœ‰ActionBarï¼ˆASä¸­åˆ›å»ºActivityæ˜¯é»˜è®¤ç»§æ‰¿å®ƒçš„ï¼‰ï¼Œä¹Ÿå°±æ˜¯iOSä¸­çš„NavigationBarã€‚ä¸ºäº†å¯ä»¥å…¼å®¹æ—§ç‰ˆçš„actionBarï¼Œsupport v7æä¾›çš„ActionBarActivityï¼ˆå…¶å®žå°±æ˜¯ä¸€ä¸ªAppCompatActivityçš„ç©ºç»§æ‰¿ï¼‰ã€‚ åœ¨è¢«æ‰“å¼€çš„Activityä¸­ï¼Œå¦‚æžœæ˜¯ä½¿ç”¨è‡ªå®šä¹‰toolbarï¼Œä¸”ä¸ç”¨å…¼å®¹æ—§ç³»ç»Ÿçš„actionBarï¼Œåˆ™å¯ä»¥è¿™æ ·æŒ‡å®šæ ‡é¢˜å’ŒåŽé€€æŒ‰é’® Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); setTitle("xx"); toolbar.setTitleTextColor(Color.BLACK); toolbar.setNavigationIcon(R.drawable.ic_toolbar_back); è‹¥æ˜¯è‡ªå®šä¹‰çš„toolbarä½†ä¸éœ€è¦å…¼å®¹actionBarï¼Œåˆ™éœ€è¦å…ˆå°†å¸ƒå±€ä¸­è‡ªå®šä¹‰çš„toolbarè®¾å®šä¸ºactionBarï¼Œå¹¶å…³é—­ç›¸å…³çš„è‡ªå®šä¹‰å±žæ€§ Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar); //ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ä¸Šçš„actionBarï¼ˆToolbaræ˜¯æ–°çš„ä»£æ›¿å·¥å…·ï¼‰ ActionBar actionBar = getSupportActionBar(); if(actionBar != null) &#123; //actionBar.hide(); actionBar.setHomeButtonEnabled(false); actionBar.setDisplayShowHomeEnabled(false); actionBar.setDisplayShowTitleEnabled(false); &#125; TextView titleView = findViewById(R.id.detail_main_title); titleView.setText(title + "è¯¦æƒ…"); Button backButton = findViewById(R.id.detail_main_back_btn); backButton.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; DetailActivity.this.finish(); overridePendingTransition(R.anim.anim_back_in, R.anim.anim_back_out); &#125; &#125;); ç‰‡æ®µ Fragmentå®˜æ–¹æ–‡æ¡£ å¯ä»¥åœ¨ä¸€ä¸ª Activity ä¸­ç»„åˆå¤šä¸ªç‰‡æ®µï¼Œä»Žè€Œæž„å»ºå¤šçª—æ ¼ç•Œé¢ï¼Œå¹¶åœ¨å¤šä¸ª Activity ä¸­é‡å¤ä½¿ç”¨æŸä¸ªç‰‡æ®µã€‚ ç‰‡æ®µå¿…é¡»å§‹ç»ˆæ‰˜ç®¡åœ¨ Activity ä¸­ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸç›´æŽ¥å—å®¿ä¸» Activity ç”Ÿå‘½å‘¨æœŸçš„å½±å“ã€‚Fragmentçš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š onAttach/onDettach onCreate/onDestroy onCreateView/onDestroyView onActivityCreate onStart/onStop onResume/onPause å½“æ‚¨å°†ç‰‡æ®µä½œä¸º Activity å¸ƒå±€çš„ä¸€éƒ¨åˆ†æ·»åŠ æ—¶ï¼Œå…¶ä½äºŽ Activity è§†å›¾å±‚æ¬¡ç»“æž„çš„æŸä¸ª ViewGroup ä¸­ï¼Œå¹¶ä¸”ç‰‡æ®µä¼šå®šä¹‰å…¶è‡ªå·±çš„è§†å›¾å¸ƒå±€ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ Activity çš„å¸ƒå±€æ–‡ä»¶ä¸­å£°æ˜Žç‰‡æ®µï¼Œå°†å…¶ä½œä¸º å…ƒç´ æ’å…¥æ‚¨çš„ Activity å¸ƒå±€ï¼Œæˆ–è€…é€šè¿‡å°†å…¶æ·»åŠ åˆ°æŸä¸ªçŽ°æœ‰çš„ ViewGroupï¼Œåˆ©ç”¨åº”ç”¨ä»£ç å°†å…¶æ’å…¥å¸ƒå±€ã€‚ å¼€å‘Fragment å¦‚æžœæ˜¯æ™®é€šçš„Fragmentï¼Œå¯ä»¥é€šè¿‡onCreateView()è¿”å›žå¸ƒå±€çš„æ ¹è§†å›¾ï¼ˆViewï¼‰ @Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123; // Inflate the layout for this fragment return inflater.inflate(R.layout.example_fragment, container, false); &#125; inflaterå‚æ•°å¯åˆ©ç”¨æ¥åŠ è½½å¸ƒå±€ï¼ˆæœ‰ç‚¹åƒActivityä¸­çš„setContentView()ï¼‰ containerå‚æ•°æ˜¯ç‰‡æ®µå¸ƒå±€å°†æ’å…¥åˆ°çš„çˆ¶çº§ViewGroupï¼ˆæ¥è‡ªActivityï¼‰ savedInstanceStateå‚æ•°æ˜¯åœ¨æ¢å¤ç‰‡æ®µæ—¶ï¼Œæä¾›ä¸Šä¸€ç‰‡æ®µå®žä¾‹ç›¸å…³æ•°æ®çš„Bundle inflate()ä½†æœ€åŽä¸€ä¸ªå¸ƒå°”åž‹å‚æ•°ï¼ŒæŒ‡ç¤ºæ˜¯å¦åº”åœ¨æ‰©å±•æœŸé—´å°†æ‰©å±•å¸ƒå±€é™„åŠ è‡³ ViewGroupï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰çš„å¸ƒå°”å€¼ã€‚ getArguments()èŽ·å–ä¼ é€’è¿›æ¥çš„å…¶å®ƒå‚æ•° getView()èŽ·å–å½“å‰çš„ViewGroup å¦‚æžœæ˜¯DialogFragmentï¼Œåˆ™éœ€è¦é‡å†™onCreateDialog()ï¼Œå¹¶è¿”å›žä¸€ä¸ªè‡ªå®šä¹‰çš„Dialogï¼ˆå¦åˆ™çˆ¶ç±»é»˜è®¤ä¼šè¿”å›žä¸€ä¸ªç©ºç™½çš„Dialogï¼‰ï¼Œç¤ºä¾‹ï¼š @Override public Dialog onCreateDialog(@Nullable Bundle savedInstanceState) &#123; Dialog alertDialog = new Dialog(getContext()); alertDialog.requestWindowFeature(Window.FEATURE_NO_TITLE); View customView = initView(null, null); alertDialog.setContentView(customView); alertDialog.setCanceledOnTouchOutside(true); alertDialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT)); WindowManager.LayoutParams windowParams = alertDialog.getWindow().getAttributes(); windowParams.width = (int) (getResources().getDisplayMetrics().widthPixels - getResources().getDisplayMetrics().density * 40); windowParams.height = (int) (getResources().getDisplayMetrics().heightPixels - getResources().getDisplayMetrics().density * 100); alertDialog.getWindow().setAttributes(windowParams); return alertDialog; &#125; //initView() Â·Â·Â· if (inflater == null) &#123; view = LayoutInflater.from(getContext()).inflate(R.layout.detail_advise_main, container); &#125; else &#123; view = inflater.inflate(R.layout.detail_advise_main, container, false); &#125; Â·Â·Â· //åœ¨viewä¸Šè®¾ç½®æŽ§ä»¶ æ•ˆæžœå¦‚ä¸‹å›¾ ListFragmentæš‚æ—¶æ²¡ç”¨åˆ°ï¼Œä½†åŽŸç†åŸºæœ¬ä¸€è‡´ã€‚ åœ¨Activityçš„å¸ƒå±€ä¸­æ’å…¥ç‰‡æ®µï¼Œå°†ç‰‡æ®µå½“ä½œè§†å›¾æ¥ä¸ºå…¶æŒ‡å®šå¸ƒå±€å±žæ€§ï¼Œåˆ›å»ºæ­¤Activityå¸ƒå±€æ—¶ï¼Œç³»ç»Ÿä¼šå°†å¸ƒå±€ä¸­æŒ‡å®šçš„æ¯ä¸ªç‰‡æ®µå®žä¾‹åŒ–ï¼Œå¹¶ä¸ºæ¯ä¸ªç‰‡æ®µè°ƒç”¨onCreateView()æ–¹æ³•ï¼Œä»¥æ£€ç´¢æ¯ä¸ªç‰‡æ®µçš„å¸ƒå±€ã€‚è¿™ä¸ªå®žçŽ°æ¯”è¾ƒç®€å•ï¼Œä¸ç»†è¯´ã€‚ é€šè¿‡ç¼–ç¨‹æ–¹å¼å±•ç¤ºï¼Œç”¨äºŽè¿è¡Œæ—¶ï¼Œåªéœ€æŒ‡å®šè¦å°†ç‰‡æ®µæ”¾å…¥å“ªä¸ªViewGroupï¼Œç¤ºä¾‹ FragmentManager fragmentManager = getSupportFragmentManager(); FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction(); ExampleFragment fragment = new ExampleFragment(); fragmentTransaction.add(R.id.fragment_container, fragment); //è¿˜æœ‰replace()ã€remove()ã€addToBackStack()è¿™äº›äº‹åŠ¡æ“ä½œæ›´æ”¹æ–¹æ³• fragmentTransaction.commit(); è¿è¡Œæ—¶çš„ç¼–ç¨‹ä¹Ÿæœ‰ç¬¬äºŒç§æ–¹å¼å±•ç¤ºFragment DetailAdviseFragment fragment = new DetailAdviseFragment(); //æ­¤å¤„ä¸ºä¸€ä¸ªDialogFragment fragment.setOnPressButtonListener(DetailActivity.this); Bundle bundle = new Bundle(); bundle.putString("advise", "something"); fragment.setArguments(bundle); //è®¾ç½®Fragmentçš„å‚æ•° fragment.show(getSupportFragmentManager(), "detailAdviseFragment"); ä¸ŽActivityé€šä¿¡çš„è¯ï¼Œæ­£å‘å°±æ˜¯é€šè¿‡FragmentManagerçš„findFragmentByIdæ‰¾å‡ºfragmentï¼Œåå‘å°±æ˜¯é€šè¿‡Fragmentå®šä¹‰æŽ¥å£ï¼ŒActiviytå®žçŽ°æŽ¥å£ï¼ˆä¸‹é¢çš„ç›‘å¬è€…ä¸€èŠ‚å†ä»‹ç»è¿™æ ·çš„æŽ¥å£å®žçŽ°ï¼‰ æœ€åŽï¼Œè¯´ä¸€ä¸ªä½¿ç”¨é¢‘çŽ‡åº”è¯¥é¢‡é«˜çš„ç¤ºä¾‹ï¼Œåˆ©ç”¨Fragmentå®žçŽ°å¤šæ ‡ç­¾åˆ‡æ¢çš„æ•ˆæžœã€‚ å…ˆå®šä¹‰ä¸€ä¸ªActivityï¼Œç»„ç»‡ä¸€ä¸ªViewPagerå’Œä¸¤ä¸ªæ•°æ®æºï¼Œæ•°æ®æºåŒ…æ‹¬ä½œä¸ºå•ä¸ªæ ‡ç­¾ä¸»ä½“çš„Fragmentçš„åˆ—è¡¨å’Œæ ‡ç­¾æ ‡é¢˜çš„åˆ—è¡¨ã€‚ public class MyActivity extends AppCompatActivity &#123; ViewPager mViewPager; List&lt;Fragment&gt; mFragmentList; String[] mTitles = new String[]&#123;"æ ‡ç­¾1","æ ‡ç­¾2"&#125;; @Override protected void onCreate(@Nullable Bundle savedInstanceState) &#123; Â·Â·Â· //find view mFragmentList = new ArrayList&lt;Fragment&gt;(); mFragmentList.add(MyFirstFragment.getInstance(network)); mFragmentList.add(MySecondFragment.getInstance(network)); MyFragmentPagerAdapter adapter = new MyFragmentPagerAdapter(getSupportFragmentManager(), mFragmentList, mTitles); mViewPager.setAdapter(adapter); mTabLayout.setupWithViewPager(mViewPager); Â·Â·Â· &#125; &#125; å¸ƒå±€ &lt;LinearLayout Â·Â·Â·&gt; &lt;android.support.design.widget.TabLayout Â·Â·Â· app:tabIndicatorColor="@color/colorBlue" app:tabIndicatorHeight="5dp" app:tabSelectedTextColor="@color/colorBlue" app:tabTextColor="@color/colorDark" /&gt; &lt;android.support.v4.view.ViewPager Â·Â·Â·/&gt; &lt;/LinearLayout&gt; å…¶æ¬¡ViewPagerå’Œæ•°æ®æºä¹‹é—´ï¼Œéœ€è¦ä¸€ä¸ªé€‚é…å™¨æ‰èƒ½è¿›è¡Œå·¥ä½œï¼Œç³»ç»Ÿå·²ç»å‡†å¤‡å¥½äº†è¿™ç§åŠŸèƒ½çš„é€‚é…å™¨FragmentPagerAdapterï¼Œç»§æ‰¿å®ƒè‡ªå®šä¹‰è‡ªå·±çš„æ•°æ®é€»è¾‘ public class MyFragmentPagerAdapter extends FragmentPagerAdapter &#123; private List&lt;Fragment&gt; mFragmentList; private String[] mTitles; public MyFragmentPagerAdapter(FragmentManager fm, List&lt;Fragment&gt; fragmentList, String[] titles) &#123; super(fm); this.mFragmentList = fragmentList; this.mTitles = titles; &#125; @Override public Fragment getItem(int i) &#123; return mFragmentList.size()&gt;0 ? mFragmentList.get(i) : null; &#125; @Override public int getCount() &#123; return mFragmentList.size(); &#125; @Nullable @Override public CharSequence getPageTitle(int position) &#123; return mTitles[position]; &#125; &#125; æœ€åŽå°±æ˜¯å®šä¹‰Fragmentï¼Œè¿™é‡Œé‡‡ç”¨å•ä¾‹çš„æ–¹å¼ï¼Œæä¾›æ•°æ®è¾“å…¥å£åˆ·æ–°é¡µé¢å†…å®¹ï¼Œå‡å¦‚æ•´ä¸ªAppé‡Œé¢åªæœ‰ä¸€å¤„å±•ç¤ºåˆ°è¿™ä¸ªViewPagerï¼Œä¸”ä½¿ç”¨é¢‘çŽ‡åˆè¾ƒé«˜ï¼Œé‚£ä½¿ç”¨è¿™ç§æ–¹å¼æœ‰ä¸€å®šçš„å¥½å¤„ã€‚ public class MyFirstFragment extends Fragment &#123; public DataModel mDataModel; private static MyFirstFragment mFragment; public static MyFirstFragment getInstance(DataModel model) &#123; if (mFragment == null) &#123; mFragment = new MyFirstFragment(); &#125; mFragment.mDataModel = model; return mFragment; &#125; @Nullable @Override public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) &#123; super.onCreateView(inflater, container, savedInstanceState); View view = inflater.inflate(R.layout.my_first_fragment_layout, container, false); return view; &#125; @Override public void onResume() &#123; super.onResume(); View view = getView(); Â·Â·Â·//find view ï¼Œsetup view &#125; &#125; è¿™å°±å®Œæˆäº†ä¸€ä¸ªæ ‡ç­¾åˆ‡æ¢åŠŸèƒ½ï¼Œæ•ˆæžœå¦‚ä¸‹ æ•ˆæžœå¦‚ä¸‹å›¾ è§†å›¾ Viewå¸ƒå±€-å®˜æ–¹æ–‡æ¡£ æ¯ä¸ªViewGroupéƒ½æ˜¯çœ‹ä¸è§çš„ç”¨äºŽç»„ç»‡å­Viewçš„å®¹å™¨ï¼Œè€Œå®ƒçš„å­Viewå¯èƒ½æ˜¯è¾“å…¥æŽ§ä»¶ï¼Œåˆæˆ–è€…åœ¨UIä¸Šç»˜åˆ¶æŸå—åŒºåŸŸçš„å°éƒ¨ä»¶ã€‚ Viewï¼šæ‰€æœ‰å¯è§†åŒ–æŽ§ä»¶çš„çˆ¶ç±»ï¼Œæä¾›ç»„ä»¶æç»˜å’Œäº‹ä»¶å¤„ç†æ–¹æ³•ï¼Œä¾‹å¦‚Buttonã€TextViewç­‰ï¼› ViewGroupï¼šViewç±»çš„å­ç±»ï¼Œå¯æ‹¥æœ‰å­æŽ§ä»¶ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨ï¼Œä¾‹å¦‚å„ç§Layoutç±»ã€‚ Android UIä¸­çš„æŽ§ä»¶éƒ½æ˜¯æŒ‰ç…§è¿™ç§å±‚æ¬¡æ ‘çš„ç»“æž„å †å å¾—ï¼Œè€Œåˆ›å»ºUIå¸ƒå±€çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œè‡ªå·±åœ¨Javaé‡Œå†™ä»£ç æˆ–è€…é€šè¿‡XMLå®šä¹‰å¸ƒå±€ï¼ŒåŽè€…æ˜¾å¾—æ›´åŠ æ–¹ä¾¿å’Œå®¹æ˜“ç†è§£ï¼ UIå¸ƒå±€çš„å±‚æ¬¡ç»“æž„å›¾å¦‚ä¸‹ å½“AppåŠ è½½ä¸Šè¿°çš„å¸ƒå±€èµ„æºæ—¶ï¼ŒAndroidä¼šå°†å¸ƒå±€ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå®žä¾‹åŒ–æˆä¸€ä¸ªä¸ªï¼ˆç±»åå¯¹åº”å…ƒç´ åç§°çš„ï¼‰å¯¹è±¡ã€‚å¯ä»¥ä¸ºè¿™äº›å¯¹è±¡å®šä¹‰ä¸€äº›é¢å¤–çš„è¡Œä¸ºï¼ŒæŸ¥è¯¢å¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ–è€…ä¿®æ”¹å¸ƒå±€ã€‚ å®¹å™¨ç±»æœ‰ FrameLayout æ¡†æž¶å¸ƒå±€ï¼Œæ‰€æœ‰çš„æŽ§ä»¶éƒ½ä¼šé»˜è®¤å‡ºçŽ°åœ¨è§†å›¾çš„å·¦ä¸Šè§’ layout_gravityï¼ˆå¯è®¾å€¼ï¼šcenterã€topã€bottomã€leftã€rightã€right|bottomï¼‰ LinearLayout çº¿æ€§å¸ƒå±€ layout_weight orientationï¼šå¸ƒå±€æ–¹å‘ï¼ˆå¯è®¾å€¼ï¼šhorizontal/verticalï¼‰ dividerï¼šåˆ†å‰²çº¿çš„æ ·å¼ showDividersï¼šåŠ åˆ†å‰²çº¿çš„ä½ç½®ï¼ˆå¯è®¾å€¼ï¼šmiddle/end/beginning/noneï¼‰ AbsoluteLayoit ç»å¯¹å¸ƒå±€ï¼Œä¸ºäº†å¸ƒå±€çš„é€‚é…ï¼ŒåŸºæœ¬ä¸ä½¿ç”¨æ­¤ç§å¸ƒå±€ã€‚ RelativeLayout ç›¸å¯¹å¸ƒå±€ï¼Œæœ‰å­æŽ§ä»¶ç›¸å¯¹äºŽçˆ¶å®¹å™¨çš„å¸ƒå±€ï¼Œä¹Ÿæœ‰å­æŽ§ä»¶ç›´æŽ¥ç›¸å¯¹çš„å¸ƒå±€ layout_aboveï¼šï¼ˆå±žæ€§å€¼ä¸ºIDçš„å¼•ç”¨åï¼‰ layout_alignLeft/Top/Right/Bottom layout_alignParentLeft/etc. layout_toLeftOf/etc. layout_alignBaseLine layout_centerInParent TableLayout è¡¨æ ¼å¸ƒå±€ï¼Œå°†å­å…ƒç´ çš„ä½ç½®åˆ†é…åˆ°è¡Œæˆ–è€…åˆ—ä¸­ï¼Œä¸€ä¸ªTableLayoutç”±è®¸å¤šçš„TableRowç»„æˆ ConstraintLayout çº¦æŸæ€§å¸ƒå±€ CoordinatorLayout åè°ƒå¸ƒå±€ layout_behavior PercentFrameLayout PercentRelativeLayout GridLayout å„ç§å®¹å™¨æ¦‚æ‹¬å›¾ åŸºæœ¬çš„å±žæ€§æœ‰ layout_width/heightï¼šï¼ˆå¯è®¾å€¼ï¼šmatch_parent/wrap_content/XXdpï¼Œé…åˆweightä½¿ç”¨æ—¶æ³¨æ„è®¾ä¸º0dipï¼‰ layout_centerHrizontal/centerVertical/centerInparentï¼šæ˜¯å¦æ°´å¹³/åž‚ç›´/ç›¸å¯¹çˆ¶å…ƒç´ å±…ä¸­ layout_margin layout_marginLeft/Top/Right/Bottom/Start/Endï¼ˆ4.2ç‰ˆæœ¬å¼€å§‹åº”ä½¿ç”¨Startå’ŒEndåˆ†åˆ«ä»£æ›¿Leftå’ŒRightï¼Œç³»ç»Ÿèƒ½æ ¹æ®ç”¨æˆ·æ‰€è®¾ç½®çš„è¯­è¨€ï¼Œä¾‹å¦‚éœ€è¦ä»Žå³åˆ°å·¦æŽ’åºçš„é˜¿æ‹‰ä¼¯è¯­ï¼Œè‡ªè¡ŒæŽ§åˆ¶è¿™ä¸ªpaddingçš„ä½ç½®ï¼Œä½¿ç”¨Startå°±å¯ä»¥äº¤ç”±ç³»ç»Ÿå¤„ç†ï¼Œè‹¥è¿˜ä½¿ç”¨Leftå°±æœ‰å¤±åé¢‡ï¼Œé™¤éžè¦å…¼å®¹æ—§çš„ç³»ç»Ÿç‰ˆæœ¬åˆ™éœ€è¦ä¸€å¹¶è®¾ç½®ä¸Šï¼‰ layout_padding layout_paddingLeft/Top/Right/Bottom/Start/End addStatesFromChildrenï¼šå¸ƒå°”å€¼ï¼Œviewgroupçš„drawableå±žæ€§æ˜¯å¦æŠŠå®ƒçš„å­ç±»çš„drawableçš„stateåŒ…å«è¿›æ¥ã€‚ tag descendantFocusabilityï¼šå½“ä¸€ä¸ªä¸ºviewèŽ·å–ç„¦ç‚¹æ—¶ï¼Œå®šä¹‰viewGroupå’Œå…¶å­æŽ§ä»¶ä¸¤è€…ä¹‹é—´çš„å…³ç³»ï¼Œå¯è®¾å€¼ï¼š beforeDescendantsï¼šviewgroupä¼šä¼˜å…ˆå…¶å­ç±»æŽ§ä»¶è€ŒèŽ·å–åˆ°ç„¦ç‚¹ afterDescendantsï¼šviewgroupåªæœ‰å½“å…¶å­ç±»æŽ§ä»¶ä¸éœ€è¦èŽ·å–ç„¦ç‚¹æ—¶æ‰èŽ·å–ç„¦ç‚¹ blocksDescendantsï¼šviewgroupä¼šè¦†ç›–å­ç±»æŽ§ä»¶è€Œç›´æŽ¥èŽ·å¾—ç„¦ç‚¹ï¼ˆä¸€èˆ¬åœ¨ListViewçš„è‡ªå®šä¹‰Itemå¸ƒå±€çš„æ ¹å¸ƒå±€åŠ ä¸Šä½¿ç”¨æ­¤å€¼ï¼Œèƒ½è§£å†³å› å­æŽ§ä»¶å°†ç„¦ç‚¹èŽ·å–è€Œå¯¼è‡´ç‚¹å‡»itemæ—¶å˜åŒ–çš„æ˜¯å­æŽ§ä»¶ä½†itemæœ¬èº«çš„ç‚¹å‡»æ²¡æœ‰å“åº”çš„é—®é¢˜ã€‚ï¼‰ splitMotionEventsï¼šå¸ƒå°”å€¼ï¼Œå®šä¹‰å¸ƒå±€æ˜¯å¦ä¼ é€’touchäº‹ä»¶åˆ°å­å¸ƒå±€ layoutModeï¼šï¼ˆå¯è®¾å€¼ï¼šclipBoundså‰ªè¾‘å­æŽ§ä»¶çš„è¾¹ç•Œ/opticalBoundså¯è§†çš„å­æŽ§ä»¶è¾¹ç•Œï¼‰ backgroundï¼šæœ¬å…ƒç´ çš„èƒŒæ™¯ foregroundï¼šè®¾ç½®å¸ƒå±€çš„å‰æ™¯å›¾ï¼Œå‰æ™¯å›¾ä¸ä¼šè¢«å­å…ƒç´ è¦†ç›– foregroundGravityï¼šè®¾ç½®å¸ƒå±€å‰æ™¯å›¾çš„ä½ç½® foregroundInsidePadding scrollX/Yï¼šæœ€åˆçš„æ°´å¹³/ç«–ç›´æ»šåŠ¨çš„åç§»ï¼Œä»¥åƒç´ ä¸ºå•ä½ focusableï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦èƒ½èŽ·å¾—ç„¦ç‚¹ï¼ˆæŒ‰é”®ï¼‰ focusableInTouchModeï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡touchèŽ·å–åˆ°ç„¦ç‚¹ fitsSystemWindowsï¼šå¸ƒå°”å€¼ï¼Œå¸ƒå±€è°ƒæ•´æ—¶æ˜¯å¦è€ƒè™‘ç³»ç»Ÿçª—å£(å¦‚çŠ¶æ€æ ) fadeScrollbarsï¼šå¸ƒå°”å€¼ï¼Œæ»šåŠ¨æ¡æ˜¯å¦è‡ªåŠ¨éšè— fadingEdgeï¼šè®¾ç½®æ‹‰æ»šåŠ¨æ¡æ—¶ï¼Œè¾¹æ¡†æ¸å˜çš„æ–¹å‘ï¼ˆå¯è®¾å€¼ï¼šnoneè¾¹æ¡†é¢œè‰²ä¸å˜ã€horizontalæ°´å¹³æ–¹å‘é¢œè‰²å˜æ·¡ã€verticalåž‚ç›´æ–¹å‘é¢œè‰²å˜æ·¡ï¼‰ã€‚ fadingEdgeLengthï¼šæ»šåŠ¨æ¡æ¸å˜é•¿åº¦ filterTouchesWhenObscuredï¼šå¸ƒå°”å€¼ï¼Œæ‰€åœ¨çª—å£è¢«å…¶å®ƒå¯è§çª—å£é®ä½æ—¶ï¼Œæ˜¯å¦è¿‡æ»¤è§¦æ‘¸äº‹ä»¶ visibilityï¼šæ˜¯å¦å¯è§ï¼ˆå¯è®¾å€¼ï¼šgone/visible/invisibleè™½ä¸å¯è§ï¼Œä½†å æ®å¸ƒå±€ä½ç½®) scrollbarsï¼šè®¾ç½®æ»šåŠ¨æ¡ï¼ˆå¯è®¾å€¼ï¼šnone/horizontal/verticalï¼‰ scrollbarStyleï¼šå¯è®¾å€¼ï¼š outsideInsetï¼šScrollBaræ˜¾ç¤ºåœ¨è§†å›¾(view)çš„è¾¹ç¼˜,å¢žåŠ äº†viewçš„padding. å¦‚æžœå¯èƒ½çš„è¯,è¯¥ScrollBarä»…ä»…è¦†ç›–è¿™ä¸ªviewçš„èƒŒæ™¯. insideInsetï¼šè¯¥ScrollBaræ˜¾ç¤ºåœ¨paddingåŒºåŸŸé‡Œé¢,å¢žåŠ äº†æŽ§ä»¶çš„paddingåŒºåŸŸ,è¯¥ScrollBarä¸ä¼šå’Œè§†å›¾çš„å†…å®¹é‡å . outsideOverlayï¼šè¯¥ScrollBaræ˜¾ç¤ºåœ¨è§†å›¾(view)çš„è¾¹ç¼˜,ä¸å¢žåŠ viewçš„padding,è¯¥ScrollBarå°†è¢«åŠé€æ˜Žè¦†ç›– insideOverlayï¼šè¯¥ScrollBaræ˜¾ç¤ºåœ¨å†…å®¹åŒºåŸŸé‡Œé¢,ä¸ä¼šå¢žåŠ äº†æŽ§ä»¶çš„paddingåŒºåŸŸ,è¯¥ScrollBarä»¥åŠé€æ˜Žçš„æ ·å¼è¦†ç›–åœ¨è§†å›¾(view)çš„å†…å®¹ isScrollContainerï¼šå¸ƒå°”å€¼ï¼Œè®¾ç½®å½“å‰Viewæ˜¯å¦ä¸ºæ»šåŠ¨å®¹å™¨ï¼ˆæ˜¯å¦å¯ä»¥ä¸ºè¾“å…¥æ³•è…¾å‡ºç©ºé—´è€Œéšè—ï¼‰ scrollbarFadeDurationï¼šè¤ªè‰²æ—¶é—´ scrollbarDefaultDelayBeforeFadeï¼šè®¾ç½®æ»šåŠ¨æ¡Næ¯«ç§’åŽå¼€å§‹æ·¡åŒ–ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚ scrollbarSizeï¼šè®¾ç½®æ»šåŠ¨æ¡å¤§å° scrollbarThumbHorizontal/Verticalï¼šè®¾ç½®æ°´å¹³/åž‚ç›´æ»šåŠ¨æ¡çš„drawable scrollbarTrackHorizontal/Verticalï¼šè®¾ç½®æ°´å¹³/åž‚ç›´æ»šåŠ¨æ¡èƒŒæ™¯ï¼ˆè½¨è¿¹ï¼‰çš„drawable scrollbarAlwaysDrawHorizontalTrack/VerticalTrackï¼šå¸ƒå°”å€¼ï¼Œè®¾ç½®æ°´å¹³æ»šåŠ¨æ¡æ˜¯å¦å«æœ‰è½¨é“ scrollbarAlwaysDrawï¼šå¸ƒå°”å€¼ï¼Œè®¾ç½®åž‚ç›´æ»šåŠ¨æ¡æ˜¯å¦å«æœ‰è½¨é“ requiresFadingEdgeï¼šå®šä¹‰è¤ªè‰²æ—¶æ»šåŠ¨è¾¹ç¼˜ï¼ˆå¯è®¾å€¼ï¼šnone/horizontal/verticalï¼‰ nextFocusLeft/Right/Up/Down/Forwardï¼šUpé”®æŒ‰ä¸‹ä¹‹åŽï¼Œå“ªä¸€ä¸ªæŽ§ä»¶èŽ·å¾—ç„¦ç‚¹ï¼ˆè¢«é€‰ä¸­ï¼‰ clickableï¼šå¸ƒå°”å€¼ longClickableï¼šå¸ƒå°”å€¼ saveEnabledï¼šå¸ƒå°”å€¼ï¼Œè®¾ç½®æ˜¯å¦åœ¨çª—å£å†»ç»“æ—¶ï¼ˆå¦‚æ—‹è½¬å±å¹•ï¼‰ä¿å­˜Viewçš„æ•°æ® drawingCacheQualityï¼šè®¾ç½®ç»˜å›¾ç¼“å­˜è´¨é‡ï¼ˆå¯è®¾å€¼ï¼šauto/low/hightï¼‰ keepScreenOnï¼šå¸ƒå°”å€¼ï¼ŒViewåœ¨å¯è§çš„æƒ…å†µä¸‹æ˜¯å¦ä¿æŒå”¤é†’çŠ¶æ€ duplicateParentStateï¼šå¸ƒå°”å€¼ï¼Œå¦‚æžœè®¾ç½®æ­¤å±žæ€§ï¼Œå°†ç›´æŽ¥ä»Žçˆ¶å®¹å™¨ä¸­èŽ·å–ç»˜å›¾çŠ¶æ€ï¼ˆå…‰æ ‡ï¼ŒæŒ‰ä¸‹ç­‰ï¼‰ã€‚ æ³¨æ„æ ¹æ®ç›®å‰æµ‹è¯•æƒ…å†µä»…ä»…æ˜¯èŽ·å–ç»˜å›¾çŠ¶æ€ï¼Œè€Œæ²¡æœ‰èŽ·å–äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯ä½ ç‚¹ä¸€ä¸‹LinearLayoutæ—¶Buttonæœ‰è¢«ç‚¹å‡»çš„æ•ˆæžœï¼Œä½†æ˜¯ä¸æ‰§è¡Œç‚¹å‡»äº‹ä»¶ã€‚ minHeight/Width soundEffectsEnabledï¼šå¸ƒå°”å€¼ï¼Œè®¾ç½®ç‚¹å‡»æˆ–è§¦æ‘¸æ—¶æ˜¯å¦æœ‰å£°éŸ³æ•ˆæžœ hapticFeedbackEnabledï¼šå¸ƒå°”å€¼ï¼Œå®žçŽ°å•å‡»æŸä¸ªè§†å›¾ï¼Œç³»ç»Ÿæä¾›ä¸€ä¸ªè§¦åŠ›åé¦ˆï¼ˆéœ‡åŠ¨ä¸€ä¸‹ï¼‰ contentDescriptionï¼šå›¾ç‰‡ä¸å¯è§æ—¶çš„æ–‡å­—æè¿°ï¼ˆç›²äººï¼‰ onClickï¼šè§¦å‘æ–¹æ³• overScrollModeï¼šæ»šåŠ¨åˆ°è¾¹ç•Œæ—¶çš„æ•ˆæžœï¼ˆå¯è®¾å€¼ï¼šifContentScrolls/always/neverï¼‰ alphaï¼šé€æ˜Žåº¦ï¼Œå°æ•°è¡¨ç¤ºå æ¯” translationX/Yï¼šX/Yè½´çš„åç§»è·ç¦» transformPivotX/Yï¼šä»ŽæŸç‚¹çš„X/Yè½´åç§»è·ç¦» rotationï¼šæ—‹è½¬ï¼ˆXå’ŒYè½´åŒæ—¶ï¼‰ rotationX/Y scaleX/Yï¼šè®¾ç½®X/Yè½´ç¼©æ”¾æ¯”ä¾‹ verticalScrollbarPositionï¼šè®¾ç½®åž‚ç›´æ»šåŠ¨æ¡çš„ä½ç½®ï¼ˆå¯è®¾å€¼ï¼šdefaultPosition/left/rightï¼‰ layerTypeï¼šç»˜å›¾æ˜¯å¦å¼€å¯ç¡¬ä»¶åŠ é€Ÿï¼ˆå¯è®¾å€¼ï¼šnone/hardware/softwareï¼‰ layoutDirectionï¼šå®šä¹‰å¸ƒå±€å›¾çº¸çš„æ–¹å‘ textDirectionï¼šæ–‡å­—æŽ’åˆ—æ–¹å‘ textAlignmentï¼šæ–‡å­—å¯¹é½æ–¹å¼ï¼ˆå¯è®¾å€¼ï¼šinherit/â€¦ï¼‰ importantForAccessibilityï¼šè®¾ç½®å¯è¾¾æ€§çš„é‡è¦è¡Œï¼ˆå¯è®¾å€¼ï¼šnoHideDescendants/â€¦ï¼‰ accessibilityLiveRegionï¼š labelForï¼šæ·»åŠ æ ‡ç­¾ measureAllChildrenï¼šå¸ƒå°”å€¼ï¼Œæµ‹é‡æ—¶æ˜¯å¦è€ƒè™‘æ‰€æœ‰æ‰€æœ‰å­æŽ§ä»¶ï¼Œä¸è€ƒè™‘åˆ™æŒ‰æ˜¯å¦æ˜¾ç¤ºæ¥æµ‹é‡ animateLayoutChangesï¼šå¸ƒå°”å€¼ï¼Œæ·»åŠ é»˜è®¤å¸ƒå±€åŠ¨ç”» clipChildrenï¼šå¸ƒå°”å€¼ï¼Œå­æŽ§ä»¶æ˜¯å¦è¦åœ¨å®ƒåº”æœ‰çš„è¾¹ç•Œå†…è¿›è¡Œç»˜åˆ¶ clipToPaddingï¼šå¸ƒå°”å€¼ï¼ŒViewGroupæ˜¯å¦å…è®¸åœ¨paddingä¸­ç»˜åˆ¶ï¼ˆé…åˆclipChildrené€‚åˆåšæ”¾å¤§ç­‰çš„ç‚¹å‡»ç‰¹æ•ˆï¼Œä¸ç”¨åŽ»æ›´æ”¹å¸ƒå±€ï¼Œåªéœ€åŠ å…¥è¿™ä¸¤ä¸ªå±žç›¸å¹¶å¼•å…¥åŠ¨ç”»æ•ˆæžœå³å¯å®žçŽ°ï¼‰ layoutAnimationï¼šè®¾ç½®layoutåŠ¨ç”» animationCacheï¼šå®šä¹‰å­å¸ƒå±€ä¹Ÿæœ‰åŠ¨ç”»æ•ˆæžœ persistentDrawingCache alwaysDrawnWithCacheï¼šå®šä¹‰å­å¸ƒå±€æ˜¯å¦åº”ç”¨ç»˜å›¾çš„é«˜é€Ÿç¼“å­˜ æ‹¿æœ€å¼ºå¤§çš„ConstraintLayoutä¸¾ä¾‹ &lt;android.support.constraint.ConstraintLayout android:layout_width="match_parent" android:layout_height="match_parent"&gt; &lt;Button android:id="@+id/login_btn" ... app:layout_constraintTop_toTopOf="parent" app:layout_constraintLeft_toLeftOf="parent" app:layout_constraintRight_toRightOf="parent" app:layout_constraintBottom_toBottomOf="parent" /&gt; &lt;EditText android:id="@+id/password_textview" ... app:layout_constraintVertical_bias="0.5" app:layout_constraintBottom_toTopOf="@+id/login_btn" app:layout_constraintTop_toTopOf="@id/accoutn_textview" app:layout_constraintLeft_toLeftOf="parent" app:layout_constraintRight_toRightOf="parent"/&gt; &lt;EditText android:id="@+id/accoutn_textview" ... app:layout_constraintVertical_bias="0.8" app:layout_constraintBottom_toTopOf="@+id/password_textview" app:layout_constraintTop_toTopOf="parent" app:layout_constraintLeft_toLeftOf="parent" app:layout_constraintRight_toRightOf="parent" /&gt; &lt;TextView android:id="@+id/separate_line" ... app:layout_constraintVertical_bias="0.2" app:layout_constraintTop_toBottomOf="@+id/login_btn" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintLeft_toLeftOf="parent" app:layout_constraintRight_toRightOf="parent" /&gt; &lt;Button android:id="@+id/guest_btn" ... app:layout_constraintHorizontal_bias="0.3" app:layout_constraintVertical_bias="0.2" app:layout_constraintTop_toBottomOf="@+id/separate_line" app:layout_constraintLeft_toLeftOf="parent" app:layout_constraintRight_toRightOf="parent" app:layout_constraintBottom_toBottomOf="parent"/&gt; &lt;/android.support.constraint.ConstraintLayout&gt; åœ¨Activityä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åº”ç”¨å¸ƒå±€ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶ç”¨ä»£ç  setContentView(R.layout.main_layout);æ‰¾åˆ°å¸ƒå±€åŽæŽ¥ç€ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ ¹æ®èµ„æºIDèŽ·å–å¸ƒå±€ä¸­çš„è§†å›¾ Button myButton = (Button) findViewById(R.id.my_button);ToolBarè‡ªå®šä¹‰ç¤ºä¾‹ï¼ˆä¸èƒ½ç”¨android:styleï¼Œåªèƒ½ç”¨android:themeï¼‰ &lt;android.support.design.widget.AppBarLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent" android:layout_height="wrap_content" android:theme="@style/AppTheme.AppBarOverlay" &gt; &lt;android.support.v7.widget.Toolbar android:id="@+id/toolbar" android:layout_width="match_parent" android:layout_height="?attr/actionBarSize" android:background="?attr/colorPrimary" app:contentInsetEnd="0dp" app:contentInsetLeft="0dp" app:contentInsetRight="0dp" app:contentInsetStart="0dp" app:popupTheme="@style/AppTheme.PopupOverlay"&gt; &lt;LinearLayout android:layout_width="wrap_content" android:layout_height="wrap_content" android:orientation="vertical" android:layout_gravity="center"&gt; &lt;TextView android:id="@+id/toolbar_title" android:layout_width="match_parent" android:layout_height="match_parent" android:layout_weight="2" android:textAlignment="center" android:textColor="@color/colorBlack" android:gravity="center" /&gt; &lt;TextView android:id="@+id/toolbar_subtitle" android:layout_width="match_parent" android:layout_height="match_parent" android:layout_weight="1" android:textAlignment="center" android:textColor="@color/colorDark" android:layout_gravity="center"/&gt; &lt;/LinearLayout&gt; &lt;/android.support.v7.widget.Toolbar&gt; &lt;/android.support.design.widget.AppBarLayout&gt; ListViewå…¶å®žListViewæœ¬èº«æ²¡å¤šå°‘å†…å®¹éœ€è¦è®²ï¼Œå…¶ä¸»è¦å¾—ä¾é ä¸€ä¸ªæ‰©å±•(ç»§æ‰¿)äºŽBaseAdapterçš„é€‚é…å™¨ï¼Œæ¥èŽ·å–æ•°æ®æºçš„Itemæ•°ã€Itemæ ‡è¯†ã€Itemè§†å›¾ mMyAdapter = new MyAdapter(this, R.layout.list_item, datas); mListView = (ListView) findViewById(R.id.list); mListView.setAdapter(mMyAdapter);//ä¸èƒ½èµ‹null mListView.setOnItemClickListener(new AdapterView.OnItemClickListener() &#123; @Override public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &#123; updateData(mMyAdapter.getItem(position)); &#125; &#125;); public class MyAdapter extends ArrayAdapter&lt;GameInterface&gt; &#123; private ArrayList&lt;ModelInterface&gt; mDatas; private int resourceId; private Context context; public MyAdapter(Context context, int resourceId, ArrayList&lt;ModelInterface&gt; objects) &#123; super(context, resourceId, objects); this.mDatas = objects; this.resourceId = resourceId; this.context = context; &#125; @Override public int getCount() &#123; return mDatas == null ? 0 : mDatas.size(); &#125; @Override public GameInterface getItem(int position) &#123; if (mDatas == null || mDatas.size() &lt;= position)&#123; return null; &#125; return mDatas.get(position); &#125; @Override public long getItemId(int position) &#123; return position; &#125; @Override public View getView(int position, View convertView, ViewGroup parent) &#123; ModelInterface game = (ModelInterface) getItem(position); View view; ViewHolder viewHolder; if (convertView == null) &#123; view = LayoutInflater.from(getContext()).inflate(resourceId, null); viewHolder = new ViewHolder(); viewHolder.titleView = (TextView) view.findViewById(R.id.title_view); viewHolder.contentView = (TextView) view.findViewById(R.id.content_view); view.setTag(viewHolder); //ç¼“å­˜ &#125; else &#123; view = convertView; viewHolder = (ViewHolder) view.getTag(); &#125; viewHolder.titleView.setText("title"); viewHolder.contentView.setText("content"); return view; &#125; class ViewHolder &#123; TextView titleView; TextView contentView; &#125; &#125; RecyclerViewå¯¹æ¯”ListViewï¼ŒRecyclerViewå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåŠ å¼ºç‰ˆçš„ListViewï¼Œå®ƒæ›´çµæ´»ã€è‡ªå®šä¹‰æ›´å®¹æ˜“ï¼Œå›žæ”¶æœºåˆ¶ä¹Ÿæ›´å®Œå–„ã€æ€§èƒ½æ›´å¥½ã€æ»‘åŠ¨æ›´æµç•…ã€‚çµæ´»ä½“çŽ°åœ¨RecyclerViewæ‰€ç»†åˆ†çš„å„å¸å…¶èŒçš„å¯¹è±¡ LayoutManager //å¸ƒå±€ç®¡ç†å™¨ ListView GridView ç€‘å¸ƒæµ Adapter //é€‚é…å™¨ ItemAnimator //Itemçš„åŠ¨ç”» ItemDecoration //Itemçš„åˆ†å‰² å…¶æ¬¡RecycleViewè¿˜æä¾›äº†ï¼š æä¾›äº†å±€éƒ¨åˆ·æ–° æ”¯æŒåµŒå¥—æ»‘åŠ¨ï¼ˆNestedScrollViewæˆ–è€…CoordinatorLayoutï¼‰ æŠŠç‚¹å‡»äº‹ä»¶çš„æŽ§åˆ¶æƒå®Œå…¨çš„äº¤ç»™å¼€å‘è€…ï¼Œé¿å…äº†Itemä¸Žå…¶å†…çš„æŽ§ä»¶ç‚¹å‡»äº‹ä»¶çš„å†²çª åˆ›å»ºä¸€ä¸ªæœ€æ™®é€šçš„RecyclerViewç¤ºä¾‹ mMyRecyclerView = findViewById(R.id.my_recyclerview); mMyAdapter = new MyAdapter(this); mMyAdapter.setOnItemClickListener(this); // åˆ›å»ºRecyclerViewçš„å¸ƒå±€ç®¡ç†å™¨ LinearLayoutManager layoutManager = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false); mMyRecyclerView.setLayoutManager(layoutManager); mMyRecyclerView.setAdapter(mMyAdapter); // åˆ›å»ºItemåˆ†å‰²æ ·å¼ DividerItemDecoration dividerItemDecoration = new DividerItemDecoration(this, DividerItemDecoration.VERTICAL); dividerItemDecoration.setDrawable(getResources().getDrawable(R.drawable.inset_recyclerview_divider)); mMyRecyclerView.addItemDecoration(dividerItemDecoration); // åˆ›å»ºï¼ˆé»˜è®¤ï¼‰ItemåŠ¨ç”»æ•ˆæžœ mMyRecyclerView.setItemAnimator(new DefaultItemAnimator()); /// RecyclerView Adapter public class MyAdapter extends RecyclerView.Adapter &lt;MyAdapter.ViewHolder&gt; &#123; private LayoutInflater mLayoutInflater; private Context mContext; private ArrayList&lt;ReportModel&gt; datas; private OnClickItemListener mOnItemClickListener; public interface OnClickItemListener &#123; void onClickItem(Model model); &#125; public MyAdapter(Context context) &#123; this.mLayoutInflater = LayoutInflater.from(context); this.mContext = context; this.datas = new ArrayList&lt;ReportModel&gt;(); &#125; @NonNull @Override public MyViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) &#123; //å½“Itemçš„ViewHolderå¤ç”¨æ± ä¸­ä¸å¤Ÿæ˜¾ç¤ºæ•°é‡æ—¶éœ€åˆ›å»ºViewHolderçš„æ–¹æ³•è¿›è¡Œå›žè°ƒå¼çš„å°è£…ï¼ˆå¯¹åº”ç€éœ€æ˜¾ç¤ºçš„Viewï¼Œè€ŒViewç”±RecyclerViewå†…éƒ¨åˆ›å»ºï¼‰ return new MyViewHolder(mLayoutInflater.inflate(R.layout.list_item , viewGroup, false)); &#125; @Override public void onBindViewHolder(@NonNull final MyViewHolder viewHolder, int i) &#123; //å¯¹å¤ç”¨çš„ViewHolderè¿›è¡Œæ›´æ–°ï¼Œä¹Ÿé‡‡ç”¨å›žè°ƒå¼çš„å°è£… final Model model = (Model)datas.get(i); viewHolder.titleView.setText("title"); viewHolder.contentView.setText("content"); viewHolder.accountSubTitle.setText(report.getCreatedUser()); viewHolder.imageView.setImageResource(R.drawable.item_image); viewHolder.itemLayout.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; mOnItemClickListener.onClickItem(model); &#125; &#125;); &#125; &#125; @Override public int getItemCount() &#123; return datas == null ? 0 : datas.size(); &#125; public static class MyViewHolder extends RecyclerView.ViewHolder &#123; public TextView titleView; public TextView contentView; public ImageView imageView; RelativeLayout itemLayout; MyViewHolder(View view) &#123; super(view); titleView = view.findViewById(R.id.list_item_title); contentView = view.findViewById(R.id.list_item_content); imageView = view.findViewById(R.id.list_item_iamge); itemLayout = view.findViewById(R.id.list_item_relative_layout); &#125; &#125; public void setOnItemClickListener(OnClickItemListener listener) &#123; this.mOnItemClickListener = listener; &#125; &#125; å…¶å®ƒé›†åˆView ViewPagerï¼ˆä»£æ›¿ä»¥å¾€çš„Galleryï¼‰ HorizontalScrollViewï¼ˆä»£æ›¿ä»¥å¾€çš„Galleryï¼‰ GridView NestedScrollView æŽ§ä»¶ TextViewç±»ä¼¼iOSä¸­çš„UILable &lt;TextView android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/colorBlue" android:gravity="bottom" android:textAlignment="center" android:padding="4dp" android:text="@string/title" android:textColor="@color/colorBlack" android:textStyle="bold" Â·Â·Â·/&gt; EditViewç±»ä¼¼iOSä¸­UITextFieldã€UITextView &lt;EditText android:layout_width="250dp" android:layout_height="wrap_content" android:gravity="center_vertical" android:background="@android:drawable/edit_text" android:imeOptions="actionDone" android:hint="è¯·è¾“å…¥å¯†ç " android:inputType="textPassword" android:textColorHint="@color/colorDark" Â·Â·Â·/&gt; //TextView.OnEditorActionListener editView.setOnEditorActionListener(this); @Override public boolean onEditorAction(TextView v, int actionId, KeyEvent event) &#123; Log.d("", "text: " + v.getText().toString()); return false; &#125; Button &lt;Button android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="æŒ‰é’®" Â·Â·Â·/&gt; ImageView &lt;ImageView android:layout_width="0dp" android:layout_height="30dp" android:src="@drawable/ic_image" android:gravity="center" Â·Â·Â·/&gt; imageView.setImageResource("R.id.image"); ProgressBar &lt;ProgressBar android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center" android:visibility="gone"/&gt; progressBar.setVisibility(View.VISIBLE); progressBar.setVisibility(View.GONE); Spinner &lt;Spinner android:entries="@array/distribute_platform" android:spinnerMode="dialog" android:layout_width="match_parent" android:layout_height="0dp" android:layout_weight="1" android:layout_margin="5dp" android:textColor="@color/colorBlack" /&gt; &lt;resources&gt; &lt;string-array name="distribute_platform"&gt; &lt;item&gt;1&lt;/item&gt; &lt;item&gt;2&lt;/item&gt; &lt;item&gt;3&lt;/item&gt; &lt;/string-array&gt; &lt;/resources&gt; SearchView &lt;SearchView Â·Â·Â· android:iconifiedByDefault="false" android:queryHint="è¯·è¾“å…¥gameCodeæœç´¢"&gt; &lt;/SearchView&gt; SearchView mSearchView = findViewById(R.id.search_bar); mSearchView.setEnabled(true); mSearchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() &#123; // å½“ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶è§¦å‘è¯¥æ–¹æ³• @Override public boolean onQueryTextSubmit(String query) &#123; // æŸ¥è¯¢ã€è¿‡æ»¤ return true; &#125; // å½“æœç´¢å†…å®¹æ”¹å˜æ—¶è§¦å‘è¯¥æ–¹æ³• @Override public boolean onQueryTextChange(String newText) &#123; if (newText.isEmpty()) &#123; // åˆ·æ–°ç•Œé¢ &#125; return false; &#125; &#125;); Switch &lt;Switch android:layout_width="wrap_content" android:layout_height="@dimen/test_config_list_item_height" android:scaleX="2" android:scaleY="2" android:textOff="" android:textOn="" android:gravity="center" Â·Â·Â· /&gt; //CompoundButton.OnCheckedChangeListener switch.setChecked(true); switch.setOnCheckedChangeListener(this); @Override public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) &#123; Integer buttonPosition = (Integer) buttonView.getTag(buttonNumber); Â·Â·Â· &#125; ç›‘å¬è€… Listenerå¯ä»¥ç”¨åˆ°ç›‘å¬è€…çš„åœºæ™¯åŒ…æ‹¬ï¼š æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„å“åº” ä¸‹çº§é¡µé¢çš„å›žè°ƒæ–¹æ³•æä¾› åˆ—è¡¨Itemæˆ–å…¶å­æŽ§ä»¶çš„ç‚¹å‡»äº‹ä»¶çš„å“åº” å¯¼èˆªæ çš„Itemç‚¹å‡»äº‹ä»¶çš„å“åº” TextViewç¼–è¾‘åŠ¨ä½œçš„ç›‘å¬ å…¶å®žå®ƒå°±å’ŒiOSä¸­çš„ä»£ç†æ¨¡å¼å¦‚å‡ºä¸€è¾™ï¼Œlinsteneræ˜¯åŽ»å®žçŽ°Interfaceçš„ï¼Œdelegateå¯¹è±¡æ˜¯è®¤é¢†éµå¾ªä¸€ä¸ªProtocolçš„ï¼Œå®ƒä»¬åœ¨æ¦‚å¿µä¸Šçš„åŒºåˆ«æ˜¯ï¼š åè®®ï¼Œæ˜¯å½“å§”æ‰˜å¯¹è±¡æ‰§è¡ŒæŸæ–¹æ³•ä¸­ï¼Œéœ€è¦ä¸€ä¸ªéµå¾ªæŸåè®®çš„å¯¹è±¡å¸®å¿™å®Œæˆè¯¥åè®®ä¸­çš„äº‹æƒ…æ—¶ï¼Œå°±ä¼šå§”æ‰˜å®ƒæ‰€æŒæœ‰çš„delegateå±žæ€§(ä»£ç†å¯¹è±¡)åŽ»æ‰§è¡Œåè®®æ–¹æ³• ç›‘å¬ï¼Œæ˜¯å½“æ‰§è¡ŒæŸæ–¹æ³•çš„ä¸­çš„ä¸»ä½“ï¼Œè®¤ä¸ºæ­¤æ—¶éœ€è¦å‘ŠçŸ¥å®ƒæ‰€æŒæœ‰çš„éœ€è¦çŸ¥é“æ­¤åˆ»æ­¤æƒ…å†µçš„ç›‘å¬è€…çš„è¯(å› æ­¤èŽ·å–é€šçŸ¥çš„æ–¹æ³•æ˜¯ä¸»ä½“æ‰€å®šä¹‰)ï¼Œå°±ä¼šè°ƒç”¨listenerå±žæ€§(ç›‘å¬è€…)åŽ»æ‰§è¡ŒæŽ¥å£å®šä¹‰ä¸­èŽ·å–é€šçŸ¥çš„æ–¹æ³• ç¤ºä¾‹ // demo1 public class MySecondActivity extends AppCompatActivity &#123; public CallbackListener mCallbackListener; public interface CallbackListener &#123; void onCallback(Model model); &#125; private void doSomething() &#123; Â·Â·Â· this.mCallbackListener = this.context; mCallbackListenr.onCallback(data); Â·Â·Â· &#125; &#125; public class MyFirstActivity extends AppCompatActivity implements MySecondActivity.CallbackListener &#123; private void onCallback(Model model) &#123; // update Â·Â·Â· &#125; private void doSomething() &#123; Intent intent = new Intent(this, MySecondActivity.class); startActivity(intent); &#125; &#125; // demo2 Button button = findViewById(R.id.button_id); button.setOnClickListener(new View.OnClickListener() &#123; //åˆ›å»ºä¸€ä¸ªå®žçŽ°OnClickListeneræŽ¥å£çš„å†…éƒ¨åŒ¿åç±»å¹¶åŒæ—¶è¿›è¡Œå®žä¾‹åŒ–newï¼Œç›‘å¬æŒ‰é’®çš„ç‚¹å‡» @Override public void onClick(View v) &#123; Â·Â·Â· &#125; &#125;); å½“ç„¶ï¼ŒInterfaceå¹¶ä¸ä»…ä»…å±€é™äºŽç›‘å¬è€…è¿™ä¸ªæ¦‚å¿µä¸Šï¼Œä½œä¸ºè§£è€¦ã€æŠ½è±¡çš„åˆ©å™¨ï¼Œä½œç”¨èŒƒå›´éžå¸¸å¹¿ï¼Œå°±çœ‹æ€Žä¹ˆåŽ»ç»“åˆä½ çš„è®¾è®¡æ¨¡å¼åŽ»åˆ©ç”¨ï¼Œä¾‹å¦‚å¯¹å¤šç§åŒç±»çš„æ¨¡åž‹å¯¹è±¡è¿›è¡ŒæŠ½è±¡ï¼Œä½¿å±•ç¤ºé¡µé¢ä¸Žè¿™ç§ç§ç±»é€»è¾‘è§£è€¦ï¼Œå°±å¯ä»¥ç”¨åˆ°æŽ¥å£è®¾è®¡ï¼Œç­‰ç­‰ã€‚ èµ„æºèµ„æº-å®˜æ–¹æ–‡æ¡£ Androidåº”ç”¨çš„èµ„æºï¼Œæ˜¯æŒ‡ä»£ç ä½¿ç”¨çš„é™„åŠ æ–‡ä»¶å’Œé™æ€å†…å®¹ï¼Œä¾‹å¦‚ä½å›¾ã€å¸ƒå±€å®šä¹‰ã€ç•Œé¢å­—ç¬¦ä¸²ã€åŠ¨ç”»è¯´æ˜Žç­‰ï¼Œéƒ½é›†ä¸­å­˜æ”¾äºŽresï¼ˆsrc/main/resï¼‰å’Œassetsæ–‡ä»¶å¤¹ä¸‹ï¼Œè¿™æ ·æ‰èƒ½èµ·åˆ°èµ„æºè„±ç¦»ä»£ç å®žçŽ°å¤–éƒ¨åŒ–ï¼Œä»¥ä¾¿å•ç‹¬å¯¹å…¶è¿›è¡Œç»´æŠ¤ã€‚ æ‰€æœ‰èµ„æºIDéƒ½åœ¨é¡¹ç›®çš„Rç±»ä¸­è¿›è¡Œå®šä¹‰ï¼Œè¯¥ç±»ç”±aaptå·¥å…·è‡ªåŠ¨ç”Ÿæˆï¼Œåœ¨Rç±»ä¸­é€šè¿‡èµ„æºç±»åž‹+èµ„æºåç§°è¿™æ ·çš„ç»„åˆæ¥è®¿é—®èµ„æºã€‚ä¾‹å¦‚ï¼š //ä»£ç ä¸­ R.string.hello //XMLä¸­ @string/hello //æ ¼å¼æ¨¡æ¿ [&lt;package_name&gt;.]R.&lt;resource_type&gt;.&lt;resource_name&gt; @[&lt;package_name&gt;:]&lt;resource_type&gt;/&lt;resource_name&gt; åŒä¸€ç§èµ„æºç±»åž‹resource_typeï¼Œè¿˜å¯åŒºåˆ†ä¸åŒçš„è¯­è¨€å’Œå±å¹•å¯†åº¦ã€‚ resresä¸­åŒ…å«ä»¥ä¸‹å¸¸è§çš„èµ„æºç±»åž‹ animatorï¼šå®šä¹‰å±žæ€§åŠ¨ç”» drawableï¼šå­˜æ”¾ä½å›¾æ–‡ä»¶ã€å¯ç»˜åˆ¶å¯¹è±¡ mipmapï¼šå¯åŠ¨å™¨çš„å¯ç»˜åˆ¶å¯¹è±¡ layoutï¼šå®šä¹‰ç•Œé¢å¸ƒå±€ menuï¼šå®šä¹‰åº”ç”¨èœå• rawï¼šä»¥åŽŸå§‹å½¢å¼ä¿å­˜çš„ä»»æ„æ–‡ä»¶ï¼Œè¿è¡Œæ—¶é€šè¿‡ Resources.openRawResource() ï¼Œ èµ„æºIDä¸ºR.raw.filename valuesï¼šåŒ…å«å­—ç¬¦ä¸²ã€æ•´åž‹æ•°å’Œé¢œè‰²ç­‰ç®€å•å€¼ã€‚åƒæŽ§ä»¶ã€å­—ç¬¦ç­‰çš„é¢œè‰²(colors)ï¼Œé—´è·(dimens)ï¼Œå­—ç¬¦ä¸²(strings)ï¼ŒæŽ§ä»¶æ ·å¼(style) xmlï¼šè‡ªå®šä¹‰çš„é…ç½®ï¼Œè¿è¡Œæ—¶é€šè¿‡ Resources.getXML() è¯»å– fontï¼šå­—ä½“ &lt;resources xmlns:android="http://schemas.android.com/apk/res/android"&gt;//å¯¼å…¥å¯å¼•ç”¨Rç±»ä¸­çš„èµ„æºID &lt;item name="ic_menu_camera" type="drawable"&gt;@android:drawable/ic_menu_camera&lt;/item&gt; &lt;/resources&gt; å¦‚æžœè¿˜è¦å¼•ç”¨å…¶å®ƒè¾…åŠ©åŠŸèƒ½çš„è¯ï¼Œå¸ƒå±€ä¸Šåˆ™éœ€è¦å¸¦ä¸Š xmlns:app=â€http://schemas.android.com/apk/res-auto&quot; å’Œ xmlns:tools=â€http://schemas.android.com/tools&quot; çš„å£°æ˜Žï¼Œä¸è¿‡ä¸€èˆ¬åªåœ¨Layoutä¸Šä½¿ç”¨è¾ƒå¤šã€‚ assetsassets/ä¸­çš„æ–‡ä»¶æ²¡æœ‰èµ„æºIDï¼Œå› æ­¤åªèƒ½ä½¿ç”¨AssetManagerè¯»å–è¿™äº›æ–‡ä»¶ã€‚å¦‚éœ€è®¿é—®åŽŸå§‹æ–‡ä»¶åå’Œæ–‡ä»¶å±‚æ¬¡ç»“æž„ï¼Œå°±åº”è€ƒè™‘å°†æŸäº›èµ„æºä¿å­˜åœ¨assets/ç›®å½•ã€‚ æ¨¡åž‹ Modelæ•°æ®çš„èŽ·å–ã€å­˜å‚¨ã€æ•°æ®çŠ¶æ€å˜åŒ–éƒ½å°†æ˜¯Modelå±‚çš„ä»»åŠ¡ã€‚è€Œå•å•æè¿°ä¸€ä¸ªäº‹ç‰©å¯¹è±¡å±žæ€§çš„ç±»ï¼Œåªèƒ½ç§°ä¹‹ä¸ºValue Objectï¼Œæ˜¯æ¨¡åž‹å±‚çš„ä¸€éƒ¨åˆ†è€Œå·²ã€‚ å…ˆä»ŽModelå±‚çš„æž¶æž„è¯´èµ·ï¼ŒæŒ‰Googleå’ŒBoilerplateçš„è¯´æ³•ï¼ŒModelå±‚çš„ç»“æž„å¯ä»¥åˆ†åˆ«æŒ‰å¦‚ä¸‹ä¸¤å›¾è®¾è®¡ Repositoryå±‚çš„ä½œç”¨æ—¶å±è”½åº•å±‚ç»†èŠ‚ï¼Œä½¿ä¸Šå±‚ä¸éœ€è¦çŸ¥é“æ•°æ®çš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬åƒç½‘ç»œã€æ•°æ®åº“ï¼Œå†…å­˜ç­‰ç­‰çš„è¿™äº›æ•°æ®çš„æ“ä½œç»†èŠ‚ã€‚ Viewå±‚ï¼šå¤„ç†ç”¨æˆ·çš„äº¤äº’å’Œè¾“å…¥äº‹ä»¶ï¼Œå¹¶ä¸”è§¦å‘Presenterä¸­çš„ç›¸åº”æ“ä½œã€‚ Presenterå±‚ï¼šPresenters è®¢é˜…ï¼ˆsubscibeï¼‰ RxJavaçš„Observablesï¼Œè´Ÿè´£å¤„ç†è®¢é˜…å‘¨æœŸï¼Œå¤„ç†ç”±DataManageræä¾›çš„æ•°æ®ï¼Œå¹¶è°ƒç”¨Viewå±‚ä¸­çš„ç›¸åº”æ–¹æ³•å±•ç¤ºæ•°æ®ã€‚ Modelå±‚ï¼šè´Ÿè´£èŽ·å–ã€ä¿å­˜ã€ç¼“å­˜ä»¥åŠä¿®æ”¹æ•°æ®ã€‚è´Ÿè´£ä¸Žæœ¬åœ°æ•°æ®åº“ã€å…¶ä»–æ•°æ®å­˜å‚¨ã€restful APIsã€ä»¥åŠç¬¬ä¸‰æ–¹SDKsçš„äº¤äº’ã€‚ DataManagerï¼šç»“åˆå¹¶ä¸”è½¬åŒ–ä¸åŒçš„Helpersç±»ä¸ºRxæ“ä½œç¬¦ï¼Œå‘Presenterå±‚æä¾›Observablesç±»åž‹çš„æ•°æ®ï¼ˆprovide meaningful data to the Presenterï¼‰ï¼Œå¹¶ä¸”åŒæ—¶å¤„ç†æ•°æ®çš„å¹¶å‘æ“ä½œï¼ˆgroup actions that will always happen together.ï¼‰ã€‚è¿™ä¸€å±‚ä¹ŸåŒ…å«å®žé™…çš„Modelç±»ï¼Œç”¨äºŽå®šä¹‰å½“å‰æ•°æ®æž¶æž„ï¼Œä¹Ÿå°±æ˜¯ä¸åŒäººæ‰€è¯´çš„Entryï¼ŒBeanï¼ŒPojoç­‰ã€‚DataManagerå°±å¥½æ¯”ä¸Šé¢çš„Repository å…¶æ¬¡ï¼Œå†è¯´Modelå±‚ä¸­çš„Modelå®žä½“ç±»çš„å®žçŽ°ï¼ŒåŒ…æ‹¬ æž„æˆæ–¹æ³•ï¼šè‡ªå®šä¹‰æž„é€ æ–¹æ³•ï¼Œå¦‚æžœå®žä½“æ¯”è¾ƒå¤æ‚ï¼Œå¯èƒ½ä¼šç”¨åˆ°å·¥åŽ‚æ¨¡å¼æˆ–è€…æ˜¯å»ºé€ è€…æ¨¡å¼ åºåˆ—åŒ–ï¼šæ¯”å¦‚å®žçŽ°SerializableæŽ¥å£ï¼ŒParcelableæŽ¥å£ã€‚ Jsonè§£æžï¼šæœ‰æ—¶å€™ç›´æŽ¥ä½¿ç”¨çš„æ˜¯jsonæ•°æ®ï¼Œæ¯”å¦‚@SerializedNameæ³¨è§£ã€‚ è‡ªå®šä¹‰æ–¹æ³•ï¼šå¯¹Modelçš„å­—æ®µæœ‰setterï¼Œgetteræ–¹æ³•ï¼ŒtoStringçš„å®žçŽ°ï¼Œåœ¨å¤„ç†hashçš„æ—¶å€™ï¼Œéœ€è¦å®žçŽ°equalså’Œhashcodeæ–¹æ³•ã€‚ å…³äºŽæŒä¹…åŒ–çš„å®žçŽ°ï¼Œæœ€è¿‘ä½¿ç”¨è¿‡ä¸€ä¸ªå‡ºåçš„æŒä¹…åŒ–ç¬¬ä¸‰æ–¹åº“Realmã€‚Realmæ˜¯ç”±ç¾Žå›½YCombinatorå­µåŒ–çš„åˆ›ä¸šå›¢é˜ŸåŽ†æ—¶å‡ å¹´æ‰“é€ ï¼Œå®ƒæ˜¯ç¬¬ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ç§»åŠ¨å¹³å°è®¾è®¡çš„æ•°æ®åº“ï¼Œæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç§»åŠ¨æ•°æ®åº“å¼•æ“Žï¼Œæ˜¯ç”±æ ¸å¿ƒæ•°æ®å¼•æ“ŽC++æ‰“é€ ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®åº“å­˜å‚¨å¼•æ“Žï¼Œå¯ä»¥æ–¹ä¾¿ã€é«˜æ•ˆçš„å®Œæˆæ•°æ®åº“çš„å„ç§æ“ä½œã€‚Realmå…·æœ‰å¼€æºã€ç®€å•æ˜“ç”¨ã€è·¨å¹³å°ã€çº¿ç¨‹å®‰å…¨è¿™äº›ä¼˜ç‚¹ï¼Œåœ¨Macä¸Šæœ‰å¯è§†åŒ–å·¥å…·Realm Browserè¾…åŠ©ã€‚Javaçš„ä»“åº“æˆ³è¿™é‡ŒðŸ‘‡ã€‚ Realmçš„ä½¿ç”¨æ­¥éª¤ï¼š ä¸»å·¥ç¨‹build.gradleä¸­çš„dependenciesæ·»åŠ  classpath â€œio.realm:realm-gradle-plugin:x.y.zâ€ï¼Œåº”ç”¨Moduleçš„build.gradleä¸­apply plugin: â€˜realm-androidâ€™ åœ¨MainActivityæˆ–è€…è‡ªå®šä¹‰çš„Applicationçš„OnCreate()ä¸­åˆå§‹åŒ– Realm.init(this); Modelç±»ç»§æ‰¿RealmObject Modelçš„æ‰€æœ‰å±žæ€§è®¾ç½®ä¸ºprivateå¹¶å®žçŽ°å¯¹åº”çš„getterå’Œsetter æŸ¥ Realm realm = Realm.getDefaultInstance(); Model model = mRealm.where(Model.class).findFirst(); RealmResults&lt;Model&gt; results = realm.where(Model.class).findAll(); RealmResults&lt;Model&gt; results = realm.where(Model.class).equalTo("key", "value").findAll(); results = results.sort("key", Sort.DESCENDING); List&lt;Model&gt; models = realm.copyFromRealm(results); //é™¤äº†findAll()ï¼Œè¿˜æœ‰sum()ã€average()ã€min()ã€max()ã€findAllSorted() å¢ž Realm realm = Realm.getDefaultInstance(); realm.beginTransaction(); Model model = realm.createObject(Model.class); model.setName("Bob"); model.setSex("male") //realm.copyToRealm(model); //å¯åœ¨beginTransactionå¤–å…ˆç”Ÿæˆå¥½modelå’Œè®¾ç½®å¥½å±žæ€§ï¼Œå†ç›´æŽ¥ä½¿ç”¨æ­¤æ–¹æ³•åœ¨beginTransactionä¸­åŒæ­¥åˆ°Realmæ•°æ®åº“ä¸­ï¼Œæœ€åŽä¹Ÿéœ€è¦commitTransaction realm.commitTransaction(); /* ä¹Ÿå¯ä½¿ç”¨å†…éƒ¨åŒ¿åç±»çš„æ–¹å¼åˆ›å»ºTransaction mRealm.executeTransaction(new Realm.Transaction() &#123; @Override public void execute(Realm realm) &#123; //Â·Â·Â· &#125; &#125;); */ æ”¹ Realm realm = Realm.getDefaultInstance(); RealmResults&lt;Model&gt; results = realm.where(Model.class).equalTo("name", "Bob").findAll(); //æŸ¥å”¯ä¸€å€¼çš„æ¡ä»¶ if (result.size() &gt; 0) &#123; realm.beginTransaction(); Model model = result.get(0); model.setSex("Female"); realm.commitTransaction(); &#125; åˆ  Realm realm = Realm.getDefaultInstance(); RealmResults&lt;Model&gt; results = realm.where(Model.class).equalTo("key", "value").findAll(); //æŸ¥å”¯ä¸€å€¼çš„æ¡ä»¶ if (result.size() &gt; 0) &#123; realm.beginTransaction(); Model model = result.get(0); model.deleteFromRealm(); //results.deleteFirstFromRealm(); //results.deleteLastFromRealm(); //results.deleteAllFromRealm() realm.commitTransaction(); &#125; ç½‘ç»œè¯·æ±‚æ–¹é¢ï¼Œä¸€èˆ¬ä¼šé€‰æ‹©ä½¿ç”¨okhttpã€‚ é€‚é…å™¨ AdapterAdapteræ˜¯ç”¨æ¥å¸®åŠ©å¡«å……æ•°æ®çš„ï¼Œå°†å„ç§æ•°æ®ä»¥åˆé€‚çš„å½¢å¼æ˜¾ç¤ºåˆ°viewä¸Šï¼Œæä¾›ç»™ç”¨æˆ·çœ‹ï¼ Adapterå’ŒiOSä¸­UITableViewControlleréžå¸¸ç›¸ä¼¼ï¼Œç»§æ‰¿BaseAdapterå°±å¥½æ¯”éµå¾ªäº†UITableDelegateå’ŒUITableViewDataSourceä¸¤ä¸ªåè®®ï¼Œä¸ºè‡ªå®šä¹‰çš„éœ€è¦è€Œå®žçŽ°æ•°æ®æºå’Œè§†å›¾çš„è¾“å‡ºæ–¹æ³•ã€‚ Adapterçš„ç»§æ‰¿ç»“æž„å›¾å¦‚ä¸‹ å®žé™…å¼€å‘ä¸­ç”¨å¾—æœ€å¤šçš„å…¶å®žæ˜¯BaseAdapterï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®žçŽ°äº†ListAdapterå’ŒSpinnerAdapterä¸¤ä¸ªæŽ¥å£ï¼Œè€Œè¿™ä¸¤ä¸ªæŽ¥å£éƒ½æ˜¯Adapterè¿™ä¸ªæŽ¥å£çš„æ‰©å±•æŽ¥å£ã€‚ ListAdapterå®šä¹‰äº† areAllItemsEnabled() æ˜¯å¦æ‰€æœ‰Itemå¯é€‰æ‹©ç‚¹å‡» isEnabled() æŸä¸€ä½ç½®ä¸Šçš„Itemæ˜¯å¦å¯é€‰æ‹©ç‚¹å‡»ä¸¤ä¸ªæ–¹æ³• åœ¨BaseAdapterçš„å®žçŽ°ä¸­é»˜è®¤éƒ½ä¸ºtrue SpinnerAdapterå®šä¹‰äº† getDropDownView() è¿”å›žä¸‹æ‹‰è§†å›¾çš„æ–¹æ³• BaseAdapterçš„å®žçŽ°ä¸­é»˜è®¤æ˜¯é€šè¿‡è°ƒç”¨å®ƒè‡ªå·±çš„getView()è¿”å›ž Adapterå®šä¹‰çš„æ–¹æ³•ä¸­ï¼Œå…³é”®ä¸”å¸¸è¢«é‡å†™çš„æ–¹æ³•ä¸º getCount() è¿”å›žæ•°æ®çš„æ€»æ•° getItem() è¿”å›žæŸè¡Œæ•°æ®çš„æ¨¡åž‹ getItemId() è¿”å›žæŸè¡Œæ•°æ®çš„IDï¼Œä¸€èˆ¬å°±æ˜¯ä½ç½®ç´¢å¼• getView() è¿”å›žæŸè¡Œçš„è‡ªå®šä¹‰è§†å›¾ ç»§æ‰¿BaseAdapterçš„å¼€å‘æ­¥éª¤ï¼š èŽ·å–å¹¶æŒæœ‰æ•°æ®æº å®žçŽ°æ•°æ®ç›¸å…³çš„è¾“å‡ºæ–¹æ³•ï¼ˆgetCountã€getItemã€getItemIdï¼‰ å®šä¹‰å†…éƒ¨çš„ViewHolderç±»ï¼ŒåŒ…å«æ¯è¡Œéœ€æ˜¾ç¤ºçš„æŽ§ä»¶å±žæ€§ï¼Œä¸åŒç±»åž‹è¡Œçš„ViewHolderéœ€åˆ†å¼€å®šä¹‰ å®žçŽ°è§†å›¾ç›¸å…³çš„è¾“å‡ºæ–¹æ³•ï¼ˆgetViewï¼‰ï¼Œç¬¬ä¸€æ¬¡åˆ›å»ºviewæ—¶ï¼Œå°†å¯¹åº”çš„ViewHolderå¯¹è±¡å¡žå…¥è¦è¿”å›žçš„viewçš„tagä¸­ï¼ŒåŒæ—¶å¯¹ViewHolderå¯¹è±¡ä¸­çš„æŽ§ä»¶è®¾ç½®ä¸Šæ•°æ®å€¼ï¼›ä¸‹æ¬¡èŽ·å–åˆ°viewæ—¶åªéœ€ä»Žtagä¸­å–å‡ºViewHolderå¯¹è±¡æ›´æ–°æŽ§ä»¶çš„æ•°æ®å€¼å³å¯ï¼Œè¾¾åˆ°äº†æŽ§ä»¶å¤ç”¨çš„æ•ˆæžœã€‚ å¦ä¸€ä¸ªä½¿ç”¨çŽ‡è¾ƒé«˜çš„å°±æ˜¯RecyclerView.Adapterï¼Œä¸ŽBaseAdapteræœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¹Ÿæœ‰ä¸åŒä¹‹å¤„ï¼Œå…¶å…·ä½“å¼€å‘æ­¥éª¤ï¼š getItemCount() è¿”å›žItemçš„æ€»æ•°ï¼Œæ³¨æ„åˆ¤ç©º getItemViewType() è¿”å›žItemè§†å›¾çš„ç±»åž‹ onCreateViewHolder() æ ¹æ®ä¸Šä¸€ç‚¹çš„æ–¹æ³•è¿”å›žç±»åž‹ï¼Œåˆ›å»ºViewHolderï¼Œç»™AdapteråŽ»å…³è”view onBindViewHolder() è§¦å‘ç»‘å®šViewHolderï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åªéœ€è´Ÿè´£æ›´æ–°ViewHolderå¯¹è±¡ä¸­æŽ§ä»¶çš„æ•°æ®å€¼å³å¯ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºRecyclerView.AdapteræŒ‡å®šå®ƒçš„æ³›åž‹ã€‚ è¯´åˆ°RecyclerView.Adapterï¼Œæœ‰ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„ç¬¬ä¸‰æ–¹BaseRecyclerViewAdapterï¼Œå°è£…äº†å¾ˆå¤šä¾¿åˆ©çš„æ–¹æ³•ä¾›ç›´æŽ¥è°ƒç”¨å’ŒçœåŽ»å¾ˆå¤šæŽ¥å£çš„å®žçŽ°ï¼Œä¹ŸåŸºæœ¬èƒ½æ»¡è¶³å¤§éƒ¨åˆ†æ•ˆæžœçš„éœ€æ±‚ï¼Œæœ‰å…´è¶£å¯ä»¥åŽ»é¢å¤–äº†è§£ä¸‹-éšæ„é—¨ã€‚ ArrayAdapterï¼š ä¾‹åŒ–æ—¶å¯ä»¥ä½¿ç”¨æ³›åž‹æž„é€ ï¼Œå¯åœ¨æž„é€ å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ç»‘å®šä¸€ä¸ªlayoutï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ç»‘å®šæ•°æ®æºï¼ˆå…¶å†…éƒ¨ä½¿ç”¨æ­¤æ•°æ®æºåŽ»å®žçŽ°getCountã€getItemç­‰æ–¹æ³•ï¼Œæ— éœ€äº²è‡ªå®žçŽ°ä¸€éï¼‰ å¢žåŠ äº†å¾ˆå¤šå’Œæ•°ç»„ç›¸å¯¹åº”çš„æ“ä½œï¼Œå¦‚add()ã€addAll()ã€insert()ã€clear()ã€remove()ã€sort()ã€setNotifyOnChange()ï¼ˆæŽ§åˆ¶ä»¥ä¸Šæ“ä½œæ–¹æ³•æ‰§è¡ŒåŽæ˜¯å¦è‡ªåŠ¨æ‰§è¡ŒnotifyDataSetChanged()ï¼Œå½“å‚æ•°ä¸ºfalseæ—¶åˆ™éœ€æ‰‹åŠ¨æ‰§è¡Œã€‚åº”ç”¨åœºæ™¯ä¸ºå½“å¤„ç†çš„æ•°æ®é‡å¤§æ—¶ï¼Œå¯åœ¨å¤„ç†å‰è®¾ç½®ä¸ºfalseï¼Œå¤„ç†åŽæ‰‹åŠ¨æ‰§è¡ŒnotifyDataSetChanged()ï¼‰ ArrayAdapteré»˜è®¤æœŸæœ›å¸ƒå±€æ–‡ä»¶é‡Œåªæœ‰ä¸€ä¸ªTextViewï¼Œå®žçŽ°ç¨å¾®å¤æ‚çš„TextViewå¯åœ¨æž„é€ æ–¹æ³•ä¸­ä¼ å…¥æŒ‡å®šçš„Field IDï¼Œå®žçŽ°å¤æ‚å¸ƒå±€æ—¶éœ€é‡å†™getView()æ–¹æ³•ã€‚ ArrayAdapteré»˜è®¤ä¸‹ä¼šè°ƒç”¨Listä¸­å¯¹è±¡çš„toString()æ–¹æ³•åŽ»è®¾ç½®TextView ä¸€ä¸ªå°æŠ€å·§ï¼Œå½“ä½¿ç”¨å›ºå®šçš„æ•°æ®æºæ—¶ï¼Œå¯åœ¨resä¸­ç›´æŽ¥åˆ›å»ºæ•°æ®æºçš„xmlï¼Œç„¶åŽç»™ListViewå¸ƒå±€ä¸­å¼•ç”¨ï¼ˆç³»ç»Ÿå†…éƒ¨åˆ›å»ºArrayAdapteråŽ»æŽ¥æ”¶ï¼‰ï¼Œ &lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;resources&gt; &lt;string-array name="myarray"&gt; &lt;item&gt;è¯­æ–‡&lt;/item&gt; &lt;item&gt;æ•°å­¦&lt;/item&gt; &lt;item&gt;è‹±è¯­&lt;/item&gt; &lt;/string-array&gt; &lt;/resources&gt; &lt;ListView android:id="@id/list_test" android:layout_height="match_parent" android:layout_width="match_parent" android:entries="@array/myarray"/&gt; SimpleAdapterï¼šæ›´æ–¹ä¾¿åœ°å¥—ç”¨Itemçš„æ˜¾ç¤ºæ ·å¼ SimpleAdapter myAdapter = new SimpleAdapter(getApplicationContext(), listitem, R.layout.list_item, new String[]&#123;"header", "name", "says"&#125;, new int[]&#123;R.id.header, R.id.name, R.id.says&#125;); SimpleCursorAdapterï¼šè¿‡æ—¶çš„ä¸€ç§ç±»ï¼Œå…¶å®žå°±æ˜¯å­˜å…¥ä¸€ä¸ªCursorå¯¹è±¡ï¼Œç”±å…¶å†…éƒ¨åˆ©ç”¨cursorè¯»å–æ•°æ®ï¼Œç”¨äºŽåœ¨æ•°æ®åº“èŽ·å–ç®€å•æ–‡æœ¬æ˜¾ç¤ºçš„listViewã€‚ä¸å¤ªæŽ¨èä½¿ç”¨ï¼Œç›´æŽ¥æ‰©å±•BaseAdapterï¼Œè‡ªè¡Œè¯»å–æ•°æ®åº“ä¼šæ›´å¥½ã€‚ FragmentPagerAdapterï¼šé¡¾åæ€ä¹‰ getCount() è¿”å›žtitleæˆ–è€…fragmentçš„æ€»æ•° getItem() è¿”å›žæŒ‡å®šä½ç½®çš„fragment getPageTitle() è¿”å›žæŒ‡å®šä½ç½®çš„title åˆ›å»ºäº†AdapteråŽï¼Œæœ€åŽè®°å¾—è®¾ç½®åˆ°ListViewæˆ–è€…RecyclerViewçš„adapterå±žæ€§ä¸­åŽ»ã€‚ è·¨åº”ç”¨é€šä¿¡ AIDLæœåŠ¡-å®˜æ–¹æ–‡æ¡£AIDL-å®˜æ–¹æ–‡æ¡£ åœ¨å¼€å‘è·¨åº”ç”¨é€šä¿¡å‰ï¼Œé¦–å…ˆå¿…é¡»åŽ»äº†è§£4å¤§ç»„ä»¶ä¹‹ä¸€çš„æœåŠ¡æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œçœ‹å®ŒæœåŠ¡çš„æ–‡æ¡£ï¼Œæ‰èƒ½ç†è§£è·¨åº”ç”¨çš„å·¥ä½œåŽŸç†ã€‚ è¿™é‡Œç®€å•æ¦‚æ‹¬ä¸€ä¸‹ï¼ŒæœåŠ¡å¯ä»¥åˆ†ä¸ºå‰å°ã€åŽå°ã€ç»‘å®šè¿™ä¸‰ç§ç±»åž‹ï¼Œå‡éœ€è‡ªè¡Œåˆ›å»ºçº¿ç¨‹æ‰§è¡Œæ“ä½œï¼Œå¦åˆ™æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚å‰å°å’ŒåŽå°çš„æœåŠ¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ˜¯ç”±è°ƒç”¨è€…æˆ–è‡ªå·±æ‰€æŽ§åˆ¶ï¼Œç»‘å®šæœåŠ¡åˆ™å…¨ç”±å‘èµ·ç»‘å®šçš„åº”ç”¨ç»„ä»¶æ‰€ç®¡ç†ã€‚å¯ä»¥ä½¿ç”¨Serviceå’ŒIntentServiceåˆ›å»ºæœåŠ¡ï¼Œå‰è€…éœ€è‡ªè¡Œåˆ›å»ºçº¿ç¨‹æ‰§è¡Œæ“ä½œï¼Œå¦åˆ™ä¼šå½±å“åº”ç”¨æ€§èƒ½ï¼ŒåŽè€…åˆ™ç”±å…¶å†…éƒ¨ä½¿ç”¨å·¥ä½œçº¿ç¨‹é€ä¸€å¤„ç†æ‰€æœ‰å¯åŠ¨è¯·æ±‚ã€‚è€Œè¿›ç¨‹é—´é€šä¿¡ (IPC)å°±æ˜¯åˆ©ç”¨ç»‘å®šå®žçŽ°çš„ï¼Œä¸€èˆ¬æè¿°æ˜¯å‘èµ·ç»‘å®šçš„ä¸ºå®¢æˆ·ç«¯ï¼Œæä¾›æœåŠ¡çš„ä¸ºæœåŠ¡ç«¯ã€‚ ä¸‹é¢å†è®²è¿°å¦‚ä½•ä½¿ç”¨AIDLï¼ˆå®‰å“æŽ¥å£å®šä¹‰è¯­è¨€ï¼‰ã€‚ AIDLæ˜¯ä»€ä¹ˆï¼Œå®ƒæ˜¯å¯ä»¥è¢«åˆ©ç”¨åŽ»æ‰€å®šä¹‰çš„å®¢æˆ·ç«¯ä¸ŽæœåŠ¡ä½¿ç”¨è¿›ç¨‹é—´é€šä¿¡ (IPC) ç›¸äº’é€šä¿¡æ—¶éƒ½è®¤å¯çš„ç¼–ç¨‹æŽ¥å£ã€‚ å®žçŽ°çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š ä½¿ç”¨Javaè¯­è¨€åœ¨.aidlæ–‡ä»¶ä¸­å®šä¹‰å‡ºAIDLæŽ¥å£ï¼Œç„¶åŽåˆ†åˆ«ä¿å­˜åœ¨æœåŠ¡å’Œå®¢æˆ·ç«¯çš„æºç ä¸­ï¼ˆsrc/ ç›®å½•ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡å®šä¸€æ ·çš„å…·ä½“è·¯å¾„ï¼Œä¾‹å¦‚æœåŠ¡çš„.aidlæ–‡ä»¶å­˜æ”¾äºŽæœåŠ¡é¡¹ç›®ä¸‹çš„src/main/aidl/com/xx/yy/IXxAidlInterface.aidlï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„.aidlæ–‡ä»¶åˆ™å­˜æ”¾äºŽå®¢æˆ·ç«¯é¡¹ç›®ä¸‹çš„åŒåè·¯å¾„ä¸‹ï¼ˆä½œä¸ºå‰¯æœ¬å­˜åœ¨ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¹Ÿéœ€å…·æœ‰å¯¹interfaceç±»çš„è®¿é—®æƒé™ï¼‰ï¼Œå…¶ä¸­com.xx.yyå°±æ˜¯æœåŠ¡æ‰€åœ¨é¡¹ç›®çš„åŒ…åï¼Œæ³¨æ„ç¡®ä¿ä¸¤ç«¯çš„aidlæ–‡ä»¶å†…å®¹ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚ ç¼–è¯‘åŽï¼ŒIBinderæŽ¥å£æ–‡ä»¶â€“IXxAidlInterface.javaæ–‡ä»¶ä¼šè¢«è‡ªåŠ¨ç”Ÿæˆï¼ˆä¸Žaidlæ–‡ä»¶ååŒåï¼‰ï¼Œã€‚ IXxAidlInterface.javaé‡Œå…·æœ‰ä¸€ä¸ªåä¸ºStubçš„å†…éƒ¨æŠ½è±¡ç±»(ç»§æ‰¿è‡ªBinderå¹¶å®žçŽ°IXxAidlInterface)ï¼Œç”¨å®ƒæ¥ç»™æœåŠ¡æ‰©å±•Binderç±»å¹¶é‡å†™å®žçŽ°AIDLæŽ¥å£ä¸­çš„æ–¹æ³•ã€‚ æœ€åŽï¼ŒæœåŠ¡å‘å®¢æˆ·ç«¯å…¬å¼€æŽ¥å£çš„æ–¹å¼ï¼Œå°±æ˜¯å®žçŽ°Serviceå¹¶é‡å†™ onBind() ä»¥è¿”å›žStubç±»ï¼ŒåŽ»å®šä¹‰æœåŠ¡çš„RPCæŽ¥å£ã€‚ RPCæ˜¯åŒæ­¥è°ƒç”¨çš„ï¼Œéœ€è‡ªè¡Œå¤„ç†å¤šçº¿ç¨‹å·¥ä½œå’Œä¿éšœçº¿ç¨‹å®‰å…¨ï¼ˆæˆ–å®¢æˆ·ç«¯ä»Žå•ç‹¬çš„çº¿ç¨‹ä¸­è°ƒç”¨æœåŠ¡ï¼‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å®¢æˆ·ç«¯å‡ºçŽ°â€œApplication is Not Respondingâ€çš„æç¤ºï¼ŒåŒæ—¶å¼‚å¸¸æ˜¯ä¸ä¼šè¿›è¡Œä¼ é€’ã€‚ å®¢æˆ·ç«¯å®žçŽ°ServiceConnectionï¼Œåœ¨onServiceConnected()çš„å›žè°ƒä¸­ä¼šæŽ¥æ”¶æœåŠ¡çš„ onBind() æ–¹æ³•è¿”å›žçš„ mBinder å®žä¾‹ï¼Œæ­¤æ—¶éœ€è°ƒç”¨IXxAidlInterface.Stub.asInterface(service)ä»¥å°†è¿”å›žçš„å‚æ•°è½¬æ¢æˆè‡ªå·±çš„ServiceInterfaceç±»åž‹ï¼ˆserviceå³æ˜¯IBinderï¼‰ï¼ŒåŽé¢å°±å¯ä»¥ä½¿ç”¨å®ƒæ¥è°ƒç”¨æœåŠ¡çš„æŽ¥å£æ–¹æ³•è¿›è¡Œé€šä¿¡äº†ã€‚ å®¢æˆ·ç«¯è§¦å‘IPCï¼Œè°ƒç”¨Context.bindService()ï¼Œä¼ å…¥æˆ‘ä»¬çš„ServiceConnectionå®žçŽ°ï¼ˆä½œä¸ºè¿žæŽ¥çš„å›žè°ƒå¯¹è±¡ï¼‰ã€‚ å¦‚æžœéœ€è¦åœ¨æŽ¥å£ä¸­ä¼ é€’å¯¹è±¡ï¼Œåˆ™ç±»å¿…é¡»å®žçŽ°ParcelableæŽ¥å£ï¼ŒåŒæ—¶æœåŠ¡å’Œå®¢æˆ·ç«¯ä¸¤ä¾§éƒ½è¦æœ‰æ­¤ç±»å¯ä¾›å¼•ç”¨ã€‚ ç¤ºä¾‹ï¼š å®šä¹‰AIDLçš„æŽ¥å£ package com.xx.yy interface IXxAidlInterface &#123; void doSomething(String data); &#125; å®šä¹‰æœåŠ¡ï¼Œå®žçŽ°ç»‘å®šç›¸å…³æ–¹æ³• public class MyAidlService extends Service &#123; @Override public IBinder onBind(Intent intent) &#123; // Â·Â·Â· return new MyBinder(); //ä¹Ÿå¯ä»¥åœ¨æ­¤ç›´æŽ¥è¿”å›žIXxAidlInterface.Stubçš„åŒ¿åå†…éƒ¨ç±»çš„å®žä¾‹ï¼ŒçœåŽ»å®šä¹‰Binderçš„ç±» &#125; @Override public boolean onUnbind(Intent intent) &#123; // Â·Â·Â· return super.onUnbind(intent); &#125; æœåŠ¡ç«¯å®šä¹‰Binderï¼Œå®žçŽ°AIDLä¸­çš„æŽ¥å£æ–¹æ³• public class MyBinder extends IXxAidlInterface.Stub &#123; @Override public void doSomething(String data) throws RemoteException &#123; Â·Â·Â· &#125; &#125; æœåŠ¡ç«¯AndroidManifestä¸­å£°æ˜ŽService &lt;service android:name="com.xx.yy.service.MyAidlService" android:exported="true"&gt; &lt;intent-filter&gt; &lt;action android:name="com.xx.yy.service.MyAidlService"/&gt; &lt;category android:name="android.intent.category.DEFAULT"/&gt; &lt;/intent-filter&gt; &lt;/service&gt; å®¢æˆ·ç«¯å®žçŽ°ServiceConnection public class MyServiceConnection implements ServiceConnection &#123; private IXxAidlInterface mService; @Override public void onServiceConnected(ComponentName name, IBinder service) &#123; mService = IXxAidlInterface.Stub.asInterface(service); &#125; @Override public void onServiceDisconnected(ComponentName name) &#123; mService = null; &#125; //å¯ä»¥é€šè¿‡è¿”å›žmServiceï¼Œå¤–é¢æ–°å»ºç±»ä½¿ç”¨å…¶ä¸Žä¸šåŠ¡é€»è¾‘è¿›è¡Œå°è£… public void doSomething(String data) &#123; mService.doSomething(data); &#125; &#125; å®¢æˆ·ç«¯è§¦å‘IPC Intent service = new Intent("com.xx.yy.service.IXxAidlInterface");//seviceçš„è·¯å¾„ service.setPackage("com.xx.yy"); service.putExtra("key","value"); List&lt;ResolveInfo&gt; list = context.getPackageManager().queryIntentServices(service, PackageManager.MATCH_DEFAULT_ONLY); if (list == null || list.isEmpty() || list.size() == 0)&#123; return;//æœåŠ¡(App)ä¸å­˜åœ¨ &#125; MyServiceConnection connection = new MyServiceConnection(); if(connection != null) &#123; try &#123; context.bindService(service, connection, Context.BIND_AUTO_CREATE); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; å¤šçº¿ç¨‹AsyncTaskAsyncTaskæ˜¯ç”¨æ¥å®žçŽ°å·¥ä½œçº¿ç¨‹ä¸Žä¸»çº¿ç¨‹ï¼ˆUIçº¿ç¨‹ï¼‰ä¹‹é—´é€šä¿¡ ä½¿ç”¨æ­¥éª¤ åˆ›å»ºAsyncTaskå­ç±»å¹¶æ ¹æ®éœ€æ±‚å®žçŽ°æ ¸å¿ƒæ–¹æ³• åˆ›å»ºAsyncTaskå­ç±»çš„å®žä¾‹å¯¹è±¡ æ‰‹åŠ¨è°ƒç”¨å®žä¾‹å¯¹è±¡çš„execute()ä»Žè€Œæ‰§è¡Œå¼‚æ­¥çº¿ç¨‹ä»»åŠ¡ private class MyTask extends AsyncTask&lt;Params, Progress, Result&gt; &#123; .... //æ‰§è¡Œå¼‚æ­¥çº¿ç¨‹å‰çš„å›žè°ƒï¼Œå¤„ç†UIçš„åˆå§‹åŒ–ï¼Œæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­å›žè°ƒçš„ @Override protected void onPreExecute() &#123; ... &#125; //æ‰§è¡Œå¼‚æ­¥çº¿ç¨‹ä»»åŠ¡ @Override protected String doInBackground(String... params) &#123; ...// è‡ªå®šä¹‰çš„çº¿ç¨‹ä»»åŠ¡ // å¯è°ƒç”¨publishProgress()æ˜¾ç¤ºè¿›åº¦ï¼Œä¹‹åŽå°†å›žè°ƒonProgressUpdate() publishProgress(count); &#125; //è¿›åº¦å›žè°ƒï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­å›žè°ƒçš„ @Override protected void onProgressUpdate(Integer... progresses) &#123; ... &#125; //è¿”å›žå¼‚æ­¥çº¿ç¨‹ä»»åŠ¡çš„æ‰§è¡Œç»“æžœï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­å›žè°ƒ @Override protected void onPostExecute(String result) &#123; ...// UIæ“ä½œ &#125; //å°†å¼‚æ­¥çº¿ç¨‹ä»»åŠ¡çŠ¶æ€ç½®ä¸ºå–æ¶ˆåŽï¼Œéœ€è‡ªè¡Œåœ¨doInBackgroundåˆ¤æ–­ä»»åŠ¡çš„çŠ¶æ€è¿›è¡Œå®žè´¨æ€§çš„é˜»æ­¢ä¸­æ–­ï¼Œå³å›žè°ƒæ­¤å‡½æ•° @Override protected void onCancelled() &#123; ... &#125; &#125; //å®žä¾‹å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­åˆ›å»º MyTask mTask = new MyTask(); //a. å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­è°ƒç”¨ //b. åŒä¸€ä¸ªAsyncTaskå®žä¾‹å¯¹è±¡åªèƒ½æ‰§è¡Œ1æ¬¡ï¼Œè‹¥æ‰§è¡Œç¬¬2æ¬¡å°†ä¼šæŠ›å‡ºå¼‚å¸¸ //c. æ‰§è¡Œä»»åŠ¡ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨AsyncTaskçš„ä¸€ç³»åˆ—æ–¹æ³•ï¼šonPreExecute() ã€doInBackground()ã€onProgressUpdate() ã€onPostExecute() //d. ä¸èƒ½æ‰‹åŠ¨è°ƒç”¨ä¸Šè¿°æ–¹æ³• mTask.execute()ï¼› //æ‰§è¡Œå¼‚æ­¥çº¿ç¨‹çš„ä»»åŠ¡ Thread + Handleråˆ›å»ºçº¿ç¨‹æœ‰ä¸¤ç§æ–¹æ³• ç»§æ‰¿Threadç±»ï¼Œé‡å†™Threadçš„run()æ–¹æ³•ï¼ˆThreadä¹Ÿå®žçŽ°äº†RunnableæŽ¥å£ï¼‰ å®žçŽ°RunnableæŽ¥å£ï¼Œé‡å†™Runnableçš„run()æ–¹æ³•ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°å®žä¾‹åŒ–Threadï¼Œè¿™æ ·èƒ½é¿å…Threadå•ç»§æ‰¿çš„å±€é™å’Œå¤šThreadä¹‹é—´å¯ä»¥å…±äº«Runnableä¸­çš„èµ„æºã€‚ public class MyThread extends Thread &#123; @Overide public void run() &#123; ...//å¼‚æ­¥çº¿ç¨‹ä»»åŠ¡ &#125; &#125; MyThread t = new MyThread();//åˆ›å»ºå·²å†…å«ä»»åŠ¡çš„çº¿ç¨‹ t.start(); public class MyRunnable implements Runnable &#123; public void run() &#123; ...//ä»»åŠ¡ &#125; &#125; MyRunnable runnable = new MyRunnable(); Thread r = new Thread(runnable, &quot;threadName&quot;);//åˆ›å»ºçº¿ç¨‹å¹¶æŒ‡å®šä»»åŠ¡ r.start(); è‹¥è¦è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢é€šä¿¡ï¼Œè€Œå¤šçº¿ç¨‹åˆé€‰ç”¨äº†Threadå®žçŽ°ï¼Œé‚£ä¹ˆå°±éœ€è¦æ­é…Handlerä½¿ç”¨äº†ï¼Œå› ä¸ºHandlerçš„æœ€å¤§ä½œç”¨å°±æ˜¯çº¿ç¨‹çš„åˆ‡æ¢ã€‚ å­çº¿ç¨‹ä¸Žä¸»çº¿ç¨‹é€šä¿¡çš„ç¤ºä¾‹ï¼š //åœ¨ä¸»çº¿ç¨‹å®žä¾‹åŒ–Handler Handler handler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; //msgæ˜¯ä»Žå­çº¿ç¨‹å‘æ¥çš„æ¶ˆæ¯ switch (msg.what) &#123; case 1: Log.i(&quot;&quot;, msg.obj); break; &#125; &#125; &#125;; //å¼€å¯å­çº¿ç¨‹ new Thread(new Runnable() &#123; @Override public void run() &#123; //åœ¨å­çº¿ç¨‹å‘é€ä¸€ä¸ªæ¶ˆæ¯ã€‚ Message msg = new Message(); //æ­£å¸¸åº”ä½¿ç”¨Message.obtain();ï¼Œè¿™æ ·å¯åˆ©ç”¨åˆ°ç³»ç»Ÿçš„Messageç¼“å­˜æ± ï¼Œä¼˜åŒ–å†…å­˜ msg.obj = &quot;è‡ªå®šä¹‰ä¼ é€’çš„æ•°æ®å¯¹è±¡&quot;; msg.what = 0; //whatç›¸å½“äºŽmsgçš„ID handler.sendMessage(msg);//åŒä¸€ä¸ªæ¶ˆæ¯ä¸è¦å‘é€ä¸¤æ¬¡ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå› ä¸ºæ¶ˆæ¯é˜Ÿåˆ—ä¸­ä¸å…è®¸å­˜åœ¨é‡å¤çš„æ¶ˆæ¯ //å¯ä½¿ç”¨postä»£æ›¿sendMessageï¼Œpostå†…éƒ¨ä¼šå°†Runnableå°è£…æˆMessageå†å‘å‡ºåŽ»ï¼Œä¸”æ­¤Runnableçš„runæ–¹æ³•æ¯”Handlerä¸­çš„handleMessageæ›´é«˜ä¼˜å…ˆçº§ handler.post(new Runnable() &#123; @Override public void run() &#123; //è¿™é‡Œæ˜¯æ¶ˆæ¯å¤„ç†çš„æ–¹æ³•ï¼Œè¿è¡Œåœ¨ä¸»çº¿ç¨‹ã€‚ &#125; &#125; &#125; &#125;).start(); åœ¨ä¸»çº¿ç¨‹å®žä¾‹åŒ–Handlerçš„è¯ï¼Œå…¶handleMessageæ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå› ä¸ºHandleré»˜è®¤é‡‡ç”¨äº†ä¸»çº¿ç¨‹çš„Looperè¿›è¡Œç»‘å®šï¼Œå³æ˜¯Handleråœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå“ªä¸ªçº¿ç¨‹åˆ›å»ºå®ƒï¼Œå°±èŽ·å–é‚£ä¸ªçº¿ç¨‹çš„Looperè¿›è¡Œç»‘å®šï¼Œæ¶ˆæ¯çš„å¤„ç†ä¹Ÿå°±åœ¨Looperæ‰€åœ¨çš„çº¿ç¨‹è¿›è¡Œï¼Œé™¤éžåœ¨å®žä¾‹æ–¹æ³•ä¸­é¢å¤–æŒ‡å®šLooperç»™Handlerã€‚ï¼ˆThreadæ‹¥æœ‰Looperï¼ŒLooperæ‹¥æœ‰Handlerå’ŒMessageQueueï¼‰ è‹¥è¦åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerï¼Œåˆ™éœ€è¦è‡ªè¡Œåˆ›å»ºLooperå¹¶å¼€å¯å…¶å¾ªçŽ¯ï¼Œæ‰èƒ½ä½¿Handleræ­£å¸¸å·¥ä½œï¼Œå› ä¸ºå…¶å®ƒçº¿ç¨‹åˆ©ç”¨ç»‘å®šè¯¥å­çº¿ç¨‹Looperçš„Handlerå‘å¾€æ­¤å­çº¿ç¨‹å‘æ¶ˆæ¯æ—¶ï¼Œä¼šå°†Messageå¡žå…¥å­çº¿ç¨‹çš„MessageQueueåŽ»ï¼Œæ²¡æœ‰Looperçš„è¯å°±å­çº¿ç¨‹å°±ä¸ä¼šåŽ»å®ƒçš„MessageQueueä¸Šå–æ¶ˆæ¯å‡ºæ¥åˆ†å‘ç»™Handlerå¤„ç†ï¼ˆå¯èƒ½è¿žæ¶ˆæ¯çš„å‘é€é˜¶æ®µå°±å·²ä¸èƒ½æˆåŠŸï¼Ÿï¼‰ã€‚ //åœ¨ä¸»çº¿ç¨‹åˆ›å»ºå¹¶å¼€å¯å­çº¿ç¨‹å¼‚æ­¥ä»»åŠ¡ Handler handler; new Thread(new Runnable() &#123; @Override public void run() &#123; //åˆ›å»ºå½“å‰çº¿ç¨‹çš„Looperï¼Œå› ä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªLooperæ‰€ä»¥ä¸èƒ½è°ƒç”¨ä¸¤æ¬¡ Looper.prepare(); //åœ¨å­çº¿ç¨‹åˆ›å»ºHandlerå¯¹è±¡ handler = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; //è¿™é‡Œæ˜¯æ¶ˆæ¯å¤„ç†ï¼Œè¿è¡Œåœ¨å­çº¿ç¨‹ &#125; &#125;; //å¼€å¯Looperçš„æ¶ˆæ¯è½®è¯¢ Looper.loop(); &#125; //å¦‚æžœHandlerä¸å†éœ€è¦å‘é€å’Œå¤„ç†æ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±éœ€è¦é€€å‡ºå­çº¿ç¨‹çš„æ¶ˆæ¯è½®è¯¢ //Looper.myLooper().quit(); //Looper.myLooper().quitSafely(); &#125;).start(); //åœ¨ä¸»çº¿ç¨‹å‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°å­çº¿ç¨‹ Message msg = new Message(); handler.sendMessage(msg); è¿˜æœ‰å…¶å®ƒä¸€äº›æ‰©å±•çš„æ–¹æ³• //å»¶æ—¶å‘é€æ¶ˆæ¯ public final boolean sendMessageDelayed(Message msg, long delayMillis) public final boolean postDelayed(Runnable r, long delayMillis); //å®šæ—¶å‘é€æ¶ˆæ¯ï¼ˆç±»æ¯”iOSçš„NSTimerï¼‰ public boolean sendMessageAtTime(Message msg, long uptimeMillis) &#123; public final boolean postAtTime(Runnable r, long uptimeMillis); public final boolean postAtTime(Runnable r, Object token, long uptimeMillis); Activityç±»çš„runOnUiThread()ã€Viewç±»çš„post()ã€HandlerThreadç±»ï¼Œè¿™äº›å…¶å®žéƒ½æ˜¯å†…éƒ¨å®žçŽ°äº†æˆ–æ–¹ä¾¿å®žçŽ°Handlerçš„æœºåˆ¶ï¼Œå°è£…èµ·äº†ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œä¾‹å¦‚runOnUiThreadå†…éƒ¨å°±æ˜¯è°ƒç”¨Activityåœ¨ä¸»çº¿ç¨‹åˆ›å»ºçš„HandleråŽ»æ‰§è¡Œpost(runnable)ï¼Œå†ä¾‹å¦‚HandlerThreadæœ¬è´¨å°±æ˜¯ä¸ªThreadï¼Œä¸Žæ™®é€šThreadçš„å·®åˆ«åœ¨äºŽå…¶å†…éƒ¨å®žçŽ°äº†Looperçš„åˆ›å»ºï¼Œæ–¹ä¾¿åœ°è®©Handlerå¯ä»¥ç›´æŽ¥æŒ‡å®šä½¿ç”¨è¿™ä¸ªçº¿ç¨‹çš„Looperã€‚ è¯è¯´å›žiOSï¼Œå®žçŽ°è¿™ç§è·¨çº¿ç¨‹çš„é€šä¿¡ï¼ŒGCDç›¸å¯¹æ–¹ä¾¿ä¸€ç‚¹ï¼Œä»Žå‘èµ·å¼‚æ­¥ä»»åŠ¡ï¼Œåˆ°ä¸Žå…¶å®ƒçº¿ç¨‹é€šä¿¡ï¼Œè¿™ä¸¤éƒ¨åˆ†é€»è¾‘çš„ä»£ç å¯ä»¥æ•´åˆåœ¨ä¸€èµ·å®žçŽ°ï¼Œéžå¸¸æ¸…æ™°ï¼Œä¸è¿‡è¿™æ˜¯ç³»ç»Ÿå°è£…åŽçš„å¾—ç›Šè€Œå·²ã€‚NSThreadä¹Ÿä¸€æ ·ï¼Œç³»ç»Ÿé€šè¿‡å°è£…å¥½å„ç§performSelectorçš„æ–¹æ³•ï¼Œç”±æˆ‘ä»¬è‡ªç”±é€‰æ‹©æ‰§è¡Œçš„æŒ‡å®šæ–¹æ³•æ‰€åœ¨çš„çº¿ç¨‹ï¼ˆæ¯”Handleråªèƒ½åœ¨Runnable Callbackæˆ–è€…handleMessageè¿™ä¸¤ä¸ªåœ°æ–¹å›žè°ƒæ›´æœ‰çµæ´»æ€§ï¼‰ï¼Œå®žçŽ°çº¿ç¨‹é—´çš„é€šä¿¡ï¼Œåªè¦æŒæœ‰ç›®æ ‡é€šä¿¡çš„NSThreadï¼Œå°±å¥½æ¯”æŒæœ‰ç€Handlerï¼Œéœ€è¦é€šä¿¡æ—¶å°±ç”¨å…¶æ¥å‘æ¶ˆæ¯ï¼ˆperformSelectorï¼‰ï¼ŒperformSelectorå†…éƒ¨å…¶å®žä¹Ÿæ˜¯é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶æ¥è§¦å‘ä»»åŠ¡çº¿ç¨‹åŽ»å¤„ç†ä»»åŠ¡ï¼ˆå€ŸåŠ©NSTimerï¼‰ï¼Œä¹Ÿæ˜¯éœ€è¦ä¸€ä¸ªå¾ªçŽ¯ä½“NSRunLoopæ‰èƒ½èµ·ä½œç”¨ã€‚ æ‰“åŒ…Apkæ“ä½œè·¯å¾„ï¼šBuild-&gt;Build Bundle(s) / APK(s)-&gt;Build APK(s)äº§å‡ºè·¯å¾„ï¼š[project]/[module]/build/outputs/apk/debug é€‰æ‹©Build Bundle(s)çš„è¯ï¼Œäº§å‡ºçš„æ˜¯aab(Android Application Bundle)ï¼Œaabæ˜¯ä¸€ç§æ–°åž‹çš„ä¸Šä¼ åŒ…æ ¼å¼ï¼Œå®ƒèƒ½åŒ…è£¹åº”ç”¨æ‰€ç¼–è¯‘çš„ä»£ç å’Œèµ„æºï¼Œä½†åªèƒ½ç”¨äºŽGoogle Playã€‚ è‹¥è¦ä½¿APKå¸¦ç­¾åçš„ï¼Œåˆ™é€‰æ‹©Generate Signed Bundle / APKï¼Œè¿™é¡¹æ˜¯éœ€è¦æŒ‡å®škeystoreæ–‡ä»¶å’Œå…¶å¯†ç åŠåˆ«åçš„ã€‚ jarä½¿ç”¨Android Studioå¯¹å·¥ç¨‹è¿›è¡Œç¼–è¯‘åŽï¼Œå°±ä¼šè‡ªåŠ¨ç”Ÿæˆjarï¼Œæ‰€åœ¨è·¯å¾„ä¸º /build/intermediates/bundles/debug(release)/classes.jar /build/intermediates/packaged-classes/release/classes.jarä½†è‹¥æƒ³åˆ é™¤jarä¸­ä¸€äº›æ— ç”¨çš„å†…å®¹ï¼Œå¯ä»¥åœ¨è¦æ‰“jarçš„Moduleä¸­çš„build.gradleé‡Œè‡ªå®šä¹‰ä¸€ä¸ªæ‰“jarçš„Taskï¼Œå¦‚ä¸‹ä¸ºåˆ¶ä½œä¸€ä¸ªæŒ‡å®šè¾“å‡ºè·¯å¾„ã€è¾“å‡ºæ–‡ä»¶åã€åˆ é™¤BuildConfig.classæ–‡ä»¶çš„jar task makeJar(type: Jar, dependsOn: [&apos;assembleRelease&apos;]) &#123; destinationDir = file(&apos;build/outputs/libs&apos;) baseName = &quot;jar_name&quot; // SDKåç§° version = &quot;1.0.0&quot; // ç‰ˆæœ¬å· from(zipTree(&apos;build/intermediates/packaged-classes/release/classes.jar&apos;)) // jarçš„å®žé™…æ¥æº exclude(&apos;com/xx/yy/BuildConfig.class&apos;) &#125; ç”±ä¸Šé¢build.gradleä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å•ç‹¬åŽ»è°ƒç”¨Gradleçš„assembleReleaseè¿™ä¸ªTaskï¼Œä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œç¼–è¯‘ç”Ÿæˆjarçš„ã€‚ arrå¯¹æ¯”jarï¼Œaaræ˜¯æ›´é€‚åˆä½œä¸ºSDKçš„æ ¼å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥åŒæ—¶æŠŠclasså’Œresæ–‡ä»¶ä¸€èµ·æ‰“åŒ…ã€‚ æ‰“åŒ…æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦åœ¨ä¸€ä¸ªProjectä¸‹ï¼Œæ–°å»ºä¸€ä¸ªç”¨äºŽæ‰“åŒ…çš„Moduleï¼ˆAndroid librariesï¼‰ï¼ŒSDKçš„æºç å’Œèµ„æºéƒ½åœ¨è¿™ä¸ªModuleä¸‹æ·»åŠ ï¼Œé‚£ä¹ˆåªè¦æ­¤Moduleä¸€è¢«ç¼–è¯‘ï¼Œaarå°±èƒ½è¢«ç”Ÿæˆï¼Œç”Ÿæˆè·¯å¾„ä¸º /build/outputs/aar/libraryname.aarå¼€å‘æ—¶åœ¨Projectä¸‹æ–°å»ºå¦ä¸€ä¸ªModuleï¼Œä½œä¸ºDemo Appï¼Œå…¶ä¾èµ–ä¸Šè¿°çš„aar Moduleï¼Œå°±å¯ä»¥å®žçŽ°æ¨¡æ‹ŸæŽ¥å…¥å’Œè°ƒè¯•ã€‚ è®¾è®¡æ¨¡å¼MVPåœ¨MVCçš„åŸºç¡€ä¸Šå¢žåŠ äº†Presenterå±‚åŽï¼ŒActivityåº”è¯¥è¦æ”¹ä¸ºè§†ä½œViewå±‚ï¼Œå…¶åŽŸæœ¬æŽ§åˆ¶å™¨çš„èŒèƒ½å·²è½¬ç§»åˆ°äº†Presenterå±‚ä¸Šï¼Œè¿›ä¸€æ­¥å‡å°‘Viewå’ŒModelçš„è€¦åˆã€‚ åšæ³•ï¼š æŠ½è±¡Viewå±‚çš„æ›´æ–°ç•Œé¢æŽ¥å£ï¼Œç”±Viewï¼ˆActivityï¼‰å®žçŽ°æ­¤æŽ¥å£ï¼ŒæŽ¥å£æä¾›ä¼ å…¥Value Objectçš„æ–¹æ³•åŽ»åˆ·æ–°Viewä¸Šçš„æ•°æ®å€¼ æŠ½è±¡å‡ºPresenterç»‘å®šï¼ˆæ³›åž‹çš„ï¼‰æŠ½è±¡Viewçš„æŽ¥å£ç±»ï¼Œå…·ä½“ä¸šåŠ¡Presenterå®žçŽ°æ­¤æŽ¥å£å¹¶æŒæœ‰ï¼ˆç»‘å®šï¼‰Viewå’Œï¼ˆåˆ›å»ºï¼‰Modelï¼ˆå³æ¯ä¸€ä¸ªActivityéƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„Presenteræ¥å¤„ç†æ•°æ®ï¼‰ å…·ä½“ä¸šåŠ¡Presenteréœ€åŒæ—¶ä½œä¸ºModelèŽ·å–æ•°æ®åŽçš„å›žè°ƒå¯¹è±¡ï¼Œå³Modelä¹ŸæŒæœ‰Presenterï¼ŒPresenterç»™Modelæä¾›å›žä¼ å‡ºValue Objectçš„èŽ·å–æ•°æ®æŽ¥å£ å…·ä½“ä¸šåŠ¡PresenteræŽ§åˆ¶ModelåŽ»èŽ·å–æ•°æ®å’Œåˆ·æ–°Viewï¼Œä»¥åŠå“åº”Viewä¿®æ”¹Modelçš„æ•°æ® MVVMå°†Presenteræ”¹åä¸ºViewModelï¼ŒåŸºæœ¬ä¸Šä¸ŽMVPæ¨¡å¼å®Œå…¨ä¸€è‡´ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå®ƒé‡‡ç”¨åŒå‘ç»‘å®šï¼ˆdata-bindingï¼‰ï¼šViewçš„å˜åŠ¨ï¼Œè‡ªåŠ¨åæ˜ åœ¨ViewModelï¼Œåä¹‹äº¦ç„¶ï¼Œå³æ˜¯Presenterä¸ä½†è¦ä½œä¸ºModleçš„å›žè°ƒå¯¹è±¡ï¼Œè¿˜è¦ä½œä¸ºViewçš„å›žè°ƒå¯¹è±¡ï¼Œæ‹¿MVPä¸Šçš„åšæ³•ä¸ºä¾‹ï¼Œè‹¥Viewåœ¨å®žçŽ°æ—¶ä¹ŸæŒæœ‰äº†ï¼ˆåˆ›å»ºï¼‰Presenterå’Œä¼šè°ƒç”¨Presenterçš„æ›´æ–°æ•°æ®æŽ¥å£ï¼Œé‚£ä¹ˆè¿™ä¸ªPresenterå°±å¯ä»¥ç†è§£ä¸ºViewModeläº†ï¼Œè¿™æ—¶å€™Modelå±‚ä¹Ÿåº”è¯¥å¾—æŠ½è±¡å‡ºä¸€å¥—ä¸šåŠ¡é€»è¾‘æŽ¥å£ã€‚ æ€»ç»“åœ¨Android Studioä¸Šé€‰æ‹©ä¸€ä¸ªæ¨¡æ¿åˆ›å»ºèµ·ä¸€ä¸ªåº”ç”¨ï¼ˆGoogleæä¾›äº†æŒºå¤šæµè¡Œçš„ç•Œé¢æ¡†æž¶é€‰æ‹©ï¼‰ï¼Œä»ŽMainActivityä¸Šå¼€å§‹ä¸€æ­¥æ­¥è¿ç”¨ä¸Šé¢æ‰€å†™çš„å„é¡¹çŸ¥è¯†ç‚¹ï¼Œä¾‹å¦‚ä½¿ç”¨MVPè®¾è®¡Appçš„æ¡†æž¶ã€è¯»å–èµ„æºæ˜¾ç¤ºåˆ°UIä¸Šã€å¸ƒå±€è‡ªå·±çš„ç•Œé¢ã€æ ¹æ®éœ€æ±‚å®‰æ’å„å¼å„æ ·çš„æŽ§ä»¶ã€ç”¨åˆ—è¡¨å±•ç¤ºå‡ºè®¾è®¡å¥½çš„æ¨¡åž‹æ•°æ®ç­‰ç­‰ï¼Œå†ç»“åˆè‡ªå·±çš„ä¸šåŠ¡Ideaï¼Œæ­å»ºå‡ºå±žäºŽä½ çš„Android Appå§ã€‚ ä½†è¿˜æœ‰ä»¥ä¸‹ä¸€äº›æˆ‘æœªç”¨åˆ°ã€ä¸Šé¢ä¹Ÿæ²¡è¯¦ç»†ä»‹ç»çš„åŠŸèƒ½ï¼Œæ—¥åŽæœ‰æœºä¼šå†è¡¥å……è¡¥å…… ContentProvider BroadcastReceiver JNI NDKï¼ˆæ˜ å°„ç­‰ï¼‰ å‚è€ƒAndroidManifest.xmlè¯¦è§£ Viewä¸ŽViewGroupçš„æ¦‚å¿µ AdapteråŸºç¡€è®²è§£ Android Adapter:ArrayAdapterç¯‡ æµ…æž MVP ä¸­ model å±‚è®¾è®¡ Android MVP å®žä¾‹ è°ˆè°ˆæˆ‘ç†è§£çš„Androidåº”ç”¨æž¶æž„ Android å¤šçº¿ç¨‹ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨AsyncTask Handlerçš„ä½¿ç”¨æ–¹å¼å’Œæ³¨æ„äº‹é¡¹ Handleræœºåˆ¶çš„å®žçŽ°ä¸Žå·¥ä½œåŽŸç†]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>MVP</tag>
        <tag>Adapter</tag>
        <tag>Activity</tag>
        <tag>Fragment</tag>
        <tag>Layout</tag>
        <tag>Res</tag>
        <tag>Realm</tag>
        <tag>AIDL</tag>
        <tag>AsyncTask</tag>
        <tag>Thread</tag>
        <tag>Handler</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidæŠ€å·§å…¥é—¨]]></title>
    <url>%2Funcategorized%2FAndroid%E6%8A%80%E5%B7%A7%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨çš„adbæŒ‡ä»¤æŸ¥çœ‹è¿žæŽ¥çš„è®¾å¤‡ï¼š adb devicesæ— çº¿è¿žæŽ¥è®¾å¤‡ï¼š adb tcpip [port] adb connect [ip]:[port] adb disconnect [ip]:[port] # å½“è¿žæŽ¥å¤±æ•ˆæ—¶ï¼Œå¯å°è¯•é‡å¯adbæœåŠ¡ï¼Œæˆ–é‡å®šå‘ç«¯å£ï¼ˆé€šè¿‡æŒ‡å®šåŒä¸€ç«¯å£å·é‡æ–°æ¿€æ´»ï¼‰ adb kill-server adb start-server adb forward tcp:[port] tcp:[port]å®‰è£…åŒ…ï¼š adb install yourapk.apk # installå¯å¸¦å‚æ•°ï¼š # -lï¼šforward lock application # -rï¼šreplace existing application # -tï¼šallow test packages # -sï¼šinstall application on sdcard # -dï¼šallow version code downgrade # -pï¼špartial application install # æ”¾ç½®obb adb push main.BundleVersionCode.packagename.obb /mnt/sdcard/Android/obb/packagename/main.BundleVersionCode.packagename.obb # æ”¾ç½®è¯ä¹¦ adb push charles-ssl-proxying-certificate.pem sdcard/charles.pemè¯¦ç»†å‚è€ƒåœ°å€-ADB Shell åç¼–è¯‘Apk/Jaræ–¹æ³•ä¸€ï¼šapktoolä½¿ç”¨apktoolè¿˜å¯ä»¥å¯¹å¾—åˆ°çš„åç¼–è¯‘æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œé‡æ–°ç”Ÿæˆapk # è§£ç ï¼ˆd: decodeï¼‰ apktool d xxx.apk # å¸¦è®¾å®šçŽ¯å¢ƒå˜é‡ï¼ŒæŽ§åˆ¶ç³»ç»Ÿåˆ†é…èµ„æºçš„è§£ç  java -server -Xms512M -Xmx512M -XX:ReservedCodeCacheSize=512m -jar /Path/to/apktool_2.4.0.jar d -f xxx.apk -o xxx_decode/ # æž„å»ºï¼ˆbï¼šbuildï¼‰ apktool b files # å¸¦è®¾å®šçŽ¯å¢ƒå˜é‡ï¼ŒæŽ§åˆ¶ç³»ç»Ÿåˆ†é…èµ„æºçš„è§£ç  cd xxx_decode java -server -Xms512M -Xmx512M -XX:ReservedCodeCacheSize=512m -jar /Path/to/apktool_2.4.0.jar b . # é‡ç­¾ jarsigner [options] jar-file alias # å¸¸ç”¨æ–¹å¼ï¼ˆç›´æŽ¥æ›¿æ¢åŽŸæ–‡ä»¶ï¼‰ #-digestalgï¼šSHA256ï¼ˆé»˜è®¤å€¼ï¼‰ã€SHA1 #-sigalgï¼šMD5withRSAã€SHA1withDSAã€SHA256withRSAã€SHA256withECDSAã€‚é»˜è®¤å€¼å–å†³äºŽprivate keyçš„ç±»åž‹ã€‚ jarsigner -verbose -digestalg [SHA1] -keystore [/Path/to/app.keystore] -storepass [storepass] -keypass [keypass] [/Path/to/dist/resigned.apk/jar] [alias name] # æŒ‡å®šè¾“å‡ºæ–¹å¼ jarsigner -digestalg [SHA1] -sigalg [MD5withRSA] -tsa -verbose -keystore [/Path/to/app.keystore] -signedjar [/Path/to/resigned.apk] [/Path/to/original.apk] [alias name] #ç”Ÿæˆç­¾å(éžå¿…é¡») keytool -genkey -keystore [/Path/to/app.keystore] -keyalg RSA -validity 10000 -alias [alias name]è¯¦ç»†å‚è€ƒåœ°å€-APKTOOLå‚è€ƒåœ°å€-jarsigner psï¼šå¦‚è‹¥é‡ç­¾åŽä¸Šä¼ åŒ…æ—¶ï¼Œè°·æ­Œæç¤ºapkæ²¡æœ‰ç»è¿‡Zipalignï¼Œåˆ™éœ€è¦å¯¹apkåšå¦‚ä¸‹å¤„ç†ï¼ˆzipalgnå·¥å…·çš„è·¯å¾„åœ¨Android SDKè·¯å¾„ä¸‹-å¯é€šè¿‡ASçš„SDK ManageræŸ¥çœ‹ï¼‰ zipalign -v 4 from.apk to.apkæ–¹æ³•äºŒï¼šjadxjadxæ˜¯ä¸€ä¸ªå°†Dexã€Apkè½¬Javaä»£ç çš„åç¼–è¯‘å·¥å…·ã€‚ æœ‰å‘½ä»¤è¡Œå’ŒGUIä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚GUIä¸Šçš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸åšè¿‡å¤šä½¿ç”¨ä»‹ç»ã€‚ å‚è€ƒåœ°å€-jadx åœ¨MacOSä¸‹ï¼Œä½¿ç”¨åŽŸå§‹åŠžæ³•æ‰“å¼€jadxçš„GUIæ¯”è¾ƒéº»çƒ¦ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åŠ å¼ºä¾¿æ·æ€§ï¼š åœ¨Alfredçš„workflowä¸­æ·»åŠ æ‰§è¡Œjadx-guiçš„è„šæœ¬ åœ¨Automatorä¸Šä½¿ç”¨Applescriptæ·»åŠ Service(ä¸‹é¢æˆªå›¾ä»‹ç»ä¸€ä¸‹) å…·ä½“Applescriptçš„ä»£ç ï¼š tell application &quot;Finder&quot; try set filename to POSIX path of (selection as text) set fileType to (do shell script &quot;sh /Users/milknero/Works/Tools/jadx-1.0.0/bin/jadx-gui &quot; &amp; filename) end try end tellAndroid Studio å¿«æ·é”® åŠŸèƒ½ å¿«æ·é”® (æ“ä½œç±»)åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œï¼ˆé€‰ä¸­è¡Œï¼‰ Cmd + Y / Cmd + X (æ“ä½œç±»)å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„è¡Œï¼ˆé€‰ä¸­è¡Œï¼‰ Cmd + D (æ“ä½œç±»)æ‰€åœ¨è¡Œæ¢è¡Œ Cmd + Alt + Enter (æ“ä½œç±»)æ ¼å¼åŒ–ä»£ç ï¼ˆjavaã€xmlï¼‰ Cmd + Alt + L (æ“ä½œç±»)ä¸Šä¸‹ç§»åŠ¨é€‰ä¸­çš„è¡Œ Cmd + Shift + Up / Down (æ“ä½œç±»)å¤§å†™/å°å†™åˆ‡æ¢ Cmd + Shift + U (åˆ›å»ºç±»)å¿«é€Ÿåˆ›å»ºå±€éƒ¨å˜é‡ Cmd + Alt + V (åˆ›å»ºç±»)å±€éƒ¨å˜é‡å˜ä¸ºæˆå‘˜å˜é‡ Cmd + Alt + F (åˆ›å»ºç±»)ä»£ç åŠ©æ‰‹ï¼Œè‡ªåŠ¨è¡¥å…¨ Ctrl [+ Alt] + ç©ºæ ¼ï¼šå±žæ€§åã€ç±»åæˆ–æŽ¥å£åæç¤º (åˆ›å»ºç±»)æ–¹æ³•æç¤º Ctrl + Shift + ç©ºæ ¼ (åˆ›å»ºç±»)å¯¼å…¥åŒ… Alt+å›žè½¦:å¯¼å…¥å½“å‰åŒ… (åˆ›å»ºç±»)å¯¼å…¥é‡è½½æ–¹æ³• Cmd + O è¾“å…¥æ–¹æ³•åä¸Šä¸‹æ–¹å‘é”®é€‰æ‹©åŽå›žè½¦ (åˆ›å»ºç±»)åˆ é™¤æ²¡ç”¨åˆ°çš„åŒ… Ctrl + Alt + O (åˆ›å»ºç±»)å¿«é€Ÿä¿®å¤ Alt + Enter (åˆ›å»ºç±»)å¤åˆ¶ç±»çš„å…¨å±€è·¯å¾„ï¼ˆåŒ…ååŠ ç±»åï¼‰ Cmd + Shift + Alt + C (å³å‡»â€“&gt; Copy Reference) (æŸ¥çœ‹ç±»)å›žåˆ°ä¸Šä¸€æ¬¡ç¼–è¾‘çš„ä½ç½® Cmd + Shift + Backspace (æŸ¥çœ‹ç±»)å¿«é€Ÿå®šä½åˆ°ä»»æ„çš„æ–‡ä»¶ æŒ‰ä¸¤æ¬¡shift (æŸ¥çœ‹ç±»)å¿«é€Ÿå®šä½åˆ°ç±»æˆ–æ–¹æ³•çš„å®šä¹‰ Cmd+B (æŸ¥çœ‹ç±»)å¿«é€Ÿå®šä½æ–¹æ³•åœ¨å“ªé‡Œè¢«è°ƒç”¨ Ctrl + Alt + H (æŸ¥çœ‹ç±»)æœç´¢æˆ–æ›¿æ¢ Cmd + F / Cmd + R (å…¨å±€+Shift) (æŸ¥çœ‹ç±»)å¿«é€ŸæŸ¥çœ‹ç±»ç»§æ‰¿ç»“æž„ Ctrl + H (æŸ¥çœ‹ç±»)å…‰æ ‡æ‰€åœ¨ä¸Šä¸€æ¬¡æˆ–ä¸‹ä¸€æ¬¡çš„ä½ç½® Cmd + Alt + Left / Right (æŸ¥çœ‹ç±»)è§†çª—çš„æ˜¾ç¤ºä¸Žéšè— Alt + è§†çª—çš„æ•°å­—æ ‡è¯† winä¸‹ï¼ˆmacä¸‹å¾…ç¡®è®¤ï¼‰ åŠŸèƒ½ å¿«æ·é”® å¿«é€Ÿå®šä½åˆ°æŸä¸€ä¸ªç±»æˆ–æ–‡ä»¶ Cmd + N æŸ¥æ‰¾æ–‡ä»¶ Cmd + Shift + Nï¼š æ–¹æ³•å‚æ•°æç¤º Cmd + P é‡å‘½å Shift + F6 å¿«é€Ÿå®šä½åˆ°ç±»ä¸­çš„æ–¹æ³•æˆ–å±žæ€§ Cmd + F12 æ‰“å°è¾“å‡º sout å¿«é€Ÿå®šä½åˆ°å½“å‰ç±»æŠ¥é”™æˆ–è­¦å‘Šçš„åœ°æ–¹ fn + F2 æˆ– fn+Shift+F2 ç”Ÿæˆ get/setæ–¹æ³•ã€æž„é€ æ–¹æ³•ã€toString() alt + insert è®¾ç½®è‡ªåŠ¨å¯¼åŒ… å‹¾é€‰ï¼šAdd unambiguous imports on the fly é€‰ä¸­å˜é‡å¿«é€Ÿè·³è½¬åˆ°ä¸‹ä¸€ä¸ª Alt + F3, F3 æ˜¾ç¤ºJavaDocï¼ˆæ³¨é‡Šæ–‡æ¡£ï¼‰ Ctrl + Q æ›´æ–° 2019.9.23 ä½¿ç”¨apksigner.jarä»£æ›¿jarsigneræ›´æ–¹ä¾¿æ˜“ç”¨ï¼Œå…åŽ»äº†æŒ‡å®šaliaså’Œæ‘˜è¦ç®—æ³•ç±»åž‹çš„å‚æ•°ï¼ŒåŒæ—¶æ”¯æŒv1ã€v2ä¸¤ç§ç­¾åæ–¹å¼ã€‚]]></content>
      <tags>
        <tag>AndroidStudio</tag>
        <tag>adb</tag>
        <tag>åç¼–è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidåŽŸç†å…¥é—¨]]></title>
    <url>%2FAndroid%2FAndroid%E5%8E%9F%E7%90%86%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[JavaJavaæ˜¯ä¸€é—¨åŸºäºŽJVMï¼ˆJava Virtual Machineï¼‰ç¼–è¯‘çš„å¼ºç±»åž‹è¯­è¨€ï¼Œä¸»è¦åº”ç”¨åˆ°Androidå’ŒæœåŠ¡ç«¯çš„å¼€å‘ã€‚ é™æ€å†…éƒ¨ç±»å’Œéžé™æ€å†…éƒ¨ç±»çš„åŒºåˆ«åœ¨Javaä¸­æˆ‘ä»¬å¯ä»¥æœ‰é™æ€å®žä¾‹å˜é‡ã€é™æ€æ–¹æ³•ã€é™æ€å—ã€‚ç±»ä¹Ÿå¯ä»¥æ˜¯é™æ€çš„ã€‚Javaå…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªç±»é‡Œé¢å®šä¹‰é™æ€ç±»ã€‚æ¯”å¦‚å†…éƒ¨ç±»ï¼ˆnested classï¼‰ã€‚æŠŠnested classå°é—­èµ·æ¥çš„ç±»å«å¤–éƒ¨ç±»ã€‚åœ¨Javaä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ç”¨staticä¿®é¥°é¡¶çº§ç±»ï¼ˆtop level classï¼‰ï¼Œåªæœ‰å†…éƒ¨ç±»å¯ä»¥ä¸ºstaticã€‚ å†…éƒ¨é™æ€ç±»ä¸éœ€è¦æœ‰æŒ‡å‘å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚ä½†éžé™æ€å†…éƒ¨ç±»éœ€è¦æŒæœ‰å¯¹å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚ éžé™æ€å†…éƒ¨ç±»èƒ½å¤Ÿè®¿é—®å¤–éƒ¨ç±»çš„é™æ€å’Œéžé™æ€æˆå‘˜ã€‚é™æ€ç±»ä¸èƒ½è®¿é—®å¤–éƒ¨ç±»çš„éžé™æ€æˆå‘˜ã€‚ä»–åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜ã€‚ ä¸€ä¸ªéžé™æ€å†…éƒ¨ç±»ä¸èƒ½è„±ç¦»å¤–éƒ¨ç±»å®žä½“è¢«åˆ›å»ºï¼Œä¸€ä¸ªéžé™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ•°æ®å’Œæ–¹æ³•ï¼Œå› ä¸ºä»–å°±åœ¨å¤–éƒ¨ç±»é‡Œé¢ã€‚ final protected privateä¿®é¥°æ–¹æ³•çš„åŒºåˆ« finalæ˜¯ä»»ä½•äººéƒ½ä¸èƒ½ä¿®æ”¹æ–¹æ³•ï¼ŒåŒ…æ‹¬å­ç±»çš„é‡å†™ï¼Œä½†å¯ä»¥ä½¿ç”¨ï¼› protectedæ˜¯åªæœ‰è‡ªå·±å’Œå­ç±»å¯ä»¥ä½¿ç”¨ï¼Œå­ç±»å¯é‡å†™ï¼Œè€Œå¤–éƒ¨å…¶å®ƒç±»ä¸çŸ¥é“è¯¥æ–¹æ³•çš„å­˜åœ¨ï¼› privateæ˜¯åªæœ‰è‡ªå·±å¯ä»¥ä½¿ç”¨ï¼Œå­ç±»ä»¥åŠå¤–éƒ¨å…¶å®ƒç±»éƒ½ä¸çŸ¥é“è¯¥æ–¹æ³•çš„å­˜åœ¨ã€‚ åŒ¿åå†…éƒ¨ç±»ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»è¿›è¡Œåˆå§‹åŒ–ï¼šåœ¨newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå°æ‹¬å·å‰å°±æ˜¯è¦å®žçŽ°çš„æŽ¥å£æˆ–è¦ç»§æ‰¿çš„çˆ¶ç±»ï¼Œå°æ‹¬å·åŽè¾¹è·Ÿä¸€ä¸ªå¤§æ‹¬å·ï¼Œå¤§æ‹¬å·å†…å°±æ˜¯è¯¥å†…éƒ¨ç±»çš„å®žçŽ°ã€‚ Person person = new Person(&quot;å¼ ä¸‰&quot;) &#123; @Override public String getName() &#123; return super.getName()+&quot;123&quot;; &#125; &#125;; class Person&#123; String name; public Person(String name)&#123; this.name = name; &#125; public String getName()&#123; return name; &#125; &#125; tv1.setOnClickListener(new OnClickListener() &#123; @Override public void onClick(View v) &#123; &#125; &#125;); public interface OnClickListener &#123; void onClick(View v); &#125; æŽ¥å£æ˜¯ä¸å¯ä»¥å®žä¾‹åŒ–çš„ï¼Œä¸Šé¢çš„OnClickListenerå¯ä»¥newï¼Œæ˜¯å› ä¸ºå¾—ç›ŠäºŽåŒ¿åå†…éƒ¨ç±»ã€‚new OnClickListener(){}å…¶å®žå¹¶æ²¡æœ‰çœŸæ­£åœ°å®žä¾‹åŒ–è¯¥æŽ¥å£ï¼Œè€Œæ˜¯newäº†ä¸€ä¸ªå®žçŽ°è¯¥æŽ¥å£çš„åŒ¿åå†…éƒ¨ç±»ã€‚å½“ç„¶åŒ¿åå†…éƒ¨ç±»è¿˜å¯ä»¥é€‰æ‹©ç»§æ‰¿çˆ¶ç±»è€Œä¸æ˜¯å®žçŽ°æŽ¥å£ï¼Œé‚£newè¯¥å†…éƒ¨ç±»æ—¶ä»Žå¤–è§‚ä¸Šçœ‹ä¹ŸåŒæ ·ä¸è¦ä»¥ä¸ºæ˜¯åœ¨newçˆ¶ç±»çš„å®žä¾‹äº†ã€‚ AndroidAsyncTaskAsyncTaskæ˜¯ä¸€ä¸ªç³»ç»Ÿè½»é‡çº§çš„å¼‚æ­¥ä»»åŠ¡æœºåˆ¶å·¥å…·ã€‚ åœ¨Androidä¸­å®žçŽ°å¼‚æ­¥ä»»åŠ¡æœºåˆ¶æœ‰ä¸¤ç§æ–¹å¼ï¼ŒHandlerå’ŒAsyncTaskã€‚ Handleræ¨¡å¼éœ€è¦ä¸ºæ¯ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä»»åŠ¡å®ŒæˆåŽé€šè¿‡Handlerå®žä¾‹å‘UIçº¿ç¨‹å‘é€æ¶ˆæ¯ï¼Œå®Œæˆç•Œé¢çš„æ›´æ–°ï¼Œè¿™ç§æ–¹å¼å¯¹äºŽæ•´ä¸ªè¿‡ç¨‹çš„æŽ§åˆ¶æ¯”è¾ƒç²¾ç»†ï¼Œä½†ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä¾‹å¦‚ä»£ç ç›¸å¯¹è‡ƒè‚¿ï¼Œåœ¨å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œæ—¶ï¼Œä¸æ˜“å¯¹çº¿ç¨‹è¿›è¡Œç²¾ç¡®çš„æŽ§åˆ¶ã€‚ ä¸ºäº†ç®€åŒ–æ“ä½œï¼ŒAndroid1.5æä¾›äº†å·¥å…·ç±»android.os.AsyncTaskï¼Œå®ƒä½¿åˆ›å»ºå¼‚æ­¥ä»»åŠ¡å˜å¾—æ›´åŠ ç®€å•ï¼Œä¸å†éœ€è¦ç¼–å†™ä»»åŠ¡çº¿ç¨‹å’ŒHandlerå®žä¾‹å³å¯å®Œæˆç›¸åŒçš„ä»»åŠ¡ã€‚AsyncTaskä¸­çš„ä¸‰ç§æ³›åž‹ç±»åž‹åˆ†åˆ«ä»£è¡¨â€œå¯åŠ¨ä»»åŠ¡æ‰§è¡Œçš„è¾“å…¥å‚æ•°â€ã€â€œåŽå°ä»»åŠ¡æ‰§è¡Œçš„è¿›åº¦â€ã€â€œåŽå°è®¡ç®—ç»“æžœçš„ç±»åž‹â€ã€‚åœ¨ç‰¹å®šåœºåˆä¸‹ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç±»åž‹éƒ½è¢«ä½¿ç”¨ï¼Œå¦‚æžœæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå¯ä»¥ç”¨java.lang.Voidç±»åž‹ä»£æ›¿ã€‚ æ‰§è¡Œæ­¥éª¤ï¼š execute(Paramsâ€¦ params)ï¼Œæ‰§è¡Œä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œéœ€è¦æˆ‘ä»¬åœ¨ä»£ç ä¸­è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè§¦å‘å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œã€‚ onPreExecute()ï¼Œåœ¨execute(Paramsâ€¦ params)è¢«è°ƒç”¨åŽç«‹å³æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨æ¥åœ¨æ‰§è¡ŒåŽå°ä»»åŠ¡å‰å¯¹UIåšä¸€äº›æ ‡è®°ã€‚ doInBackground(Paramsâ€¦ params)ï¼Œåœ¨onPreExecute()å®ŒæˆåŽç«‹å³æ‰§è¡Œï¼Œç”¨äºŽæ‰§è¡Œè¾ƒä¸ºè´¹æ—¶çš„æ“ä½œï¼Œæ­¤æ–¹æ³•å°†æŽ¥æ”¶è¾“å…¥å‚æ•°å’Œè¿”å›žè®¡ç®—ç»“æžœã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è°ƒç”¨publishProgress(Progressâ€¦ values)æ¥æ›´æ–°è¿›åº¦ä¿¡æ¯ã€‚ onProgressUpdate(Progressâ€¦ values)ï¼Œåœ¨è°ƒç”¨publishProgress(Progressâ€¦ values)æ—¶ï¼Œæ­¤æ–¹æ³•è¢«æ‰§è¡Œï¼Œç›´æŽ¥å°†è¿›åº¦ä¿¡æ¯æ›´æ–°åˆ°UIç»„ä»¶ä¸Šã€‚ onPostExecute(Result result)ï¼Œå½“åŽå°æ“ä½œç»“æŸæ—¶ï¼Œæ­¤æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ï¼Œè®¡ç®—ç»“æžœå°†åšä¸ºå‚æ•°ä¼ é€’åˆ°æ­¤æ–¹æ³•ä¸­ï¼Œç›´æŽ¥å°†ç»“æžœæ˜¾ç¤ºåˆ°UIç»„ä»¶ä¸Šã€‚ æ³¨æ„ç‚¹ï¼šæœ‰å‡ ç‚¹éœ€è¦æ ¼å¤–æ³¨æ„ï¼š å¼‚æ­¥ä»»åŠ¡çš„å®žä¾‹å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­åˆ›å»ºã€‚ execute(Paramsâ€¦ params)æ–¹æ³•å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­è°ƒç”¨ã€‚ ä¸è¦æ‰‹åŠ¨è°ƒç”¨onPreExecute()ï¼ŒdoInBackground(Paramsâ€¦ params)ï¼ŒonProgressUpdate(Progressâ€¦ values)ï¼ŒonPostExecute(Result result)è¿™å‡ ä¸ªæ–¹æ³•ã€‚ ä¸èƒ½åœ¨doInBackground(Paramsâ€¦ params)ä¸­æ›´æ”¹UIç»„ä»¶çš„ä¿¡æ¯ã€‚ ä¸€ä¸ªä»»åŠ¡å®žä¾‹åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æžœæ‰§è¡Œç¬¬äºŒæ¬¡å°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æ¦‚æ‹¬æ¥è¯´ï¼Œå½“æˆ‘ä»¬è°ƒç”¨execute(Paramsâ€¦ params)æ–¹æ³•åŽï¼Œexecuteæ–¹æ³•ä¼šè°ƒç”¨onPreExecute()æ–¹æ³•ï¼Œç„¶åŽç”±ThreadPoolExecutorå®žä¾‹sExecutoræ‰§è¡Œä¸€ä¸ªFutureTaskä»»åŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­doInBackground(Paramsâ€¦ params)å°†è¢«è°ƒç”¨ï¼Œå¦‚æžœè¢«å¼€å‘è€…è¦†å†™çš„doInBackground(Paramsâ€¦ params)æ–¹æ³•ä¸­è°ƒç”¨äº†publishProgress(Progressâ€¦ values)æ–¹æ³•ï¼Œåˆ™é€šè¿‡InternalHandlerå®žä¾‹sHandlerå‘é€ä¸€æ¡MESSAGE_POST_PROGRESSæ¶ˆæ¯ï¼Œæ›´æ–°è¿›åº¦ï¼ŒsHandlerå¤„ç†æ¶ˆæ¯æ—¶onProgressUpdate(Progressâ€¦ values)æ–¹æ³•å°†è¢«è°ƒç”¨ï¼›å¦‚æžœé‡åˆ°å¼‚å¸¸ï¼Œåˆ™å‘é€ä¸€æ¡MESSAGE_POST_CANCELçš„æ¶ˆæ¯ï¼Œå–æ¶ˆä»»åŠ¡ï¼ŒsHandlerå¤„ç†æ¶ˆæ¯æ—¶onCancelled()æ–¹æ³•å°†è¢«è°ƒç”¨ï¼›å¦‚æžœæ‰§è¡ŒæˆåŠŸï¼Œåˆ™å‘é€ä¸€æ¡MESSAGE_POST_RESULTçš„æ¶ˆæ¯ï¼Œæ˜¾ç¤ºç»“æžœï¼ŒsHandlerå¤„ç†æ¶ˆæ¯æ—¶onPostExecute(Result result)æ–¹æ³•è¢«è°ƒç”¨ã€‚ å»¶ä¼¸ï¼šç†è®ºä¸Šé€šè¿‡executeå¯åŠ¨AsyncTaskä»»åŠ¡è¿™ç§æ–¹å¼å¯ä»¥åˆ›å»ºæ— æ•°ä¸ªtaskï¼Œå¹¶ä¸”æ‰€æœ‰çš„taskæ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚ AsyncTask.THREAD_POOL_EXECUTORæ˜¯AsyncTaské»˜è®¤å¸®æˆ‘ä»¬é…ç½®çš„Executorï¼Œå®ƒçš„é…ç½®æ˜¯æ ¸å¿ƒçº¿ç¨‹æ•°ä¸ºCPUæ ¸ä¸ªæ•°+1ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ˜¯2å€çš„CPUæ ¸ä¸ªæ•°+1ï¼Œä»»åŠ¡æŽ’é˜Ÿé˜Ÿåˆ—å¤§å°ä¸º128ï¼Œå‡è®¾æ‰‹æœºCPUæ ¸çš„ä¸ªæ•°ä¸º8ï¼Œåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º9ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º17ï¼Œåˆ™æœ€å¤§çš„ä»»åŠ¡æ•°ä¸º128+17ï¼Œè¶…è¿‡è¿™ä¸ªæ•°é‡å°±ä¼šæŠ›å‡ºRejectedExecutionExceptionã€‚åœ¨æŽ’é˜Ÿé˜Ÿåˆ—æœªæ»¡ä¹‹å‰ï¼Œæœ€å¤šæœ‰9ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œå½“æŽ’é˜Ÿé˜Ÿåˆ—æ»¡äº†ä¹‹åŽï¼Œæœ€å¤šæœ‰17ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é“¾æŽ¥ã€è£…è½½ã€åº“]]></title>
    <url>%2F%E7%B3%BB%E7%BB%9F%2F%E9%93%BE%E6%8E%A5%E3%80%81%E8%A3%85%E8%BD%BD%E3%80%81%E5%BA%93%2F</url>
    <content type="text"><![CDATA[ä»‹ç»æ­¤æ–‡å’Œä¸­å¿ƒåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šç¬¬ä¸€æ˜¯å ç¯‡å¹…æœ€å¤šçš„ç¼–è¯‘ã€é“¾æŽ¥ã€åŠ è½½ç­‰ï¼Œè¿™äº›ç›¸å¯¹åº•å±‚çš„ç³»ç»Ÿæœºåˆ¶å’Œè¿è¡ŒåŽŸç†ï¼›ç¬¬äºŒæ˜¯ç©¿æ’äºŽç¬¬ä¸€ç‚¹å†…å®¹ä¹‹ä¸­ï¼Œå¯¹åº”äºŽå„æ­¥éª¤çš„æ“ä½œæˆ–åˆ†æžå‘½ä»¤ï¼Œä»¥åŠæœ€åŽçš„æ±‡ç¼–è¯­è¨€å…¥é—¨è®²è§£ã€‚ é€šè¿‡äº†è§£è¿™äº›ç³»ç»Ÿåº•å±‚çš„åŽŸç†åŠçŸ¥è¯†ï¼Œèƒ½è®©æˆ‘ä»¬æ›´å¥½æ›´å¿«åœ°æŽ’æŸ¥ç¨‹åºæž„å»ºæˆ–è¿è¡Œæ—¶çš„é—®é¢˜ï¼Œåˆæˆ–è€…å¸®åŠ©æˆ‘ä»¬è¿›è¡Œç¨‹åºé€†å‘æˆ–ä»£ç å®‰å…¨é˜²æŠ¤çš„åˆ†æžç ”ç©¶ã€‚ ä¸€ç‚¹ç‚¹è€å¿ƒåœ°ç§¯ç´¯ï¼Œä¸è¦è¿‡æ—©å°±å¿Œæ€•è‡ªå·±æ— æ³•é©¾é©­æž¯ç‡¥çš„çŸ¥è¯†ï¼Œæ‰“é€€å ‚é¼“ã€‚ è®¡ç®—æœºç¡¬ä»¶æ¡†æž¶åŒ—æ¡¥ï¼ˆPCI bridgeï¼‰ï¼šè´Ÿè´£åè°ƒCPUã€å†…å­˜å’Œé«˜é€Ÿçš„å›¾å½¢è®¾å¤‡é«˜é€Ÿåœ°äº¤æ¢æ•°æ®ï¼›å—æ¡¥ï¼ˆISA bridgeï¼‰ï¼šè´Ÿè´£è¿žæŽ¥ä½Žé€Ÿè®¾å¤‡ï¼Œå¦‚ç£ç›˜ã€USBã€é”®ç›˜ã€é¼ æ ‡ç­‰I/Oï¼Œä½¿å…¶ä¸ŽåŒ—æ¡¥è¿žæŽ¥åˆ†ç¦»ï¼›ç³»ç»Ÿæ€»çº¿ï¼ˆSystem BUSï¼‰ï¼šç”±äºŽCPUä¸Žå†…å­˜ã€I/Oçš„é¢‘çŽ‡ç›¸å·®å¤ªå¤§ï¼Œéœ€è¦ä¸€ä¸ªéš”ç¦»å®ƒä»¬çš„é€šä¿¡è¿žæŽ¥ï¼›ï¼ˆåƒPCIæ€»çº¿å’ŒISAæ€»çº¿ï¼Œå…¶å®žéƒ½æ˜¯ä¸ºäº†åˆ†ç¦»ä¸åŒé€ŸçŽ‡çš„è®¾å¤‡ï¼Œå¹¶é€‚é…å®ƒä»¬é—´çš„é€šä¿¡ï¼‰ ã€å›¾ã€‘è®¡ç®—æœºç¡¬ä»¶ç»“æž„æ¡†æž¶å›¾ ç³»ç»Ÿè½¯ä»¶å¯åˆ†ä¸ºä¸¤ç±» å¹³å°æ€§çš„ï¼Œå¦‚æ“ä½œç³»ç»Ÿå†…æ ¸ã€é©±åŠ¨ç¨‹åºã€è¿è¡Œåº“ã€ç³»ç»Ÿå·¥å…·ï¼› ç¨‹åºå¼€å‘çš„ï¼Œå¦‚ç¼–è¯‘å™¨ã€æ±‡ç¼–å™¨ã€é“¾æŽ¥å™¨ç­‰å¼€å‘å·¥å…·å’Œå¼€å‘åº“ï¼› ã€å›¾ã€‘è½¯ä»¶ä½“ç³»ç»“æž„å›¾ CPU åˆ†æ—¶ç³»ç»Ÿï¼ˆTime-Sharing Systemï¼‰ï¼šæ¯ä¸ªç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åŽéƒ½ä¸»åŠ¨è®©å‡ºCPUç»™å…¶å®ƒç¨‹åºï¼Œä½¿å¾—ä¸€æ®µæ—¶é—´å†…æ¯ä¸ªç¨‹åºéƒ½æœ‰æœºä¼šè¿è¡Œä¸€å°æ®µæ—¶é—´ã€‚ç¼ºç‚¹æ˜¯å¦‚æžœä¸€ä¸ªç¨‹åºéœ¸å ç€CPUä¸æ”¾ï¼ˆä¾‹å¦‚while(1) ï¼‰ï¼Œå…¶å®ƒç¨‹åºä¹Ÿå°±åªèƒ½ç­‰ç€ï¼Œç³»ç»Ÿä¹Ÿæ²¡æ³•å¤„ç†ã€‚ å¤šä»»åŠ¡ç³»ç»Ÿï¼ˆMulti-tasking Systemï¼‰ï¼šCPUç”±æ“ä½œç³»ç»Ÿç»Ÿä¸€è¿›è¡Œåˆ†é…ï¼Œæ¯ä¸ªè¿›ç¨‹æ ¹æ®è¿›ç¨‹ä¼˜å…ˆçº§çš„é«˜ä½Žéƒ½æœ‰æœºä¼šå¾—åˆ°CPUï¼Œä½†å¦‚æžœè¿è¡Œæ—¶é—´è¶…å‡ºä¸€å®šæ—¶é—´ï¼Œæ“ä½œç³»ç»Ÿä¼šæš‚åœè¯¥è¿›ç¨‹ï¼Œå°†CPUèµ„æºåˆ†é…ç»™å…¶å®ƒç­‰å¾…è¿è¡Œçš„è¿›ç¨‹ï¼ˆæ­¤ä¸ºæŠ¢å å¼åˆ†é…-Preemptiveï¼‰ã€‚å› ä¸ºCPUåœ¨è¿›ç¨‹é—´çš„åˆ‡æ¢éžå¸¸å¿«é€Ÿï¼Œæ‰€ä»¥äººä»¬æ„Ÿè§‰å¾ˆå¤šè¿›ç¨‹éƒ½æ˜¯åœ¨åŒæ—¶è¿è¡Œçš„å‡è±¡ã€‚ è¿›ç¨‹ï¼ˆProcessï¼‰ï¼šæ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½ä»¥è¿›ç¨‹æ–¹å¼è¿è¡Œåœ¨æ¯”æ“ä½œç³»ç»Ÿæƒé™æ›´ä½Žçš„çº§åˆ«ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä½¿å¾—è¿›ç¨‹ä¹‹é—´çš„åœ°å€ç©ºé—´ç›¸äº’éš”ç¦»ã€‚ ç¡¬ä»¶ ç¡¬ç›˜ï¼šå­˜å‚¨å•ä½ä¸ºæ‰‡åŒºï¼ˆSectorï¼‰ï¼Œä¸€ä¸ªæ‰‡åŒºæœ‰512å­—èŠ‚ï¼Œä¸€ç£é“æœ‰1024ä¸ªæ‰‡åŒºï¼Œä¸€ç›˜é¢æœ‰65536ä¸ªç£é“ï¼Œä¸€ä¸ªç›˜ç‰‡æœ‰2ä¸ªç›˜é¢ï¼Œä¸€ä¸ªç¡¬ç›˜æœ‰nä¸ªç›˜ç‰‡ã€‚æ€»å®¹é‡ä¸ºn * 2 * 65536 * 1024 * 512ã€‚æ‰‡åŒºä¸€èˆ¬ä¸æŒ‰ç¡¬ä»¶ç»†èŠ‚æè¿°ç¼–å·ï¼Œè€Œé‡‡ç”¨é€»è¾‘æ‰‡åŒºå·ï¼ˆLBA Logic Block Addressï¼‰ä»Ž0å¼€å§‹ç¼–æŽ’ï¼Œç”±ç”µå­è®¾å¤‡åœ¨å†…éƒ¨ä¸ºæˆ‘ä»¬è½¬ä¸ºç›˜é¢ã€ç£é“è¿™äº›å®žé™…çš„ä½ç½®ã€‚ I/Oç«¯å£ï¼šx86ä¸Šæœ‰65536ä¸ªç¡¬ä»¶ç«¯å£å¯„å­˜å™¨ï¼ŒCPUæä¾›äº†æŒ‡ä»¤inå’Œoutå®žçŽ°å¯¹ç¡¬ä»¶ç«¯å£çš„è¯»å’Œå†™ã€‚å¯¹ç¡¬ç›˜çš„IDEæŽ¥å£ï¼Œæœ‰IDE0å’ŒIDE1ä¸¤ä¸ªé€šé“ï¼Œæ¯ä¸ªé€šé“å¯è¿žæŽ¥2ä¸ªè®¾å¤‡ï¼ˆMasterå’ŒSlaveï¼‰ï¼ŒIDEé€šé“çš„ç«¯å£åœ°å€ä¸ºç«¯å£å¯„å­˜å™¨ä¸­é—´çš„4ä¸ªå­—èŠ‚ï¼Œæœ€å‰1ä¸ªå­—èŠ‚ä¸ºè¯»å–çš„æ‰‡åŒºæ•°ï¼Œæœ€åŽ1ä¸ªå­—èŠ‚ä¸ºæ“ä½œå‘½ä»¤ç ã€‚ å†…å­˜ï¼š ç¨‹åºç»™å‡ºçš„åœ°å€éƒ½æ˜¯ä¸€ç§è™šæ‹Ÿåœ°å€ï¼ˆVirtual Addressï¼‰ï¼Œé€šè¿‡æ˜ å°„çš„æ–¹æ³•å°†è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºå®žé™…çš„ç‰©ç†åœ°å€ã€‚ åœ°å€ç©ºé—´ï¼Œå¯ä»¥è¿™æ ·è§£é‡Šå®ƒçš„ä½œç”¨ï¼Œæƒ³è±¡æˆä¸€ä¸ªå·¨å¤§çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œè€Œè¿™ä¸ªæ•°ç»„çš„å¤§å°å°±æ˜¯ç”±åœ°å€ç©ºé—´çš„åœ°å€é•¿åº¦å†³å®šçš„ï¼Œæ¯”å¦‚32ä½ï¼ˆå³CPUæœ‰32æ¡åœ°å€çº¿ï¼‰çš„åœ°å€ç©ºé—´ä¸‹ï¼Œè¿™ä¸ªæ•°ç»„å¤§å°ä¸º2çš„32æ¬¡æ–¹ä¸ªï¼ˆå­—èŠ‚ï¼‰ï¼Œå³4294967296å­—èŠ‚=4GBï¼Œ16è¿›åˆ¶è¡¨ç¤ºä¸º0x00000000~0xFFFFFFFFã€‚ åˆ†æ®µï¼ˆSegmentationï¼‰ï¼šå°†ç¨‹åºéœ€è¦çš„å†…å­˜ç©ºé—´å¤§å°çš„è™šæ‹Ÿç©ºé—´æ˜ å°„åˆ°æŸä¸ªåœ°å€ç©ºé—´ï¼Œè¿™æ ·å¯è¾¾åˆ°åœ°å€éš”ç¦»ï¼ˆç”±ç³»ç»Ÿæ˜ å°„å‡½æ•°ä¸­åˆ¤æ–­æ˜¯å¦è¶Šè¿‡ç¨‹åºå†…å­˜åŒºçš„è®¿é—®ï¼‰å’Œåœ°å€æ˜¯ç¡®å®šè€Œæ— éœ€åœ¨æ¯æ¬¡è¿è¡Œæ—¶éƒ½é‡å®šä½ï¼Œä½†å•å•è¿™æ ·å†…å­˜çš„ä½¿ç”¨æ•ˆçŽ‡è¿˜æ˜¯è¿‡ä½Žï¼ˆåœ¨å†…å­˜ä¾›ç»™ä¸è¶³æ—¶æ•°æ®æ¢å…¥æ¢å‡ºçš„æƒ…å†µä¸‹ï¼‰ã€‚ åˆ†é¡µï¼ˆPagingï¼‰ï¼šå°†åœ°å€ç©ºé—´ç­‰åˆ†æˆå›ºå®šå¤§å°çš„é¡µï¼Œæ¯ä¸€é¡µçš„å¤§å°ç”±ç¡¬ä»¶æˆ–ç³»ç»Ÿå†³å®šã€‚æ¯ä¸€é¡µå°±æ˜¯å†…å­˜ä¸­çš„å­˜å‚¨å•ä½ï¼ˆæœ‰ç‚¹ç±»ä¼¼ç¡¬ç›˜çš„æ‰‡åŒºæ¦‚å¿µï¼‰ã€‚ç³»ç»Ÿä¼šæŠŠå¸¸ç”¨çš„æ•°æ®å’Œä»£ç é¡µè£…è½½åˆ°å†…å­˜ï¼Œä¸å¸¸ç”¨çš„ä»£ç å’Œæ•°æ®ä¿å­˜åˆ°ç£ç›˜é‡Œï¼Œéœ€è¦ç”¨åˆ°çš„æ—¶å€™ï¼Œç¡¬ä»¶ä¼šæ•èŽ·é¡µé”™è¯¯ï¼ˆPage Faultï¼‰æ¶ˆæ¯ï¼Œç”±æ“ä½œç³»ç»ŸæŽ¥ç®¡è¿›ç¨‹ï¼Œè´Ÿè´£å°†ç£ç›˜çš„æ•°æ®é¡µï¼ˆç£ç›˜é¡µï¼ŒDPï¼‰ä»Žç£ç›˜ä¸­è¯»å‡ºæ¥å¹¶è£…å…¥å†…å­˜å˜ä¸ºç‰©ç†é¡µï¼ˆPPï¼‰ï¼Œç„¶åŽè®©å…¶ä¸Žè™šæ‹Ÿé¡µï¼ˆVPï¼‰å»ºç«‹æ˜ å°„å…³ç³»ã€‚ é¡µæ˜ å°„ï¼šè™šæ‹Ÿå­˜å‚¨ä¾é ç¡¬ä»¶æ”¯æŒï¼Œç¡¬ä»¶é‡‡ç”¨MMUï¼ˆMemory Management Unitï¼Œä¸€èˆ¬é›†æˆåœ¨CPUï¼‰éƒ¨ä»¶è¿›è¡Œæ˜ å°„ï¼Œå°†CPUéœ€è®¿é—®çš„è™šæ‹Ÿåœ°å€ï¼ˆå³æˆ‘ä»¬åœ¨ç¨‹åºä¸­çœ‹åˆ°çš„åœ°å€ï¼‰è½¬æ¢ä¸ºå†…å­˜çš„å®žé™…ç‰©ç†åœ°å€ã€‚ çº¿ç¨‹ï¼š ç»„æˆï¼šç‹¬ç«‹çš„ çº¿ç¨‹IDã€å½“å‰æŒ‡ä»¤æŒ‡é’ˆï¼ˆPCï¼‰ã€å¯„å­˜å™¨é›†åˆã€å †æ ˆã€‚ï¼ˆå¤šæ ¸CPUä¸‹ï¼‰å¤šä¸ªçº¿ç¨‹ç»„æˆä¸€ä¸ªè¿›ç¨‹ã€‚ å…±äº«ï¼šç¨‹åºçš„å†…å­˜ç©ºé—´ï¼ŒåŒ…æ‹¬ä»£ç æ®µã€æ•°æ®æ®µã€å †ç­‰ã€‚ ç§æœ‰ï¼šå±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ã€çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆThread Local Storageï¼ŒTLSï¼‰æ•°æ®ã€‚ æ‰§è¡Œï¼šçº¿ç¨‹æ•°å°‘äºŽç­‰äºŽå¤„ç†å™¨æ•°æ—¶æ˜¯çœŸå¹¶å‘ï¼Œå¦åˆ™æ“ä½œç³»ç»Ÿä¼šè®©è¿è¡Œå¤šä¸ªçº¿ç¨‹çš„å¤„ç†å™¨è½®æµæ‰§è¡Œè¿™äº›çº¿ç¨‹ï¼Œè¿™æ—¶å°±éœ€è¦çº¿ç¨‹è°ƒåº¦ï¼ˆThread Scheduleï¼‰è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œä¸€èˆ¬é‡‡ç”¨é‡‡ç”¨è½®è½¬æ³•ï¼ˆRound Robinï¼‰ï¼Œé‚£çº¿ç¨‹å°±ä¼šæ‹¥æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šè¿è¡Œï¼ˆRunningï¼‰ã€å°±ç»ªï¼ˆReadyï¼‰ã€ç­‰å¾…ï¼ˆWaitingï¼‰ï¼š å½“æ—¶é—´ç‰‡ç”¨å°½æ—¶ï¼Œçº¿ç¨‹å°†è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œå¦‚æžœæ—¶é—´ç‰‡ç”¨å°½å‰çº¿ç¨‹å°±å¼€å§‹ç­‰å¾…æŸäº‹ä»¶åˆ™è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼› å½“çº¿ç¨‹ç¦»å¼€è¿è¡ŒçŠ¶æ€ï¼ˆæ— è®ºå°±ç»ªè¿˜æ˜¯ç­‰å¾…ï¼‰ï¼Œè°ƒåº¦ç³»ç»Ÿä¼šé€‰æ‹©ä¸€ä¸ªå…¶å®ƒå°±ç»ªçš„çº¿ç¨‹æ‰§è¡Œï¼› ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹æ‰€ç­‰å¾…çš„äº‹ä»¶å‘ç”ŸåŽï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥å°±ç»ªçŠ¶æ€ ä¼˜å…ˆçº§ï¼ˆPriorityï¼‰ï¼šçº¿ç¨‹éƒ½æ‹¥æœ‰å„è‡ªçš„çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œå…·æœ‰é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¼šæ›´æ—©åœ°æ‰§è¡Œï¼Œè€Œä½Žä¼˜å…ˆçº§çš„çº¿ç¨‹å¸¸è¦ç­‰å¾…åˆ°ç³»ç»Ÿä¸­å·²ç»æ²¡æœ‰é«˜ä¼˜å…ˆçº§çš„å¯æ‰§è¡Œçš„çº¿ç¨‹å­˜åœ¨æ—¶æ‰èƒ½æ‰§è¡Œã€‚I/Oå¯†é›†åž‹çº¿ç¨‹ï¼ˆI/O Bound Threadï¼‰æ¯”CPUå¯†é›†åž‹çº¿ç¨‹ï¼ˆCPU Bound Threadï¼‰æ›´å®¹æ˜“å¾—åˆ°ä¼˜å…ˆçº§çš„æå‡ï¼ˆå› å…¶é¢‘ç¹è¿›å…¥ç­‰å¾…è€Œé‡Šæ”¾CPUï¼‰ã€‚æ”¹å˜ä¼˜å…ˆçº§ï¼š ç”¨æˆ·æŒ‡å®šï¼› æ ¹æ®è¿›å…¥ç­‰å¾…çŠ¶æ€çš„é¢‘ç¹ç¨‹åº¦æå‡æˆ–é™ä½Žä¼˜å…ˆçº§ï¼› é•¿æ—¶é—´å¾—ä¸åˆ°æ‰§è¡Œè€Œè¢«æå‡ä¼˜å…ˆçº§ï¼Œé¿å…å› å­˜åœ¨é«˜ä¼˜å…ˆçº§çš„CPUå¯†é›†åž‹çº¿ç¨‹å¯¼è‡´çš„é¥¿æ­»ï¼ˆStarvationï¼‰ã€‚ å®‰å…¨ï¼šç¨‹åºä»£ç ç¼–è¯‘ä¸ºæ±‡ç¼–ä»£ç ä¹‹åŽï¼ŒåŽŸæœ¬ä¸€è¡Œçš„ä»£ç æŒ‡ä»¤å¯èƒ½ç”±ä¸æ­¢ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ç»„æˆï¼Œå› æ­¤åœ¨æ‰§è¡Œäº†ä¸€åŠè¢«è°ƒåº¦ç³»ç»Ÿæ‰“æ–­åŽ»æ‰§è¡Œåˆ«çš„ä»£ç åŽï¼Œä»Žè€Œä½¿ç»“æžœå¯èƒ½å‡ºçŽ°æ„æƒ³ä¸åˆ°çš„ç»“æžœã€‚æ‰€ä»¥éœ€è¦ä¸€äº›æŽªæ–½é¿å…è¿™ç§è¢«æ‰“æ–­å¯¼è‡´çš„å‡ºé”™ï¼š åŽŸå­æ€§ï¼ˆAtomicï¼‰ï¼šæ„ä¸ºå•æŒ‡ä»¤å®Œæˆçš„æ“ä½œï¼› åŒæ­¥é”ï¼ˆSynchrominzation Lockï¼‰ï¼šåŒæ­¥æŒ‡åœ¨ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ•°æ®æœªç»“æŸçš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹ä¸å¾—å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œè®¿é—®ï¼›é”åˆ™æ˜¯åŒæ­¥çš„ä¸€ç§æ–¹æ³•ï¼Œéžå¼ºåˆ¶ä½¿ç”¨ï¼Œå½“æ¯ä¸€ä¸ªçº¿ç¨‹åœ¨è®¿é—®æ•°æ®æˆ–èµ„æºå‰å…ˆè¯•å›¾èŽ·å–é”ï¼Œå¹¶åœ¨è®¿é—®ç»“æŸåŽé‡Šæ”¾é”ï¼Œåœ¨é”å·²ç»è¢«å ç”¨çš„æ—¶å€™è¯•å›¾èŽ·å–é”æ—¶çº¿ç¨‹ä¼šç­‰å¾…ï¼ˆè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼‰ï¼Œç›´åˆ°é”é‡æ–°å¯ç”¨ï¼ˆè¿›å…¥è¿è¡ŒçŠ¶æ€ï¼‰ã€‚ç±»åž‹æœ‰ï¼š äºŒå…ƒä¿¡å·é‡ï¼ˆBinary Semaphoreï¼‰ å¤šå…ƒä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šèŽ·å–ä¿¡å·é‡æ—¶ä¿¡å·é‡å‡1ï¼Œä¿¡å·é‡å°‘äºŽ0åˆ™è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œé‡Šæ”¾ä¿¡å·é‡æ—¶ä¿¡å·é‡åŠ 1ï¼Œä¿¡å·é‡å°‘äºŽ1åˆ™å”¤é†’ä¸€ä¸ªç­‰å¾…ä¸­çš„çº¿ç¨‹ã€‚ äº’æ–¥é‡ï¼ˆMutexï¼‰ï¼šå’ŒSemaphoreç›¸ä¼¼ï¼Œä½†åªèƒ½å“ªä¸ªçº¿ç¨‹èŽ·å–çš„å°±å“ªä¸ªçº¿ç¨‹è´Ÿè´£é‡Šæ”¾ï¼› ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ï¼šå’ŒMutexç›¸ä¼¼ï¼Œä½†æ›´è¿›ä¸€æ­¥ä¸¥æ ¼ï¼Œä½œç”¨èŒƒå›´å±€é™åˆ°æœ¬è¿›ç¨‹å†…ï¼› è¯»å†™é” æ¡ä»¶å˜é‡ é˜²æ­¢è¿‡åº¦ä¼˜åŒ–ï¼šç”±äºŽç¼–è¯‘å™¨å¯èƒ½ä¼šä¸ºæé«˜è®¿é—®é€Ÿåº¦ã€æ‰§è¡Œæ•ˆçŽ‡ï¼Œå¯¹å¯„å­˜å™¨ã€æŒ‡ä»¤ç­‰çš„æ“ä½œè¿›è¡Œå¹²é¢„ï¼Œä½¿ç”¨å…³é”®å­—volatileå¯ä»¥è¯•å›¾é˜»æ­¢è¿‡åº¦ä¼˜åŒ–ï¼Œè§£å†³ï¼š é˜»æ­¢ç¼–è¯‘å™¨ä¸ºäº†æé«˜é€Ÿåº¦å°†ä¸€ä¸ªå˜é‡ç¼“å­˜åˆ°å¯„å­˜å™¨å†…è€Œä¸å†™å›žï¼› é˜»æ­¢ç¼–è¯‘å™¨è°ƒæ•´æ“ä½œvolatileå˜é‡çš„æŒ‡ä»¤é¡ºåºï¼›ï¼ˆä½†CPUåŠ¨æ€è°ƒåº¦æ¢åºè¿˜å¯èƒ½å­˜åœ¨ï¼Œå¯å†é€šè¿‡CPUæä¾›çš„barrieræŒ‡ä»¤ï¼Œå¦‚lwsyncï¼Œæ¥åšä¸€ä¸ªé˜»æ­¢æŒ‡ä»¤è¢«è°ƒåº¦äº¤æ¢çš„åˆ†æ°´å²­ï¼‰ ç”¨æˆ·æ€ï¼šå†…æ ¸ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œæœ‰å¯èƒ½å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ€çš„çº¿ç¨‹ã€‚ åœ¨1å¯¹1æ¨¡åž‹ä¸‹çº¿ç¨‹ä¹‹é—´æ˜¯çœŸæ­£çš„å¹¶å‘ï¼Œä¸€ä¸ªçº¿ç¨‹é˜»å¡žæ—¶å…¶å®ƒçº¿ç¨‹ä¸å—å½±å“ã€‚ä½†ç”¨æˆ·çš„çº¿ç¨‹æ•°é‡ä¼šå—åˆ°é™åˆ¶ï¼ˆæœ€å¤šåªèƒ½ç­‰åŒäºŽCPUæ•°ï¼‰ã€‚ å¤šå¯¹1æ¨¡åž‹ä¸‹ï¼Œæ˜¾è€Œæ˜“è§çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹é˜»å¡žä¼šå¯¼è‡´è¯¥å†…æ ¸ä¸­çš„å…¶å®ƒç”¨æˆ·æ€çº¿ç¨‹é˜»å¡žã€‚ä½†å®ƒå…·æœ‰é«˜æ•ˆçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œæ— é™åˆ¶çš„çº¿ç¨‹æ•°ã€‚ å¤šå¯¹å¤šæ¨¡åž‹ é™æ€é“¾æŽ¥ç¼–è¯‘å’Œé“¾æŽ¥GCCç¼–è¯‘è¿‡ç¨‹ = é¢„å¤„ç†ï¼ˆPrepressingï¼‰ + ç¼–è¯‘ï¼ˆCompilationï¼‰ + æ±‡ç¼–ï¼ˆAssemblyï¼‰ + é“¾æŽ¥ï¼ˆLinkingï¼‰ ã€å›¾ã€‘GCCç¼–è¯‘è¿‡ç¨‹åˆ†è§£å›¾ ç¼–è¯‘å™¨å°±æ˜¯å°†é«˜çº§è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„ä¸€ä¸ªå·¥å…· ã€å›¾ã€‘ç¼–è¯‘è¿‡ç¨‹å›¾ é¢„ç¼–è¯‘ä¸»è¦å¤„ç†æºä»£ç æ–‡ä»¶ä¸­ä»¥â€œ#â€å¼€å§‹çš„é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œæ¯”å¦‚#includeã€#defineã€#ifã€#ifdefç­‰ã€‚ å¤„ç†çš„æ–‡ä»¶åŒ…æ‹¬.c å’Œ .hæ–‡ä»¶ã€‚ï¼ˆå¦‚æžœæ˜¯å…¶å®ƒåŸºäºŽCæ‰©å±•çš„è¯­è¨€ çš„ç¼–è¯‘å™¨ï¼Œå¯èƒ½è¿˜ä¼šå¤„ç†.m .mmç­‰æ–‡ä»¶ï¼‰ï¼Œç”Ÿæˆ.iæ–‡ä»¶ã€‚ #-Eè¡¨ç¤ºåªè¿›è¡Œé¢„ç¼–è¯‘ $gcc -E hello.c -o hello.i å¤„ç†æ­¥éª¤ï¼š åˆ é™¤#defineï¼Œå¹¶å±•å¼€å®å®šä¹‰ å¤„ç†æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ å¤„ç†å¯¼å…¥é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶é€’å½’æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½® åˆ é™¤æ³¨é‡Š æ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†ï¼Œæ¯”å¦‚ #2 â€œhello.câ€ 2ï¼ˆä¾¿äºŽè°ƒè¯•ï¼‰ ä¿ç•™ç¼–è¯‘å™¨éœ€è¦çš„#pragmaç¼–è¯‘æŒ‡ä»¤ ç¼–è¯‘è¿›è¡Œä¸€ç³»åˆ—è¯æ³•åˆ†æžã€è¯­æ³•åˆ†æžã€è¯­ä¹‰åˆ†æžã€ä¼˜åŒ–åŽäº§ç”Ÿç›¸åº”çš„æ±‡ç¼–ä»£ç æ–‡ä»¶ã€‚ $gcc -S hello.i -o hello.s è¯æ³•åˆ†æžï¼šæºä»£ç è¢«è¾“å…¥åˆ°æ‰«æå™¨ï¼ˆScannerï¼‰ï¼Œç”¨æœ‰é™çŠ¶æ€æœºï¼ˆFinite State Machineï¼‰å°†æºä»£ç çš„å­—ç¬¦åˆ†å‰²æˆä¸€ç³»åˆ—è®°å·ï¼ˆTokenï¼‰ï¼Œå¦‚å…³é”®å­—ï¼ˆç³»ç»Ÿå®šä¹‰ï¼‰ã€æ ‡è¯†ç¬¦ï¼ˆå˜é‡åï¼‰ã€å­—é¢é‡ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ï¼‰ã€ç‰¹æ®Šç¬¦å·ï¼ˆåŠ å·ã€ç­‰å·ã€æ‹¬å·ï¼‰ã€‚æ ‡è¯†ç¬¦æ”¾å…¥åˆ°ç¬¦å·è¡¨ï¼Œæ•°å­—å­—ç¬¦ä¸²æ”¾å…¥åˆ°æ–‡å­—è¡¨ã€‚lexå·¥å…·ç¨‹åºå¯ä»¥å¸®åŠ©å®Œæˆæ­¤é¡¹å·¥ä½œã€‚ è¯­æ³•åˆ†æžï¼šç”±è¯­æ³•åˆ†æžå™¨ï¼ˆGrammar Parserï¼‰ï¼Œé‡‡ç”¨ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•ï¼ˆContext-free Grammarï¼‰çš„åˆ†æžæ‰‹æ®µï¼Œå¯¹è®°å·è¿›è¡Œåˆ†æžä»Žè€Œäº§ç”Ÿè¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰ã€‚è¯­æ³•æ ‘å°±æ˜¯ä»¥è¡¨è¾¾å¼ä¸ºèŠ‚ç‚¹çš„æ ‘ã€‚yaccå·¥å…·ç¨‹åºå¯ä»¥å¸®åŠ©å®Œæˆæ­¤é¡¹å·¥ä½œã€‚ è¯­ä¹‰åˆ†æžï¼šç”±è¯­ä¹‰åˆ†æžå™¨ï¼ˆSemantic Analyzerï¼‰å®Œæˆå¯¹è¡¨è¾¾å¼çš„è¯­æ³•å±‚é¢åˆ†æžï¼Œåˆ†ä¸ºé™æ€è¯­ä¹‰å’ŒåŠ¨æ€è¯­ä¹‰ï¼š é™æ€è¯­ä¹‰åŒ…æ‹¬å£°æ˜Žå’Œç±»åž‹çš„åŒ¹é…ã€ç±»åž‹çš„è½¬æ¢ï¼ˆä¸€èˆ¬æ˜¯éšå«æ€§çš„ï¼‰ åŠ¨æ€è¯­ä¹‰æŒ‡è¿è¡Œæ—¶æœŸå‡ºçŽ°çš„è¯­ä¹‰ç›¸å…³é—®é¢˜ï¼ˆæ¯”å¦‚0ä½œä¸ºé™¤æ•°ï¼‰ æœ€åŽæ•´ä¸ªè¯­æ³•æ ‘çš„è¡¨è¾¾å¼éƒ½è¢«æ ‡è¯†äº†ç±»åž‹ï¼ˆå¦‚éœ€åšéšå¼è½¬æ¢ï¼Œè¯­ä¹‰åˆ†æžç¨‹åºä¼šåœ¨è¯­æ³•æ ‘ç§æ’å…¥ç›¸åº”çš„è½¬æ¢èŠ‚ç‚¹ï¼‰ ä¸­é—´è¯­è¨€ç”Ÿæˆï¼š ä¸­é—´ä»£ç ï¼ˆIntermediate Codeï¼‰ï¼šæºç çº§ä¼˜åŒ–å™¨ï¼ˆSource Code Optimizerï¼‰å¯¹åœ¨ç¼–è¯‘æœŸå¯è¢«ç¡®å®šå€¼çš„è¡¨è¾¾å¼ç­‰çš„æƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œå°†æ•´ä¸ªè¯­æ³•æ ‘è½¬æ¢æˆä¸­é—´ä»£ç ï¼Œå…¶å®žå°±æ˜¯è¯­æ³•æ ‘ç»ä¼˜åŒ–åŽçš„é¡ºåºè¡¨ç¤ºã€‚ å†…å®¹ï¼šè·Ÿç›®æ ‡æœºå™¨å’Œè¿è¡Œæ—¶çŽ¯å¢ƒæ— å…³ï¼Œåƒä¸åŒ…å«æ•°æ®çš„å°ºå¯¸ã€å˜é‡åœ°å€ã€å¯„å­˜å™¨åç­‰ã€‚è€Œä»£ç çš„å½¢å¼ç±»åž‹ä¸€èˆ¬å¸¸è§çš„æœ‰ä¸‰å€ç ã€Pä»£ç ã€‚ æ„ä¹‰ï¼šä½¿å¾—ç¼–è¯‘å™¨å¯ä»¥è¢«åˆ†ä¸ºå‰ç«¯å’ŒåŽç«¯ï¼Œå‰ç«¯è´Ÿè´£äº§ç”Ÿæœºå™¨æ— å…³çš„ä¸­é—´ä»£ç ï¼ŒåŽç«¯è´Ÿè´£å°†ä¸­é—´ç è½¬æ¢ä¸ºç›®æ ‡æœºå™¨ç ã€‚ï¼ˆæœ‰å¼€å‘è€…é€šè¿‡ä¿®æ”¹ç¼–è¯‘å™¨æˆ–å¢žåŠ æ’ä»¶å®žçŽ°äº†å¯¹IRå±‚ä»£ç çš„æ··æ·†ï¼Œæ¯”æ··æ·†æºç æˆ–æœºå™¨ç æ¥å¾—ç®€å•æ–¹ä¾¿ï¼‰ æ±‡ç¼–å°†æ±‡ç¼–ä»£ç è½¬å˜æˆæœºå™¨å¯æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œæ¯ä¸€ä¸ªæ±‡ç¼–è¯­å¥å‡ ä¹Žéƒ½å¯¹åº”ä¸€æ¡æœºå™¨æŒ‡ä»¤ï¼Œç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆObject Fileï¼‰.o æˆ– .objã€‚ $as hello.s -o hello.o $gcc -c hello.s -o hello.o $gcc -c hello.c -o hello.o ä»£ç ç”Ÿæˆå™¨ï¼ˆCode Generatorï¼‰å’Œç›®æ ‡ä»£ç ä¼˜åŒ–å™¨ï¼ˆTarget Code Optimizerï¼‰ä¾æ®ä¸åŒçš„å­—é•¿ã€å¯„å­˜å™¨ã€æ•´æ•°æ•°æ®ç±»åž‹ã€æµ®ç‚¹æ•°æ•°æ®ç±»åž‹ç­‰å·¥ä½œï¼Œå°†ä¸­é—´ç ç”Ÿæˆç”¨æ±‡ç¼–è¯­è¨€è¡¨ç¤ºçš„ç›®æ ‡æŒ‡ä»¤ä»£ç ï¼Œç„¶åŽè¿›è¡Œæœºå™¨ä»£ç çº§åˆ«çš„ä¼˜åŒ–ï¼Œæœ€åŽç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚ é“¾æŽ¥å¤„ç†.oæ–‡ä»¶å’Œåº“.aï¼ˆåº“æ˜¯åŠ äº†ç´¢å¼•çš„ä¸€ç»„ç›®æ ‡æ–‡ä»¶çš„åŒ…ï¼‰ï¼Œæœ€ç»ˆç”Ÿæˆ.outæ–‡ä»¶ $ld -static crt1.o crti.o crtbeginT.o hello.o -start-group -lgcc -lgcc_eh -lc -end-group crtend.o crtn.o é‡å®šä½ï¼ˆRelocationï¼‰ï¼šé‡æ–°è®¡ç®—å„ä¸ªç›®æ ‡åœ°å€çš„è¿‡ç¨‹ æ±‡ç¼–è¯­è¨€çš„ç¬¦å·ï¼ˆSymbolï¼‰ï¼šä½¿ç”¨ç¬¦å·å’Œæ ‡è®°ï¼Œå¦‚jmpä»£è¡¨ä¸€æ¡8ä½ï¼ˆ1å­—èŠ‚ï¼‰æŒ‡ä»¤çš„é«˜å››ä½çš„å«ä¹‰ï¼Œå¦‚divideä»£è¡¨ä¸€ä¸ªç¨‹åºçš„èµ·å§‹ä½ç½®ã€‚ æ¨¡å—ï¼š ä¸ºæ–¹ä¾¿å¼€å‘ã€ç¼–è¯‘ã€æµ‹è¯•ã€é‡ç”¨ã€é˜…è¯»ã€ç†è§£ï¼Œæ¯ä¸ªç±»æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ¨¡å—ï¼Œè‹¥å¹²ä¸ªç±»æ¨¡å—ç»„æˆä¸€ä¸ªåŒ…ï¼Œè‹¥å¹²ä¸ªåŒ…ç»„æˆä¸€ä¸ªç¨‹åºã€‚æ¨¡å—é—´ä»¥ç¬¦å·å¼•ç”¨æ¥é€šä¿¡ã€‚ æ¯ä¸ªæ¨¡å—éƒ½æ˜¯å•ç‹¬ç¼–è¯‘çš„ï¼Œå®ƒä¼šæš‚æ—¶æŠŠä¸çŸ¥é“åœ°å€çš„å‡½æ•°æˆ–å˜é‡çš„ç›®æ ‡åœ°å€æç½®ï¼ˆç½®0ï¼‰ï¼Œç­‰åˆ°æœ€åŽé“¾æŽ¥æ—¶ç”±é“¾æŽ¥å™¨åŽ»ä¿®æ­£è¿™äº›æŒ‡ä»¤çš„ç›®æ ‡åœ°å€ã€‚æ¯ä¸ªè¦è¢«ä¿®æ­£çš„åœ°æ–¹å«ä¸€ä¸ªé‡å®šä½å…¥å£ï¼ˆRelocation Entryï¼‰ã€‚ é“¾æŽ¥ï¼šè´Ÿè´£å°†æ¨¡å—æ‹¼æŽ¥èµ·æ¥ï¼ŒæŠŠå„ä¸ªæ¨¡å—ä¹‹é—´çš„ç›¸äº’å¼•ç”¨çš„éƒ¨åˆ†éƒ½å¤„ç†å¥½ï¼Œèƒ½æ­£ç¡®åœ°è¡”æŽ¥ï¼ˆå…¶å®žå°±æ˜¯æŠŠä¸€äº›æŒ‡ä»¤å¯¹å…¶å®ƒç¬¦å·åœ°å€çš„å¼•ç”¨åŠ ä»¥ä¿®æ­£ï¼‰ï¼Œäº§ç”Ÿå¯æ‰§è¡Œçš„ç¨‹åºã€‚ åœ°å€å’Œç©ºé—´åˆ†é…ï¼ˆAddress and Storage Allocationï¼‰ ç¬¦å·å†³è®®ï¼ˆSymbol Resolutionï¼‰ï¼Œåˆå«ç¬¦å·ç»‘å®šã€åç§°ç»‘å®šã€‚ é‡å®šä½ ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼ç›®æ ‡æ–‡ä»¶ï¼šæºä»£ç ç¼–è¯‘åŽä½†æœªè¿›è¡Œé“¾æŽ¥çš„ä¸­é—´æ–‡ä»¶ï¼ˆæ˜¯ç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œåªæ˜¯è¿˜æ²¡ç»è¿‡é“¾æŽ¥è¿‡ç¨‹ï¼Œå¯èƒ½æœ‰äº›å¯Œè±ªæˆ–åœ°å€è¿˜æ²¡è¢«è°ƒæ•´ï¼‰ã€‚ åŸºäºŽCOFFï¼ˆCommon file formatï¼‰çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼š Windowsï¼šPEï¼ˆPortable Executableï¼‰ ç›®æ ‡æ–‡ä»¶ï¼š.obj åŠ¨æ€é“¾æŽ¥åº“(DLL,Dynamic Linking Library)ï¼š.dll é™æ€é“¾æŽ¥åº“(Static Linking Library)ï¼š.lib Linuxï¼šELFï¼ˆExecutable Linkable Formatï¼‰ ç›®æ ‡æ–‡ä»¶ï¼š.o åŠ¨æ€é“¾æŽ¥åº“ï¼š.so é™æ€é“¾æŽ¥åº“ï¼š.a é™æ€é“¾æŽ¥åº“æ˜¯æŠŠå¾ˆå¤šç›®æ ‡æ–‡ä»¶åŠ ä¸Šç´¢å¼•åŽæ†ç»‘åœ¨ä¸€èµ·å½¢æˆçš„ä¸€ä¸ªæ–‡ä»¶åŒ…ã€‚ æ–‡ä»¶å½’ç±»ï¼š å¯é‡å®šä½æ–‡ä»¶ï¼šåŒ…å«ä»£ç å’Œæ•°æ®ï¼Œå¯è¢«ç”¨æ¥é“¾æŽ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–å…±äº«ç›®æ ‡æ–‡ä»¶ï¼ˆå¦‚.o .a .obj .libï¼‰ å¯æ‰§è¡Œæ–‡ä»¶ï¼šåŒ…å¯ç›´æŽ¥æ‰§è¡Œçš„ç¨‹åºï¼Œæ²¡æœ‰æ‰©å±•åï¼ˆå¦‚bin/bash .exeï¼‰ å…±äº«ç›®æ ‡æ–‡ä»¶ï¼ˆ.so .dllï¼‰ï¼š è¿žæŽ¥å™¨å°†å…¶ä¸Žå…¶ä»–å¯é‡å®šä½æ–‡ä»¶å’Œå…±äº«ç›®æ ‡æ–‡ä»¶é“¾æŽ¥ï¼Œäº§ç”Ÿæ–°çš„ç›®æ ‡æ–‡ä»¶ åŠ¨æ€é“¾æŽ¥å™¨å°†nä¸ªå…±äº«ç›®æ ‡æ–‡ä»¶ä¸Žå¯æ‰§è¡Œæ–‡ä»¶ç»“åˆï¼Œä½œä¸ºè¿›ç¨‹æ˜ åƒçš„ä¸€éƒ¨åˆ†æ¥è¿è¡Œ æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ï¼ˆcore dumpï¼‰ æŸ¥çœ‹æ–‡ä»¶æ ¼å¼çš„æŒ‡ä»¤ $ file foobar.o ç›®æ ‡æ–‡ä»¶çš„ç»“æž„åˆ†æ®µåˆ†æ®µçš„å¥½å¤„ï¼š æ•°æ®ä¸ŽæŒ‡ä»¤åˆ†åˆ«æ˜ å°„åˆ°ä¸¤ä¸ªè™šå­˜åŒºåŸŸï¼Œé˜²æ­¢æŒ‡ä»¤åœ°å€è¢«æ”¹å†™ï¼› åˆ†ç¦»æ•°æ®ç¼“å­˜å’ŒæŒ‡ä»¤ç¼“å­˜ï¼Œæé«˜CPUç¼“å­˜å‘½ä¸­çŽ‡ï¼› è¿è¡Œå¤šä¸ªç¨‹åºå‰¯æœ¬æ—¶ï¼Œå…±äº«æŒ‡ä»¤ï¼ˆæ•°æ®åŒºåŸŸåˆ™æ˜¯è¿›ç¨‹ç§æœ‰ï¼‰ æ–‡ä»¶å¤´ï¼šæè¿°æ•´ä¸ªæ–‡ä»¶çš„å±žæ€§ï¼Œæ¯”å¦‚æ˜¯å¦å¯æ‰§è¡Œã€æ˜¯å¦é™æ€é“¾æŽ¥è¿˜åŠ¨æ€é“¾æŽ¥ã€å…¥å£åœ°å€ã€ç›®æ ‡ç¡¬ä»¶ã€ç›®æ ‡æ“ä½œç³»ç»Ÿã€æ®µè¡¨ç­‰ã€‚æ®µè¡¨ï¼šæè¿°æ–‡ä»¶ä¸­å„ä¸ªæ®µçš„æ•°ç»„ã€‚ å­˜å‚¨å•ä½ï¼šæ®µ/èŠ‚ï¼ˆSectionï¼‰ï¼Œç³»ç»Ÿä¿ç•™çš„æ®µé‡‡ç”¨â€œ.â€ä½œä¸ºå‰ç¼€ï¼Œå› ä¸ºå¯ä»¥æ‹¥æœ‰åŒåæ®µï¼Œæ‰€ä»¥è‡ªå®šä¹‰çš„æ®µä¸èƒ½ä½¿ç”¨â€œ.â€ä½œä¸ºå‰ç¼€ï¼Œé¿å…ä¸Žç³»ç»Ÿæ®µå†²çªã€‚ ä»£ç æ®µï¼šå­˜æ”¾ç¨‹åºæºä»£ç ç¼–è¯‘åŽçš„æœºå™¨æŒ‡ä»¤ï¼ˆå¸¸ç”¨æ®µåä¸º.code .textï¼‰ æ•°æ®æ®µï¼šå­˜æ”¾å·²ç»åˆå§‹åŒ–è¿‡çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡æ•°æ®ï¼ˆå¸¸ç”¨æ®µåä¸º.dataï¼‰ .bssæ®µï¼šå­˜æ”¾æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ï¼Œæä¾›é¢„ç•™ä½ç½® .rodataæ®µï¼šå­˜æ”¾åªè¯»æ•°æ®ï¼ˆconstå’Œå­—ç¬¦ä¸²å¸¸é‡ï¼Œæœ‰æ—¶åä¸º.rodata1ï¼‰ .debugæ®µï¼šè°ƒè¯•ä¿¡æ¯ .lineæ®µï¼šè°ƒè¯•æ—¶æ®µè¡Œå·è¡¨ .noteæ®µï¼šé¢å¤–çš„ç¼–è¯‘å™¨ä¿¡æ¯ .commentæ®µï¼šç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯ .dynamicæ®µï¼šåŠ¨æ€é“¾æŽ¥ä¿¡æ¯ .hashæ®µï¼šç¬¦å·å“ˆå¸Œè¡¨ .strtabæ®µï¼šå­—ç¬¦ä¸²è¡¨ï¼Œå­˜å‚¨ELFæ–‡ä»¶ä¸­ç”¨åˆ°çš„å„ç§å­—ç¬¦ä¸² .symtabæ®µï¼šç¬¦å·è¡¨ .shstrtabæ®µï¼šæ®µåè¡¨ .plt .gotï¼šåŠ¨æ€é“¾æŽ¥çš„è·³è½¬è¡¨å’Œå…¨å±€å…¥å£è¡¨ .init .finiï¼šç¨‹åºåˆå§‹åŒ–ä¸Žç»ˆç»“ä»£ç æ®µ è‡ªå®šä¹‰æ®µï¼šç¤ºä¾‹ __attribute((section(&quot;FOO&quot;))) int global = 42; __attribute((section(&quot;BAR&quot;))) void foo() &#123;&#125; åœ°å€é¡ºåºï¼šæ–‡ä»¶å¤´å¼€å§‹äºŽ0x00000000ï¼Œå¾€ä¸Šå åŠ ï¼Œæ¯æ®µçš„èµ·å§‹åœ°å€ä¸ºè‡ªèº«åç§»ï¼ˆFile offsetï¼Œæ®µåç§»ä¸ºç´¯è®¡å·²å åŠ æ®µçš„é•¿åº¦æ€»å’Œ+æ–‡ä»¶å¤´é•¿åº¦ï¼‰ï¼Œé€šè¿‡ä»¥ä¸‹æŒ‡ä»¤æŸ¥çœ‹æ–‡ä»¶ç»“æž„ä¿¡æ¯ï¼š $ gcc -c xx.c #ç¼–è¯‘æ–‡ä»¶ï¼Œ-cåªç¼–è¯‘ä¸é“¾æŽ¥ $ objdump -h xx.o #æŸ¥çœ‹objectæ–‡ä»¶å†…å®¹ï¼Œ-hæ‰“å°å„æ®µåŸºæœ¬ä¿¡æ¯ï¼Œ-xå¯æ‰“å°æ›´å¤šä¿¡æ¯ $ objdump -s -d xx.o #-sä»¥åå…­åˆ¶å½¢å¼æ‰“å°ï¼Œ-då°†æŒ‡ä»¤æ®µåæ±‡ç¼– $ size xx.o #æŸ¥çœ‹ELFæ–‡ä»¶å„æ®µé•¿åº¦ è¿˜å¯ä»¥å°†åª’ä½“æ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ®µ $objcopy -I binary -O elf32-i386 -B i386 image.jpg image.o $objdump -ht image.o æ–‡ä»¶å¤´æ–‡ä»¶å¤´ä¿¡æ¯å¯¹åº”æ–‡ä»¶å¤´ç»“æž„Elf32_Ehdrå…³ç³»ï¼š ELFé­”æ•°ï¼ˆMagicï¼‰ï¼šå±že_identå­—æ®µ æ–‡ä»¶æœºå™¨å­—èŠ‚é•¿åº¦(Class)ï¼šå±že_identå­—æ®µï¼Œä½†ä»ŽMagicä¸­èŽ·å– æ•°æ®å­˜å‚¨æ–¹å¼(Data)ï¼šå±že_identå­—æ®µï¼Œä½†ä»ŽMagicä¸­èŽ·å– ç‰ˆæœ¬(Version)ï¼šå±že_identå­—æ®µï¼Œä½†ä»ŽMagicä¸­èŽ·å– è¿è¡Œå¹³å°(OS/ABI)ï¼šå±že_identå­—æ®µï¼Œä½†ä»ŽMagicä¸­èŽ·å– ABIç‰ˆæœ¬(ABI Version)ï¼šå±že_identå­—æ®µï¼Œä½†ä»ŽMagicä¸­èŽ·å– ELFé‡å®šä½ç±»åž‹(Type)ï¼šå±že_typeï¼ŒELFæ–‡ä»¶ç±»åž‹ï¼ˆ1-ET_RELå¯é‡å®šä½æ–‡ä»¶.o,2-ET_EXECå¯æ‰§è¡Œæ–‡ä»¶,3-ET_DYNå…±äº«ç›®æ ‡æ–‡ä»¶.soï¼‰ ç¡¬ä»¶å¹³å°(Machine)ï¼šå±že_machineï¼ŒCPUçš„å¹³å°å±žæ€§ ç¡¬ä»¶å¹³å°ç‰ˆæœ¬(Version)ï¼šå±že_versionï¼Œä¸€èˆ¬ä¸ºå¸¸æ•°1 å…¥å£åœ°å€(Entry point address)ï¼šå±že_entryï¼Œè§„å®šELFç¨‹åºçš„å…¥å£è™šæ‹Ÿåœ°å€ï¼Œæ“ä½œç³»ç»Ÿåœ¨åŠ è½½å®Œè¯¥ç¨‹åºåŽä»Žè¿™ä¸ªåœ°å€å¼€å§‹æ‰§è¡Œè¿›ç¨‹çš„æŒ‡ä»¤ï¼ˆå¯é‡å®šä½æ–‡ä»¶ä¸€èˆ¬æ²¡æœ‰å…¥å£åœ°å€ï¼Œåˆ™æ­¤å€¼ä¸º0ï¼‰ ç¨‹åºå¤´å…¥å£å’Œé•¿åº¦(Start of program headers)ï¼šå±že_phoff æ®µè¡¨çš„ä½ç½®å’Œé•¿åº¦(Start of section headers)ï¼šå±že_shoffï¼Œæ®µè¡¨åœ¨æ–‡ä»¶ä¸­çš„åç§» æ®µæ•°é‡ï¼šå±že_shnum (FLAGS)ï¼še_wordï¼ŒELFæ ‡å¿—ä½ï¼Œæ ‡è¯†ä¸€äº›EFLæ–‡ä»¶å¹³å°ç›¸å…³çš„å±žæ€§ ï¼še_ehsizeï¼Œæ–‡ä»¶å¤´æœ¬èº«å¤§å° ï¼še_phentsizeï¼Œç¨‹åºå¤´æè¿°ç¬¦å¤§å­¦ ï¼še_phnumï¼Œç¨‹åºå¤´æè¿°ç¬¦æ•°é‡ ï¼še_shentsizeï¼Œæ®µè¡¨æè¿°ç¬¦å¤§å° ï¼še_shstrndexï¼Œæ®µè¡¨å­—ç¬¦ä¸²è¡¨æ‰€åœ¨çš„æ®µåœ¨æ®µè¡¨ä¸­çš„ä¸‹æ ‡ æŸ¥çœ‹å¤´æ–‡ä»¶ä¿¡æ¯æŒ‡ä»¤ä¸º $ readelf -h SimpleSection.o #-hè¡¨ç¤ºåªæ˜¾ç¤º æ®µè¡¨ï¼ˆSection Header Tableï¼‰ç”¨äºŽä¿å­˜ELFæ–‡ä»¶ä¸­å„ç§æ®µçš„åŸºæœ¬å±žæ€§ï¼Œæ¯”å¦‚æ¯ä¸ªæ®µçš„æ®µåã€æ®µçš„é•¿åº¦ã€åœ¨æ–‡ä»¶ä¸­çš„åç§»ã€è¯»å†™æƒé™ã€ç­‰ç­‰å…¶ä»–å±žæ€§ã€‚æ˜¯ä»¥Elf32_Shdrç»“æž„ä½“ï¼ˆç§°ä¸ºæ®µæè¿°ç¬¦ï¼ŒSection Descriptorï¼‰ä¸ºå…ƒç´ çš„æ•°ç»„ï¼Œç»“æž„ä½“æˆå‘˜å¦‚ä¸‹ï¼š sh_nameï¼šæ®µåï¼Œä½äºŽâ€.shstrtabâ€œçš„å­—ç¬¦ä¸²è¡¨ä¸­ï¼Œsh_nameæ˜¯æ®µåå­—ç¬¦ä¸²åœ¨â€.shstrtabâ€œä¸­çš„åç§»ï¼› sh_typeï¼šæ®µç±»åž‹ï¼Œå¸¸é‡ä»¥SHT_å¼€å¤´ï¼ŒåŒ…æ‹¬ç¨‹åºæ®µã€å­—ç¬¦ä¸²è¡¨ã€ç¬¦å·è¡¨ã€é‡å®šä½è¡¨ã€å“ˆå¸Œè¡¨ã€åŠ¨æ€é“¾æŽ¥ä¿¡æ¯ã€æç¤ºæ€§ä¿¡æ¯ã€æ²¡å†…å®¹ã€é‡å®šä½ä¿¡æ¯ã€ä¿ç•™ã€åŠ¨æ€é“¾æŽ¥ç¬¦å·è¡¨ã€æ— æ•ˆï¼› sh_flagsï¼šæ®µæ ‡å¿—ä½ï¼Œè¡¨ç¤ºæ®µåœ¨è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„å±žæ€§ï¼Œæ¯”å¦‚å¯å†™ã€é¡»åˆ†é…ç©ºé—´ã€å¯æ‰§è¡Œï¼› sh_addrï¼šæ®µè™šæ‹Ÿåœ°å€ï¼Œå¦‚æžœæ®µå¯è¢«åŠ è½½æ—¶ï¼Œsh_addrä¸ºè¯¥æ®µè¢«åŠ è½½åŽåœ¨è¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„è™šæ‹Ÿåœ°å€ï¼Œå¦åˆ™ä¸º0ï¼› sh_offsetï¼šæ®µåç§»ï¼Œå¦‚æžœæ®µå­˜åœ¨äºŽæ–‡é™ä¸­ï¼Œåˆ™è¡¨ç¤ºè¯¥æ®µåœ¨æ–‡ä»¶ä¸­çš„åç§»ï¼Œå¦åˆ™æ— æ„ä¹‰ï¼› sh_sizeï¼šæ®µé•¿åº¦ï¼› sh_linkï¼šæ®µé“¾æŽ¥ä¿¡æ¯ï¼Œå–å†³äºŽsh_type SHT_DYNAMICï¼šè¯¥æ®µæ‰€ä½¿ç”¨çš„å­—ç¬¦ä¸²è¡¨åœ¨æ®µè¡¨ä¸­çš„ä¸‹æ ‡ SHT_HASHï¼šè¯¥æ®µæ‰€ä½¿ç”¨çš„ç¬¦å·è¡¨åœ¨æ®µè¡¨ä¸­çš„ä¸‹æ ‡ SHT_RELï¼šè¯¥æ®µæ‰€ä½¿ç”¨çš„ç›¸åº”ç¬¦å·è¡¨åœ¨æ®µè¡¨ä¸­çš„ä¸‹æ ‡ SHT_RELAï¼šåŒä¸Š SHT_SYMTABï¼šæ“ä½œç³»ç»Ÿç›¸å…³ SHT_DYNSYMï¼šåŒä¸Š otherï¼šSHN_UNDEF sh_infoï¼šåŒä¸Šï¼› sh_addralignï¼šæ®µåœ°å€å¯¹é½ï¼Œè¡¨ç¤ºåœ°å€å¯¹é½æ•°é‡ä¸­çš„æŒ‡æ•°ï¼Œä½¿sh_addr%(2**sh_addralign)=0ï¼Œè‹¥ä¸º1æˆ–0åˆ™æ®µæ²¡æœ‰å¯¹é½è¦æ±‚ï¼› sh_entsizeï¼šé¡¹çš„é•¿åº¦ï¼Œå½“æ®µåŒ…å«å›ºå®šå¤§å°çš„é¡¹æ—¶ï¼Œå…¶è¡¨ç¤ºæ¯ä¸ªé¡¹çš„å¤§å°ï¼› æŸ¥çœ‹å®Œæ•´çš„ELFæ–‡ä»¶çš„æ®µçš„æŒ‡ä»¤ä¸º readelf -S SimpleSection.o é‡å®šä½è¡¨ å¯¹äºŽæ¯ä¸ªé¡»è¦é‡å®šä½çš„ä»£ç æ®µæˆ–æ•°æ®æ®µï¼Œå³æ˜¯å½“æ®µä¸­æœ‰ç»å¯¹åœ°å€å¼•ç”¨æ—¶ï¼Œå°±éƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åº”çš„é‡å®šä½è¡¨ï¼Œæ¯”å¦‚.rel.textå°±æ˜¯é’ˆå¯¹.textçš„é‡å®šä½è¡¨ã€‚ ä¸€ä¸ªé‡å®šä½è¡¨å°±æ˜¯ç‹¬ç«‹ä¸€ä¸ªæ®µï¼Œå®ƒçš„sh_linkå°±è¡¨ç¤ºç¬¦å·è¡¨çš„ä¸‹æ ‡ï¼Œsh_infoè¡¨ç¤ºå®ƒä½œç”¨äºŽå“ªä¸ªæ®µ å­—ç¬¦ä¸²è¡¨ æ®µåã€å˜é‡åç­‰ï¼ŒæŠŠå­—ç¬¦ä¸²é›†ä¸­èµ·æ¥å­˜æ”¾åˆ°ä¸€ä¸ªè¡¨ï¼Œç„¶åŽç”¨å­—ç¬¦ä¸²åœ¨è¡¨ä¸­çš„åç§»æ¥å¼•ç”¨å­—ç¬¦ä¸²ï¼Œä½¿ç”¨åç§»æ—¶å®žè´¨ä¹Ÿæ˜¯å¼•ç”¨å­—ç¬¦ä¸²è¡¨ä¸­çš„ä¸‹æ ‡ã€‚ å­—ç¬¦ä¸²è¡¨ä»¥æ®µå½¢å¼ä¿å­˜ï¼Œä¸€èˆ¬ä¸º.strtabå­—ç¬¦ä¸²è¡¨ï¼ˆæ™®é€šå­—ç¬¦ä¸²ï¼‰æˆ–è€….shstrtabæ®µè¡¨å­—ç¬¦ä¸²è¡¨ï¼ˆæ®µè¡¨ä¸­çš„å­—ç¬¦ä¸²ï¼Œå¦‚æ®µåï¼‰ã€‚ Elf32_Ehdræœ€åŽä¸€ä¸ªæˆå‘˜e_shstrndxä»£è¡¨æ®µè¡¨å­—ç¬¦ä¸².shstrtabåœ¨æ®µè¡¨ä¸­çš„ä¸‹æ ‡ã€‚ ç¬¦å·è¡¨é“¾æŽ¥è¿‡ç¨‹çš„æœ¬è´¨å°±æ˜¯æŠŠå¤šä¸ªä¸åŒçš„ç›®æ ‡æ–‡ä»¶ä¹‹é—´äº’ç›¸â€ç²˜â€œåˆ°ä¸€èµ·ï¼Œç›®æ ‡æ–‡ä»¶ä¹‹é—´ç›¸äº’æ‹¼åˆå®žé™…ä¸Šæ˜¯ç›®æ ‡æ–‡ä»¶ä¹‹é—´å¯¹åœ°å€çš„å¼•ç”¨ï¼Œå³å¯¹å‡½æ•°å’Œå˜é‡åœ°å€çš„å¼•ç”¨ï¼Œè€Œåœ¨é“¾æŽ¥ä¸­ï¼Œæˆ‘ä»¬å°†å‡½æ•°å’Œå˜é‡ç»Ÿç§°ä¸ºç¬¦å·ï¼ˆSymbolï¼‰ï¼Œå‡½æ•°åå’Œå˜é‡åå°±æ˜¯ç¬¦å·åï¼Œç¬¦å·å€¼å°±æ˜¯ä»–ä»¬çš„åœ°å€ã€‚ ä¸€èˆ¬æ˜¯åä¸ºâ€œ.symtabâ€çš„æ®µï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªElf32_Symç»“æž„ä½“: st_nameï¼šç¬¦å·åï¼Œè¿™ä¸ªæˆå‘˜åŒ…å«äº†è¯¥ç¬¦å·ååœ¨å­—ç¬¦ä¸²è¡¨ä¸­çš„ä¸‹æ ‡ st_valueï¼šç¬¦å·å€¼ï¼ŒéžCOMMONå—ç¬¦å·æ˜¯åœ¨é€šè¿‡st_shndxç¡®å®šç¬¦å·æ‰€åœ¨æ®µåŽï¼Œå°†åœ¨è¯¥æ®µä¸­çš„åç§»åœ°å€è®¾ç½®ä¸ºç¬¦å·å€¼ï¼Œè€ŒCOMMONå—ç¬¦å·æ˜¯å°†ç¬¦å·çš„å¯¹é½å±žæ€§è®¾ç½®ä¸ºç¬¦å·å€¼ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¸‹ç¬¦å·å€¼åˆ™ç›´æŽ¥æ˜¯ç¬¦å·çš„è™šæ‹Ÿåœ°å€ã€‚ st_sizeï¼šç¬¦å·å¤§å° st_infoï¼šç¬¦å·ç±»åž‹åŠç»‘å®šä¿¡æ¯ï¼Œä½Ž4ä½è¡¨ç¤ºç±»åž‹ï¼Œé«˜4ä½è¡¨ç¤ºç¬¦å·ç»‘å®šä¿¡æ¯ STB_LOCALï¼šç»‘å®šä¿¡æ¯-å±€éƒ¨ç¬¦å·ï¼Œç›®æ ‡æ–‡ä»¶å¤–ä¸å¯è§ STB_GLOBALï¼šç»‘å®šä¿¡æ¯-å…¨å±€ç¬¦å·ï¼Œå¤–éƒ¨å¯è§ STB_WEAKï¼šç»‘å®šä¿¡æ¯-å¼±å¼•ç”¨ STT_NOTYPEï¼šè¡¨ç¤ºæœªçŸ¥ç±»åž‹ STT_OBJECTï¼šè¡¨ç¤ºæ•°æ®å¯¹è±¡ï¼Œå¦‚å˜é‡ã€æ•°ç»„ç­‰ STT_FUNCï¼šè¡¨ç¤ºå‡½æ•°æˆ–å…¶ä»–å¯æ‰§è¡Œä»£ç  STT_SECTIONï¼šè¡¨ç¤ºä¸€ä¸ªæ®µ STT_FILEï¼šæ–‡ä»¶åï¼Œä¸€èˆ¬æ˜¯è¯¥ç›®æ ‡æ–‡ä»¶æ‰€å¯¹åº”çš„æºæ–‡ä»¶åï¼Œæ‰€ä»¥ä¸€å®šæ˜¯å’ŒSTB_LOCALæ­é…ï¼Œst_shndxä¸€å®šæ˜¯SHN_ABS st_otherï¼šé¢„ç•™ st_shndxï¼šç¬¦å·æ‰€åœ¨çš„æ®µï¼Œå¦‚æžœè¯¥ç¬¦å·å®šä¹‰åœ¨ç›®æ ‡æ–‡ä»¶å†…ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºç¬¦å·æ‰€åœ¨æ®µåœ¨æ®µè¡¨çš„ä¸‹æ ‡ï¼Œå¦åˆ™æœ‰3ç§ç±»åž‹è¡¨ç¤ºï¼š SHN_ABSï¼šç¬¦å·åŒ…å«äº†ä¸€ç»å¯¹å€¼ SHN_COMMONï¼šç¬¦å·æ˜¯ä¸€ä¸ªCOMMONå—ï¼Œä¾‹å¦‚æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ç¬¦å· SHN_UNDEFï¼š0ï¼Œç¬¦å·æœªå®šä¹‰ï¼Œåœ¨æœ¬ç›®æ ‡æ–‡ä»¶ä¸­å¼•ç”¨åˆ°ï¼Œä½†å®šä¹‰åœ¨å…¶ä»–ç›®æ ‡æ–‡ä»¶ä¸­ ç‰¹æ®Šç¬¦å· __executable_startï¼šç¨‹åºèµ·å§‹åœ°å€ï¼ˆä¸æ˜¯å…¥å£åœ°å€ï¼‰ __etextï¼šä»£ç æ®µç»“æŸã€æœ«å°¾çš„åœ°å€ _edataï¼šæ•°æ®æ®µç»“æŸåœ°å€ _endï¼šç¨‹åºç»“æŸåœ°å€ å¼•ç”¨ç¤ºä¾‹ï¼šextern char executable_start[];print(â€œ%Xâ€,executable_start); ç¬¦å·ä¿®é¥°å’Œå‡½æ•°ç­¾åä¸ºäº†é˜²æ­¢ç¬¦å·åå†²çªï¼š æ·»åŠ å‰åŽç¼€ UNIXä¸‹çš„Cè¯­è¨€ï¼Œå…¨å±€å˜é‡å’Œå‡½æ•°åœ¨ç»è¿‡ç¼–è¯‘åŽï¼Œç¬¦å·åå‰åŠ ä¸‹åˆ’çº¿â€œ_â€ï¼Œä¾‹å¦‚å‡½æ•°_fooï¼ˆLinuxä¸‹çš„GCCå·²ä¸é‡‡ç”¨ï¼‰ï¼› Fortranè¯­è¨€ï¼Œç¼–è¯‘åŽæ‰€æœ‰ç¬¦å·åå‰åŠ â€œ_â€ï¼ŒåŽé¢ä¹ŸåŠ â€œ_â€ï¼Œä¾‹å¦‚å‡½æ•°_foo_ï¼› å¢žåŠ å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ ç¬¦å·ä¿®é¥°ï¼ˆName Decorationï¼‰ å‡½æ•°ç­¾åï¼ˆFunction Signatureï¼‰ï¼ŒåŒ…å«å‡½æ•°åã€å‚æ•°ç±»åž‹ã€æ‰€åœ¨ç±»ã€å‘½åç©ºé—´ç­‰å…¶å®ƒä¿¡æ¯ã€‚ åç§°ä¿®é¥°æ³•ï¼Œåœ¨ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶æ—¶ï¼Œå‡½æ•°åå’Œå˜é‡åä¼šè¢«ä¿®é¥°è€Œå½¢æˆç¬¦å·ï¼š GCCçš„C++åç§°ä¿®é¥°æ–¹æ³•ï¼š æ‰€æœ‰ç¬¦å·éƒ½ä»¥â€œ_Zâ€å¼€å¤´ åŽé¢ç´§è·Ÿâ€œNâ€ ç„¶åŽæ˜¯å„å‘½åç©ºé—´å’Œç±»çš„åå­—å­—ç¬¦ä¸²é•¿åº¦å’Œè¯¥åå­—ï¼Œå¦‚1N2AB æœ€åŽä»¥â€œEâ€ç»“å°¾ å†åŠ å‚æ•°åˆ—è¡¨ï¼Œå¦‚intå³æ˜¯i ç¤ºä¾‹ï¼ˆGCCï¼‰ï¼š å‡½æ•° int N::C::func(int) ä¿®é¥°åŽä¸º _ZN1N1C4funcEiï¼› fooä¸­çš„å…¨å±€å˜é‡barä¿®é¥°åŽä¸º_ZN3foo3barEï¼› funcå‡½æ•°ä¸­çš„é™æ€å˜é‡skrä¿®é¥°åŽä¸º_ZZ4funcE3skrï¼Œè‹¥å¤šä¸ªå‡½æ•°å†…æœ‰ç›¸åŒçš„é™æ€å˜é‡åï¼Œåˆ™åœ¨â€œEâ€å‰å¤šåŠ å­—ç¬¦åŒºåˆ†ï¼Œæ¯”å¦‚å¤šåŠ ä¸€ä¸ªâ€œvâ€æˆ_ZZ4mainvE3skrï¼› å¯ä½¿ç”¨binutilsä¸­çš„c++filtå·¥å…·å¯¹è¢«ä¿®é¥°è¿‡çš„åç§°è¿›è¡Œè§£æžã€‚ Visualçš„C++åç§°ä¿®é¥°å‘ â€œ?â€å¼€å¤´ å‡½æ•°åï¼Œâ€œ@â€ç»“å°¾ ç±»åï¼Œâ€œ@â€ç»“å°¾ å‘½åç©ºé—´ï¼Œâ€œ@â€ç»“å°¾ è°ƒç”¨ç±»åž‹ï¼ŒAè¡¨ç¤º__cdecl å‚æ•°ç±»åž‹åŠè¿”å›žå€¼ ç¤ºä¾‹ï¼šå‡½æ•° int N::C::func(int) ä¿®é¥°åŽä¸º ?func@C@N@@AAEHH@Zï¼› extern â€œCâ€ï¼š C++ç¼–è¯‘å™¨ä¼šå°†åœ¨extern â€œCâ€çš„å¤§æ‹¬å·å†…éƒ¨æˆ–å…¶åŒè¡ŒåŽå£°æ˜Žçš„ä»£ç å½“åšCè¯­è¨€ä»£ç å¤„ç†ï¼Œè¿™æ ·C++çš„åç§°ä¿®é¥°æœºåˆ¶å°±ä¸ä¼šèµ·ä½œç”¨ã€‚ é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ‰‹åŠ¨èŽ·å–åˆ°ä¿®é¥°åå­—åŽçš„å˜é‡ã€‚ C++ç¼–è¯‘å™¨ä¸­æä¾›äº†ä¸€ä¸ªå®â€œ__cplusplusâ€æ¥é¿å…Cç¼–è¯‘å™¨ä¸æ”¯æŒextern â€œCâ€çš„æƒ…å†µã€‚ å¼ºç¬¦å·å’Œå¼±ç¬¦å· å¼ºç¬¦å·ï¼ˆStrong Symbolï¼‰ï¼Œå¯¹äºŽå‡½æ•°å’Œåˆå§‹åŒ–äº†çš„å…¨å±€å˜é‡ï¼Œç¼–è¯‘å™¨é»˜è®¤ä¸ºå¼ºç¬¦å·ï¼Œå½“å®šä¹‰çš„ä¸¤ä¸ªå¼ºç¬¦å·ï¼Œä¾‹å¦‚ä¸¤ä¸ªå…¨å±€å˜é‡éƒ½åˆå§‹åŒ–äº†å€¼ï¼Œä¸”åå­—ä¸€æ ·çš„æ—¶å€™ï¼Œç¼–è¯‘å°±ä¼šæŠ¥é”™ã€‚ å¼±ç¬¦å·ï¼ˆWeak Symbolï¼‰ï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ä¸ºå¼±ç¬¦å·ï¼Œå¯ä»¥é€šè¿‡__attribute__((weak))æ¥å®šä¹‰ä»»ä½•ä¸€ä¸ªå¼ºç¬¦å·ä¸ºå¼±ç¬¦å·ã€‚å¤–éƒ¨å˜é‡çš„å¼•ç”¨æ˜¯éžå¼ºä¹Ÿéžå¼±ï¼Œä¾‹å¦‚ extern int extã€‚ è§„åˆ™ ä¸å…è®¸å¼ºç¬¦å·è¢«å¤šæ¬¡å®šä¹‰ï¼› è‹¥ä¸€ä¸ªç¬¦å·åœ¨æŸç›®æ ‡æ–‡ä»¶ä¸­æ˜¯å¼ºç¬¦å·ï¼Œåœ¨å…¶ä»–æ–‡ä»¶æ˜¯å¼±ç¬¦å·ï¼Œé‚£ä¹ˆé€‰æ‹©å¼ºç¬¦å·ï¼› è‹¥ä¸€ä¸ªç¬¦å·åœ¨æ‰€æœ‰ç›®æ ‡æ–‡ä»¶éƒ½æ˜¯å¼±ç¬¦å·ï¼Œé‚£ä¹ˆé€‰æ‹©å…¶ä¸­å ç”¨ç©ºé—´æœ€å¤§çš„ä¸€ä¸ªï¼› å¼ºå¼•ç”¨å’Œå¼±å¼•ç”¨ å¼ºå¼•ç”¨ï¼Œè‹¥æ²¡æ‰¾åˆ°ç¬¦å·çš„å®šä¹‰ï¼Œç¼–è¯‘å™¨å› æ— æ³•å†³è®®ç¬¦å·çš„å¼•ç”¨è€Œä¼šæŠ¥é”™ï¼› å¼±å¼•ç”¨ï¼Œè‹¥ç¬¦å·æœ‰å®šä¹‰ï¼Œåˆ™ç¼–è¯‘å™¨å°†è¯¥ç¬¦å·çš„å¼•ç”¨å†³è®®ï¼Œå¦åˆ™ç¼–è¯‘å™¨å¯¹äºŽè¯¥å¼•ç”¨ä¹Ÿä¸æŠ¥é”™ï¼Œä¾‹å¦‚__attribute__ ((weakref)) void foo(); ä¸»è¦éƒ½æ˜¯ç”¨äºŽåº“é“¾æŽ¥çš„è¿‡ç¨‹ã€‚åº“ä¸­å®šä¹‰çš„å¼±ç¬¦å·å¯ä»¥è¢«ç”¨æˆ·çš„å¼ºç¬¦å·æ‰€è¦†ç›–ï¼Œä»Žè€Œä½¿å¾—ç¨‹åºå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç‰ˆæœ¬çš„åº“å‡½æ•°ã€‚å¯ä»¥å£°æ˜Žä¸€ä¸ªå¼±å¼•ç”¨å‡½æ•°ï¼Œåˆ©ç”¨å…¶åˆ¤æ–­è¯¥å‡½æ•°æ˜¯å¦å­˜åœ¨å¯ä½¿ç”¨è€Œä¸ä¼šç¼–è¯‘æŠ¥é”™ï¼Œå°±å¯ä»¥æ’æ‹”å«æ­¤å‡½æ•°çš„åº“æˆ–æ›´æ¢åº“ç‰ˆæœ¬ã€‚ è°ƒè¯•ä¿¡æ¯GCCç¼–è¯‘æ—¶åŠ ä¸Šâ€œ-gâ€å‚æ•°ï¼Œå¯åœ¨ç›®æ ‡æ–‡ä»¶ä¸­åŠ ä¸Šè°ƒè¯•ä¿¡æ¯ï¼Œä¼šå‘çŽ°ç›®æ ‡æ–‡ä»¶ä¸­å¤šäº†å¾ˆå¤šdebugç›¸å…³çš„æ®µã€‚ ELFæ–‡ä»¶é‡‡ç”¨DWARFï¼ˆDebug With Arbitrary Record Formatï¼‰çš„è°ƒè¯•ä¿¡æ¯æ ‡å‡†æ ¼å¼ï¼Œè€ŒWindowsä¸Šé‡‡ç”¨CodeViewæ ‡å‡†ã€‚ è°ƒè¯•ä¿¡æ¯åœ¨ç›®æ ‡æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶ä¸Šå å¾ˆå¤§ç©ºé—´ï¼Œæ¯”ä»£ç å’Œæ•°æ®ä¼šå¤§å‡ å€ï¼Œæ‰€ä»¥äº§å“å‘å¸ƒæ—¶éƒ½é¡»è¦æŠŠè°ƒè¯•ä¿¡æ¯åŽ»æŽ‰ï¼ŒèŠ‚çœç©ºé—´ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„releaseç‰ˆæœ¬ã€‚ åŽ»æŽ‰ELFæ–‡ä»¶ä¸­çš„è°ƒè¯•ä¿¡æ¯å‘½ä»¤ $strip fooç©ºé—´ä¸Žåœ°å€åˆ†é…å¯¹äºŽé“¾æŽ¥å™¨ï¼Œæ•´ä¸ªé“¾æŽ¥è¿‡ç¨‹ä¸­ï¼Œå°±æ˜¯å°†å‡ ä¸ªè¾“å…¥ç›®æ ‡æ–‡ä»¶åŠ å·¥åŽåˆå¹¶æˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ã€‚ å› ä¸ºæ¯ä¸ªæ®µéƒ½é¡»è¦æœ‰ä¸€å®šçš„åœ°å€å’Œç©ºé—´å¯¹é½è¦æ±‚ï¼Œå¦‚æžœæŒ‰åºå åŠ æ®µï¼Œå°±ä¼šé€ æˆå†…å­˜ç©ºé—´å¤§é‡çš„å†…éƒ¨ç¢Žç‰‡ã€‚ æ‰€ä»¥ä¸€èˆ¬é‡‡å–ç›¸ä¼¼æ®µåˆå¹¶ï¼Œä½¿ç”¨ä¸¤æ­¥é“¾æŽ¥ï¼ˆTwo-pass Linkingï¼‰çš„æ–¹æ³•ï¼š ç©ºé—´ä¸Žåœ°å€åˆ†é…ï¼šæ”¶å½•èµ·å„æ®µä¿¡æ¯ï¼ˆæ›´æ–°æ®µè¡¨çš„ä¿¡æ¯ï¼‰å’Œç¬¦å·ï¼ˆæ”¾å…¥å…¨å±€ç¬¦å·è¡¨ï¼‰ ç¬¦å·è§£æžä¸Žé‡å®šä½ï¼šåˆ©ç”¨ä¸Šé¢çš„ä¿¡æ¯è¿›è¡Œç¬¦å·è§£æžå’Œé‡å®šä½ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé“¾æŽ¥å™¨ä¸ºç›®æ ‡æ–‡ä»¶åˆ†é…åœ°å€å’Œç©ºé—´å°±åŒ…å«ä¸¤ä¸ªæ„æ€ï¼š è¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç©ºé—´ï¼ˆåˆå¹¶æ®µåŽç¡®å®šï¼‰ï¼› è£…è½½åŽçš„è™šæ‹Ÿåœ°å€ä¸­çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆé‡é“¾æŽ¥åŽç¡®å®šï¼‰ï¼› é“¾æŽ¥çš„æŒ‡ä»¤ï¼š #-e mainè¡¨ç¤ºå°†mainå‡½æ•°ä½œä¸ºç¨‹åºå…¥å£ï¼Œå› ä¸ºldé“¾æŽ¥å™¨é»˜è®¤ä»¥_startä¸ºå…¥å£ #-o abè¡¨ç¤ºé“¾æŽ¥è¾“å‡ºæ–‡ä»¶åä¸ºabï¼Œé»˜è®¤ä¸ºa.out $ld a.o b.o -e main -o ab ã€å›¾ã€‘å¯æ‰§è¡Œæ–‡ä»¶ä¸Žè¿›ç¨‹ç©ºé—´ å› ä¸ºåˆå¹¶ç›®æ ‡æ–‡ä»¶åŽï¼Œå„ä¸ªç¬¦å·åœ¨æ®µå†…çš„ç›¸å¯¹ä½ç½®å›ºå®šäº†ï¼Œæ‰€ä»¥é“¾æŽ¥å™¨å°±å¯ä»¥å¼€å§‹è®¡ç®—å„ä¸ªç¬¦å·çœŸæ­£çš„è™šæ‹Ÿåœ°å€ï¼Œç»™æ¯ä¸ªç¬¦å·åŠ ä¸Šä¸€ä¸ªåç§»é‡ã€‚ è€Œè™šæ‹Ÿç©ºé—´ä»Ž0å¼€å§‹åˆ†é…ï¼Œæ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿçš„è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´çš„åˆ†é…è§„åˆ™ï¼Œæ¯ä¸ªè¿›ç¨‹çš„ELFå¯æ‰§è¡Œæ–‡ä»¶é»˜è®¤éƒ½ä»Žåœ°å€0x8048000å¼€å§‹åˆ†é…ï¼Œç”±ç³»ç»Ÿå†…æ ¸ç®¡ç†ç€æ¯ä¸ªè¿›ç¨‹è™šæ‹Ÿå†…å­˜å’Œæœºå™¨çš„ç‰©ç†RAMå®ƒä»¬ä¹‹é—´çš„æ˜ å°„ï¼Œæ‰€ä»¥æ¯ä¸ªè¿›ç¨‹çš„èµ·å§‹ç‰©ç†åœ°å€æ˜¯ä¸åŒçš„ã€‚ ç¬¦å·è§£æžä¸Žé‡å®šä½é‡å®šä½$objdump -d a.o #-dæŸ¥çœ‹ä»£ç çš„åæ±‡ç¼–ç»“æžœ åœ¨æ²¡é“¾æŽ¥ä¹‹å‰ï¼Œä¸çŸ¥é“å˜é‡æˆ–å‡½æ•°çš„åœ°å€æ—¶ï¼Œç›®æ ‡æ–‡ä»¶ä¼šä»¥ä¸¤ç§å½¢å¼ä¸´æ—¶è®¾å®šä¸€äº›ä¸´æ—¶åœ°å€ï¼š ç»å¯¹å¯»å€ï¼Œä¾‹å¦‚å¯¹äºŽä¸€æ¡ä¼ è¾“æŒ‡ä»¤çš„æºä¸ºä¸€ä¸ªç«‹å³æ•°æ—¶ï¼Œè¯¥è¢«ä¼ è¾“çš„å˜é‡åˆ™é‡‡ç”¨ç»å¯¹å¯»å€ï¼Œå¯»å€ä¿®æ­£åŽçš„åœ°å€ä¸ºè¯¥ç¬¦å·çš„å®žé™…åœ°å€ï¼› ç›¸å¯¹å¯»å€ï¼Œå¯¹äºŽä¸åŒçš„æŒ‡ä»¤ï¼ˆjmpã€callã€movç­‰ç­‰ï¼‰ï¼Œå¯»å€çš„æ–¹å¼éƒ½åƒå·®ä¸‡åˆ«ï¼Œä¾‹å¦‚è¿‘å€ç›¸å¯¹ä½ç§»è°ƒç”¨æŒ‡ä»¤ï¼Œå³æ˜¯ä¸€è¡ŒæŒ‡ä»¤ä¸­ï¼Œé™¤åŽ»æŒ‡ä»¤ç å¤–ï¼Œæœ€åŽé¢çš„4å­—èŠ‚32ä½å°±æ˜¯è¢«è°ƒç”¨å‡½æ•°çš„ç›¸å¯¹äºŽè°ƒç”¨æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åç§»é‡ï¼Œä¸€èˆ¬ä»¥ï¼ˆå°ç«¯ï¼‰è¡¥ç å½¢å¼è¡¨ç¤ºå‡½æ•°çš„åœ°å€ï¼Œå¯»å€ä¿®æ­£åŽçš„åœ°å€ä¸ºç¬¦å·ä¸¾ä¾‹è¢«ä¿®æ­£ä½ç½®çš„åœ°å€å·®ã€‚ é“¾æŽ¥åŽï¼Œä¼šä»Žå®šä¹‰å˜é‡çš„åœ°æ–¹é‡å®šä½å‡ºæ­¤å‰æœªå®šä½å˜é‡åœ¨ä»£ç ä¸­çš„è™šæ‹Ÿåœ°å€ï¼Œä¹Ÿä¼šä»Žè°ƒç”¨æœªå®šä½å‡½æ•°çš„æŒ‡ä»¤ç›¸é‚»çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„è™šæ‹Ÿåœ°å€ï¼ŒåŠ ä¸Šåç§»é‡åæŽ¨å‡ºè¯¥å‡½æ•°çš„è™šæ‹Ÿåœ°å€ã€‚ $objdump -r a.o #-ræŸ¥çœ‹é‡å®šä½è¡¨ æ¯”å¦‚.textä¸€èˆ¬å¯¹åº”.rel.texté‡å®šä½è¡¨ã€‚æ¯ä¸ªè¦è¢«é‡å®šä½çš„åœ°æ–¹å«é‡å®šä½å…¥å£ï¼ˆRelocation Entryï¼‰ï¼Œé‡å®šä½è¡¨ç»“æž„å¦‚ä¸‹ï¼š r_offsetï¼Œé‡å®šä½å…¥å£çš„åç§» å¯é‡å®šä½æ–‡ä»¶ä¸­ï¼Œæ˜¯ï¼ˆè¯¥é‡å®šä½å…¥å£è¦ä¿®æ­£çš„ä½ç½®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ç›¸å¯¹æ®µèµ·å§‹çš„åç§»ï¼› å¯æ‰§è¡Œæ–‡ä»¶æˆ–å…±äº«å¯¹è±¡æ–‡ä»¶ï¼Œæ˜¯ï¼ˆè¯¥é‡å®šä½å…¥å£è¦ä¿®æ­£çš„ä½ç½®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ï¼‰è™šæ‹Ÿåœ°å€ï¼› r_infoï¼Œé«˜24ä½è¡¨ç¤ºé‡å®šä½å…¥å£çš„ç¬¦å·åœ¨ç¬¦å·è¡¨ä¸­çš„ä¸‹æ ‡ï¼Œä½Ž8ä½è¡¨ç¤ºé‡å®šä½å…¥å£çš„ç±»åž‹ ç¬¦å·è§£æžæ¯ä¸ªç›®æ ‡æ–‡ä»¶éƒ½å¯èƒ½å®šä¹‰ä¸€äº›ç¬¦å·ï¼Œä¹Ÿå¯èƒ½å¼•ç”¨åˆ°å®šä¹‰åœ¨å…¶ä»–ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·ã€‚ æ¯ä¸ªé‡å®šä½çš„å…¥å£éƒ½æ˜¯å¯¹ä¸€ä¸ªç¬¦å·çš„å¼•ç”¨ã€‚ è¿žæŽ¥å™¨å¯¹æŸä¸ªç¬¦å·çš„å¼•ç”¨è¿›è¡Œé‡å®šä½æ—¶ï¼Œå°±ä¼šåŽ»æŸ¥æ‰¾ç”±æ‰€æœ‰è¾“å…¥ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·è¡¨ç»„æˆçš„å…¨å±€ç¬¦å·è¡¨ï¼Œç¡®å®šç¬¦å·çš„åœ°å€ã€‚ COMMONå—äº‹å…ˆå£°æ˜Žéœ€è¦çš„ä¸´æ—¶ä½¿ç”¨ç©ºé—´çš„å¤§å°ã€‚ åœ¨é“¾æŽ¥æ—¶ï¼Œå½“ä¸åŒçš„ç›®æ ‡æ–‡ä»¶éœ€è¦çš„COMMONå—ç©ºé—´å¤§å°ä¸ä¸€è‡´æ—¶ï¼Œä»¥æœ€å¤§çš„é‚£å—ä¸ºå‡†ï¼Œè€Œä¸”åªé’ˆå¯¹å¼±ç¬¦å·ï¼Œå› ä¸ºå¦‚æžœæœ‰å…¶ä¸­ä¸€ä¸ªæ˜¯å¼ºç¬¦å·ï¼Œé‚£ä¹ˆæœ€ç»ˆè¾“å‡ºç»“æžœä¸­çš„ç¬¦å·æ‰€å ç”¨ç©ºé—´å°±ä¸Žå¼ºç¬¦å·ç›¸åŒäº†ã€‚ å¼±ç¬¦å·å¤§äºŽå¼ºç¬¦å·æ—¶å°±ä¼šé“¾æŽ¥æŠ¥é”™ã€‚ ä»¥ä¸‹æ–¹å¼å…è®¸æˆ‘ä»¬æŠŠæ‰€æœ‰æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ä¸ä»¥COMMONå—çš„å½¢å¼å¤„ç†ï¼Œå³æ˜¯å½“ä¸€ä¸ªæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ä¸æ˜¯ä»¥COMMONå—çš„å½¢å¼å­˜åœ¨ï¼Œé‚£å°±ç›¸å½“äºŽä¸€ä¸ªå¼ºç¬¦å·ï¼š $gcc -fno-common ini global __attribute__((nocommon)); ABIï¼ˆApplication Binary Interfaceï¼‰ç¬¦å·ä¿®é¥°æ ‡å‡†ã€å˜é‡å†…å­˜å¸ƒå±€ã€å‡½æ•°è°ƒç”¨æ–¹å¼ç­‰è·Ÿå¯æ‰§è¡Œä»£ç äºŒè¿›åˆ¶å…¼å®¹æ€§ç›¸å…³çš„å†…å®¹ã€‚ é™æ€åº“é“¾æŽ¥é™æ€åº“å¯ç®€å•çœ‹æˆä¸€ç»„ç›®æ ‡æ–‡ä»¶çš„é›†åˆã€‚ æ ¹æ®æ˜¯å¦æ”¯æŒå¤šçº¿ç¨‹å’Œè°ƒè¯•çš„åŠŸèƒ½ï¼ŒCè¿è¡Œåº“å¯åŒºåˆ†ä¸ºå¤šä¸ªç‰ˆæœ¬ã€‚ ä»¥ä¸‹æŒ‡ä»¤å¯æŸ¥çœ‹é™æ€åº“åŒ…å«äº†å“ªäº›ç›®æ ‡æ–‡ä»¶ï¼š $ar -t libc.a æŸ¥æ‰¾å‡½æ•°æ‰€åœ¨çš„ç›®æ ‡æ–‡ä»¶ï¼š $objdump -t libc.a å…³é—­å†…ç½®å‡½æ•°ä¼˜åŒ–é€‰é¡¹ï¼ˆé¿å…GCCä¸ºæé«˜è¿è¡Œé€Ÿåº¦æ›¿æ¢å‡½æ•°ï¼‰ï¼š $gcc -c -fno-builtin hello.c è§£åŽ‹ç›®æ ‡æ–‡ä»¶åˆ°å½“å‰ç›®å½•ï¼š $ar -x libc.a ä¸Žé™æ€åº“é“¾æŽ¥ï¼Œldé“¾æŽ¥å™¨ä¼šè‡ªåŠ¨å¯»æ‰¾æ‰€æœ‰éœ€è¦çš„ç¬¦å·åŠå®ƒä»¬æ‰€åœ¨çš„ç›®æ ‡æ–‡ä»¶ï¼Œå°†è¿™äº›ç›®æ ‡æ–‡ä»¶ä»Žé™æ€åº“ä¸­è§£åŽ‹å‡ºæ¥ï¼Œç„¶åŽé“¾æŽ¥åœ¨ä¸€èµ·æˆä¸ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ ç¼–è¯‘é“¾æŽ¥è¿‡ç¨‹è¯¦æƒ…ï¼š $gcc -static --verbose -fno-builtin hello.c ... /usr/lib/gcc/i486-linux-gnu/4.1.3/cc1 -quiet -v hello.o -quiet -dumpbase hello.c -mtune=generic -auxbase hello -version -fno-builtin -fstack-protector -fstack-protector -o /tmp/ccUhtGSB.s ... as --traditional-format -V -Qy -o /tmp/ccQZRPL5.o /tmp/ccUhtGSB.s ... /usr/lib/gcc/i486-linux-gnu/4.1.3/collect2 -m elf_i386 --hash-style=both -static crt1.o crti.o crtbeginT.o -L/lib /tmp/ccQZRPL5.o --start-group -lgcc -lgcc_eh -lc --end-group crtend.o crtn.o cc1æ˜¯GCCçš„Cç¼–è¯‘å™¨ï¼Œç¼–è¯‘å‡ºä¸´æ—¶çš„æ±‡ç¼–æ–‡ä»¶.sï¼› asæ˜¯GNUçš„æ±‡ç¼–å™¨ï¼Œå°†ä¸´æ—¶æ±‡ç¼–æ–‡ä»¶æ±‡ç¼–æˆç›®æ ‡æ–‡ä»¶.oï¼› collect2æ˜¯ldè¿žæŽ¥å™¨çš„ä¸€ä¸ªåŒ…è£…ï¼Œå…¶å…ˆè°ƒç”¨ldå®Œæˆç›®æ ‡æ–‡ä»¶çš„é“¾æŽ¥ï¼Œç„¶åŽå¯¹é“¾æŽ¥ç»“æžœåšæ”¶é›†æ‰€æœ‰ä¸Žç¨‹åºåˆå§‹åŒ–æœ‰å…³çš„ä¿¡æ¯å¹¶æž„é€ åˆå§‹åŒ–çš„ç»“æž„çš„å¤„ç† å°†å‡½æ•°å°½é‡ç‹¬ç«‹å¼€å­˜æ”¾åˆ°ä¸åŒçš„ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥å°½é‡å‡å°‘ç©ºé—´çš„æµªè´¹ï¼Œè¿™æ ·æ²¡æœ‰è¢«ç”¨åˆ°ç›®æ ‡æ–‡ä»¶ï¼ˆå‡½æ•°ï¼‰å°±ä¸è¦é“¾æŽ¥åˆ°æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ã€‚ é“¾æŽ¥è¿‡ç¨‹æŽ§åˆ¶é“¾æŽ¥è¿‡ç¨‹éœ€è¦ç¡®è®¤çš„å†…å®¹ï¼š ä½¿ç”¨å“ªäº›ç›®æ ‡æ–‡ä»¶ ä½¿ç”¨å“ªäº›åº“æ–‡ä»¶ æ˜¯å¦åœ¨æœ€ç»ˆå¯æ‰§è¡Œæ–‡ä»¶ä¸­ä¿ç•™è°ƒè¯•ä¿¡æ¯ è¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼Œæ˜¯å¯æ‰§è¡Œæ–‡ä»¶è¿˜æ˜¯åŠ¨æ€é“¾æŽ¥åº“ æ˜¯å¦è¦å¯¼å‡ºç¬¦å·ä¾›è°ƒè¯•ä½¿ç”¨ æŽ§åˆ¶é“¾æŽ¥æœ‰3ç§æ–¹å¼ï¼šé“¾æŽ¥å™¨åœ¨å‘½ä»¤è¡Œçš„å‚æ•°ã€é“¾æŽ¥æŒ‡ä»¤å†…ç½®äºŽç›®æ ‡æ–‡ä»¶ã€é“¾æŽ¥è„šæœ¬ã€‚ æŸ¥çœ‹ldé»˜è®¤çš„é“¾æŽ¥è„šæœ¬ï¼ˆè·¯å¾„ï¼š/usr/lib/ldscriptsï¼‰ï¼š $ld -verbose è‡ªå®šä¹‰é“¾æŽ¥è„šæœ¬ï¼š $ld -T link.script å†…åµŒæ±‡ç¼–ï¼š asm(&quot;movl $42, %ebx \n\t&quot; &quot;movl $1, %eax \n\t&quot; &quot;int $0x80 \n\t&quot; ); intæ˜¯ä¸­æ–­æŒ‡ä»¤ï¼Œé€šè¿‡0x80å®žçŽ°ç³»ç»Ÿè°ƒç”¨ï¼Œæ ¹æ®eaxä¸­çš„ç³»ç»Ÿè°ƒç”¨å·é€‰æ‹©ä¸­æ–­ç±»åž‹ã€‚ åœ¨main()å‡½æ•°ç»“æŸåŽæŽ§åˆ¶æƒä¼šè¿”å›žç»™ç³»ç»Ÿåº“ï¼Œç”±ç³»ç»Ÿåº“è´Ÿè´£è°ƒç”¨EXITï¼ŒEXITæ˜¯ä¸€ç§ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶è°ƒç”¨å·ä¸º1ã€‚ æŽ§åˆ¶é“¾æŽ¥çš„è¿‡ç¨‹æ— éžå°±æ˜¯æŽ§åˆ¶è¾“å…¥æ®µï¼ˆè¾“å…¥æ–‡ä»¶ä¸­çš„æ®µï¼‰å¦‚ä½•å˜æˆè¾“å‡ºæ®µï¼ˆè¾“å‡ºæ–‡ä»¶ä¸­çš„æ®µï¼‰ï¼Œæ¯”å¦‚å“ªäº›è¾“å…¥æ®µè¦åˆå¹¶ä¸€ä¸ªè¾“å‡ºæ®µï¼Œå“ªäº›è¾“å…¥æ®µè¦ä¸¢å¼ƒã€‚æŒ‡å®šè¾“å‡ºæ®µçš„åå­—ã€è£…è½½åœ°å€ã€å±žæ€§ç­‰ã€‚ é“¾æŽ¥è„šæœ¬ç¤ºä¾‹ï¼š ENTRY(nomain) SECTIONS &#123; .=0x0804800 + SIZEOF_HEADERS; tinytext : &#123; *(.text) *(.data) *(.rodata) &#125; /DISCARD/: &#123; *(.comment) &#125; &#125; ENTRY(symbol)æŒ‡å®šç¨‹åºå…¥å£å‡½æ•°ï¼Œå¯¹åº”ldæŒ‡ä»¤çš„-eé€‰é¡¹ï¼Œä½¿ç”¨ä¼˜å…ˆçº§ï¼š-e&gt;entry&gt;_start&gt;.textç¬¬ä¸€ä¸ªå­—èŠ‚&gt;0 SECTIONS {}çš„æ˜¯æŒ‡å®šå„è¾“å…¥æ®µåˆ°è¾“å‡ºæ®µçš„å˜æ¢æŒ‡ä»¤ å¤§æ‹¬å·å†…çš„åˆ™æ˜¯å˜æ¢è§„åˆ™ .=è¡¨ç¤ºå½“å‰è™šæ‹Ÿåœ°å€çš„èµ‹å€¼ï¼Œä¸‹ä¸€ä¸ªè§„åˆ™å¤„ä¸­çš„æ®µåˆ™ä»¥æ­¤åœ°å€èµ·å§‹ï¼› xx : { *(.xx) *(.yy)}å¤§æ‹¬å·ä¸­çš„æ®µä¾æ¬¡åˆå¹¶åˆ°è¾“å‡ºæ–‡ä»¶tinytext(xx)ä¸­ï¼Œ*è¡¨ç¤ºé€šé…è¾“å…¥æ–‡ä»¶ï¼Œå¯é‡‡ç”¨æ­£åˆ™ï¼› /DISCARD/ : { *(.zz) }ä¸¢å¼ƒæ®µ å…¶å®ƒ STARTUP(filename)æŒ‡å®šæ–‡ä»¶filenameä¸ºç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼› SEARCH_DIR(path)æŒ‡å®šè·¯å¾„pathåŠ å…¥åˆ°é“¾æŽ¥å™¨çš„åº“æŸ¥æ‰¾ç›®å½•ï¼Œå¯¹åº”-Lpathå‘½ä»¤ï¼› INPUT(file,file,...)æŒ‡å®šè¾“å…¥æ–‡ä»¶ INCLUDE filenameåŒ…å«æŒ‡å®šæ–‡ä»¶è¿›é“¾æŽ¥è„šæœ¬ PROVIDE(symbol)åœ¨é“¾æŽ¥è„šæœ¬å®šä¹‰æŸä¸ªç¬¦å· ldå¯é€šè¿‡-så‚æ•°ç¦æ­¢é“¾æŽ¥å™¨äº§ç”Ÿç¬¦å·è¡¨ï¼Œæˆ–ä½¿ç”¨stripå‘½ä»¤åŽ»é™¤ã€‚å¯¹å¯æ‰§è¡Œæ–‡ä»¶æ¥è¯´ï¼Œç¬¦å·è¡¨å’Œå­—ç¬¦ä¸²è¡¨ç¤ºå¯é€‰çš„ï¼Œä½†æ®µåå­—ç¬¦ä¸²è¡¨åˆ™æ˜¯å¿…é¡»çš„ã€‚ BFDåº“å› ä¸ºç¡¬è½¯ä»¶å¹³å°ç§ç±»ç¹å¤šï¼Œå›ºäº§ç”Ÿäº†BFDåº“ï¼ˆBinary File Description libraryï¼‰æ¥ç»Ÿä¸€å¤„ç†ä¸åŒçš„ç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œå®ƒæ˜¯binutilsçš„ä¸€ä¸ªå­é¡¹ç›®ã€‚ BFDæŠŠç›®æ ‡æ–‡ä»¶æŠ½è±¡æˆä¸€ä¸ªç»Ÿä¸€çš„æ¨¡åž‹ã€‚ GCCã€GNUã€ldã€GDBã€binutilséƒ½é€šè¿‡BFDåº“æ¥å¤„ç†ç›®æ ‡æ–‡ä»¶ï¼Œè€Œéžç›´æŽ¥å¤„ç†ã€‚ è£…è½½ä¸ŽåŠ¨æ€é“¾æŽ¥è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´æ¯ä¸ªç¨‹åºè¢«è¿è¡ŒåŽï¼Œéƒ½å°†æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆVirtual Address Spaceï¼‰ï¼Œå…¶å¤§å°ç”±è®¡ç®—æœºçš„ç¡¬ä»¶å¹³å°å†³å®šï¼ˆCPUçš„ä½æ•°å†³å®šï¼‰ã€‚ 32ä½çš„ç¡¬ä»¶å¹³å°ï¼Œè™šæ‹Ÿç©ºé—´çš„åœ°å€ä¸º0-2^32-1ï¼Œå³0x00000000~0xFFFFFFFFï¼Œ4GBå¤§å°ï¼Œ4å­—èŠ‚é•¿åº¦ï¼ˆä½æ•°ï¼Œæ¯ä¸¤ä½16è¿›åˆ¶ä¸º1å­—èŠ‚é•¿åº¦ï¼‰ï¼› 64ä½å¯»å€èƒ½åŠ›çš„å¹³å°åˆ™æœ‰è¾¾2^64å­—èŠ‚ï¼Œå³17179869184GBçš„å¤§å°ã€‚ Cè¯­è¨€æŒ‡é’ˆå¤§å°çš„ä½æ•°ä¸Žè™šæ‹Ÿç©ºé—´çš„ä½æ•°ç›¸åŒï¼Œ32ä½å¹³å°çš„æŒ‡é’ˆä¸º32ä½ï¼Œå³4å­—èŠ‚ï¼›64ä½å¹³å°çš„æŒ‡é’ˆä¸º64ä½ï¼Œå³8å­—èŠ‚ã€‚ è¿›ç¨‹åªèƒ½ä½¿ç”¨æ“ä½œç³»ç»Ÿåˆ†é…ç»™è¿›ç¨‹çš„åœ°å€ï¼Œå¦‚æžœè®¿é—®æœªç»å…è®¸çš„ç©ºé—´ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿå°±ä¼šæ•èŽ·åˆ°è¿™äº›è®¿é—®ï¼Œå°†è¿›ç¨‹çš„è¿™ç§è®¿é—®å½“ä½œéžæ³•æ“ä½œï¼Œå¼ºåˆ¶ç»“æŸè¿›ç¨‹ã€‚ ã€å›¾ã€‘è¿›ç¨‹è™šæ‹Ÿç©ºé—´åˆ†å¸ƒ æ‰€æœ‰ä»£ç ã€æ•°æ®åŒ…æ‹¬é€šè¿‡Cè¯­è¨€malloc()ç­‰æ–¹æ³•ç”³è¯·çš„è™šæ‹Ÿç©ºé—´ä¹‹å’Œæ˜¯ä¸èƒ½è¶…è¿‡3GBï¼Œè€Œä¸”è¿˜æœ‰ä¸€éƒ¨åˆ†å…¶å®žæ˜¯é¢„ç•™ç»™å…¶å®ƒç”¨é€”ï¼Œå¹¶ä¸èƒ½å…¨å ç”¨è¯¥3GBã€‚ åœ¨æ‰©å±•çš„36ä½åœ°å€çº¿ä¸‹ï¼ŒIntelä¿®æ”¹äº†é¡µæ˜ å°„æ–¹å¼ï¼Œä½¿å¾—æ–°çš„æ˜ å°„æ–¹å¼å¯ä»¥è®¿é—®åˆ°æ›´å¤šçš„ç‰©ç†å†…å­˜ï¼Œæ­¤æ–¹å¼å«PAEï¼ˆPhysical Address Extensionï¼‰ã€‚æ“ä½œç³»ç»Ÿæä¾›ä¸€ä¸ªçª—å£æ˜ å°„çš„æ–¹æ³•ï¼ŒæŠŠè¿™äº›é¢å¤–çš„å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ä¸­æ¥ã€‚Linuxç³»ç»Ÿä¸‹é‡‡ç”¨mmap()ç³»ç»Ÿè°ƒç”¨æ¥å®žçŽ°ã€‚ ã€å›¾ã€‘PAE/AWE è£…è½½çš„æ–¹å¼åŠ¨æ€è£…å…¥çš„åŽŸç†ï¼Œæ¥æºäºŽå¾ˆå¤šæ—¶å€™ï¼ˆå¤šä¸ªè¿è¡Œçš„ï¼‰ç¨‹åºæ‰€éœ€è¦çš„å†…å­˜æ•°é‡ä¼šå¤§äºŽç‰©ç†å†…å­˜çš„æ•°é‡ï¼Œä½†ç¨‹åºè¿è¡Œæ—¶æ˜¯æœ‰å±€éƒ¨æ€§åŽŸç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ç¨‹åºæœ€å¸¸ç”¨çš„éƒ¨åˆ†é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œå°†ä¸å¤ªå¸¸ç”¨çš„æ•°æ®å­˜æ”¾åœ¨ç£ç›˜é‡Œé¢ã€‚ ä¸¤ç§å…¸åž‹çš„åŠ¨æ€è£…è½½æ–¹æ³•ï¼š è¦†ç›–è£…å…¥ï¼ˆOverlayï¼‰ å‡ ä¹Žå·²è¢«æ·˜æ±°ï¼Œä½†åœ¨å†…å­˜å—é™çš„åµŒå…¥å¼ï¼Œå¦‚DSPè¿˜å¯èƒ½æœ‰ç”¨ï¼› ç¨‹åºå‘˜éœ€æ‰‹å·¥å°†æ¨¡å—æŒ‰ç…§å®ƒä»¬ä¹‹é—´çš„è°ƒç”¨ä¾èµ–å…³ç³»ç»„ç»‡æˆæ ‘çŠ¶ç»“æž„ï¼Œè¿™æ ·åŒå±‚çº§æˆ–ä¸åŒåˆ†æ”¯ä¸Šçš„èŠ‚ç‚¹å°±æ„å‘³ç€æ˜¯ç‹¬ç«‹ä¸ä¼šäº’ç›¸è°ƒç”¨çš„ï¼Œéœ€è¦ç”¨åˆ°æ—¶å°±å¯ä»¥è¦†ç›–è£…å…¥åˆ°åŒå±‚å…¶å®ƒèŠ‚ç‚¹åŽŸå…ˆæ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ å…¸åž‹ç”¨æ—¶é—´æ¢å–ç©ºé—´ï¼Œå› ä¸ºå½“èŠ‚ç‚¹æ¨¡å—æ²¡åœ¨å†…å­˜ä¸­ï¼Œåˆ™éœ€ä»Žç£ç›˜æˆ–å…¶å®ƒå­˜å‚¨å™¨è¯»å–ï¼Œè¦†ç›–è£…å…¥çš„é€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚ é¡µæ˜ å°„ï¼ˆPagingï¼‰ å°†å†…å­˜å’Œæ‰€æœ‰ç£ç›˜ä¸­çš„æ•°æ®å’ŒæŒ‡ä»¤æŒ‰ç…§â€œé¡µï¼ˆPageï¼‰â€ä¸ºå•ä½åˆ’åˆ†æˆè‹¥å¹²ä¸ªé¡µï¼Œä»¥åŽæ‰€æœ‰çš„è£…è½½å’Œæ“ä½œçš„å•ä½å°±æ˜¯é¡µã€‚ å°†ç¨‹åºå½“å‰ç”¨åˆ°çš„å¯æ‰§è¡Œæ–‡ä»¶é¡µï¼ŒæŒ‰å…ˆè¿›å…ˆå‡ºçš„å†…å­˜åˆ†é…è§„åˆ™ï¼ˆFIFOï¼‰ï¼Œæˆ–æ‰¾å‡ºæ¯”è¾ƒå°‘è®¿é—®çš„å·²è£…è½½çš„ç‰©ç†é¡µåˆ†é…è§„åˆ™ï¼ˆLURï¼‰ï¼Œæ‰¾å‡ºå¯ç”¨äºŽé‡æ–°è£…è½½çš„ç‰©ç†å†…å­˜ã€‚ å¦‚æ­¤è£…è½½çš„ç®¡ç†å™¨å°±æ˜¯çŽ°ä»£çš„æ“ä½œç³»ç»Ÿï¼Œæ›´å‡†ç¡®æ¥è¯´æ˜¯æ“ä½œç³»ç»Ÿçš„å­˜å‚¨ç®¡ç†å™¨ã€‚ è£…è½½è¿‡ç¨‹ åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼› å»ºç«‹è™šæ‹Ÿç©ºé—´åˆ°ç‰©ç†å†…å­˜çš„æ˜ å°„å…³ç³»ï¼› å®žè´¨åªæ˜¯åˆ†é…ä¸€ä¸ªé¡µç›®å½•çš„æ•°æ®ç»“æž„ï¼Œå¹¶æœªå‘ç”Ÿè£…è½½è¿›å†…å­˜çš„æ“ä½œã€‚ è£…è½½ç›¸åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼šè¯»å–å¯æ‰§è¡Œæ–‡ä»¶å¤´ï¼Œå¹¶ä¸”å»ºç«‹è™šæ‹Ÿç©ºé—´ä¸Žå¯æ‰§è¡Œæ–‡ä»¶çš„æ˜ å°„å…³ç³»ï¼› å½“ç¨‹åºæ‰§è¡Œå‘ç”Ÿé¡µé”™è¯¯æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†ä»Žç‰©ç†å†…å­˜ä¸­åˆ†é…ä¸€ä¸ªç‰©ç†é¡µï¼Œç„¶åŽå°†è¯¥â€œç¼ºé¡µâ€ä»Žç£ç›˜ä¸­è¯»å–åˆ°å†…å­˜ä¸­ï¼Œå†è®¾ç½®ç¼ºé¡µçš„è™šæ‹Ÿé¡µå’Œç‰©ç†é¡µçš„æ˜ å°„å…³ç³»ï¼Œè¿™å°±æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„è£…è½½è¿‡ç¨‹ï¼› ç”±äºŽå¯æ‰§è¡Œæ–‡ä»¶è£…è½½æ—¶å®žé™…ä¸Šæ˜¯è¢«æ˜ å°„çš„è™šæ‹Ÿç©ºé—´ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºæ˜ åƒæ–‡ä»¶ï¼ˆImageï¼‰ æ˜ å°„çš„å…³ç³»åªæ˜¯ä¿å­˜åœ¨æ“ä½œç³»ç»Ÿå†…éƒ¨çš„ä¸€ä¸ªæ•°æ®ç»“æž„ï¼› è™šæ‹Ÿå†…å­˜åŒºåŸŸï¼ˆVMAï¼ŒVirtual Memory Areaï¼‰ï¼Œä»£è¡¨è¿›ç¨‹è™šæ‹Ÿç©ºé—´ä¸­çš„ä¸€ä¸ªæ®µï¼Œåœ¨ç³»ç»Ÿåˆ›å»ºè¿›ç¨‹åŽåœ¨è¿›ç¨‹ç›¸åº”çš„æ•°æ®ç»“æž„ä¸­è®¾ç½®æœ‰ä¸€ä¸ªå¯¹åº”æ®µçš„VMAï¼Œå½“å‘ç”Ÿæ®µé”™è¯¯æ—¶ï¼Œå°±ä¼šè¢«æŸ¥æ‰¾æ¥å®šä½é”™è¯¯é¡µåœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ä½ç½®ã€‚ æ‰§è¡Œï¼šå°†CPUçš„æŒ‡ä»¤å¯„å­˜å™¨è®¾ç½®æˆå¯æ‰§è¡Œæ–‡ä»¶çš„å…¥å£åœ°å€ï¼Œå¯åŠ¨è¿è¡Œã€‚ é¡µé”™è¯¯ï¼ˆPage Faultï¼‰å‘ç”Ÿè¿‡ç¨‹ï¼š CPUå¼€å§‹æ‰§è¡Œä¸€ä¸ªåœ°å€çš„æŒ‡ä»¤æ—¶ï¼Œå‘çŽ°è¯¥é¡µæ˜¯ä¸ªç©ºé¡µæ—¶ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªé¡µé”™è¯¯ï¼› æ“ä½œç³»ç»Ÿé€šè¿‡ä¸“é—¨çš„é¡µé”™è¯¯å¤„ç†ä¾‹ç¨‹å¤„ç†ï¼› æŸ¥è¯¢è™šæ‹Ÿç©ºé—´å’Œå¯æ‰§è¡Œæ–‡ä»¶çš„æ˜ å°„å…³ç³»æ•°æ®ç»“æž„ï¼Œæ‰¾åˆ°ç©ºé¡µçš„VMAï¼› è®¡ç®—ç›¸åº”é¡µé¢åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„åç§»ï¼Œç„¶åŽåœ¨ç‰©ç†å†…å­˜ä¸­åˆ†é…ä¸€ä¸ªç‰©ç†é¡µé¢ï¼Œå°†è¿›ç¨‹ä¸­è¯¥è™šæ‹Ÿé¡µä¸Žåˆ†é…çš„ç‰©ç†é¡µä¹‹é—´å»ºç«‹æ˜ å°„å…³ç³»ï¼› æŠŠæŽ§åˆ¶æƒäº¤è¿˜ç»™è¿›ç¨‹ï¼Œç»§ç»­æ‰§è¡Œã€‚ ã€å›¾ã€‘é¡µé”™è¯¯ è™šæ‹Ÿç©ºé—´å°±ç›¸å½“äºŽä¸€ä¸ªç¼“å†²æ¡¥æ¢ä¸€æ ·çš„å­˜åœ¨ï¼Œå°†ç‰©ç†é¡µå’Œå¯æ‰§è¡Œæ–‡ä»¶çš„åˆ†é¡µåœ¨éœ€è¦(ç”¨åˆ°)çš„æ—¶å€™æ‰å…³è”èµ·æ¥ã€‚ è¿›ç¨‹è™šå­˜çš„ç©ºé—´åˆ†å¸ƒELFæ–‡ä»¶è§†å›¾ELFæ–‡ä»¶è¢«æ˜ å°„æ—¶ï¼Œæ˜¯ä»¥ç³»ç»Ÿçš„é¡µé•¿åº¦ä½œä¸ºå•ä½çš„ï¼Œé‚£ä¹ˆæ¯ä¸ªæ®µåœ¨æ˜ å°„æ—¶çš„é•¿åº¦åº”è¯¥éƒ½æ˜¯ç³»ç»Ÿé¡µé•¿åº¦çš„æ•´æ•°å€ï¼›å¦‚æžœä¸æ˜¯ï¼Œé‚£ä¹ˆå¤šä½™çš„éƒ¨åˆ†ä¹Ÿå°†å ç”¨ä¸€ä¸ªé¡µã€‚ å› æ­¤ï¼Œå¯¹äºŽç›¸åŒæƒé™çš„æ®µï¼ˆæ¯”å¦‚å¯è¯»å¯å†™ã€å¯è¯»å¯æ‰§è¡Œï¼‰ï¼ŒæŠŠå®ƒä»¬åˆå¹¶åˆ°ä¸€èµ·å½“ä½œä¸€ä¸ªæ®µè¿›è¡Œæ˜ å°„ï¼Œå°±å‡å°‘äº†å†…å­˜çš„æµªè´¹ã€‚ ELFä¸­çš„Segmentï¼ˆèŠ‚ï¼‰å°±æ˜¯è¿™ç§ç»è¿‡åˆå¹¶çš„åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå±žæ€§ç±»ä¼¼çš„Sectionï¼ˆæ®µï¼‰çš„æ¦‚å¿µã€‚åˆå¹¶æˆSegmentï¼ˆèŠ‚ï¼‰åŽï¼ŒVMAä¹Ÿä¼šå¯¹åº”å‡å°‘ï¼ˆä¸€ä¸ªSegmentå¯¹åº”ä¸€ä¸ªï¼‰ï¼Œä»Žè€Œå‡å°‘é¡µé¢å†…éƒ¨çš„ç¢Žç‰‡ï¼ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚ Sectionå­˜å‚¨çš„æ˜¯ä»Žé“¾æŽ¥çš„è§’åº¦å‡ºå‘ï¼Œç§°ä¸ºELFæ–‡ä»¶çš„é“¾æŽ¥è§†å›¾ï¼ˆLinking Viewï¼‰ï¼› Segmentåˆ’åˆ†çš„æ˜¯ä»Žè£…è½½çš„è§’åº¦å‡ºå‘ï¼Œç§°ä¸ºELFæ–‡ä»¶çš„æ‰§è¡Œè§†å›¾ï¼ˆExecution Viewï¼‰ã€‚ æŸ¥çœ‹Segmentçš„æŒ‡ä»¤ï¼š $gcc -static SectionMapping.c -o SectionMapping.elf $readelf -S SectionMapping.elf $readelf -l SectionMapping.elf æè¿°Segmentçš„ç»“æž„å«ç¨‹åºå¤´ï¼ˆProgram Headerï¼‰ï¼Œæè¿°äº†ELFæ–‡ä»¶è¯¥å¦‚ä½•è¢«æ“ä½œç³»ç»Ÿæ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´ï¼Œåœ¨ELFå¯æ‰§è¡Œæ–‡ä»¶ä¸­ä¼šæœ‰ä¸€ä¸ªä¸“é—¨çš„æ•°æ®ç»“æž„ç¨‹åºå¤´è¡¨ï¼ˆProgram Header Tableï¼‰ç”¨æ¥ä¿å­˜Segmentä¿¡æ¯ï¼Œè¡¨å…ƒç´ æ˜¯ç»“æž„ä½“Elf32_Phdrï¼š p_typeï¼šSegmentçš„ç±»åž‹ï¼ŒåŒ…æ‹¬LOADã€DYNAMICã€INTERPï¼› p_offsetï¼šSegmentåœ¨æ–‡ä»¶ä¸­çš„åç§»ï¼› p_vaddrï¼šSegmentç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´çš„èµ·å§‹ä½ç½®ï¼ŒLOADç±»åž‹çš„å…ƒç´ å‡æŒ‰æ­¤ä»Žå°åˆ°å¤§æŽ’åˆ—ï¼› p_paddrï¼šSegmentçš„ç‰©ç†è£…è½½åœ°å€ï¼ŒLMAï¼Œä¸€èˆ¬å’Œp_vaddrä¸€æ ·ï¼› p_fileszï¼šSegmentçš„ELFæ–‡ä»¶æ‰€å ç”¨é•¿åº¦ï¼Œå¯èƒ½ä¸º0ï¼Œå› å¯èƒ½è¿™ä¸ªSegmentæ˜¯åœ¨ELFæ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„å†…å­˜ï¼› p_memseï¼šSegmentçš„è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´å ç”¨é•¿åº¦ï¼Œå¯èƒ½ä¸º0ã€‚å¯¹äºŽLOADç±»åž‹çš„Segmentï¼Œp_memseä¸èƒ½å°‘äºŽp_fileszï¼Œå¤šä½™çš„éƒ¨åˆ†å…¨å¡«å……0ï¼Œä»£è¡¨æž„é€ ELFæ–‡ä»¶æ—¶ä¸éœ€è¦é¢å¤–è®¾ç«‹BSSçš„Segmentï¼› p_flagsï¼šSegmentçš„æƒé™å±žæ€§ï¼ŒåŒ…æ‹¬Rå¯è¯»ã€Wå¯å†™ã€Xå¯æ‰§è¡Œï¼› p_alignï¼šSegmentçš„å¯¹é½å±žæ€§ï¼Œå®žé™…å¯¹é½å­—èŠ‚æ˜¯ç­‰äºŽ2çš„p_alignæ¬¡æ–¹ï¼› å †æ ˆVMAé™¤äº†è¢«ç”¨æ¥æ˜ å°„å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å„ä¸ªSegmentå¤–ï¼Œè¿˜è¢«ä½¿ç”¨æ¥å¯¹è¿›ç¨‹çš„åœ°å€ç©ºé—´è¿›è¡Œç®¡ç†ã€‚å †ï¼ˆHeapï¼‰ã€æ ˆï¼ˆStackï¼‰åœ¨è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´ä¸­çš„è¡¨çŽ°å°±æ˜¯ä»¥VMAçš„å½¢å¼å­˜åœ¨ã€‚ æŸ¥çœ‹è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´åˆ†å¸ƒï¼š $./SectionMapping.elf &amp; # æŸ¥è¯¢å¯æ‰§è¡Œæ–‡ä»¶çš„è¿›ç¨‹å· $cat /proc/21963/maps æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å±žäºŽè‡ªå·±çš„å †æ ˆï¼Œå•çº¿ç¨‹çš„ç¨‹åºä¸­VMAå †æ ˆæ˜¯å…¨éƒ¨å½’å®ƒä½¿ç”¨ã€‚ä¹Ÿæœ‰ä¸ªç‰¹æ®Šçš„VMAå«â€œvdsoâ€ï¼Œå…¶åœ°å€ä½äºŽå†…æ ¸ç©ºé—´ï¼Œäº‹å®žä¸Šå®ƒæ˜¯ä¸€ä¸ªå†…æ ¸æ¨¡å—ï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®è¿™ä¸ªVMAæ¥è·Ÿå†…æ ¸è¿›è¡Œä¸€äº›é€šä¿¡ã€‚ æ“ä½œç³»ç»Ÿé€šè¿‡ç»™è¿›ç¨‹ç©ºé—´åˆ’åˆ†å‡ºä¸€ä¸ªä¸ªVMAæ¥ç®¡ç†è™šæ‹Ÿç©ºé—´ï¼ŒåŸºæœ¬åŽŸåˆ™ä¸ºå°†ç›¸åŒæƒé™å±žæ€§çš„ã€æœ‰æ˜ åƒæ–‡ä»¶çš„æ˜ å°„æˆä¸€ä¸ªVMAï¼Œè¿›ç¨‹ä¸­åˆ†å¦‚ä¸‹å‡ ç§VMAåŒºåŸŸï¼š ä»£ç VMAï¼Œæƒé™åªè¯»ã€å¯æ‰§è¡Œï¼Œæœ‰æ˜ åƒæ–‡ä»¶ï¼› æ•°æ®VMAï¼Œæƒé™å¯è¯»å†™ã€å¯æ‰§è¡Œï¼Œæœ‰æ˜ åƒæ–‡ä»¶ï¼› å †VMAï¼Œæƒé™å¯è¯»å†™ã€å¯æ‰§è¡Œï¼Œæ— æ˜ åƒæ–‡ä»¶ï¼ŒåŒ¿åï¼Œå¯å‘ä¸Šæ‰©å±•ï¼ˆåœ°å€æ¯”æ ˆä½Žï¼Œä½Žä½çš„èµ·å§‹åœ°å€é è¿‘å†…å­˜åº•ç«¯ï¼‰ï¼› æ ˆVMAï¼Œæƒé™å¯è¯»å†™ã€ä¸å¯æ‰§è¡Œï¼Œæ— æ˜ åƒæ–‡ä»¶ï¼ŒåŒ¿åï¼Œå¯å‘ä¸‹æ‰©å±•ï¼ˆåœ°å€æ¯”å †é«˜ï¼Œé«˜ä½çš„èµ·å§‹åœ°å€é è¿‘ç³»ç»Ÿå†…æ ¸å†…å­˜åŒºåŸŸï¼‰ï¼› å †æœ€å¤§çš„ç”³è¯·æ•°é‡ä¼šå—åˆ°ç³»ç»Ÿç‰ˆæœ¬ã€ç¨‹åºå¤§å°ã€ç”¨åˆ°çš„åŠ¨æ€åº“/å…±äº«åº“æ•°é‡ã€å¤§å°ã€ç¨‹åºæ ˆæ•°é‡ã€å¤§å°ã€éšæœºåœ°å€ç©ºé—´åˆ†å¸ƒæŠ€æœ¯ï¼ˆä¸ºé˜²æ­¢ç¨‹åºè¢«æ¶æ„æ”»å‡»ï¼‰ç­‰å› ç´ å½±å“ï¼Œä¸‹é¢æ˜¯æµ‹è¯•mallocæœ€å¤§å†…å­˜ç”³è¯·æ•°é‡çš„ä»£ç ï¼š #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; unsigned maximum = 0; int main(int argc, char *argv[]) &#123; unsigned blocksize[] = &#123; 1024 * 1024 , 1024, 1 &#125;; int i, count; for (i=0; i&lt;3; i++) &#123; for (count=1; ; count++) &#123; void *block = malloc( maximum + blocksize[i] * count); if (block) &#123; maximum = maximum + blocksize[i] * count; free(block); else &#123; break; &#125; &#125; &#125; printf(&quot;maximum malloc size = %u bytes\n&quot;, maximum); &#125; ç”±äºŽæœ‰ç€é•¿åº¦å’Œèµ·å§‹åœ°å€çš„é™åˆ¶ï¼Œå¯¹äºŽå¯æ‰§è¡Œæ–‡ä»¶æ¥è¯´ï¼Œå®ƒåº”è¯¥å°½é‡åœ°ä¼˜åŒ–è‡ªå·±çš„ç©ºé—´å’Œåœ°å€çš„å®‰æŽ’ï¼Œä»¥èŠ‚çœç©ºé—´ã€‚ ELFå¯æ‰§è¡Œæ–‡ä»¶çš„èµ·å§‹è™šæ‹Ÿåœ°å€ä¸€èˆ¬ä¸º0x08048000ï¼ŒæŒ‰ä¸Šè¿°çš„åˆå¹¶è¿‡ç¨‹æ‰€å¾—çš„Segmentï¼Œåœ¨å…¶å¯¹é½åœ°å€ï¼ˆæŒ‰é¡µå•ä½å¤§å°åˆ’åˆ†ï¼‰åŽå†…éƒ¨ä»å¯èƒ½å­˜åœ¨å¾ˆå¤šç¢Žç‰‡ï¼ˆä¸è¶³ä¸€é¡µçš„å¤šä½™éƒ¨åˆ†ï¼‰ï¼Œæ‰€ä»¥UNIXç³»ç»Ÿå°†å„ä¸ªæ®µæŽ¥å£¤éƒ¨åˆ†ï¼ˆæ–‡ä»¶å¤´ä¹Ÿè¢«è§†ä½œä¸€ä¸ªæ®µä¼šä¸Žå…¶å®ƒæ®µåˆå¹¶ï¼‰å…±äº«ä¸€ä¸ªç‰©ç†é¡µé¢ï¼Œç„¶åŽå°†ç‰©ç†é¡µé¢åˆ†åˆ«æ˜ å°„ä¸¤æ¬¡åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä½¿è™šæ‹Ÿåœ°å€ç©ºé—´çœ‹èµ·æ¥å’ŒELFçš„æ–‡ä»¶åˆ†æ®µä¸€è‡´ï¼Œå®žè´¨åœ¨ç‰©ç†å†…å­˜ä¸­æ˜¯å…±äº«é¡µæ¥å……åˆ†åˆ©ç”¨ç©ºé—´ï¼Œä»Žè€Œä½¿ä¸€ä¸ªç‰©ç†é¡µé¢å¯èƒ½åŒæ—¶åŒ…å«ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„æ®µæ•°æ®ï¼ˆåªè¦æ®µæ•°æ®çš„å¤§å°æ€»å’Œå°‘äºŽç‰©ç†é¡µå•ä½å¤§å°ï¼‰ã€‚æ‰€ä»¥ä¸€ä¸ªå¯è£…è½½çš„Segmentï¼Œå®ƒçš„p_vaddré™¤ä»¥å¯¹é½å±žæ€§çš„ä½™æ•°ç­‰äºŽp_offseté™¤ä»¥å¯¹é½å±žæ€§çš„ä½™æ•°ã€‚ ã€å›¾ã€‘ELFæ–‡ä»¶æ®µåˆå¹¶ è£…è½½ELFè¿‡ç¨‹ åœ¨ç”¨æˆ·å±‚é¢ï¼Œbashè¿›ç¨‹è°ƒç”¨fork()ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼› æ–°è¿›ç¨‹è°ƒç”¨execve()ç³»ç»Ÿè°ƒç”¨æ‰§è¡ŒæŒ‡å®šçš„ELFæ–‡ä»¶ï¼› åŽŸbashè¿›ç¨‹ç»§ç»­è¿”å›žç­‰å¾…åˆšæ‰å¯åŠ¨çš„æ–°è¿›ç¨‹ç»“æŸï¼› ç„¶åŽç»§ç»­ç­‰å¾…ç”¨æˆ·è¾“å…¥å‘½ä»¤ã€‚ execve()æœ‰å¾ˆå¤šä¸åŒå½¢å¼åŒ…è£…çš„execç³»åˆ—APIï¼Œå…¶åœ¨å†…æ ¸ä¸­åšäº†å¦‚ä¸‹äº‹æƒ…ï¼š è°ƒç”¨å…¥å£sys_execve()è¿›è¡Œä¸€äº›å‚æ•°çš„æ£€æŸ¥å¤åˆ¶ï¼› è°ƒç”¨do_execve()ï¼ŒæŸ¥æ‰¾è¢«æ‰§è¡Œçš„æ–‡ä»¶ï¼Œæ‰¾åˆ°åˆ™è¯»å–æ–‡ä»¶çš„å‰128å­—èŠ‚ï¼Œæ¥åˆ¤æ–­æ–‡ä»¶æ ¼å¼ï¼Œå¤´4ä¸ªå­—èŠ‚ç”šè‡³ç§°ä¸ºé­”æ•°ï¼Œä¾‹å¦‚ELFå¯æ‰§è¡Œæ–‡ä»¶æ˜¯ 0x7F e l fï¼ŒJavaå¯æ‰§è¡Œæ–‡ä»¶æ˜¯ c a f eï¼ŒShellç­‰è„šæœ¬æ˜¯ #!(æ ¹æ®é­”æ•°ç¡®å®šæ˜¯è„šæœ¬åŽå†è§£æžåŽé¢çš„è§£é‡Šç¨‹åºçš„è·¯å¾„ï¼Œåƒ #!/bin/shã€#!/usr/bin/python)ï¼› ç„¶åŽè°ƒç”¨search_binary_handle()åŽ»æœç´¢å’ŒåŒ¹é…åˆé€‚çš„å¯æ‰§è¡Œæ–‡ä»¶è£…è½½å¤„ç†è¿‡ç¨‹ï¼Œä¾‹å¦‚load_elf_binary()ã€load_aout_binary()ã€load_script()ç­‰ï¼Œä»¥ELFåŠ è½½ä¸ºä¾‹ï¼š æ£€æŸ¥æ–‡ä»¶æ ¼å¼çš„æœ‰æ•ˆæ€§ï¼› å¯»æ‰¾åŠ¨æ€é“¾æŽ¥çš„â€.interpâ€æ®µï¼Œè®¾ç½®åŠ¨æ€é“¾æŽ¥å™¨è·¯å¾„ï¼› æ ¹æ®ç¨‹åºå¤´è¡¨ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œæ˜ å°„ï¼› åˆå§‹åŒ–ELFè¿›ç¨‹çŽ¯å¢ƒï¼› å°†ç³»ç»Ÿè°ƒç”¨çš„è¿”å›žåœ°å€ä¿®æ”¹æˆELFå¯æ‰§è¡Œæ–‡ä»¶çš„å…¥å£ç‚¹ï¼Œå¯¹äºŽé™æ€é“¾æŽ¥çš„ELFæ–‡ä»¶è¯¥å…¥å£ç‚¹å°±æ˜¯ELFæ–‡ä»¶çš„æ–‡ä»¶å¤´ä¸­e_entryæ‰€æŒ‡çš„åœ°å€ï¼Œå¯¹äºŽåŠ¨æ€é“¾æŽ¥çš„ELFå¯æ‰§è¡Œæ–‡ä»¶åˆ™å…¥å£ç‚¹æ˜¯åŠ¨æ€é“¾æŽ¥å™¨ï¼› å½“sys_execve()ç³»ç»Ÿè°ƒç”¨ä»Žå†…æ ¸æ€è¿”å›žåˆ°ç”¨æˆ·æ€æ—¶ï¼ŒEIPå¯„å­˜å™¨ç›´æŽ¥è·³è½¬åˆ°ELFç¨‹åºçš„å…¥å£åœ°å€ï¼Œå¼€å§‹æ‰§è¡Œç¨‹åºï¼ŒELFå¯æ‰§è¡Œæ–‡ä»¶è£…è½½å®Œæˆã€‚ åŠ¨æ€é“¾æŽ¥é™æ€é“¾æŽ¥çš„ç¼ºç‚¹ï¼š æµªè´¹å†…å­˜å’Œç£ç›˜ç©ºé—´ï¼Œæ¯”å¦‚ä¸€ä¸ªç›®æ ‡æ–‡ä»¶é™æ€é“¾æŽ¥åˆ°Nä¸ªä¸åŒçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆç£ç›˜è¢«å ç”¨çš„ç©ºé—´å°±æ¯”å¤ç”¨ä¸€ä¸ªç›®æ ‡æ–‡ä»¶æ—¶å¤šå‡ºäº†Nå€ï¼Œè‹¥è¿™äº›æ–‡ä»¶åŒæ—¶è¢«åŠ è½½è¿è¡Œçš„è¯ï¼Œå†…å­˜ç©ºé—´ä¹ŸåŒæ ·æ˜¯Nå€çš„å¢žé•¿ï¼› æ¨¡å—æ›´æ–°å›°éš¾ï¼Œä¸€æ—¦ä½¿ç”¨çš„ç›®æ ‡æ–‡ä»¶æ¨¡å—æ›´æ–°ï¼Œæ‰€æœ‰ç”¨åˆ°çš„ç¨‹åºå°±å¾—é‡æ–°èŽ·å–æ–°ç‰ˆæœ¬ã€é‡æ–°é“¾æŽ¥ã€å†å‘å¸ƒæ–°ç¨‹åºã€‚ åŠ¨æ€é“¾æŽ¥ï¼ˆDynamic Linkingï¼‰ä¼˜ç‚¹ï¼š æŠŠç¨‹åºçš„æ¨¡å—ç›¸äº’åˆ†å‰²å¼€æ¥ï¼Œå½¢æˆç‹¬ç«‹çš„æ–‡ä»¶ï¼Œä¸å¯¹é‚£äº›ç»„æˆç¨‹åºçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æŽ¥ï¼Œç­‰åˆ°ç¨‹åºè¿è¡Œæ—¶æ‰é“¾æŽ¥ï¼›ï¼ˆè§£å†³å ç”¨ç£ç›˜ç©ºé—´é—®é¢˜ï¼‰ è‹¥æœ‰ç¨‹åºå·²åŠ è½½å¹¶åŠ¨æ€é“¾æŽ¥äº†æ‰€éœ€çš„ç›®æ ‡æ–‡ä»¶ï¼Œä¸‹ä¸€ä¸ªå¤ç”¨è¯¥ç›®æ ‡æ–‡ä»¶çš„ç¨‹åºåŠ è½½æ—¶ï¼Œå°±æ— éœ€é‡å¤åŠ è½½æ­¤ç›®æ ‡æ–‡ä»¶ï¼Œåªè¦é“¾æŽ¥å°±è¡Œäº†ï¼›ï¼ˆè§£å†³å ç”¨å†…å­˜ç©ºé—´é—®é¢˜ï¼‰ è¿˜å‡å°‘äº†ç‰©ç†é¡µçš„æ¢å…¥æ¢å‡ºï¼Œå¢žåŠ äº†CPUçš„ç¼“å­˜å‘½ä¸­çŽ‡ï¼Œä¹Ÿè§£å†³äº†æ¨¡å¼å‡çº§éš¾çš„é—®é¢˜ï¼› è¿è¡Œæ—¶å¯åŠ¨æ€åŠ è½½å„ç§ç¨‹åºæ¨¡å—ï¼ŒåŽæ¥è¢«ç”¨æ¥åˆ¶ä½œå„ç§æ’ä»¶ï¼ˆPlug-inï¼‰ï¼Œäº§å“å…¬å¸æŒ‰è§„åˆ™åˆ¶å®šå¥½ç¨‹åºçš„æŽ¥å£ï¼Œå…¶å®ƒå…¬å¸æˆ–å¼€å‘è€…æŒ‰è¿™ç§æŽ¥å£ç¼–å†™ç¬¦åˆè¦æ±‚çš„åŠ¨æ€é“¾æŽ¥æ–‡ä»¶ï¼› åŠ å¼ºç¨‹åºçš„å…¼å®¹æ€§ï¼ŒåŠ¨æ€é“¾æŽ¥åº“ç›¸å½“äºŽåœ¨ç¨‹åºå’Œæ“ä½œç³»ç»Ÿä¹‹é—´å¢žåŠ äº†ä¸€ä¸ªä¸­é—´å±‚ã€‚ è€ŒåŠ¨æ€é“¾æŽ¥çš„ç¼ºç‚¹æ˜¯ï¼Œå½“ç¨‹åºæ‰€ä¾èµ–çš„æŸä¸ªæ¨¡å—æ›´æ–°åŽï¼Œç”±äºŽæ–°çš„æ¨¡å—ä¸Žæ—§çš„æ¨¡å—ä¹‹é—´æŽ¥å£ä¸å…¼å®¹ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•è¿è¡Œï¼Œæ‰€ä»¥éžå¤§ç‰ˆæœ¬æ›´æ–°æ—¶å°±éœ€ä¸€ç›´åšå‘åŽå…¼å®¹ã€‚ ELFåŠ¨æ€é“¾æŽ¥æ–‡ä»¶ç§°ä¸ºåŠ¨æ€å…±äº«å¯¹è±¡ï¼ˆDSOï¼ŒDynamic Shared Objectsï¼‰ï¼Œå³å…±äº«å¯¹è±¡ï¼Œä¸€èˆ¬æ˜¯.soæ ¼å¼æ–‡ä»¶ï¼ŒWindowsä¸‹æ˜¯åŠ¨æ€é“¾æŽ¥åº“ï¼ˆDynamic Linking Libraryï¼‰ï¼Œä¸€èˆ¬æ˜¯.dllæ ¼å¼æ–‡ä»¶ã€‚ ç¨‹åºè¢«è£…è½½æ—¶éƒ½è¦è¿›è¡Œé‡æ–°é“¾æŽ¥ï¼Œæ‰€ä»¥ï¼ŒåŠ¨æ€é“¾æŽ¥ä¼šå¯¼è‡´ç¨‹åºåœ¨æ€§èƒ½çš„ä¸€äº›æŸå¤±ï¼ˆ5%å·¦å³ï¼Œå¯¹æ¯”é‡å¤åœ°æµªè´¹å†…å­˜å’Œç£ç›˜ç©ºé—´æ˜¯å€¼å¾—çš„ï¼‰ï¼Œä½†æœ‰äº›ä¼˜åŒ–æ–¹æ³•å¯å‡å°ï¼šæ¯”å¦‚å»¶è¿Ÿç»‘å®šï¼ˆLazy Bindingï¼‰ã€‚ä»Žè€Œæ¢å–ç¨‹åºçš„ç©ºé—´èŠ‚çœå’Œæž„å»ºã€å‡çº§æ—¶çš„çµæ´»æ€§ã€‚ ä¾‹å­ç¼–è¯‘æˆå…±äº«å¯¹è±¡ï¼š $gcc -fPIC -shared -o Lib.so Lib.cç¼–è¯‘é“¾æŽ¥ï¼š $gcc -o Program Program.c ./Lib.soLib.soä¹Ÿå‚ä¸Žé“¾æŽ¥æ˜¯å› ä¸ºï¼Œé“¾æŽ¥å™¨éœ€è¦æŠŠå®šä¹‰åœ¨åŠ¨æ€å…±äº«å¯¹è±¡ä¸­çš„å‡½æ•°ç¬¦å·çš„å¼•ç”¨æ ‡è®°ä¸ºä¸€ä¸ªåŠ¨æ€é“¾æŽ¥çš„ç¬¦å·ï¼Œä½†ä¸ä¼šå¯¹å®ƒè¿›è¡Œåœ°å€é‡å®šä½ï¼ŒæŠŠè¿™ä¸ªè¿‡ç¨‹ç•™åˆ°è£…è½½çš„æ—¶å†è¿›è¡Œã€‚è¦ä¸é“¾æŽ¥é™æ€åº“é‡å®šä½å‡ºå¤–éƒ¨å¼•ç”¨çš„å‡½æ•°åœ°å€ï¼Œè¦ä¸é“¾æŽ¥åŠ¨æ€åº“æ ‡è®°ä¸ºåŠ¨æ€é“¾æŽ¥ç¬¦å·ï¼Œè¦ä¸å°±ç¼–è¯‘æŠ¥é”™äº†ã€‚ ã€å›¾ã€‘åŠ¨æ€é“¾æŽ¥è¿‡ç¨‹ æŸ¥çœ‹è™šæ‹Ÿåœ°å€ç©ºé—´åˆ†å¸ƒï¼ˆå¯æŸ¥çœ‹åˆ°å¯¹åŠ¨æ€å…±äº«å¯¹è±¡çš„å¼•ç”¨ï¼‰ï¼š $./Program &amp; [1] xxxxx printing from Lib.so 1 $cat /proc/xxxxx/maps $kill xxxxxä¸€èˆ¬ä¼šåŒ…æ‹¬åŠ¨æ€é“¾æŽ¥å™¨ld.soã€Cè¯­è¨€è¿è¡Œåº“libc.so æŸ¥çœ‹åŠ¨æ€å…±äº«å¯¹è±¡çš„è£…è½½å±žæ€§ï¼š $readelf -l Lib.soåŠ¨æ€é“¾æŽ¥æ¨¡å—çš„è£…è½½åœ°å€æ˜¯ä»Ž0x00000000å¼€å§‹çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— æ•ˆåœ°å€ï¼Œå…±äº«å¯¹è±¡çš„æœ€ç»ˆè£…è½½åœ°å€åœ¨ç¼–è¯‘æ—¶æ˜¯ä¸ç¡®å®šçš„ã€‚ åœ°å€æ— å…³ä»£ç ä¸Šä¸€ç‚¹æåˆ°ï¼Œå…±äº«å¯¹è±¡çš„è£…è½½èµ·å§‹åœ°å€ä¸æ˜¯ä¸€å¼€å§‹å°±å›ºå®šçš„ï¼ˆä¸Žå¯æ‰§è¡Œæ–‡ä»¶ä¸åŒï¼‰ï¼Œä¸ºç®¡ç†å…±äº«æ¨¡å—çš„åœ°å€åˆ†é…ï¼Œè¦æ‰‹å·¥åˆ†é…çš„ç§°ä¸ºé™æ€å…±äº«åº“ï¼Œä¼šæœ‰ä»¥ä¸‹é—®é¢˜ï¼š åœ°å€å†²çªï¼› é™æ€å…±äº«åº“çš„å‡çº§åŽï¼Œä¼šäº§ç”Ÿå…¨å±€å‡½æ•°å’Œå˜é‡åœ°å€å˜åŒ–ï¼› æ‰€ä»¥å…±äº«å¯¹è±¡åœ¨ç¼–è¯‘æ—¶ä¸èƒ½å‡è®¾è‡ªå·±åœ¨è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„ä½ç½®ã€‚ ä¸€ä¸ªç¨‹åºåœ¨ç¼–è¯‘æ—¶å‡è®¾è¢«è£…è½½çš„ç›®æ ‡åœ°å€ä¸º0x1000ï¼Œä½†åœ¨è£…è½½æ—¶æ“ä½œç³»ç»Ÿå‘çŽ°0x1000è¿™ä¸ªåœ°å€å·²ç»è¢«åˆ«çš„ç¨‹åºä½¿ç”¨äº†ï¼Œä»Ž0x4000å¼€å§‹æœ‰ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´å¯ä»¥å®¹çº³è¯¥ç¨‹åºï¼Œé‚£ä¹ˆè¯¥ç¨‹åºå°±å¯ä»¥è¢«è£…è½½è‡³0x4000ï¼Œç¨‹åºæŒ‡ä»¤æˆ–æ•°æ®ä¸­çš„æ‰€æœ‰ç»å¯¹å¼•ç”¨åªè¦éƒ½åŠ ä¸Š0x3000çš„åç§»ï¼Œè¿™å°±æ˜¯è£…è½½æ—¶é‡å®šä½ï¼ˆLoad Time Relocationï¼‰ï¼Œè§£å†³äº†åŠ¨æ€æ¨¡å—ä¸­æœ‰ç»å¯¹åœ°å€å¼•ç”¨çš„é—®é¢˜ï¼Œä½†æŒ‡ä»¤éƒ¨åˆ†æ— æ³•åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´å…±äº«ï¼ˆå› ä¸ºè¿›ç¨‹ä¹‹é—´ç›¸äº’ä¸çŸ¥é“æŒ‡ä»¤åœ¨å…¶å®ƒè¿›ç¨‹è£…è½½é‡å®šä½çš„åœ°å€ï¼Œæ‰€ä»¥åªèƒ½å’Œæ•°æ®ä¸€æ ·ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸­æŒ‰ä¸Šè¿°è§„åˆ™äº§ç”Ÿäº†å‰¯æœ¬ï¼‰ã€‚ $gcc -fPIC -shared -o Lib.so Lib.cä¸Šé¢è¿™ä¸ªæŒ‡ä»¤ä¸­ï¼Œ-fPICä»£è¡¨ä½¿ç”¨åœ°å€æ— å…³ä»£ç æŠ€æœ¯ï¼Œå¦åˆ™ä½¿ç”¨è£…è½½æ—¶é‡å®šä½ã€‚ åœ°å€æ— å…³ä»£ç ï¼ˆPICï¼ŒPosition-independent Codeï¼‰ï¼Œæ˜¯è¦ä½¿ç¨‹åºæ¨¡å—ä¸­å…±äº«çš„æŒ‡ä»¤éƒ¨åˆ†åœ¨è£…è½½æ—¶ä¸éœ€è¦å› ä¸ºè£…è½½åœ°å€æ”¹å˜è€Œæ”¹å˜ï¼ŒæŠŠæŒ‡ä»¤ä¸­çš„é‚£äº›éœ€è¦è¢«ä¿®æ”¹çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ï¼Œå’Œæ•°æ®éƒ¨åˆ†æ”¾ä¸€èµ·ï¼Œæ•°æ®éƒ¨åˆ†åœ¨æ¯ä¸ªè¿›ç¨‹ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œè¿™æ ·æŒ‡ä»¤éƒ¨åˆ†å°±å¯ä¿æŒä¸å˜äº†ã€‚ æœ‰4ç§å¯»å€æ¨¡å¼ï¼š æ¨¡å—å†…éƒ¨è°ƒç”¨æˆ–è·³è½¬ï¼Œåˆ©ç”¨ç›¸å¯¹åç§»è°ƒç”¨æŒ‡ä»¤å®žçŽ°ï¼› æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®ï¼Œåˆ©ç”¨å½“å‰æŒ‡ä»¤åœ°å€ï¼ˆPCï¼‰åŠ åç§»é‡å®žçŽ°ï¼›ï¼ˆèŽ·å–PCé€šè¿‡è°ƒç”¨__i686.get_pc_thunk.cxå‡½æ•°ï¼ŒæŠŠè¿”å›žåœ°å€ï¼Œå³æŠŠcallçš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€æ”¾åˆ°ecxå¯„å­˜å™¨ï¼Œé‚£å°±æ˜¯å½“å‰PCäº†ï¼‰ æ¨¡å—é—´æ•°æ®è®¿é—®ï¼Œå…¶å®ƒæ¨¡å—çš„å…¨å±€å˜é‡çš„åœ°å€æ˜¯è·Ÿæ¨¡å—çš„è£…è½½åœ°å€æœ‰å…³ï¼Œå› ä¸ºELFçš„æ•°æ®æ®µé‡Œé¢å»ºç«‹äº†ä¸€ä¸ªæŒ‡å‘è¿™äº›å˜é‡çš„æŒ‡é’ˆæ•°ç»„ï¼Œå³å…¨å±€åç§»è¡¨ï¼ˆGlobal Offset Tableï¼ŒGOTï¼‰ï¼Œå½“ä»£ç éœ€è¦å¼•ç”¨è¿™äº›å…¨å±€å˜é‡æ—¶ï¼Œé€šè¿‡GOTä¸­ç›¸åº”çš„é¡¹é—´æŽ¥å¼•ç”¨ï¼Œæ¯ä¸ªå˜é‡éƒ½å¯¹åº”ä¸€ä¸ª4ä¸ªå­—èŠ‚çš„åœ°å€ï¼Œé“¾æŽ¥å™¨åœ¨è£…è½½æ¨¡å—çš„æ—¶å€™ä¼šæŸ¥æ‰¾æ¯ä¸ªå˜é‡æ‰€åœ¨çš„åœ°å€ï¼Œç„¶åŽå¡«å……GOTä¸­çš„å„ä¸ªé¡¹ã€‚ç”±äºŽGOTæ”¾åœ¨æ•°æ®æ®µï¼Œæ‰€ä»¥å¯åœ¨è£…è½½æ—¶å†è¢«ä¿®æ”¹ï¼Œå¹¶æ¯ä¸ªè¿›ç¨‹éƒ½å¯ä»¥æœ‰ç‹¬ç«‹çš„å‰¯æœ¬äº’ä¸å½±å“ï¼› æ¨¡å—é—´è°ƒç”¨æˆ–è·³è½¬ï¼Œç›®æ ‡å‡½æ•°çš„åœ°å€ä¿å­˜åœ¨GOTä¸­ï¼Œè°ƒç”¨æ—¶é€šè¿‡GOTä¸­çš„é¡¹è¿›è¡Œé—´æŽ¥è·³è½¬ï¼ˆå…ˆå¾—åˆ°å½“å‰æŒ‡ä»¤åœ°å€PCï¼Œç„¶åŽåŠ ä¸Šåç§»å€¼å¾—åˆ°å‡½æ•°æ‰€åœ¨GOTä¸­çš„åç§»ã€‚è¿™æ ·æ‰€å¼•ç”¨çš„å¤–éƒ¨æ¨¡å—å‡½æ•°å°±ä¹Ÿæ˜¯åœ°å€æ— å…³çš„ï¼Œç›¸å¯¹åœ°æ ¹æ®åç§»æ‰¾åˆ°GOTä¸­åœ¨åŠ¨æ€é“¾æŽ¥åŽåŠ è½½çš„å…¶å®ƒæ¨¡å—çš„ç›®æ ‡å‡½æ•°æ‰€åœ¨åœ°å€ï¼‰ã€‚ å¤§å†™çš„-fPICæ˜¯æ²¡æœ‰ç¡¬ä»¶å¹³å°çš„é™åˆ¶çš„ï¼Œå°å†™çš„-fpicåˆ™å­˜åœ¨æŸäº›å¹³å°ä¸Šæœ‰é™åˆ¶ï¼Œä¾‹å¦‚å…¨å±€ç¬¦å·çš„æ•°é‡æˆ–è€…ä»£ç çš„é•¿åº¦ã€‚ åŒºåˆ†æ˜¯å¦PICçš„æŒ‡ä»¤ï¼š readelf -d foo.so | grep TEXTRELPICæ˜¯ä¸åŒ…å«ä»£ç é‡å®šä½è¡¨çš„ã€‚ ELFå…±äº«åº“åœ¨ç¼–è¯‘æ—¶ï¼Œé»˜è®¤éƒ½æŠŠå®šä¹‰åœ¨æ¨¡å—å†…éƒ¨çš„å…¨å±€å˜é‡å½“ä½œå®šä¹‰åœ¨å…¶ä»–æ¨¡å—çš„å…¨å±€å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ä½œå‰é¢çš„â€œæ¨¡å—é—´è°ƒç”¨æˆ–è·³è½¬â€ï¼Œé€šè¿‡GOTæ¥å®žçŽ°å˜é‡çš„è®¿é—®ï¼Œå½“å…±äº«æ¨¡å—è¢«è£…è½½æ—¶ï¼Œå¦‚æžœæŸä¸ªå…¨å±€å˜é‡åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ‹¥æœ‰å‰¯æœ¬ï¼Œé‚£ä¹ˆåŠ¨æ€é“¾æŽ¥å™¨å°±ä¼šæŠŠGOTä¸­çš„ç›¸åº”åœ°å€æŒ‡å‘è¯¥å‰¯æœ¬ï¼Œè¿™æ ·æ­¤å˜é‡åœ¨è¿è¡Œæ—¶å®žé™…ä¸Šæœ€ç»ˆå°±åªæœ‰ä¸€ä¸ªå®žä¾‹ã€‚ å¤šäº†GOTä¸­é—´ä¸€å±‚çš„å¯»å€ï¼Œé€Ÿåº¦ä¼šæ¯”è£…è½½æ—¶é‡å®šä½çš„å…±äº«å¯¹è±¡è¿è¡Œé€Ÿåº¦æ…¢ï¼Œä½†GCCé»˜è®¤ä¼šä½¿ç”¨PICæ–¹å¼æ¥åŠ¨æ€é“¾æŽ¥å¯æ‰§è¡Œæ–‡ä»¶çš„ä»£ç éƒ¨åˆ†ï¼Œä»¥ä¾¿ä¸åŒçš„è¿›ç¨‹èƒ½å…±äº«ä»£ç æ®µï¼ŒèŠ‚çœå†…å­˜ï¼ˆå­˜åœ¨.gotè¿™æ ·çš„æ®µï¼‰ã€‚ å»¶è¿Ÿç»‘å®šï¼ˆPLTï¼‰è¦è§£å†³åŠ¨æ€é“¾æŽ¥ã€ï¼ˆå…¨å±€å’Œé™æ€æ•°æ®ã€æ¨¡å—é—´è°ƒç”¨çš„ï¼‰GOTå®šä½æ…¢ã€é—´æŽ¥å¯»å€ç­‰çš„é€Ÿåº¦é—®é¢˜ï¼ŒELFé‡‡ç”¨äº†ä¸€ç§å«å»¶è¿Ÿç»‘å®šï¼ˆLazy Bindingï¼‰çš„æ€è·¯ï¼Œå½“å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨åˆ°æ—¶æ‰è¿›è¡Œç»‘å®šï¼ˆç¬¦å·æŸ¥æ‰¾ã€é‡å®šä½ç­‰ï¼‰ï¼Œå®žçŽ°æ–¹æ³•æ˜¯PLTï¼ˆProcedure Linkage Tableï¼‰ï¼š é“¾æŽ¥å™¨åˆå§‹åŒ–é˜¶æ®µï¼Œæ²¡æœ‰å¡«å…¥å‡½æ•°çš„åœ°å€ï¼Œä¸éœ€æŸ¥æ‰¾ç¬¦å·ï¼Œåªæ˜¯å°†ç¬¦å·å¼•ç”¨åœ¨é‡å®šä½è¡¨â€œ.rel.pltâ€çš„ä¸‹æ ‡å’Œæ¨¡å—IDåŽ‹å…¥å †æ ˆï¼Œç„¶åŽè°ƒç”¨_dl_runtime_resolve()æ¥å®Œæˆç¬¦å·è§£æžå’Œé‡å®šä½ã€‚ .gotä¿å­˜å…¨å±€å˜é‡å¼•ç”¨çš„åœ°å€ï¼Œ.got.pltä¿å­˜å‡½æ•°å¼•ç”¨çš„åœ°å€ .got.pltä¿å­˜çš„å‰ä¸‰é¡¹ï¼ˆå»¶è¿Ÿç»‘å®šæ‰€éœ€çš„ä¸€äº›ä¿¡æ¯ï¼‰ï¼Œä¸ºç³»ç»Ÿæ‰€ç”¨ï¼ŒåŒ…æ‹¬ .dynamicæ®µçš„åœ°å€ æœ¬æ¨¡å—çš„IDï¼ˆåŠ¨æ€è£…è½½æ—¶è¢«åˆå§‹åŒ–ï¼‰ _dl_runtime_resolve()çš„åœ°å€ï¼ˆåŠ¨æ€è£…è½½æ—¶è¢«åˆå§‹åŒ–ï¼‰ã€‚ pltæ®µæœ¬èº«ä¹Ÿæ˜¯åœ°å€æ— å…³çš„ä»£ç ï¼Œæ‰€ä»¥å¯è·Ÿä»£ç ç­‰ä¸€èµ·åˆå¹¶æˆåŒä¸€ä¸ªå¯è¯»å¯æ‰§è¡Œçš„â€œSegmentâ€è¢«è£…è½½å…¥å†…å­˜ã€‚ åŠ¨æ€é“¾æŽ¥ç›¸å…³ç»“æž„åŠ¨æ€é“¾æŽ¥å™¨ï¼ˆDynamic Linkerï¼‰å®žé™…ä¸Šæ˜¯ä¸€ä¸ªå…±äº«å¯¹è±¡ã€‚ .interpæ®µï¼Œè§£é‡Šå™¨ï¼Œä¿å­˜éœ€è¦çš„åŠ¨æ€é“¾æŽ¥å™¨çš„è·¯å¾„ã€‚æŸ¥çœ‹æŒ‡ä»¤objdump -s a.out .dynamicæ®µï¼Œä¿å­˜åŠ¨æ€é“¾æŽ¥å™¨æ‰€éœ€è¦çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¯ä»¥çœ‹ä½œæ˜¯åŠ¨æ€é“¾æŽ¥ä¸‹ELFæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼ŒæŒ‡ç¤ºä¾èµ–å“ªäº›å…±äº«å¯¹è±¡ã€åŠ¨æ€é“¾æŽ¥ç¬¦å·è¡¨çš„ä½ç½®ã€åŠ¨æ€é“¾æŽ¥é‡å®šä½è¡¨çš„ä½ç½®ã€å…±äº«å¯¹è±¡åˆå§‹åŒ–ä»£ç çš„åœ°å€ç­‰ï¼Œç»“æž„ä¸ºElf32_Dynï¼Œd_tagå¯¹åº”çš„å«ä¹‰ï¼š DT_SYMTABï¼ŒåŠ¨æ€é“¾æŽ¥ç¬¦å·è¡¨åœ°å€ DT_STRTABï¼ŒåŠ¨æ€é“¾æŽ¥å­—ç¬¦ä¸²è¡¨åœ°å€ DT_STRSZï¼ŒåŠ¨æ€é“¾æŽ¥å­—ç¬¦ä¸²è¡¨å¤§å° DT_HASHï¼ŒåŠ¨æ€é“¾æŽ¥å“ˆå¸Œè¡¨åœ°å€ DT_SONAMEï¼Œæœ¬å…±äº«å¯¹è±¡çš„â€œSO-NAMEâ€ DT_RPATHï¼ŒåŠ¨æ€é“¾æŽ¥å…±äº«å¯¹è±¡æœç´¢è·¯å¾„ DT_INITï¼Œåˆå§‹åŒ–ä»£ç åœ°å€ DT_FINITï¼Œç»“æŸä»£ç åœ°å€ DT_NEEDï¼Œä¾èµ–çš„å…±äº«å¯¹è±¡æ–‡ä»¶(å) DT_REL DT_RELAï¼ŒåŠ¨æ€é“¾æŽ¥é‡å®šä½è¡¨åœ°å€ DT_RELENT DT_RELAENTï¼ŒåŠ¨æ€é‡å®šä½è¡¨å…¥å£æ•°é‡ æŸ¥çœ‹.dynamicæ®µçš„å†…å®¹ï¼š $readelf -d Lib.soæŸ¥çœ‹ä¸»æ¨¡å—æˆ–å…±äº«åº“ä¾èµ–äºŽå“ªäº›å…±äº«åº“ï¼š $ldd Program1æŸ¥çœ‹åŠ¨æ€ç¬¦å·è¡¨åŠå…¶å“ˆå¸Œè¡¨(ç”¨äºŽæ›´å¿«åœ°æŸ¥æ‰¾ç¬¦å·)ï¼š $readelf -sD Lib.soPICæ¨¡å¼çš„å…±äº«å¯¹è±¡ä¹Ÿéœ€è¦é‡å®šä½ï¼Œè™½ç„¶ä»£ç æ®µä¸éœ€è¦é‡å®šä½ï¼Œä½†æ•°æ®æ®µåŒ…å«äº†ç»å¯¹åœ°å€çš„å¼•ç”¨ï¼ˆä»£ç æ®µä¸­çš„ç»å¯¹åœ°å€ç›¸å…³éƒ¨åˆ†è¢«åˆ†ç¦»æˆGOTï¼Œè€ŒGOTå®žé™…ä¸Šæ—¶æ•°æ®æ®µçš„ä¸€éƒ¨åˆ†ï¼‰ã€‚åƒ.rel.dynå®žé™…ä¸Šæ˜¯å¯¹.gotå’Œæ•°æ®æ®µçš„æ•°æ®å¼•ç”¨çš„ä¿®æ­£ï¼Œ.rel.pltæ˜¯å¯¹å‡½æ•°å¼•ç”¨çš„ä¿®æ­£ï¼Œä½äºŽ.got.pltã€‚ æŸ¥çœ‹åŠ¨æ€é“¾æŽ¥æ–‡ä»¶çš„é‡å®šä½è¡¨ï¼š $readelf -r Lib.so $readelf -S Lib.soGLOB_DATå’ŒJUMP_SLOTæ­¤ä¸¤ç§é‡å®šä½å…¥å£ç±»åž‹è¡¨ç¤ºï¼Œå½“åŠ¨æ€é“¾æŽ¥å™¨éœ€è¦é‡å®šä½æ—¶ï¼ˆå¯èƒ½è¢«å»¶è¿Ÿï¼‰ï¼Œå…ˆæ‰¾åˆ°å‡½æ•°ç¬¦å·åœ¨å…¨å±€ç¬¦å·è¡¨ä¸­çš„åœ°å€ï¼Œç„¶åŽç›´æŽ¥å°†å…¶å¡«å…¥.got.pltä¸­å¯¹åº”åç§»çš„ä½ç½®ä¸Šï¼ˆå³è¢«ä¿®æ­£çš„ä½ç½®ï¼‰ã€‚è€ŒRELATIVEåˆ™å¿…é¡»åœ¨è£…è½½æ—¶è¿›è¡Œé‡å®šä½ï¼Œå³åŸºå€é‡ç½®Rebasingï¼Œå› ä¸ºå…¶åŒ…å«ç»å¯¹åœ°å€çš„å¼•ç”¨ï¼Œä¸€èˆ¬æ˜¯æ•°æ®æ®µçš„éƒ¨åˆ†ã€‚ PICæ¨¡å¼ç¼–è¯‘çš„ELFæ–‡ä»¶ï¼Œè°ƒç”¨äº†ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼Œåˆ™å‡½æ•°ä¼šå‡ºçŽ°åœ¨.rel.pltä¸­ï¼Œè€Œå¦‚æžœä¸æ˜¯PICæ¨¡å¼ç¼–è¯‘åˆ™å‡ºçŽ°åœ¨.rel.dynä¸­ã€‚ æœ€åŽï¼Œåœ¨åŠ¨æ€é“¾æŽ¥æ—¶ï¼Œè¿›ç¨‹å †æ ˆä¼šä¿å­˜åŠ¨æ€é“¾æŽ¥å™¨æ‰€éœ€çš„ä¸€äº›è¾…åŠ©ä¿¡æ¯æ•°ç»„ï¼ˆAuxiliary Vectorï¼‰ï¼Œå®ƒä½äºŽçŽ¯å¢ƒå˜é‡æŒ‡é’ˆçš„åŽé¢ï¼ˆæ›´é«˜ä½çš„å†…å­˜åœ°å€ä¸Šï¼‰ åŠ¨æ€é“¾æŽ¥çš„æ­¥éª¤å’Œå®žçŽ° åŠ¨æ€é“¾æŽ¥å™¨æœ¬èº«ä¸å¯ä»¥ä¾èµ–äºŽå…¶ä»–ä»»ä½•å…±äº«å¯¹è±¡ï¼› åŠ¨æ€é“¾æŽ¥å™¨æœ¬èº«æ‰€éœ€è¦çš„å…¨å±€å’Œé™æ€å˜é‡çš„é‡å®šä½å·¥ä½œç”±å®ƒæœ¬èº«å®Œæˆï¼Œå³è‡ªä¸¾ï¼ˆBootstrapï¼‰ã€‚å½“æ“ä½œç³»ç»Ÿå°†è¿›ç¨‹æŽ§åˆ¶æƒäº¤ç»™åŠ¨æ€é“¾æŽ¥å™¨æ—¶å¼€å§‹æ‰§è¡Œï¼Œè°ƒç”¨è¿™äº›å˜é‡ç”šè‡³å‡½æ•°å‰è¦å…ˆç­‰è‡ªä¸¾å®Œæˆï¼ŒåŒ…æ‹¬è‡ªä¸¾å†…éƒ¨ä¹Ÿä¸èƒ½è°ƒç”¨ã€‚ å…ˆæ‰¾å‡ºè‡ªå·±çš„GOT å†æ‰¾å‡º.dynamicæ®µ é€šè¿‡é‡å®šä½è¡¨å’Œç¬¦å·è¡¨ï¼Œå¾—åˆ°æœ¬èº«çš„é‡å®šä½å…¥å£ï¼Œè¿›è¡Œé‡å®šä½ã€‚ è‡ªä¸¾åŽï¼Œå¯æ‰§è¡Œæ–‡ä»¶å’Œé“¾æŽ¥å™¨æœ¬èº«çš„ç¬¦å·è¡¨å°±åˆå¹¶åˆ°å…¨å±€ç¬¦å·è¡¨ï¼ˆGlobal Symbol Tableï¼‰ã€‚ç„¶åŽæ ¹æ®.dynamicä¸­çš„DT_NEEDEDå…¥å£ç±»åž‹æ‰¾å‡ºä¾èµ–çš„å…±äº«å¯¹è±¡ï¼Œæ”¾å…¥åˆ°ä¸€ä¸ªè£…è½½é›†åˆä¸­ï¼Œä¹‹åŽé€šè¿‡ä¸€èˆ¬çš„å¹¿åº¦ä¼˜å…ˆç®—æ³•è¿›è¡ŒéåŽ†é›†åˆä¸­ä¾èµ–çš„å…±äº«å¯¹è±¡ï¼Œè¯»å–ç›¸åº”çš„ELFæ–‡ä»¶å¤´å’Œ.dynamicæ®µè¿›è¡Œä»£ç æ®µå’Œæ•°æ®æ®µçš„ç©ºé—´æ˜ å°„ã€‚ æŒ‡å®šå¯»å€å…±äº«å¯¹è±¡çš„è·¯å¾„ï¼š $gcc main.c b1.so b2.so -o main -Xlinker -rpath ./å½“é‡åˆ°ä¾èµ–çš„å…±äº«å¯¹è±¡ä¸­ï¼Œå­˜åœ¨é‡åç¬¦å·çš„æƒ…å†µæ—¶ï¼Œä¼šå‡ºçŽ°å…±äº«å¯¹è±¡é‡Œé¢çš„å…¨å±€ç¬¦å·è¢«å¦ä¸€ä¸ªå…±äº«å¯¹è±¡çš„åŒåå…¨å±€ç¬¦å·è¦†ç›–ï¼Œæ­¤ç§°ä¸ºå…¨å±€ç¬¦å·ä»‹å…¥ï¼ˆGlobal Symbol Interposeï¼‰ï¼Œå®ƒéµå¾ªçš„è§„åˆ™æ˜¯ï¼Œå½“ä¸€ä¸ªç¬¦å·éœ€è¦è¢«åŠ å…¥å…¨å±€ç¬¦å·è¡¨æ—¶ï¼Œå¦‚æžœç›¸åŒçš„ç¬¦å·åå·²ç»å­˜åœ¨ï¼Œåˆ™åŽé¢åŠ å…¥çš„ç¬¦å·è¢«å¿½ç•¥ã€‚ ç„¶åŽï¼Œé“¾æŽ¥å™¨å¼€å§‹é‡æ–°éåŽ†å¯æ‰§è¡Œæ–‡ä»¶å’Œå…±äº«å¯¹è±¡çš„é‡å®šä½è¡¨ï¼Œå°†ä»–ä»¬GOT/PLTä¸­æ¯ä¸ªéœ€è¦é‡å®šä½çš„ä½ç½®è¿›è¡Œä¿®æ­£ã€‚ å®Œæˆé‡å®šä½åŽï¼Œå¦‚æžœå…±äº«å¯¹è±¡æœ‰.initæ®µåˆ™é“¾æŽ¥å™¨æ‰§è¡Œä¹‹å®žçŽ°åˆå§‹åŒ–ï¼Œå¦‚æœ‰.finitæ®µåˆ™åœ¨ç¨‹åºé€€å‡ºæ—¶æ‰§è¡Œã€‚å¯æ‰§è¡Œæ–‡ä»¶çš„.initå’Œ.finitåˆ™ç”±ç¨‹åºæ¥æ‰§è¡Œã€‚ æœ€åŽè¿›ç¨‹çš„æŽ§åˆ¶æƒè½¬äº¤ç»™ç¨‹åºçš„å…¥å£å¹¶ä¸”å¼€å§‹æ‰§è¡Œã€‚ é“¾æŽ¥å™¨æ—¢æ˜¯ä¸€ä¸ªå…±äº«å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªELFå¯æ‰§è¡Œç¨‹åºã€‚å¯¹äºŽåŠ¨æ€é“¾æŽ¥çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå†…æ ¸ï¼ˆexecve()ï¼‰ä¼šåˆ†æžå®ƒçš„åŠ¨æ€é“¾æŽ¥å™¨åœ°å€ï¼ˆåœ¨.interpæ®µï¼‰ï¼Œå°†åŠ¨æ€é“¾æŽ¥å™¨æ˜ å°„è‡³è¿›ç¨‹åœ°å€ç©ºé—´ï¼ŒæŠŠæŽ§åˆ¶æƒäº¤ç»™å®ƒï¼ŒåŽ»è£…è½½ä¾èµ–çš„å…±äº«åº“ã€‚(å…¥å£åœ°å€åœ¨æ²¡æœ‰.interpå°±æ˜¯ELFçš„e_entryï¼Œæœ‰åˆ™æ˜¯åŠ¨æ€é“¾æŽ¥å™¨çš„e_entry) åŠ¨æ€é“¾æŽ¥å™¨å…¥å£ï¼ˆæ‰§è¡Œé¡ºåºï¼‰ï¼š _start() _dl_start()é‡å®šä½/è‡ªä¸¾ _dl_start_final()æ”¶é›†åŸºæœ¬çš„è¿è¡Œæ•°å€¼ _dl_sysdep_startè¿›è¡Œå¹³å°ç›¸å…³çš„å¤„ç† _dl_main()å¯¹ç¨‹åºä¾èµ–çš„å…±äº«å¯¹è±¡è¿›è¡Œè£…è½½ã€‚ æ˜¾å¼è¿è¡Œæ—¶é“¾æŽ¥æ˜¾ç¤ºè¿è¡Œæ—¶é“¾æŽ¥ï¼ˆExplicit Run-time Linkingï¼‰ï¼Œä¹Ÿå«è¿è¡Œæ—¶åŠ è½½ï¼Œå°±æ˜¯è®©ç¨‹åºè‡ªå·±åœ¨è¿è¡Œæ—¶æŽ§åˆ¶åŠ è½½æŒ‡å®šçš„æ¨¡å—ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸éœ€è¦è¯¥æ¨¡å—æ—¶å°†å…¶å¸è½½ã€‚èƒ½è¢«è¿™æ ·æ“ä½œçš„å…±äº«å¯¹è±¡å«åšåŠ¨æ€è£…è½½åº“ï¼ˆDynamic Loading Libraryï¼‰ã€‚ å½“ç¨‹åºéœ€è¦ç”¨åˆ°æŸä¸ªæ’ä»¶æˆ–è€…é©±åŠ¨çš„æ—¶å€™ï¼Œæ‰å°†ç›¸åº”çš„æ¨¡å—è£…è½½è¿›æ¥ï¼Œè€Œä¸éœ€è¦ä»Žä¸€å¼€å§‹å°±å°†ä»–ä»¬å…¨éƒ¨è£…è½½è¿›æ¥ï¼Œä»Žè€Œå‡å°‘äº†ç¨‹åºå¯åŠ¨æ—¶é—´å’Œå†…å­˜ä½¿ç”¨ã€‚å¹¶ä¸”ç¨‹åºå¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™é‡æ–°åŠ è½½æŸä¸ªæ¨¡å—ï¼Œè¿™æ ·ä½¿å¾—ç¨‹åºæœ¬èº«ä¸å¿…é‡æ–°å¯åŠ¨è€Œå®žçŽ°æ¨¡å—çš„å¢žåŠ ã€åˆ é™¤ã€æ›´æ–°ç­‰ã€‚ åŠ¨æ€åº“çš„è£…è½½é€šè¿‡ä¸€ç³»åˆ—åŠ¨æ€é“¾æŽ¥å™¨æä¾›çš„APIå®Œæˆï¼š dlopenï¼Œæ‰“å¼€åŠ¨æ€åº“ï¼Œå½“ç¬¬ä¸€ä¸ªå‚æ•°filenameè®¾ç½®ä¸º0æ—¶ï¼Œå‡½æ•°è¿”å›žå…¨å±€ç¬¦å·è¡¨çš„å¥æŸ„ï¼›ç¬¬äºŒä¸ªå‚æ•°flagè¡¨ç¤ºå‡½æ•°ç¬¦å·çš„è§£æžæ–¹å¼ï¼ŒåŒ…æ‹¬RTLD_LAZYå»¶è¿Ÿç»‘å®šï¼ŒRTLD_NOWæ¨¡å—è¢«åŠ è½½æ—¶å³å®Œæˆå‡½æ•°ç»‘å®šï¼›è¿”å›žå€¼æ˜¯è¢«åŠ è½½çš„æ¨¡å—çš„å¥æŸ„ï¼Œéœ€è¦æ‰‹å·¥å…ˆåŠ è½½å…¶å®ƒåµŒå¥—çš„ä¾èµ–åº“ã€‚ dlsymï¼ŒæŸ¥æ‰¾éœ€è¦çš„ç¬¦å·ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºdlopenè¿”å›žçš„å¥æŸ„ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æŸ¥æ‰¾çš„ç¬¦å·ï¼›è¿”å›žå€¼ï¼Œè‹¥æ‰¾çš„ç¬¦å·æ˜¯å‡½æ•°ï¼Œåˆ™è¿”å›žå‡½æ•°çš„åœ°å€ï¼Œå¦‚æžœæ˜¯å˜é‡ï¼Œåˆ™è¿”å›žå˜é‡çš„åœ°å€ï¼Œå¦‚æžœæ˜¯å¸¸é‡ï¼Œåˆ™è¿”å›žå¸¸é‡å€¼ã€‚ dlerrorï¼Œå¦‚æžœdlsymæ‰¾åˆ°ç¬¦å·ï¼Œåˆ™è¿”å›žNULLï¼Œå¦åˆ™è¿”å›žå¯¹åº”çš„é”™è¯¯ä¿¡æ¯ã€‚ dlcloseï¼Œå¸è½½å·²åŠ è½½çš„æ¨¡å—ï¼Œå…¶ä¸Ždlopenä¸€èµ·å…±åŒé€šè¿‡åŠ è½½è®¡æ•°å™¨ç®¡ç†æ¨¡å—è£…è½½çŠ¶æ€ï¼Œå¸è½½è¿‡ç¨‹æ˜¯å…ˆæ‰§è¡Œ.finitæ®µä»£ç ï¼Œç„¶åŽå°†ç›¸åº”ç¬¦å·ä»Žç¬¦å·è¡¨ä¸­åŽ»é™¤ï¼Œå–æ¶ˆè¿›ç¨‹ç©ºé—´è·Ÿæ¨¡å—çš„æ˜ å°„å…³ç³»ï¼Œæœ€åŽå…³é—­æ¨¡å—æ–‡ä»¶ã€‚ å¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤å‚è€ƒç¬¦å·è¡¨ï¼š $objdump -t å…±äº«åº“çš„ç»„ç»‡å…±äº«åº“ç‰ˆæœ¬å…±äº«åº“çš„æ›´æ–°åˆ†ä¸¤ç±»ï¼š å…¼å®¹æ›´æ–° ä¸å…¼å®¹æ›´æ–° å…±äº«åº“çš„ABIï¼ˆApplication Binary Interfaceï¼‰ï¼Œå¯¹äºŽä¸åŒè¯­è¨€ï¼Œä¸»è¦åŒ…æ‹¬ä¸€äº›è¯¸å¦‚å‡½æ•°è°ƒç”¨çš„å †æ ˆç»“æž„ã€ç¬¦å·å‘½åã€å‚æ•°è§„åˆ™ã€æ•°æ®ç»“æž„çš„å†…å­˜åˆ†å¸ƒç­‰æ–¹é¢çš„è§„åˆ™ã€‚æ”¹å˜ï¼ˆCè¯­è¨€ï¼‰å…±äº«åº“ABIçš„è¡Œä¸ºåŒ…æ‹¬ï¼š å¯¼å‡ºå‡½æ•°çš„è¡Œä¸ºå‘ç”Ÿæ”¹å˜ï¼Œä¸å†æ»¡è¶³æ—§ç‰ˆæœ¬è§„åˆ™çš„å‡½æ•°è¡Œä¸ºå‡†åˆ™ï¼› å¯¼å‡ºå‡½æ•°è¢«åˆ é™¤ï¼› å¯¼å‡ºæ•°æ®çš„ç»“æž„å‘ç”Ÿå˜åŒ–ï¼› å¯¼å‡ºå‡½æ•°çš„æŽ¥å£å‘ç”Ÿå˜åŒ–ã€‚ ä¾‹å¦‚ä¸åŒç‰ˆæœ¬çš„ç¼–è¯‘å™¨ã€æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œéƒ½å¾ˆå®¹æ˜“ä½¿å¾—äº§ç”Ÿçš„ç¨‹åºæ–‡ä»¶çš„APIå…¼å®¹å›°éš¾ã€‚ ç‰ˆæœ¬å‘½åä¸€èˆ¬é‡‡ç”¨è§„åˆ™ï¼šlibname.so.x.y.zï¼Œæ¯ä¸ªå…±äº«åº“éƒ½æœ‰ä¸€ä¸ªSO-NAMEï¼Œè¿™ä¸ªSO-NAMEå³å…±äº«åº“çš„æ–‡ä»¶ååŽ»æŽ‰æ¬¡ç‰ˆæœ¬å·å’Œå‘å¸ƒç‰ˆæœ¬å·ï¼Œä¿ç•™ä¸»ç‰ˆæœ¬å·ã€‚ç³»ç»Ÿä¼šä¸ºæ¯ä¸ªå…±äº«åº“åœ¨å®ƒæ‰€åœ¨çš„ç›®å½•åˆ›å»ºä¸€ä¸ªè·ŸSO-NAMEç›¸åŒçš„å¹¶ä¸”æŒ‡å‘å®ƒçš„è½¯é“¾æŽ¥ï¼ˆSymbol Linkï¼‰ï¼Œè¿™ä¸ªè½¯é“¾æŽ¥ä¼šæŒ‡å‘ç›®å½•ä¸­ä¸»ç‰ˆæœ¬å·ç›¸åŒã€æ¬¡ç‰ˆæœ¬å·å’Œå‘å¸ƒç‰ˆæœ¬å·æœ€æ–°çš„å…±äº«åº“ï¼Œ.dynamicä¸­çš„DT_NEEDç±»åž‹çš„å­—æ®µå€¼å°±æ˜¯ä½¿ç”¨SO-NAMEï¼Œè¿™æ ·ä½¿èƒ½ä¾èµ–æœ€æ–°çš„å…¼å®¹çš„å…±äº«åº“ï¼Œä½†åˆæ— éœ€æ¯æ¬¡éƒ½æ›´æ”¹ä¾èµ–çš„åº“çš„ç‰ˆæœ¬å·ã€‚è€Œå½“ä¸»ç‰ˆæœ¬å·å‡çº§åŽï¼Œç³»ç»Ÿå°±ä¼šå­˜åœ¨å¤šä¸ªSO-NAMEï¼Œä¹Ÿä¸ä¼šå½±å“å·²æœ‰çš„ç¨‹åºï¼Œé™¤éžè¿›è¡Œå¸è½½åˆ é™¤ã€‚ å·¥å…·ldconfigï¼Œåœ¨å®‰è£…æˆ–æ›´æ–°ä¸€ä¸ªå…±äº«åº“æ—¶ï¼Œè¿è¡Œå®ƒä¼šéåŽ†æ‰€æœ‰çš„é»˜è®¤å…±äº«åº“ç›®å½•ï¼Œæ›´æ–°æˆ–åˆ›å»ºæ‰€æœ‰çš„è½¯é“¾æŽ¥ï¼Œä½¿æŒ‡å‘æœ€æ–°ç‰ˆæœ¬çš„å…±äº«åº“ã€‚ åœ¨ç¼–è¯‘å™¨å‘½ä»¤è¡Œé‡Œï¼Œå¯ä»¥æŒ‡å®š-lXXXï¼Œè¡¨ç¤ºé“¾æŽ¥ä¸€ä¸ªlibXXX.so.2.6.1çš„å…±äº«åº“ã€‚ ç¬¦å·ç‰ˆæœ¬ä¸ºè§£å†³æ¬¡ç‰ˆæœ¬å·äº¤ä¼šé—®é¢˜ï¼ˆMinor-revision Rendezvous Problemï¼‰ï¼Œå³è¾ƒä½Žæ¬¡ç‰ˆæœ¬ä¸å‘å‰å…¼å®¹æ‰€äº§ç”Ÿçš„ç¬¦å·ç¼ºå°‘é—®é¢˜ï¼Œé‡‡ç”¨äº†ç¬¦å·ç‰ˆæœ¬æœºåˆ¶ã€‚ åœ¨å…±äº«åº“æ¬¡ç‰ˆæœ¬å‡çº§æ—¶ï¼Œé™¤äº†SO-NAMEæ›´æ–°ï¼Œè¿˜ä¸ºæ–°æ·»åŠ çš„å…¨å±€ç¬¦å·æ‰“ä¸Šæ ‡è®°ã€‚å¯ä»¥åœ¨é“¾æŽ¥å…±äº«åº“æ—¶ç¼–å†™ä¸€ç§ç¬¦å·ç‰ˆæœ¬è„šæœ¬çš„æ–‡ä»¶ï¼ŒæŒ‡å®šè¿™äº›ç¬¦å·ä¸Žé›†åˆä¹‹é—´åŠé›†åˆä¸Žé›†åˆä¹‹é—´çš„ç»§æ‰¿ä¾èµ–å…³ç³»ã€‚å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬æœºåˆ¶ï¼ˆVersioningï¼‰å’ŒèŒƒå›´æœºåˆ¶ï¼ˆScopingï¼‰ä¸¤ç§æ–¹å¼æŒ‡å®šã€‚ ç¨‹åºé‡Œé¢è®°å½•çš„ä¸æ˜¯æž„å»ºæ—¶å…±äº«åº“ä¸­ç‰ˆæœ¬æœ€æ–°çš„ç¬¦å·é›†åˆï¼Œè€Œæ˜¯ç¨‹åºæ‰€ä¾èµ–çš„é›†åˆä¸­ç‰ˆæœ¬å·æœ€å°çš„é‚£ä¸ªã€‚ æŒ‡å®šè„šæœ¬æ–‡ä»¶ï¼š $gcc -shared -fPIC lib.c -Xlinker --version-script lib.ver -o lib.so # ç›¸å½“äºŽld --version-script lib.verå…±äº«åº“ç³»ç»Ÿè·¯å¾„å¤§éƒ¨åˆ†å¼€æºçš„æ“ä½œç³»ç»Ÿéƒ½éµå®ˆä¸€ä¸ªå«FHSï¼ˆFile Hierarchy Standardï¼‰çš„æ ‡å‡†ï¼Œå…¶è§„å®šäº†ä¸€ä¸ªç³»ç»Ÿä¸­çš„ç³»ç»Ÿæ–‡ä»¶åº”è¯¥å¦‚ä½•å­˜æ”¾ã€‚ /libï¼Œå­˜æ”¾ç³»ç»Ÿæœ€å…³é”®å’ŒåŸºç¡€çš„å…±äº«åº“ï¼Œå¦‚åŠ¨æ€é“¾æŽ¥å™¨ã€Cè¯­è¨€è¿è¡Œåº“ã€æ•°æ®åº“ç­‰ï¼› /usr/libï¼Œå­˜æ”¾éžç³»ç»Ÿè¿è¡Œæ—¶æ‰€éœ€çš„å…³é”®æ€§å…±äº«åº“ï¼Œä¸»è¦æ˜¯å¼€å‘æ—¶ç”¨çš„åº“ï¼› /usr/local/libï¼Œæ”¾ç½®æ›´æ“ä½œç³»ç»Ÿæœ¬èº«å¹¶ä¸ååˆ†ç›¸å…³çš„åº“ï¼Œä¸»è¦æ˜¯ç¬¬ä¸‰æ–¹çš„åº”ç”¨ç¨‹åºçš„åº“ã€‚ å…±äº«åº“æŸ¥æ‰¾è¿‡ç¨‹åŠ¨æ€é“¾æŽ¥çš„æ¨¡å—æ‰€ä¾èµ–çš„æ¨¡å—è·¯å¾„ä¿å­˜åœ¨.dynamicæ®µé‡Œé¢ï¼Œç”±DT_NEEDç±»åž‹çš„é¡¹è¡¨ç¤ºã€‚å¯¹æ¨¡å—çš„æŸ¥æ‰¾è§„åˆ™ï¼š å¦‚æžœDT_NEEDé‡Œé¢ä¿å­˜çš„ç»å¯¹è·¯å¾„ï¼Œåˆ™åŠ¨æ€é“¾æŽ¥å™¨å°±æŒ‰æ­¤è·¯å¾„æŸ¥æ‰¾ï¼› å¦‚æžœDT_NEEDé‡Œé¢ä¿å­˜çš„ç›¸å¯¹è·¯å¾„ï¼Œåˆ™åŠ¨æ€é“¾æŽ¥å™¨ä¼šåœ¨/libã€/usr/libå’Œ/etc/ld.so.confé…ç½®æ–‡ä»¶æŒ‡å®šçš„ç›®å½•ä¸­æŸ¥æ‰¾å…±äº«åº“ã€‚ï¼ˆä¸ºä¿å¯ç§»æ¤æ€§å’Œå…¼å®¹æ€§ï¼Œä¸€èˆ¬æ˜¯ç›¸å¯¹çš„ï¼‰ ldconfigè¿˜ä¼šç¼“å­˜èµ·SO-NAMEåˆ°/etc/ld.so.cacheï¼Œæ–¹ä¾¿å¿«æ·æŸ¥æ‰¾ï¼ˆå…±äº«åº“ç›®å½•ä¸‹æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°ä»»ä½•ä¸€ä¸ªå…±äº«åº“æˆ–æ›´æ”¹/etc/ld.so.confçš„é…ç½®ï¼Œéƒ½åº”è¯¥è¿è¡Œldconfigï¼‰ã€‚ çŽ¯å¢ƒå˜é‡ LD_LIBRARY_PATHï¼ˆä¼˜å…ˆæŸ¥æ‰¾è¯¥æŒ‡å®šçš„ç›®å½•ä¸‹çš„å…±äº«åº“ï¼‰ï¼Œå¯¹åº”æŒ‡ä»¤å‚æ•°-library-pathï¼› LD_PRELOADï¼ŒæŒ‡å®šé¢„å…ˆè£…è½½çš„ä¸€äº›å…±äº«åº“æˆ–ç›®æ ‡æ–‡ä»¶ã€‚åˆ©ç”¨å®ƒæ¥è¦†ç›–åŽé¢åŠ è½½çš„åŒåå…¨å±€ç¬¦å·ï¼ˆå…¨å±€ç¬¦å·ä»‹å…¥æœºåˆ¶ï¼‰ï¼Œä»Žè€Œæ”¹å†™æ ‡å‡†Cåº“ä¸­çš„æŸä¸ªæˆ–æŸå‡ ä¸ªå‡½æ•°è€Œä¸å½±å“å…¶ä»–å‡½æ•°ï¼Œæ–¹ä¾¿è°ƒè¯•æµ‹è¯•ï¼› LD_DEBUGï¼Œæ‰“å¼€åŠ¨æ€é“¾æŽ¥å™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œè¿è¡Œæ—¶æ‰“å°å‡ºå„ç§æœ‰ç”¨çš„ä¿¡æ¯ã€‚ å…±äº«åº“çš„åˆ›å»ºå’Œå®‰è£…åˆ›å»ºï¼š $gcc -shared -Wl,-soname,my_soname -o library_name source_files library_files-Wl ä¼ é€’-soname my_sonameç»™é“¾æŽ¥å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé“¾æŽ¥å™¨åœ¨äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œåªä¼šå°†é‚£äº›é“¾æŽ¥æ—¶è¢«å…¶ä»–å…±äº«æ¨¡å—å¼•ç”¨åˆ°çš„ç¬¦å·æ”¾åˆ°åŠ¨æ€ç¬¦å·è¡¨ï¼Œè¿™æ ·å¯ä»¥å‡å°‘åŠ¨æ€ç¬¦å·è¡¨çš„å¤§å°ã€‚ldé“¾æŽ¥å™¨æä¾›äº†-export-dynamicå‚æ•°å°†å…¨å±€ç¬¦å·å¯¼å‡ºåˆ°åŠ¨æ€ç¬¦å·è¡¨ã€‚ æ¸…é™¤ç¬¦å·ä¿¡æ¯ï¼ˆæˆ–é€šè¿‡ldçš„-så’Œ-Så‚æ•°ä½¿ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ä¸äº§ç”Ÿç¬¦å·ä¿¡æ¯ï¼Œsæ˜¯æ‰€æœ‰ç¬¦å·ä¿¡æ¯ï¼ŒSæ˜¯è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼‰ï¼š $strip libfoo.soå…±äº«åº“æž„é€ å’Œæžæž„å‡½æ•°attribute((constructor))æ­¤å±žæ€§åŠ åœ¨å£°æ˜Žçš„å‡½æ•°ä¸Šï¼Œå³æŒ‡å®šè¯¥å‡½æ•°ä¸ºå…±äº«åº“æž„é€ å‡½æ•°ï¼Œæ‹¥æœ‰è¿™ç§å±žæ€§çš„å‡½æ•°ä¼šåœ¨å…±äº«åº“åŠ è½½æ—¶è¢«æ‰§è¡Œï¼Œå³åœ¨ç¨‹åºçš„mainå‡½æ•°ä¹‹å‰æ‰§è¡Œï¼Œåˆæˆ–è€…åœ¨dlopenè¿”å›žä¹‹å‰è¢«æ‰§è¡Œã€‚ å†…å­˜ç¨‹åºçš„å†…å­˜å¸ƒå±€ æ ˆï¼šé€šå¸¸åœ¨ç”¨æˆ·ç©ºé—´çš„æœ€é«˜åœ°å€å¤„åˆ†é…ï¼ˆæŽ¥è¿‘å†…æ ¸ç©ºé—´å¤„ï¼‰ï¼› å †ï¼šå½“ç¨‹åºä½¿ç”¨mallocæˆ–newåˆ†é…å†…å­˜æ—¶ï¼Œåœ¨æ ˆçš„ä¸‹æ–¹ï¼ˆä½Žåœ°å€æ–¹å‘ï¼‰åˆ†é…ï¼Œå †ä¸€èˆ¬æ¯”æ ˆå¤§å¾—å¤šï¼Œä¹Ÿæ²¡å›ºå®šç»Ÿä¸€çš„å­˜å‚¨åŒºåŸŸï¼› å¯æ‰§è¡Œæ–‡ä»¶æ˜ åƒï¼šç”±è£…è½½å™¨åœ¨è£…è½½æ—¶å°†å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å­˜è¯»å–æˆ–æ˜ å°„åˆ°è¿™é‡Œï¼› ä¿ç•™åŒºï¼šå¯¹å†…å­˜ä¸­å—åˆ°ä¿æŠ¤è€Œç¦æ­¢è®¿é—®çš„å†…å­˜åŒºåŸŸæ€»ç§°ï¼Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„åŒºåŸŸï¼› åŠ¨æ€é“¾æŽ¥åº“æ˜ å°„åŒºåŸŸï¼šå¦‚æžœå¯æ‰§è¡Œæ–‡ä»¶ä¾èµ–å…¶ä»–å…±äº«åº“ï¼Œå°±åœ¨æ ˆå’Œå †ä¹‹é—´åˆ†é…ä¸€ä¸ªåŒºåŸŸè£…è½½å…±äº«åº“è¿›ç©ºé—´ã€‚ æ ˆå‘ä½Žåœ°å€å¢žé•¿ï¼Œå †å‘é«˜åœ°å€å¢žé•¿ã€‚æŒ‡é’ˆåˆå§‹åŒ–ä¸ºNULLæˆ–æ ˆä¸Šçš„æŒ‡é’ˆåˆå§‹åŒ–è¢«éšæœºåˆ†é…åœ°å€éƒ½ç›´æŽ¥ä½¿ç”¨ä¸ªï¼Œéƒ½å¯èƒ½å‡ºçŽ°â€œæ®µé”™è¯¯ï¼ˆsegment faultï¼‰â€ï¼Œç”±éžæ³•æŒ‡é’ˆè§£å¼•é€ æˆã€‚ æ ˆæ ˆé¡¶ç”±ç§°ä¸ºespçš„å¯„å­˜å™¨è¿›è¡Œå®šä½ï¼ŒåŽ‹æ ˆçš„æ“ä½œä½¿æ ˆé¡¶çš„åœ°å€å‡å°‘ï¼Œå¼¹å‡ºçš„æ“ä½œä½¿æ ˆé¡¶åœ°å€å¢žå¤§ã€‚æ ˆä¿å­˜äº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ‰€éœ€è¦çš„ç»´æŠ¤ä¿¡æ¯ï¼Œè¢«ç§°ä¸ºå †æ ˆå¸§ï¼ˆStack Frameï¼‰æˆ–æ´»åŠ¨è®°å½•ï¼ˆActivate Recordï¼‰ï¼ŒåŒ…æ‹¬ï¼š å‡½æ•°è¿”å›žåœ°å€å’Œå‚æ•°ï¼› ä¸´æ—¶å˜é‡ï¼ŒåŒ…æ‹¬å‡½æ•°çš„éžé™æ€å±€éƒ¨å˜é‡ã€ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å…¶å®ƒä¸´æ—¶å˜é‡ï¼› ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬å‡½æ•°è°ƒç”¨å‰åŽéœ€è¦ä¿æŒä¸å˜çš„å¯„å­˜å™¨ã€‚ å‡½æ•°çš„æ´»åŠ¨è®°å½•ç”¨ebpï¼ˆæŒ‡å‘å‡½æ•°æ´»åŠ¨è®°å½•çš„ä¸€ä¸ªå›ºå®šä½ç½®ï¼Œç§°ä¸ºå¸§æŒ‡é’ˆ Frame Pointerï¼‰å’Œespä¸¤ä¸ªå¯„å­˜å™¨åˆ’å®šèŒƒå›´ã€‚ åœ¨å‚æ•°ä¹‹åŽçš„æ•°æ®å³æ˜¯å½“å‰å‡½æ•°çš„æ´»åŠ¨è®°å½•ï¼Œebpæ‰€ç›´æŽ¥æŒ‡å‘çš„æ•°æ®æ˜¯è°ƒç”¨è¯¥å‡½æ•°å‰ebpçš„å€¼ï¼Œè¿™æ ·åœ¨å‡½æ•°è¿”å›žçš„æ—¶å€™ï¼Œebpå¯ä»¥é€šè¿‡è¯»å–è¿™ä¸ªå€¼æ¢å¤åˆ°è°ƒç”¨å‰çš„å€¼ ã€å›¾ã€‘æ´»åŠ¨è®°å½• å‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼š æŠŠæ‰€æœ‰æˆ–ä¸€éƒ¨åˆ†å‚æ•°åŽ‹å…¥æ ˆä¸­ï¼Œè‹¥å…¶å®ƒå‚æ•°æ²¡æœ‰å…¥æ ˆï¼Œé‚£ä¹ˆä½¿ç”¨æŸäº›ç‰¹å®šçš„å¯„å­˜å™¨ä¼ é€’ï¼› æŠŠå½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€åŽ‹å…¥æ ˆä¸­ï¼Œå¹¶è·³è½¬åˆ°å‡½æ•°ä½“æ‰§è¡Œï¼Œè¿™ä¸¤æ­¥ç”±callæŒ‡ä»¤å®Œæˆï¼› push ebpï¼ŒæŠŠebpåŽ‹å…¥æ ˆä¸­ï¼Œç§°ä¸ºold ebpï¼› mov ebp,espï¼Œebp=esp ã€å¯é€‰ã€‘sub esp, XXXï¼Œåœ¨æ ˆä¸Šåˆ†é…XXXå­—èŠ‚çš„ä¸´æ—¶ç©ºé—´ï¼› ã€å¯é€‰ã€‘push XXXï¼Œå¦‚æœ‰å¿…è¦ï¼Œä¿å­˜åä¸ºXXXå¯„å­˜å™¨ï¼› GCCç¼–è¯‘å™¨æœ‰ä¸€ä¸ªå‚æ•°-fomit-frame-pointerå¯ä»¥å–æ¶ˆå¸§æŒ‡é’ˆï¼Œç©ºå‡ºebpå¯„å­˜å™¨ä¾›ä½¿ç”¨ï¼Œä½†å¸§ä¸Šçš„å¯»å€é€Ÿåº¦ä¼šå˜æ…¢ï¼Œæ— æ³•å‡†ç¡®å®šä½å‡½æ•°çš„è°ƒç”¨è½¨è¿¹ã€‚ eaxä¸€èˆ¬ä¼šåœ¨å‡½æ•°çš„æœ€åŽè¢«èµ‹å€¼ï¼Œä½œä¸ºè¿”å›žå€¼ä¼ å‡ºï¼Œå‡½æ•°è¿”å›žä¹‹åŽï¼Œè°ƒç”¨æ–¹å¯ä»¥é€šè¿‡è¯»å–eaxå¯„å­˜å™¨æ¥èŽ·å–è¿”å›žå€¼ã€‚ ä½†åƒå‡½æ•°è¢«å£°æ˜Žä¸ºstaticã€å‡½æ•°åœ¨ç¼–è¯‘å•å…ƒä»…è¢«ç›´æŽ¥è°ƒç”¨ï¼Œæ²¡æœ‰æ˜¾ç¤ºæˆ–éšå¼åŽ»åœ°å€çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ç”Ÿæˆå‡½æ•°çš„è¿›å…¥å’Œé€€å‡ºæŒ‡ä»¤åºåˆ—æ—¶å¹¶ä¸æŒ‰æ ‡å‡†æ–¹å¼è¿›è¡Œã€‚ è°ƒç”¨æƒ¯ä¾‹å‡½æ•°çš„è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹å¯¹äºŽå‡½æ•°å¦‚ä½•è°ƒç”¨é¡»è¦æœ‰ä¸€ä¸ªæ˜Žç¡®çš„çº¦å®šï¼Œå³è°ƒç”¨æƒ¯ä¾‹ï¼ˆCalling Conventionï¼‰ã€‚ å‡½æ•°å‚æ•°çš„ä¼ é€’é¡ºåºå’Œæ–¹å¼ï¼Œè°ƒç”¨æ–¹å°†å‚æ•°åŽ‹å…¥æ ˆï¼Œå‡½æ•°è‡ªå·±å†ä»Žæ ˆä¸­å°†å‚æ•°å–å‡ºï¼ŒåŽ‹æ ˆé¡ºåºä»Žå·¦è‡³å³ï¼Œè¿˜æ˜¯ä»Žå³è‡³å·¦ï¼Œè¿˜æ˜¯ä½¿ç”¨å¯„å­˜å™¨ä¼ é€’ä»¥æé«˜æ€§èƒ½ï¼› æ ˆçš„ç»´æŠ¤æ–¹å¼ï¼Œå¼¹å‡ºå…¨éƒ¨è¢«åŽ‹å…¥æ ˆçš„å‚æ•°çš„å·¥ä½œï¼Œç”±å‡½æ•°çš„è°ƒç”¨æ–¹è¿˜æ˜¯å‡½æ•°æœ¬èº«æ¥å®Œæˆï¼› åå­—ä¿®é¥°çš„ç­–ç•¥ï¼Œä¸ºäº†é“¾æŽ¥æ—¶å¯¹è°ƒç”¨æƒ¯ä¾‹è¿›è¡ŒåŒºåˆ†ã€‚ é»˜è®¤çš„è°ƒç”¨æƒ¯ä¾‹æ˜¯cdeclï¼Œå¦‚ int _cdecl foo(int n, float m)ï¼Œä»£è¡¨ä»Žå³è‡³å·¦çš„é¡ºåºåŽ‹å‚æ•°å…¥æ ˆã€å‡½æ•°è°ƒç”¨æ–¹å‡ºæ ˆã€ç›´æŽ¥åœ¨å‡½æ•°åç§°å‰åŠ 1ä¸ªä¸‹åˆ’çº¿ã€‚å…¶å®ƒè¿˜æœ‰å¦‚stdcallã€fastcallã€pascalã€‚ ç¨‹åºè¿”å›žæ—¶ï¼Œå…ˆä½¿ç”¨popæ¢å¤ä¿å­˜åœ¨æ ˆé‡Œçš„å¯„å­˜å™¨ï¼Œç„¶åŽä»Žæ ˆé‡Œå–å¾—è¿”å›žåœ°å€ï¼Œè¿”å›žåˆ°è°ƒç”¨æ–¹ï¼Œè°ƒç”¨æ–¹å†è°ƒæ•´ESPå°†å †æ ˆæ¢å¤ã€‚ ä¸€èˆ¬çš„è°ƒç”¨æƒ¯ä¾‹ï¼Œéƒ½é‡‡ç”¨eaxå’Œedxè”åˆè¿”å›žçš„æ–¹å¼è¿›è¡Œï¼Œeaxå­˜å‚¨è¿”å›žå€¼è¦ä½Ž4å­—èŠ‚ï¼Œedxå­˜å‚¨è¿”å›žå€¼è¦é«˜1-4å­—èŠ‚ï¼›è¶…è¿‡8å­—èŠ‚çš„é‡‡ç”¨éšå«å‚æ•°ä¼ å…¥ï¼ˆé€šè¿‡å¤åˆæŒ‡ä»¤rep movsï¼Œç›¸å½“äºŽmemcpyï¼‰ï¼Œå°†eaxæŒ‡å‘çš„å†…å®¹æ‹·è´ç»™è°ƒç”¨æ–¹ï¼Œå³ä»ç„¶æ˜¯eaxä¼ å‡ºå‡½æ•°è¿”å›žçš„ç»“æž„ä½“ï¼Œåªä¸è¿‡å­˜å‚¨çš„æ˜¯ç»“æž„ä½“çš„æŒ‡é’ˆã€‚ å †ä¸Žå†…å­˜ç®¡ç†å¦‚æžœå†…æ ¸æä¾›ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥è®©ç¨‹åºä½¿ç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ç”³è¯·å†…å­˜ï¼Œä½†æ•ˆçŽ‡è¾ƒå·®ï¼Œæ¯æ¬¡ç¨‹åºç”³è¯·æˆ–è€…é‡Šæ”¾å †ç©ºé—´éƒ½è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€‚æ‰€ä»¥ï¼Œç¨‹åºå‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€å—é€‚å½“å¤§å°çš„å †ç©ºé—´ï¼Œç„¶åŽç”±ç¨‹åºè‡ªå·±ç®¡ç†è¿™å—ç©ºé—´ï¼Œç®¡ç†ç€å †ç©ºé—´åˆ†é…çš„å¾€å¾€æ˜¯ç¨‹åºçš„è¿è¡Œåº“ã€‚ è¿è¡Œåº“æ‹¥æœ‰ä¸€ä¸ªç®—æ³•è¿›è¡Œç®¡ç†å †ç©ºé—´ã€‚ brk()ç³»ç»Ÿè°ƒç”¨ï¼Œå®žé™…ä¸Šå°±æ˜¯è®¾ç½®è¿›ç¨‹çš„æ•°æ®æ®µç»“æŸåœ°å€ã€‚ mmap()ç³»ç»Ÿè°ƒç”¨ï¼Œå‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€æ®µè™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå½“å®ƒä¸å°†åœ°å€ç©ºé—´æ˜ å°„åˆ°æŸä¸ªæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ç§°è¿™å—ç©ºé—´ä¸ºåŒ¿åï¼ˆAnonymousï¼‰ç©ºé—´ï¼Œå°±æ‹¿æ¥ä½œä¸ºå †ç©ºé—´ã€‚ mallocå‡½æ•°ï¼š å¯¹äºŽå°çŽ‰128KBçš„è¯·æ±‚ï¼Œä¼šåœ¨çŽ°æœ‰çš„å †ç©ºé—´é‡Œé¢æŒ‰å †åˆ†é…ç®—æ³•åˆ†é…ä¸€å—ç©ºé—´å¹¶è¿”å›žï¼› å¯¹äºŽå¤§äºŽ128KBçš„è¯·æ±‚ï¼Œä¼šä½¿ç”¨mmap()å‡½æ•°ä¸ºå®ƒåˆ†é…ä¸€å—åŒ¿åç©ºé—´ï¼Œç„¶åŽå†åŒ¿åç©ºé—´ä¸­ä¸ºç”¨æˆ·åˆ†é…ç©ºé—´ã€‚ mallocç”³è¯·çš„ç©ºé—´èµ·å§‹åœ°å€å’Œå¤§å°éƒ½å¿…é¡»æ˜¯ç³»ç»Ÿé¡µçš„å¤§å°çš„æ•´æ•°å€ã€‚ å †åˆ†é…ç®—æ³• ç©ºé—²é“¾è¡¨ï¼Œä¸€æ—¦é“¾è¡¨è¢«ç ´åï¼Œæ•´ä¸ªå †å°±æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå®¹æ˜“è¢«è¶Šç•Œè¯»å†™æ‰€æŽ¥è§¦åˆ°ï¼› ä½å›¾ï¼ˆBitmapï¼‰ï¼Œå°†æ•´ä¸ªå †åˆ’åˆ†ä¸ºå¤§é‡çš„å—ï¼Œæ¯ä¸ªå—çš„å¤§å°ç›¸åŒï¼Œæ€»æ˜¯åˆ†é…æ•´æ•°ä¸ªå—ç»™ç”¨æˆ·ï¼Œä½¿ç”¨ä¸€ä¸ªæ•´æ•°æ•°ç»„è®°å½•å—çš„ä½¿ç”¨æƒ…å†µï¼Œç”¨ä¸¤ä½è¡¨ç¤ºä¸€ä¸ªå—çš„å¤´/ä¸»ä½“/ç©ºé—²ä¸‰ç§çŠ¶æ€ã€‚ å¤šçº§ä½å›¾ï¼› å¯¹è±¡æ± ã€‚ è¿è¡Œåº“å…¥å£å‡½æ•°å’Œç¨‹åºçš„åˆå§‹åŒ–å…¥å£å‡½æ•°æˆ–å…¥å£ç‚¹ï¼ˆEntry Pointï¼‰å‡†å¤‡å¥½mainå‡½æ•°æ‰§è¡Œæ‰€éœ€è¦çš„çŽ¯å¢ƒï¼Œå¹¶è´Ÿè´£è°ƒç”¨mainå‡½æ•°ï¼Œä¼šè®°å½•mainå‡½æ•°çš„è¿”å›žå€¼ï¼Œè°ƒç”¨atexitæ³¨å†Œçš„å‡½æ•°ï¼Œç»“æŸè¿›ç¨‹ã€‚ æ“ä½œç³»ç»Ÿåœ¨åˆ›å»ºè¿›ç¨‹åŽï¼Œå§æŽ§åˆ¶æƒäº¤ç»™ç¨‹åºçš„å…¥å£ï¼Œæ­¤å…¥å£å¾€å¾€æ˜¯è¿è¡Œåº“ä¸­çš„æŸä¸ªå…¥å£å‡½æ•°ï¼› å…¥å£å‡½æ•°å¯¹è¿è¡Œåº“å’Œç¨‹åºè¿è¡ŒçŽ¯å¢ƒè¿›è¡Œåˆå§‹åŒ–ï¼ŒåŒ…æ‹¬å †ã€I/Oã€çº¿ç¨‹ã€å…¨å±€å˜é‡æž„é€ ç­‰ï¼› å…¥å£å‡½æ•°å®Œæˆåˆå§‹åŒ–åŽï¼Œè°ƒç”¨mainå‡½æ•°ï¼Œå¼€å§‹æ‰§è¡Œç¨‹åºä¸»ä½“éƒ¨åˆ†ï¼› mainå‡½æ•°æ‰§è¡Œå®Œæ¯•åŽï¼Œè¿”å›žåˆ°å…¥å£å‡½æ•°ï¼Œå…¥å£å‡½æ•°è¿›è¡Œæ¸…ç†å·¥ä½œï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡çš„æžæž„ã€å †é”€æ¯ã€å…³é—­I/Oç­‰ï¼Œç„¶åŽè¿›è¡Œç³»ç»Ÿè°ƒç”¨ç»“æŸè¿›ç¨‹ã€‚ _start() __libc_start_main() exit() _exit() è¿è¡Œåº“ä¸ŽI/Oæ–‡ä»¶æ˜¯ä¸€ä¸ªå¹¿ä¹‰çš„æ¦‚å¿µï¼Œå„ç§å…·æœ‰è¾“å…¥è¾“å‡ºæ¦‚å¿µçš„å®žä½“ï¼Œå¦‚è®¾å¤‡ã€ç£ç›˜æ–‡ä»¶ã€å‘½ä»¤è¡Œç­‰ã€‚åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šï¼Œæ–‡ä»¶æ“ä½œä¹Ÿæ˜¯æœ‰ç±»ä¼¼äºŽFILEçš„ä¸€ä¸ªæ¦‚å¿µï¼Œè¿™å«æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰æˆ–å¥æŸ„ï¼ˆHandleï¼‰ï¼Œæ‰“å¼€æ–‡ä»¶å¾—åˆ°çš„fdï¼Œè¡¨ç¤ºæ‰“å¼€æ–‡ä»¶è¡¨çš„ä¸‹æ ‡ï¼Œç”±äºŽè¡¨å¤„äºŽå†…æ ¸ï¼Œå¹¶ä¸”ç”¨æˆ·æ— æ³•è®¿é—®ï¼Œå› æ­¤ç”¨æˆ·å³ä½¿æ‹¥æœ‰fdï¼Œä¹Ÿæ— æ³•å¾—åˆ°æ‰“å¼€æ–‡ä»¶å¯¹è±¡çš„åœ°å€ï¼Œåªèƒ½é€šè¿‡ç³»ç»Ÿæä¾›çš„å‡½æ•°æ¥æ“ä½œã€‚ I/Oçš„èŒè´£æ˜¯ï¼Œåˆå§‹åŒ–å‡½æ•°éœ€è¦åœ¨ç”¨æˆ·ç©ºé—´ä¸­å»ºç«‹stdinã€stdoutã€stderråŠå…¶å¯¹åº”çš„FILEç»“æž„ï¼Œä½¿å¾—ç¨‹åºè¿›å…¥mainä¹‹åŽå¯ä»¥ç›´æŽ¥ä½¿ç”¨printfã€scanfç­‰å‡½æ•°ã€‚ Cè¯­è¨€è¿è¡Œåº“Cè¿è¡Œåº“ï¼ˆCRTï¼‰ ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š å¯åŠ¨ä¸Žé€€å‡º æ ‡å‡†å‡½æ•° I/O å † è¯­è¨€å®žçŽ° è°ƒè¯• æ ‡å‡†åº“ï¼šANSI C89 ï¼Œåˆ°ANSI C99ï¼Œä¸»è¦æ–‡ä»¶ï¼ˆæ¨¡å—ï¼‰åŒ…æ‹¬ï¼š æ ‡å‡†è¾“å…¥è¾“å‡º stdio.h æ–‡ä»¶æ“ä½œ stdio.h å­—ç¬¦æ“ä½œ ctype.h å­—ç¬¦ä¸²æ“ä½œ string.h æ•°å­¦å‡½æ•° math.h èµ„æºç®¡ç† stdlib.h æ ¼å¼è½¬æ¢ stdlib.h æ—¶é—´/æ—¥æœŸ time.h æ–­è¨€ assert.h å„ç§ç±»åž‹ä¸Šçš„å¸¸æ•° limits.h &amp; float.h å˜é•¿å‚æ•° stdarg.h éžå±€éƒ¨è·³è½¬ setjmp.h è¿è¡Œåº“çš„ä»£è¡¨æ€§ç‰¹æ®Šå‡½æ•°ï¼š å˜é•¿å‚æ•°ï¼ˆå¾—ç›ŠäºŽcdeclè°ƒç”¨æƒ¯ä¾‹ï¼‰ va_list ap;ï¼Œè®©apä»¥åŽä¾æ¬¡æŒ‡å‘å„ä¸ªå¯å˜å‚æ•° va_start(ap, lastarg);ï¼Œåˆå§‹åŒ–ap type next = va_arg(ap, type);ï¼ŒèŽ·å¾—ä¸‹ä¸€ä¸ªä¸å®šå‚æ•° va_end(ap); åœ¨GCCç¼–è¯‘å™¨ä¸‹ï¼Œå˜é•¿å‚æ•°æ³“å¯ä»¥ä½¿ç”¨â€œ##â€å®å­—ç¬¦ä¸²é“¾æŽ¥æ“ä½œå®žçŽ°ï¼Œåœ¨MSVCä¸‹ä½¿ç”¨VA_ARGSã€‚ éžå±€éƒ¨è·³è½¬ã€‚ è¾…åŠ©ç¨‹åºè¿è¡Œçš„è¿è¡Œåº“ï¼š /usr/lib/crtl.oï¼ŒåŒ…å«ç¨‹åºçš„å…¥å£å‡½æ•°_startï¼Œç”±å®ƒè´Ÿè´£è°ƒç”¨__libc_start_mainåˆå§‹åŒ–libcå¹¶ä¸”è°ƒç”¨mainå‡½æ•°è¿›å…¥çœŸæ­£çš„ç¨‹åºä¸»ä½“ï¼› /usr/lib/crti.oï¼Œå¸®åŠ©.initå’Œ.finitå®ƒä»¬å¯åŠ¨ï¼Œæ¯”å¦‚è®¡ç®—GOTç­‰ï¼› /usr/lib/crtn.oï¼ŒåŒä¸Šã€‚å…¶å®žcrti.oå’Œcrtn.oåˆ†åˆ«æ˜¯_init()å’Œ_finit()å‡½æ•°çš„å¼€å§‹å’Œç»“å°¾éƒ¨åˆ†ï¼Œå®ƒä»¬å’Œå…¶å®ƒç›®æ ‡æ–‡ä»¶æŒ‰é¡ºåºé“¾æŽ¥åŽåˆšå¥½å½¢æˆå®Œæ•´çš„_init()å’Œ_finit()å‡½æ•°ï¼Œå› æ­¤é“¾æŽ¥æ—¶ï¼Œcrti.oå¿…é¡»åœ¨ç”¨æˆ·ç›®æ ‡æ–‡ä»¶å’Œç³»ç»Ÿåº“ä¹‹å‰ï¼Œcrtn.oå¿…é¡»åœ¨ç”¨æˆ·ç›®æ ‡æ–‡ä»¶å’Œç³»ç»Ÿåº“ä¹‹åŽã€‚ $objdump -dr /usr/lib/crti.o$objdump -dr /usr/lib/crtn.o å¸Œæœ›ä½¿ç”¨è‡ªå·±çš„libcå’Œcrt1.oç­‰å¯åŠ¨æ–‡ä»¶ä»£æ›¿ç³»ç»Ÿé»˜è®¤çš„ï¼Œä½¿ç”¨å‚æ•°GCCçš„å‚æ•°â€-nostartfileâ€œå’Œâ€-nostdlibâ€œ è¿è¡Œåº“ä¸Žå¤šçº¿ç¨‹çº¿ç¨‹åœ¨å®žé™…è¿ç”¨ä¸­ä¹Ÿæ‹¥æœ‰è‡ªå·±çš„ç§æœ‰å­˜å‚¨ç©ºé—´ï¼š æ ˆï¼Œåªè¦çŸ¥é“å…¶ä»–çº¿ç¨‹çš„å †æ ˆåœ°å€è¿˜æ˜¯å¯ä»¥åœ¨çº¿ç¨‹é—´è®¿é—® çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆThread Local Storageï¼ŒTLSï¼‰ å¯„å­˜å™¨ï¼ˆåŒ…æ‹¬PCå¯„å­˜å™¨ï¼‰ï¼Œå¯„å­˜å™¨å­˜æ”¾çš„æ•°æ®æ˜¯æ‰§è¡Œæµçš„åŸºæœ¬æ•°æ®ã€‚ çº¿ç¨‹ç›¸å…³çš„éƒ¨åˆ†ä¸å±žäºŽæ ‡å‡†åº“çš„å†…å®¹ï¼Œå¤šçº¿ç¨‹ç›¸å…³ä¸»è¦æŒ‡ï¼š æä¾›å¤šçº¿ç¨‹æ“ä½œçš„æŽ¥å£ï¼Œæ¯”å¦‚åˆ›å»ºçº¿ç¨‹ã€é€€å‡ºçº¿ç¨‹ã€è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ç­‰å‡½æ•°æŽ¥å£ï¼› è¿è¡Œåº“èƒ½åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹æ­£ç¡®è¿è¡Œã€‚ è‡ªç„¶å…·æœ‰çº¿ç¨‹å®‰å…¨å±žæ€§çš„å‡½æ•°åŒ…æ‹¬ï¼š å­—ç¬¦å¤„ç†ï¼ˆåŒæ—¶è¿˜æ˜¯å¯é‡å…¥ï¼‰ å­—ç¬¦ä¸²å¤„ç† æ•°å­¦å‡½æ•°ï¼ˆåŒæ—¶è¿˜æ˜¯å¯é‡å…¥ï¼‰ å­—ç¬¦ä¸²è½¬æ•´å½¢/æµ®ç‚¹æ•° èŽ·å–çŽ¯å¢ƒå˜é‡ï¼ˆåŒæ—¶è¿˜æ˜¯å¯é‡å…¥ï¼‰ å˜é•¿æ•°ç»„è¾…åŠ©å‡½æ•° éžå±€éƒ¨è·³è½¬å‡½æ•° çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆTLSï¼‰çš„å®žçŽ°ï¼Œå®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ä¸ºTLSç±»åž‹ï¼Œåˆ™åªéœ€åŠ ä¸Šä»¥ä¸‹å…³é”®å­—ï¼ˆéšå¼TLSï¼‰ï¼š __thread int number;è¿™æ ·ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæ‹¥æœ‰è¿™ä¸ªå˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚ æ˜¾å¼TLSï¼Œç¨‹åºå‘˜é¡»è¦æ‰‹å·¥ç”³è¯·TLSå˜é‡ï¼Œå¹¶åœ¨æ¯æ¬¡è®¿é—®è¯¥å˜é‡æ—¶éƒ½è¦è°ƒç”¨ç›¸åº”çš„å‡½æ•°å¾—åˆ°å˜é‡çš„åœ°å€ï¼Œå¹¶åœ¨è®¿é—®å®Œæˆä¹‹åŽé¡»è¦é‡Šæ”¾è¯¥å˜é‡ã€‚pthreadåº“ä¸­æä¾›äº† pthread_key_create()ã€pthread_getspecific()ã€pthread_setspecific()ã€pthread_key_delete()ã€‚ freadå®žçŽ°freadæœ‰4ä¸ªå‚æ•°ï¼Œä»Žæ–‡ä»¶æµstreamé‡Œè¯»å–countä¸ªå¤§å°ä¸ºelementSizeå­—èŠ‚çš„æ•°æ®ï¼Œå­˜å‚¨åœ¨bufferé‡Œã€‚ ç”±äºŽç³»ç»Ÿè°ƒç”¨å¼€é”€å¤§ï¼Œè¦è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€å†…æ ¸å‚æ•°æ£€æŸ¥ã€å¤åˆ¶ï¼Œé¢‘ç¹è¿›è¡Œä¼šä¸¥é‡å½±å“ç¨‹åºå’Œç³»ç»Ÿæ€§èƒ½ï¼Œæ‰€ä»¥I/Oç³»ç»Ÿä¸­å¼•å…¥ç¼“å†²ï¼ˆBufferï¼‰çš„æ¦‚å¿µã€‚æ¯”å¦‚è®²å¯¹æŽ§åˆ¶å°çš„å¤šæ¬¡å†™å…¥æ”¾å…¥ä¸€ä¸ªæ•°ç»„é‡Œï¼Œç­‰åˆ°æ•°ç»„è¢«å¡«æ»¡ä¹‹åŽå†ä¸€æ¬¡æ€§å®Œæˆç³»ç»Ÿè°ƒç”¨å†™å…¥ã€‚è¯»æ–‡ä»¶åˆ™å…ˆçœ‹ç¼“å†²ä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œæœ‰åˆ™ç›´æŽ¥ä»Žç¼“å†²ä¸­è¯»å–ï¼Œè‹¥ä¸ºç©ºåˆ™é€šè¿‡ç³»ç»Ÿè°ƒç”¨ä¸€æ¬¡æ€§è¯»å–ä¸€å¤§å—æ–‡ä»¶å†…å®¹å¡«å……åˆ°ç¼“å†²åŒºã€‚ fwriteå‘æ–‡ä»¶å†™å…¥ä¸€æ®µæ•°æ®æ—¶ï¼Œæ­¤æ—¶è¿™äº›æ•°æ®ä¸ä¸€å®šè¢«çœŸæ­£åœ°å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å¯èƒ½è¿˜å­˜åœ¨äºŽæ–‡ä»¶çš„å†™ç¼“å†²é‡Œé¢ï¼Œå¦‚æžœæ­¤æ—¶ç³»ç»Ÿå´©æºƒæˆ–æ„å¤–é€€å‡ºç¨‹åºï¼Œå°±å¯èƒ½ä¸¢å¤±æ•°æ®ã€‚å› æ­¤æ ‡å‡†åº“æä¾›äº†ç›¸å…³çš„å‡½æ•°å¼¥è¡¥ç¼“å†²å¸¦æ¥çš„é—®é¢˜ï¼š fflushï¼Œå°†ç¼“å†²çš„æ•°æ®å…¨éƒ¨å†™å…¥å®žé™…çš„æ–‡ä»¶ï¼Œå¹¶æƒ…å†µç¼“å†²ã€‚ setvbufï¼Œè®¾ç½®æŒ‡å®šæ–‡ä»¶çš„ç¼“å†²ï¼Œ_IONBFï¼ˆæ— ç¼“å†²æ¨¡å¼ï¼‰ï¼šè¯¥æ–‡ä»¶ä¸ä½¿ç”¨ä»»ä½•ç¼“å†²ï¼Œ_IOLBFï¼ˆè¡Œç¼“å†²æ¨¡å¼ï¼‰ï¼šä»…æ”¯æŒæ–‡æœ¬æ¨¡å¼æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ¯æ”¶åˆ°ä¸€æ¢è¡Œç¬¦ï¼Œå°±å°†ç¼“å†²flushï¼Œ_IOFBFï¼ˆå…¨ç¼“å†²æ¨¡å¼ï¼‰ï¼šä»…å½“ç¼“å†²æ»¡æ—¶æ‰flushã€‚ setbufï¼ŒåŒä¸Šã€‚ fread-&gt;fread_s (ç¼“å†²æº¢å‡ºä¿æŠ¤ã€åŠ é”çº¿ç¨‹å®‰å…¨)-&gt;_fread_nolock_sï¼ˆå¾ªçŽ¯è¯»å–ã€ç¼“å†²ï¼‰-&gt;_readï¼ˆæ¢è¡Œç¬¦è½¬æ¢ï¼‰-&gt;ç³»ç»ŸAPI ç³»ç»Ÿè°ƒç”¨ä¸ŽAPIç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ï¼Œæ˜¯åº”ç”¨ç¨‹åºä¸Žæ“ä½œç³»ç»Ÿå†…æ ¸ä¹‹é—´çš„æŽ¥å£ã€‚è¿™äº›æŽ¥å£å¾€å¾€é€šè¿‡ä¸­æ–­æ¥å®žçŽ°ï¼Œæ¯”å¦‚0x80å·ä¸­æ–­ä½œä¸ºç³»ç»Ÿè°ƒç”¨çš„å…¥å£ï¼Œå„ä¸ªé€šç”¨å¯„å­˜å™¨ç”¨äºŽä¼ é€’å‚æ•°ï¼ŒEAXå¯„å­˜å™¨ç”¨äºŽè¡¨ç¤ºç³»ç»Ÿè°ƒç”¨çš„æŽ¥å£å·ï¼Œæ¯”å¦‚ï¼š EAX=1è¡¨ç¤ºé€€å‡ºè¿›ç¨‹ï¼ˆexitï¼‰ï¼› EAX=2è¡¨ç¤ºåˆ›å»ºè¿›ç¨‹ï¼ˆforkï¼‰ï¼› EAX=3è¡¨ç¤ºè¯»å–æ–‡ä»¶IOï¼ˆreadï¼‰ï¼› EAX=4è¡¨ç¤ºå†™æ–‡ä»¶æˆ–IOSï¼ˆwriteï¼‰ï¼› EAX=5è¡¨ç¤ºæ‰“å¼€æ–‡ä»¶ï¼ˆopenï¼‰ï¼› EAX=6è¡¨ç¤ºå…³é—­æ–‡ä»¶ï¼ˆcloseï¼‰ï¼› EAX=7è¡¨ç¤ºç­‰å¾…è¿›ç¨‹é€€å‡ºï¼ˆwaitpidï¼‰ï¼› EAX=8è¡¨ç¤ºåˆ›å»ºæ–‡ä»¶ï¼ˆcreateï¼‰â€¦ æ¯ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½å¯¹åº”äºŽå†…æ ¸æºç ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œéƒ½ä»¥sys_å¼€å¤´ï¼Œæ¯”å¦‚exitå¯¹åº”sys_exitå‡½æ•°ï¼Œå½“ç³»ç»Ÿè°ƒç”¨è¿”å›žæ—¶ï¼ŒEAXåˆä½œä¸ºè°ƒç”¨ç»“æžœçš„è¿”å›žå€¼ï¼Œå‚æ•°é€šè¿‡EBXã€ECXã€EDXã€ESIã€EDIå’ŒEBPä¼ å…¥ã€‚ç±»åž‹åŒ…æ‹¬æœ‰æƒé™ç®¡ç†ã€å®šæ—¶å™¨ã€ä¿¡å·ã€ç½‘ç»œç­‰ç›¸å…³çš„ã€‚ å¯ä»¥ä½¿ç”¨manå‘½ä»¤æŸ¥çœ‹æ¯ä¸ªç³»ç»Ÿè°ƒç”¨çš„è¯¦ç»†è¯´æ˜Žã€‚å› ä¸ºç³»ç»Ÿè°ƒç”¨ä½¿ç”¨ä¸ä¾¿ã€æ“ä½œç³»ç»Ÿé—´ä¸å…¼å®¹ï¼Œæ‰€ä»¥è¿è¡Œåº“çš„å­˜åœ¨çš„ä¸€éƒ¨åˆ†åŽŸå› ä¹Ÿæ˜¯ä¸ºè§£å†³è¿™éƒ¨åˆ†é—®é¢˜ã€‚ ç³»ç»Ÿè°ƒç”¨æ˜¯è¿è¡Œåœ¨å†…æ ¸çŠ¶æ€çš„ï¼Œè€Œåº”ç”¨ç¨‹åºåŸºæœ¬éƒ½æ˜¯è¿è¡Œåœ¨ç”¨æˆ·æ€çš„ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡ä¸­æ–­ï¼ˆInterruptï¼‰æ¥ä»Žç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚ ä¸­æ–­æœ‰ä¸¤ç§ç±»åž‹ï¼š ç¡¬ä¸­æ–­ï¼Œæ¥è‡ªç¡¬ä»¶çš„å¼‚å¸¸æˆ–äº‹ä»¶å‘ç”Ÿï¼› è½¯ä¸­æ–­ï¼Œé€šå¸¸æ˜¯ä¸€æ¡æŒ‡ä»¤ï¼ˆintï¼‰ï¼Œå¸¦ä¸€ä¸ªå‚æ•°è®°å½•ä¸­æ–­å·ï¼Œè§¦å‘æŸä¸ªä¸­æ–­å¹¶æ‰§è¡Œå…¶ä¸­æ–­å¤„ç†ç¨‹åºã€‚ åœ¨å†…æ ¸ä¸­æœ‰ä¸€ä¸ªæ•°ç»„ç§°ä¸ºä¸­æ–­å‘é‡è¡¨ï¼ˆInterrupt Vector Tableï¼‰ï¼Œç¬¬né¡¹å³åŒ…å«äº†æŒ‡å‘ç¬¬nå·ä¸­æ–­çš„ä¸­æ–­å¤„ç†ç¨‹åºçš„æŒ‡é’ˆã€‚è§¦å‘ç³»ç»Ÿè°ƒç”¨çš„æŒ‡ä»¤ï¼ˆä¸­æ–­å·æ”¾ç½®åœ¨å›ºå®šçš„å¯„å­˜å™¨ä¸­ï¼Œåƒeaxæ¥ä¼ å…¥ï¼‰ï¼š int 0x80ç³»ç»Ÿè°ƒç”¨ä½¿ç”¨è¿”å›žå€¼ä¼ é€’é”™è¯¯ç ï¼Œè‹¥ä¸ºè´Ÿæ•°è¡¨æ˜Žè°ƒç”¨å¤±è´¥ï¼Œè€ŒCè¯­è¨€é‡Œå¤§å¤šå‡½æ•°éƒ½ä»¥è¿”å›ž-1è¡¨ç¤ºè°ƒç”¨å¤±è´¥ï¼Œè€Œå°†å‡ºé”™ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªåä¸ºerrnoçš„å…¨å±€å˜é‡ã€‚ CPUæ‰§è¡Œåˆ°int $0x80æ—¶ï¼Œä¿å­˜çŽ°åœºä»¥ä¾¿æ¢å¤ï¼›ï¼ˆintå¯¹åº”çš„æ˜¯iretæŒ‡ä»¤ï¼Œä¼šå¯¹åŽ‹æ ˆçš„å¯„å­˜å™¨åœ¨åˆ‡å›žåˆ°ç”¨æˆ·æ€æ—¶å‡ºæ ˆï¼‰ ç„¶åŽå°†ç‰¹æƒçŠ¶æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼›ï¼ˆç”¨æˆ·æ€å’Œå†…æ ¸æ€ä½¿ç”¨çš„æ˜¯ä¸åŒçš„æ ˆï¼Œå¯„å­˜å™¨SSè¿˜åº”è¯¥æŒ‡å‘å½“å‰æ ˆæ‰€åœ¨çš„é¡µï¼Œåœ¨å†…æ ¸æ ˆä¸­åŽ‹å…¥ç”¨æˆ·æ€çš„å¯„å­˜å™¨ï¼‰ ç„¶åŽCPUæŸ¥æ‰¾ä¸­æ–­å‘é‡è¡¨ä¸­çš„ç¬¬0x80å·å…ƒç´  å…³äºŽæ±‡ç¼–æ±‡ç¼–è¯­è¨€ï¼ˆ assembly languageï¼Œç¼©å†™ä¸º asmï¼‰æ˜¯äºŒè¿›åˆ¶æŒ‡ä»¤çš„æ–‡æœ¬å½¢å¼ï¼Œä¸ŽæŒ‡ä»¤æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚äºŒè¿›åˆ¶çš„æŒ‡ä»¤åˆç§°ä¸ºæ“ä½œç ï¼ˆopcodeï¼‰ã€‚ æŠŠæ–‡å­—æŒ‡ä»¤ç¿»è¯‘æˆäºŒè¿›åˆ¶ï¼Œè¿™ä¸ªæ­¥éª¤å°±ç§°ä¸º assemblingï¼Œå®Œæˆè¿™ä¸ªæ­¥éª¤çš„ç¨‹åºå°±å«åš assemblerï¼Œå®ƒå¤„ç†çš„æ–‡æœ¬ï¼Œè‡ªç„¶å°±å«åš aseembly codeã€‚ å¯„å­˜å™¨CPU æœ¬èº«åªè´Ÿè´£è¿ç®—ï¼Œä¸è´Ÿè´£å‚¨å­˜æ•°æ®ã€‚CPU çš„è¿ç®—é€Ÿåº¦è¿œé«˜äºŽå†…å­˜çš„è¯»å†™é€Ÿåº¦ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¢«æ‹–æ…¢ï¼ŒCPU éƒ½è‡ªå¸¦ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼Œè€Œä¸ä»Žå†…å­˜è¯»å†™ã€‚ä½†CPU ç¼“å­˜è¿˜æ˜¯ä¸å¤Ÿå¿«ï¼Œå¦å¤–æ•°æ®åœ¨ç¼“å­˜é‡Œé¢çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼ŒCPU æ¯æ¬¡è¯»å†™éƒ½è¦å¯»å€ä¹Ÿä¼šæ‹–æ…¢é€Ÿåº¦ã€‚å› æ­¤ï¼Œé™¤äº†ç¼“å­˜ä¹‹å¤–ï¼ŒCPU è¿˜è‡ªå¸¦äº†å¯„å­˜å™¨ï¼ˆregisterï¼‰ï¼Œç”¨æ¥å‚¨å­˜æœ€å¸¸ç”¨çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé‚£äº›æœ€é¢‘ç¹è¯»å†™çš„æ•°æ®ï¼ˆæ¯”å¦‚å¾ªçŽ¯å˜é‡ï¼‰ï¼Œéƒ½ä¼šæ”¾åœ¨å¯„å­˜å™¨é‡Œé¢ï¼ŒCPU ä¼˜å…ˆè¯»å†™å¯„å­˜å™¨ï¼Œå†ç”±å¯„å­˜å™¨è·Ÿå†…å­˜äº¤æ¢æ•°æ®ã€‚å¯„å­˜å™¨ä¸ä¾é åœ°å€åŒºåˆ†æ•°æ®ï¼Œè€Œä¾é åç§°ã€‚ 32 ä½ CPU çš„å¯„å­˜å™¨å¤§å°å°±æ˜¯4ä¸ªå­—èŠ‚ï¼Œæ—©æœŸçš„ x86 CPU åªæœ‰8ä¸ªå¯„å­˜å™¨ï¼š EAX EBX ECX EDX EDI ESI EBP ESP å¯„å­˜å™¨åªèƒ½å­˜æ”¾å¾ˆå°‘é‡çš„æ•°æ®ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼ŒCPU è¦æŒ‡æŒ¥å¯„å­˜å™¨ï¼Œç›´æŽ¥è·Ÿå†…å­˜äº¤æ¢æ•°æ®ã€‚ å¯„å­˜å™¨çš„å…·ä½“ç§ç±»ï¼š æ•°æ®å¯„å­˜å™¨ AXï¼šç´¯ç§¯æš‚å­˜å™¨ BXï¼šåŸºåº•æš‚å­˜å™¨ CXï¼šè®¡æ•°æš‚å­˜å™¨ DXï¼šèµ„æ–™æš‚å­˜å™¨ ç´¢å¼•æš‚å­˜å™¨ï¼ˆå˜å€&amp;æŒ‡é’ˆå¯„å­˜å™¨ï¼‰ SIï¼šæ¥æºç´¢å¼•æš‚å­˜å™¨ DIï¼šç›®çš„ç´¢å¼•æš‚å­˜å™¨ æŒ‡é’ˆå¯„å­˜å™¨ SPï¼šå †å æŒ‡æ ‡æš‚å­˜å™¨ BPï¼šåŸºåº•æŒ‡æ ‡æš‚å­˜å™¨ é€šç”¨å¯„å­˜å™¨ï¼ˆå˜é‡ï¼‰ EAX æ˜¯â€ç´¯åŠ å™¨â€(accumulator)ï¼Œå®ƒæ˜¯å¾ˆå¤šåŠ æ³•ä¹˜æ³•æŒ‡ä»¤çš„ç¼ºçœå¯„å­˜å™¨ï¼Œé»˜è®¤ä¿å­˜æ‰€æœ‰APIå‡½æ•°çš„è¿”å›žå€¼ã€‚ EBX æ˜¯â€åŸºåœ°å€â€(base)å¯„å­˜å™¨, åœ¨å†…å­˜å¯»å€æ—¶å­˜æ”¾åŸºåœ°å€ï¼Œå³ä½œä¸ºå­˜å‚¨å™¨æŒ‡é’ˆæ¥ä½¿ç”¨ã€‚ ECX æ˜¯è®¡æ•°å™¨(counter), æ˜¯é‡å¤(REP)å‰ç¼€æŒ‡ä»¤å’ŒLOOPæŒ‡ä»¤çš„å†…å®šè®¡æ•°å™¨ï¼Œå³åœ¨å¾ªçŽ¯å’Œå­—ç¬¦ä¸²æ“ä½œæ—¶ï¼Œè¦ç”¨å®ƒæ¥æŽ§åˆ¶å¾ªçŽ¯æ¬¡æ•°ï¼›åœ¨ä½æ“ä½œä¸­ï¼Œå½“ç§»å¤šä½æ—¶ï¼Œè¦ç”¨CLæ¥æŒ‡æ˜Žç§»ä½çš„ä½æ•°ã€‚loopæŒ‡ä»¤çš„ç”¨æ³•ä¸ºï¼ŒCPUæ‰§è¡ŒloopæŒ‡ä»¤çš„æ—¶å€™ï¼Œä¸€å…ˆè¿›è¡Œ(CX)=(CX)-1ï¼ŒäºŒåˆ¤æ–­cxä¸­çš„å€¼ï¼Œä¸ä¸º0åˆ™è½¬è‡³æ ‡å·å¤„æ‰§è¡Œç¨‹åºï¼Œå¦‚æžœä¸º0åˆ™å‘ä¸‹æ‰§è¡Œã€‚ EDX æ€»æ˜¯è¢«ç”¨æ¥æ”¾æ•´æ•°é™¤æ³•äº§ç”Ÿçš„ä½™æ•°ï¼Œåœ¨è¿›è¡Œä¹˜ã€é™¤è¿ç®—æ—¶ï¼Œå®ƒå¯ä½œä¸ºé»˜è®¤çš„æ“ä½œæ•°å‚ä¸Žè¿ç®—ï¼Œä¹Ÿå¯ç”¨äºŽå­˜æ”¾I/Oçš„ç«¯å£åœ°å€ã€‚ ESI/EDIåˆ†åˆ«å«åšâ€æº/ç›®æ ‡ç´¢å¼•å¯„å­˜å™¨â€(source/destination index)ï¼Œå› ä¸ºåœ¨å¾ˆå¤šå­—ç¬¦ä¸²æ“ä½œæŒ‡ä»¤ä¸­ï¼ŒDS:ESIæŒ‡å‘æºä¸²ï¼Œè€ŒES:EDIæŒ‡å‘ç›®æ ‡ä¸²ã€‚ä¹Ÿå¯ä»¥å«ä»–ä»¬åšå˜å€å¯„å­˜å™¨(Index Registerï¼‰ï¼Œä¸»è¦æ˜¯å¯ç”¨äºŽå­˜æ”¾å­˜å‚¨å•å…ƒåœ¨æ®µå†…çš„åç§»é‡ï¼Œç”¨å®ƒä»¬å¯å®žçŽ°å¤šç§å­˜å‚¨å™¨æ“ä½œæ•°çš„å¯»å€æ–¹å¼ï¼Œä¸ºä»¥ä¸åŒçš„åœ°å€å½¢å¼è®¿é—®å­˜å‚¨å•å…ƒæä¾›æ–¹ä¾¿ã€‚å˜å€å¯„å­˜å™¨ä¸å¯åˆ†å‰²æˆ8ä½å¯„å­˜å™¨ã€‚ä½œä¸ºé€šç”¨å¯„å­˜å™¨ï¼Œä¹Ÿå¯å­˜å‚¨ç®—æœ¯é€»è¾‘è¿ç®—çš„æ“ä½œæ•°å’Œè¿ç®—ç»“æžœã€‚å®ƒä»¬å¯ä½œä¸€èˆ¬çš„å­˜å‚¨å™¨æŒ‡é’ˆä½¿ç”¨ã€‚åœ¨å­—ç¬¦ä¸²æ“ä½œæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹å®ƒä»¬æœ‰ç‰¹å®šçš„è¦æ±‚ï¼Œè€Œä¸”è¿˜å…·æœ‰ç‰¹æ®Šçš„åŠŸèƒ½ã€‚ EBP åŸºå€æŒ‡é’ˆå¯„å­˜å™¨(extended base pointer)ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„åº•éƒ¨ ESP æ ˆæŒ‡é’ˆå¯„å­˜å™¨(extended stack pointer)ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„æ ˆé¡¶ã€‚SS:SPï¼ŒSSä¸­å­˜æ”¾çš„æ˜¯æ ˆé¡¶çš„æ®µåœ°å€ï¼Œåç§»åœ°å€å­˜æ”¾åœ¨SPä¸­ï¼Œä»»æ„æ—¶åˆ»æœ‰ï¼šSS:SPæŒ‡å‘æ ˆé¡¶å…ƒç´ ã€‚ æ®µå¯„å­˜å™¨ï¼ˆç‰©ç†åœ°å€=æ®µåœ°å€*16+åç§»åœ°å€ï¼‰ CS CPUå°†CS:IPæŒ‡å‘çš„å†…å­˜å•å…ƒä¸­çš„å†…å®¹çœ‹ä½œæŒ‡ä»¤ï¼ˆCS:ä»£ç æ®µå¯„å­˜å™¨ã€‚IPï¼šæŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼‰ DS ES SS EAXæ˜¯32ä½å¯„å­˜å™¨ï¼ŒAXæ˜¯16ä½å¯„å­˜å™¨,AL(AH)æ˜¯å…«ä½å¯„å­˜å™¨ã€‚EAXå¯ä»¥å­˜å‚¨çš„æ•°å­—æ˜¯DWORDï¼ˆåŒå­—ï¼‰ï¼ŒAXå­˜å‚¨çš„æ˜¯WORDï¼ˆå­—ï¼‰ï¼ŒAL(AH)å­˜å‚¨çš„æ˜¯BYTEï¼ˆå­—èŠ‚ï¼‰ã€‚EAXã€ECXã€EDXã€EBXï¼šæ˜¯AXã€CXã€DXã€BXçš„å»¶ä¼¸ï¼Œå„ä¸º32ä½ä½ã€‚ESIã€EDIã€ESPã€EBPï¼šæ˜¯SIã€DIã€SPã€BPçš„å»¶ä¼¸ï¼Œå„ä¸º32ä½ä½ å†…å­˜æ¨¡åž‹å…³äºŽå †ï¼Œå¯¹äºŽåŠ¨æ€çš„å†…å­˜å ç”¨è¯·æ±‚ï¼Œç³»ç»Ÿå°±ä¼šä»Žé¢„å…ˆåˆ†é…å¥½çš„é‚£æ®µå†…å­˜ä¹‹ä¸­ï¼Œåˆ’å‡ºä¸€éƒ¨åˆ†ç»™ç”¨æˆ·ï¼Œå…·ä½“è§„åˆ™æ˜¯ä»Žèµ·å§‹åœ°å€+ä¸€æ®µé™æ€æ•°æ®åŽçš„åœ°å€å¼€å§‹åˆ’åˆ†ï¼Œæ­¤ä¸ºHeapï¼ˆå †ï¼‰ã€‚ å…³äºŽæ ˆï¼Œå…¶ä»–çš„å†…å­˜å ç”¨å°±å«åš Stackï¼ˆæ ˆï¼‰ï¼Œæ˜¯ç”±äºŽå‡½æ•°è¿è¡Œè€Œä¸´æ—¶å ç”¨çš„å†…å­˜åŒºåŸŸã€‚åœ¨æ ˆä¸­ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªè°ƒç”¨çš„å‡½æ•°æ–°å»ºä¸€ä¸ªå¸§ï¼Œç”¨æ¥å‚¨å­˜å®ƒçš„å†…éƒ¨å˜é‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨æ ˆæœ‰å¤šå°‘å±‚ï¼Œå°±æœ‰å¤šå°‘å¸§ã€‚æ ˆæ˜¯ç”±å†…å­˜åŒºåŸŸçš„ç»“æŸåœ°å€å¼€å§‹ï¼Œä»Žé«˜ä½ï¼ˆåœ°å€ï¼‰å‘ä½Žä½ï¼ˆåœ°å€ï¼‰åˆ†é…ã€‚ ç¨‹åºä»Žå‡½æ•°çš„æ ‡ç­¾å¼€å§‹æ‰§è¡Œï¼Œè¿™æ—¶ä¼šåœ¨ Stack ä¸Šä¸ºå‡½æ•°å»ºç«‹ä¸€ä¸ªå¸§ï¼Œå¹¶å°† Stack æ‰€æŒ‡å‘çš„åœ°å€ï¼Œå†™å…¥ ESP å¯„å­˜å™¨ã€‚ æ±‡ç¼–æŒ‡ä»¤X86æŒ‡ä»¤ push nï¼šç”¨äºŽå°†è¿ç®—å­æ”¾å…¥ Stackï¼ŒpushæŒ‡ä»¤å…¶å®žæœ‰ä¸€ä¸ªå‰ç½®æ“ä½œã€‚å®ƒä¼šå…ˆå–å‡º ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€ï¼Œå°†å…¶å‡åŽ»ï¼ˆå³å‘ä½Žä½å‘å±•ï¼‰næ‰€å ç”¨çš„å­—èŠ‚æ•°ï¼Œç„¶åŽå°†æ–°åœ°å€å†™å…¥ ESP å¯„å­˜å™¨ã€‚ push %ebxï¼šè¡¨ç¤ºå°† EBX å¯„å­˜å™¨é‡Œé¢çš„å€¼ï¼Œå†™å…¥æŸå‡½æ•°çš„å¸§ã€‚æœ‰äº›ç¼–è¯‘å™¨ï¼ˆåƒå¾®è½¯çš„ï¼‰æè¿°çš„å¯„å­˜å™¨ä½ç½®åˆ™æ²¡æœ‰å‰ç¼€ç¬¦å·%ã€‚ call functionï¼šç¨‹åºä¼šåŽ»æ‰¾functionè¯¥å‡½æ•°æ ‡ç­¾ï¼Œå¹¶ä¸ºè¯¥å‡½æ•°å»ºç«‹ä¸€ä¸ªæ–°çš„å¸§ã€‚ mov %eax, [%esp+8] ï¼šè¿™æ˜¯Intelçš„movæ ¼å¼ï¼Œå…ˆå°† ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€åŠ ä¸Š8ä¸ªå­—èŠ‚ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œç„¶åŽæŒ‰ç…§è¿™ä¸ªåœ°å€åœ¨ Stack å–å‡ºæ•°æ®ï¼Œå†å°†æ•°æ®å†™å…¥ EAX å¯„å­˜å™¨ã€‚ movl %edx, 4(%edi)ï¼šè¿™ä¸ªAT&amp;Tçš„æ ¼å¼ï¼Œç”±äºŽGNUæ±‡ç¼–å™¨ä¸å…è®¸å€¼ä¸Žå¯„å­˜å™¨ç›¸åŠ ï¼Œå¿…é¡»å°†å€¼æ”¾åœ¨æ‹¬å·å¤–ï¼ˆå…ˆå–åœ°å€å†è¿ç®—ï¼‰ï¼Œè¿™æ¡æŒ‡ä»¤å°±æ˜¯æŠŠEDXå¯„å­˜å™¨çš„å€¼å­˜æ”¾åœ¨EDIå¯„å­˜å™¨æŒ‡å‘çš„ä½ç½®ä¹‹åŽ4ä¸ªå­—èŠ‚çš„å†…å­˜ä½ç½®ä¸­ï¼Œ4ä¹Ÿæ˜¯è®¾ç½®ä¸º-4æ¥è®©æ–¹å‘å–åã€‚è‹¥å¯¹ç«‹å³æ•°æ“ä½œï¼Œåˆ™ç«‹å³æ•°å‰é¢å¿…é¡»æ”¾ä¸€ä¸ª$ï¼Œç”¨å…¶è¡¨ç¤ºå–valueçš„å†…å­˜åœ°å€ã€‚ add %eax, %ebxï¼šå°†ä¸¤ä¸ªè¿ç®—å­ç›¸åŠ ï¼Œå¹¶å°†ç»“æžœå†™å…¥ç¬¬ä¸€ä¸ªè¿ç®—å­ã€‚å³å°† EAX å¯„å­˜å™¨çš„å€¼åŠ ä¸Š EBX å¯„å­˜å™¨çš„å€¼ï¼Œç»“æžœå†™å…¥ç¬¬ä¸€ä¸ªè¿ç®—å­ EAX å¯„å­˜å™¨ã€‚ pop %ebxï¼šå–å‡º Stack æœ€è¿‘ä¸€ä¸ªå†™å…¥çš„å€¼ï¼ˆå³æœ€ä½Žä½åœ°å€çš„å€¼ï¼‰ï¼Œå¹¶å°†è¿™ä¸ªå€¼å†™å…¥è¿ç®—å­æŒ‡å®šçš„ä½ç½®ï¼ˆå¯„å­˜å™¨ï¼‰ã€‚æ³¨æ„ï¼ŒpopæŒ‡ä»¤è¿˜ä¼šå°† ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€åŠ 4è¿›è¡Œå›žæ”¶ã€‚ retï¼šç»ˆæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå°†è¿è¡Œæƒäº¤è¿˜ç»™ä¸Šå±‚å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å½“å‰å‡½æ•°çš„å¸§å°†è¢«å›žæ”¶ã€‚ add %esp, 8ï¼šç”±äºŽespå¯„å­˜å™¨å­˜çš„å€¼å°±æ˜¯æ ˆé¡¶åœ°å€ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºï¼Œå°† ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€ï¼Œæ‰‹åŠ¨åŠ ä¸Š8ä¸ªå­—èŠ‚ï¼Œå†å†™å›ž ESP å¯„å­˜å™¨ã€‚ movl %ebx, (%edi)ï¼šå½“ediæ²¡æ‹¬å·æ—¶ï¼Œåˆ™åªæ˜¯æŠŠEBXå¯„å­˜å™¨çš„å€¼åŠ è½½åˆ°EDIå¯„å­˜å™¨ä¸­ï¼Œä½†è‹¥EDIå¸¦æœ‰æ‹¬å·æ—¶ï¼Œåˆ™æŒ‡ä»¤è¡¨ç¤ºæŠŠEBXå¯„å­˜å™¨ä¸­çš„å€¼ä¼ é€ç»™EDIå¯„å­˜å™¨ä¸­åŒ…å«çš„å†…å­˜ä½ç½®ã€‚ lea eax,[ebx+8]ï¼šå°±æ˜¯å°†ebx+8è¿™ä¸ªå€¼ç›´æŽ¥èµ‹ç»™eaxï¼ˆebxå…¶æ‰€å­˜åœ°å€æŒ‡å‘çš„å€¼+8ï¼‰ï¼Œè€Œä¸æ˜¯æŠŠebx+8å¤„çš„å†…å­˜åœ°å€é‡Œçš„æ•°æ®èµ‹ç»™eaxã€‚ LEAï¼ˆload dffective addressï¼‰å…³äºŽLEAï¼Œå¯èƒ½æ¯”è¾ƒéš¾ç†è§£ï¼Œä¸‹é¢åšè¯¦ç»†çš„ä»‹ç» LEAæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å–åç§»åœ°å€ï¼ˆä¼˜åŒ–å¯»å€æ—¶çš„ç®—æœ¯è¿ç®—ï¼Œå¯å››åˆ™æ··åˆè¿ç®—ï¼‰ï¼ŒMOVæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯ä¼ é€æ•°æ® LEA AX,[1000H]ï¼Œä½œç”¨æ˜¯å°†å†…å­˜å•å…ƒ[1000H]çš„åç§»åœ°å€1000Hé€è‡³AXï¼›MOV AX,[1000H]ï¼Œä½œç”¨æ˜¯å°†å†…å­˜å•å…ƒ[1000H]çš„å†…å®¹1234Hé€ç»™AX LEA AX,[SI]ï¼Œä½œç”¨æ˜¯å°†å¯„å­˜å™¨SIçš„å†…å®¹4567Hå½“åšæ•°æ®ä¼ é€ç»™AXï¼›MOV AX,[SI]ï¼Œä½œç”¨æ˜¯å°†å¯„å­˜å™¨SIçš„å†…å®¹4567Hå½“åšåœ°å€çœ‹å¾…ï¼Œå°†åœ°å€ä¸º4567Hå¤„çš„å†…å®¹ä¼ é€ç»™AXï¼› LEA AX,SIï¼Œä½œç”¨æ˜¯å°†å¯„å­˜å™¨SIçš„åç§»åœ°å€1001Hä¼ é€ç»™AXï¼›MOV AX,SIï¼Œä½œç”¨æ˜¯å°†å¯„å­˜å™¨SIçš„å†…å®¹ä¼ é€ç»™AXï¼› å‡ ç§å½¢å¼ï¼šLEA BX ï¼ŒBUFFERLEA AXï¼Œ[BX]DILEA DXï¼ŒDATA [BX]SI å‡ ç§ç­‰ä»·ï¼š1.LEA BX,TABLE ç­‰ä»·äºŽ MOV BX,OFFSET TABLE2.LEA AX,[SI] ç­‰ä»·äºŽ MOV AX,SI ä½†æœ‰æ—¶ä¸èƒ½ç›´æŽ¥ä½¿ç”¨MOVä»£æ›¿ï¼Œæ¯”å¦‚ï¼šLEA AX,[SI+6] ä¸èƒ½ç›´æŽ¥æ›¿æ¢æˆï¼šMOV AX,SI+6ï¼›ä½†å¯æ›¿æ¢ä¸ºæ‹†åˆ†ä¸¤æ­¥ï¼šMOV AX,SI å’Œ ADD AX,6 LEAæŒ‡ä»¤æ˜¯ä¸€ä¸ªè®¡ç®—æœºæŒ‡ä»¤ï¼Œå¯ä»¥å°†æœ‰æ•ˆåœ°å€ä¼ é€åˆ°æŒ‡å®šçš„çš„å¯„å­˜å™¨ã€‚LEA OPRD1,OPRD2ï¼ŒOPRD1 ä¸ºç›®çš„æ“ä½œæ•°ï¼ŒOPRD2 ä¸ºæºæ“ä½œæ•°ï¼Œå¯ä¸ºå˜é‡åã€æ ‡å·æˆ–åœ°å€è¡¨è¾¾å¼ã€‚ä»Žç¬¬äºŒä¸ªæ“ä½œæ•°ï¼ˆæºæ“ä½œæ•°ï¼‰è®¡ç®—æœ‰æ•ˆåœ°å€ï¼Œå¹¶å°†ç»“æžœå­˜å…¥ç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼ˆç›®çš„æ“ä½œæ•°ï¼‰ã€‚æºæ“ä½œæ•°æ˜¯æŒ‡å®šäº†ä¸€ç§è®¿å­˜æ“ä½œçš„å†…å­˜åœ°å€ï¼Œç›®çš„æ“ä½œæ•°ä¸ºä¸€ä¸ªé€šç”¨å¯„å­˜å™¨ã€‚ æºæ“ä½œæ•°ä¸ºå˜é‡æˆ–è€…ç«‹å³æ•°æ—¶ï¼Œä¸Žä¸ºå¯„å­˜å™¨æ—¶ä¸åŒã€‚ å¯¹äºŽleaæŒ‡ä»¤æ¥è¯´ï¼Œæœ‰æ²¡æœ‰[]å¯¹äºŽå˜é‡æ˜¯æ— æ‰€è°“çš„ï¼Œå…¶ç»“æžœéƒ½æ˜¯å–å˜é‡çš„åœ°å€ï¼Œç›¸å½“äºŽèŽ·å–å…¶æŒ‡é’ˆï¼ŒLeaçš„åç§»é‡è¿˜å¯ä»¥æ˜¯ç«‹å³æ•°ï¼Œlea ebx,num; = lea eax,[num]; å¯¹äºŽmovæŒ‡ä»¤æ¥è¯´ï¼Œæœ‰æ²¡æœ‰[]å¯¹äºŽå˜é‡æ˜¯æ— æ‰€è°“çš„ï¼Œå…¶ç»“æžœéƒ½æ˜¯å–å€¼ï¼Œç«‹å³æ•°æ—¶åˆ™æ˜¯ç›´æŽ¥èµ‹å€¼ å¦å¤–ä¸€åˆ™ä¾‹å­ï¼š lea eax,[ebx+8]ï¼šè¡¨ç¤ºå°†ebx+8è¿™ä¸ªå€¼ç›´æŽ¥èµ‹ç»™eaxï¼ˆebxå…¶æ‰€å­˜åœ°å€æŒ‡å‘çš„å€¼+8ï¼‰ï¼Œè€Œä¸æ˜¯æŠŠebx+8å¤„çš„å†…å­˜åœ°å€é‡Œçš„æ•°æ®èµ‹ç»™eaxã€‚ mov eax,[ebx+8]ï¼šè€ŒmovæŒ‡ä»¤åˆ™æ°æ°ç›¸åï¼Œæ˜¯æŠŠå†…å­˜åœ°å€ä¸ºebx+8å¤„çš„æ•°æ®èµ‹ç»™eaxã€‚ lea ebx ,[eax+edx]ï¼šè¿™æ ·å¯ä»¥æ»¡è¶³è¦è®¡ç®—ä¸¤ä¸ªå¯„å­˜å™¨çš„å’Œï¼Œè€Œåˆä¸ç ´ååŽŸæ¥çš„å€¼ã€‚è¿™æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ˜¯ ebx = eax + edx è¿™æ¡åŠ æ³•è¿ç®—ï¼ˆä¸¤é¡¹åœ°å€æ‰€æŒ‡å‘çš„å€¼ç›¸åŠ ï¼‰ï¼Œå¦‚æžœç”¨addæŒ‡ä»¤ï¼Œåˆ™ä¸å¯èƒ½ä¸€æ¡æŒ‡ä»¤å†…å®Œæˆã€‚ ARMæŒ‡ä»¤ä¸ŽX86æ±‡ç¼–æ¯”è¾ƒï¼š x86æ±‡ç¼–çš„å¯„å­˜å™¨å°‘ï¼Œç”¨é€”æ˜“è®°ï¼ŒæŒ‡ä»¤æœ€å¤šåªæœ‰2ä¸ªæ“ä½œæ•°ï¼Œå¸¸ç”¨çš„æŒ‡ä»¤åŸºæœ¬éƒ½æ”¯æŒå„ç§å¯»å€æ¨¡å¼ï¼Œx86å¯¹äºŽæ±‡ç¼–å™¨ä»¥åŠåæ±‡ç¼–å™¨å¼€å‘è€…å°±ç‰¹åˆ«éº»çƒ¦ï¼Œ1æ˜¯opcodeè§„åˆ™ç‰¹åˆ«ç‰¹åˆ«å¤æ‚ï¼Œ2æ˜¯å¤ªå¤šå¯æœ‰å¯æ— çš„å‰ç¼€ã€‚ ARMåˆ™æ°å¥½ç›¸åï¼Œå¯„å­˜å™¨å¤šçš„åƒæµ·ä¸€æ ·éš¾è®°ï¼Œè¿˜æœ‰ç«‹å³æ•°çš„ä½¿ç”¨é™åˆ¶ï¼ˆ32ä½æŒ‡ä»¤å¤„ç†32ä½ç«‹å³æ•°é€šè¿‡ä¼ªæŒ‡ä»¤ï¼ˆå¯„å­˜å™¨ï¼‰æ¥å¤„ç†ï¼‰ï¼Œ3å…ƒæ“ä½œæ•°æŒ‡ä»¤æä¾›äº†ä¸å°‘çµå¼‚å˜åŒ–å’Œä¼˜åŒ–ç©ºé—´ã€‚ ä¿æŠ¤æ¨¡å¼åˆ†é¡µåˆ†åˆ«å­˜åœ¨äºŽARMå’Œx86ï¼Œæ˜¯éœ€è¦æŽŒæ¡çš„åŸºç¡€ã€‚ ARMçš„æŒ‡ä»¤æ ¼å¼ï¼š &lt;opcode&gt;{&lt;cond&gt;}{S}{. W|.N} &lt;Rd&gt;,&lt;Rn&gt;{,&lt;operand2&gt;} {}ä¸ºå¯é€‰å‚æ•°ï¼Œ&lt;&gt;ä¸ºå˜é‡ opcodeï¼šæŒ‡ä»¤åŠ©è®°ç¬¦ï¼Œå¦‚MOVã€ADDã€SUBç­‰ï¼› condï¼šæŒ‡ä»¤æ¡ä»¶ç ï¼š EQï¼šç›¸ç­‰ï¼Œæ ‡å¿—ä½Z=1 NEï¼šä¸ç›¸ç­‰ï¼Œæ ‡å¿—ä½Z=0 CS/HSï¼šæ— ç¬¦å·æ•°å¤§äºŽæˆ–ç­‰äºŽï¼Œæ ‡å¿—ä½C=1 CC/LOï¼šæ— ç¬¦å·æ•°å°äºŽï¼Œæ ‡å¿—ä½C=0 MIï¼šè´Ÿæ•°ï¼Œæ ‡å¿—ä½N=1 PLï¼šæ­£æ•°æˆ–é›¶ï¼Œæ ‡å¿—ä½N=0 VSï¼šæº¢å‡ºï¼Œæ ‡å¿—ä½V=1 VCï¼šæ²¡æœ‰æº¢å‡ºï¼Œæ ‡å¿—ä½V=0 HIï¼šæ— ç¬¦å·æ•°å¤§äºŽï¼Œæ ‡å¿—ä½C=1 Z=0 LSï¼šæ— ç¬¦å·æ•°å°äºŽæˆ–ç­‰äºŽï¼Œæ ‡å¿—ä½C=0 Z=1 GEï¼šæœ‰ç¬¦å·æ•°å¤§äºŽæˆ–ç­‰äºŽï¼Œæ ‡å¿—ä½N=V LTï¼šæœ‰ç¬¦å·æ•°å°äºŽï¼Œæ ‡å¿—ä½N!=V GTï¼šæœ‰ç¬¦å·æ•°å¤§äºŽï¼Œæ ‡å¿—ä½Z=0 N=V LEï¼šæœ‰ç¬¦å·æ•°å°äºŽæˆ–ç­‰äºŽï¼Œæ ‡å¿—ä½Z=1 N!=V ALï¼šæ— æ¡ä»¶æ‰§è¡Œï¼ˆé»˜è®¤æ¡ä»¶ï¼‰ï¼Œä»»ä½•æ ‡å¿—ä½ {S}ï¼šæ˜¯å¦å½±å“CPSRçš„å€¼ {.W .N}ï¼šæŒ‡ä»¤å®½åº¦è¯´æ˜Žç¬¦ Rdï¼šç›®çš„å¯„å­˜å™¨ Rnï¼šç¬¬ä¸€ä¸ªæ“ä½œæ•°å¯„å­˜å™¨ operand2ï¼šç¬¬äºŒä¸ªæ“ä½œæ•°ï¼Œå¯ä»¥æ˜¯å¯„å­˜å™¨ã€ç«‹å³æ•°ã€å¯„å­˜å™¨ç§»ä½æ“ä½œã€‚ è·³è½¬æŒ‡ä»¤ BæŒ‡ä»¤ï¼šB{cond} lableï¼Œæ¯”å¦‚BNEå°±æ˜¯not equal z=0æ—¶ï¼Œè·³è½¬åˆ°lableã€‚ BLæŒ‡ä»¤ï¼šBL{cond} lableï¼Œå¦‚æžœæ¡ä»¶condæ»¡è¶³ï¼Œä¼šå°†å½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€copyåˆ°R14ï¼ˆLRï¼‰å¯„å­˜å™¨ä¸­ï¼Œç„¶åŽè·³è½¬åˆ°lableæŒ‡å®šçš„åœ°å€ç»§ç»­æ‰§è¡Œï¼Œè¿™æ¡æŒ‡ä»¤é€šå¸¸ä½œç”¨äºŽå­ç¨‹åºï¼Œåœ¨å­ç¨‹åºçš„å°¾éƒ¨ æ‰§è¡ŒMOV PC,LR å°±å¯ä»¥è¿”å›žåˆ°ä¸»ç¨‹åºä¸­ï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ BXæŒ‡ä»¤ï¼šBX{cond} Rmï¼Œè·³è½¬æ—¶åˆ¤æ–­æ˜¯ç”¨armä»£è¿˜æ˜¯Thumbä»£ç æ‰§è¡Œã€‚ å­˜å‚¨å™¨è®¿é—®æŒ‡ä»¤ LDRæŒ‡ä»¤ï¼šLDR{type}{cond} Rd,lableï¼Œä»Žå­˜å‚¨å™¨ä¸­åŠ è½½æ•°æ®åˆ°å¯„å­˜å™¨ï¼ŒRdæ˜¯è¦åŠ è½½çš„å¯„å­˜å™¨ï¼Œlableæ˜¯è¦è¯»å–çš„å†…å­˜åœ°å€ï¼Œ typeæŒ‡æ˜Žæ“ä½œæ•°çš„å¤§å°ï¼š Bï¼šæ— ç¬¦å·å­—èŠ‚ï¼› SBï¼šæœ‰ç¬¦å·å­—èŠ‚ï¼› Hï¼šæ— ç¬¦å·åŠå­—ï¼› SHï¼šæœ‰ç¬¦å·åŠå­—ï¼› lableè¯»å–å†…å­˜çš„è¡¨ç¤ºæ–¹å¼ï¼š LDR R8, [R9, #04] æˆ– LDR R8, [R9], #04ï¼Œè¡¨ç¤ºç›´æŽ¥åç§»æˆ–å¯„å­˜å™¨åç§»ï¼Œå³åœ¨å¯„å­˜å™¨ä¿å­˜çš„åœ°å€ä¸ŠåŠ ä¸Šåç§»é‡å¾—å‡ºè¦å–å€¼çš„åœ°å€ï¼Œç„¶åŽå–å¾—å€¼å°±æ˜¯labelï¼› LDR R8, #04ï¼Œè¡¨ç¤ºå–å€¼åœ°å€æ˜¯ç›¸å¯¹äºŽPCåç§»ï¼Œlabelå°±æ˜¯PCåç§»åœ°å€æ‰€å­˜çš„å€¼ï¼› STRæŒ‡ä»¤ï¼šSTR{type}{cond} Rd, labelï¼Œä¸ŽLDRç›¸åï¼Œå­˜å‚¨å†…å®¹åˆ°æŒ‡å®šçš„å†…å­˜ä¸­ï¼ŒRdè¡¨ç¤ºè¦å­˜çš„å†…å®¹ï¼Œlabelè¡¨ç¤ºå­˜å‚¨å•å…ƒï¼Œtypeä¸­SBä¸ŽSHæ— æ•ˆã€‚STR R0,[R2,#04] å°†R0å¯„å­˜å™¨çš„æ•°æ®ï¼Œå­˜å‚¨åˆ°R2+4æ‰€æŒ‡å‘çš„å­˜å‚¨å•å…ƒä¸­åŽ»ã€‚ LDMæŒ‡ä»¤ï¼šLDM{addr_mode}{cond} Rn{!} reglistï¼Œä»ŽæŒ‡å®šçš„å­˜å‚¨å•å…ƒåŠ è½½å¤šä¸ªæ•°æ®åˆ°ä¸€ä¸ªå¯„å­˜å™¨åˆ—è¡¨ï¼š Rnä¸ºåŸºåœ°å€å¯„å­˜å™¨ï¼Œç”¨äºŽå­˜å‚¨åˆå§‹åœ°å€ï¼› ! è¡¨ç¤ºæœ€ç»ˆåœ°å€å°†å†™å›žåˆ°Rnå¯„å­˜å™¨ reglistï¼Œåœ¨å¤šä¸ªè¿žç»­çš„å¯„å­˜å™¨æ—¶ä½¿ç”¨â€œ-â€è¿žæŽ¥ï¼Œå¦‚{R0-R3}ï¼Œå¦åˆ™{R0,R3,R7} addr_mode: IAï¼ŒåŸºå€å¯„å­˜å™¨åœ¨æ‰§è¡ŒæŒ‡ä»¤ä¹‹åŽå¢žåŠ ï¼ˆé»˜è®¤ï¼‰ IBï¼Œæ‰§è¡Œå‰å¢žåŠ  DAï¼Œæ‰§è¡Œå‰å‡å°‘ DBï¼Œæ‰§è¡ŒåŽå‡å°‘ FBï¼Œæ»¡é€’å‡å †æ ˆ FAï¼Œæ»¡é€’å¢žå †æ ˆ EDï¼Œç©ºé€’å‡å †æ ˆ EAï¼Œç©ºé€’å¢žå †æ ˆ STMæŒ‡ä»¤ï¼šSTM{addr_mode}{cond} Rn{!} reglistï¼Œä¸ŽLDMç›¸å PUSHæŒ‡ä»¤ï¼šPUSH{cond} reglistï¼Œå°†å¯„å­˜å™¨æŽ¨å…¥æ»¡é€’å‡å †æ ˆä¸­ POPæŒ‡ä»¤ï¼šPOP{cond} reglistï¼Œä¸ŽPUSHç›¸å SWPæŒ‡ä»¤ï¼šSWP {B}{cond} Rd, Rm, [Rn]ï¼Œäº¤æ¢å¯„å­˜å™¨ä¸Žå­˜å‚¨å™¨ä¹‹é—´çš„æ•°æ®ï¼Œ Bä¸ºå¯é€‰å­—èŠ‚ï¼Œæœ‰Båˆ™äº¤æ¢å­—èŠ‚ï¼Œå¦åˆ™äº¤æ¢32ä½çš„å­— Rdä¸ºè¦ä»Žå­˜å‚¨å™¨ä¸­åŠ è½½æ•°æ®çš„å¯„å­˜å™¨ å­˜å‚¨å™¨-&gt;å¯„å­˜å™¨ Rmä¸ºè¦ä»Žå¯„å­˜å™¨åŠ è½½æ•°æ®åˆ°å­˜å‚¨å™¨çš„å¯„å­˜å™¨ å¯„å­˜å™¨-&gt;å­˜å‚¨å™¨ Rn:ä¸ºéœ€è¦è¿›è¡Œæ•°æ®äº¤æ¢çš„å­˜å‚¨å™¨åœ°å€ã€‚ æ•°æ®å¤„ç†æŒ‡ä»¤ MOVæŒ‡ä»¤ï¼šMOV{cond}{S} Rd, operand2ï¼Œå°†8ä½ç«‹å³æ•°æˆ–è€…å¯„å­˜å™¨çš„å†…å®¹ä¼ é€åˆ°ç›®æ ‡å¯„å­˜å™¨ï¼Œå¦‚MOV,RO,#8æˆ–MOV,RO,R1 MVNæŒ‡ä»¤ï¼šMVN{cond}{S} Rd, operand2ï¼Œå°†8ä½çš„ç«‹å³æ•°æˆ–å¯„å­˜å™¨æŒ‰ä½å–ååŽï¼Œä¼ é€åˆ°ç›®æ ‡å¯„å­˜å™¨ï¼Œæ­¤ä¸ºæ•°æ®éžä¼ é€æŒ‡ä»¤ ç®—æ•°è¿ç®—æŒ‡ä»¤ ADDæŒ‡ä»¤ï¼šä¸ºåŠ æ³•æŒ‡ä»¤ï¼Œä¾‹å¦‚ADD R0,R1,LSL #3å³R0 = R1 * 8ï¼ŒADDS R0,R1,R2å³R0 = R1+R2ï¼ŒADD R0,R1,#2å³R0 = R1+@ ADCæŒ‡ä»¤ï¼šADC{cond}{S} Rd, Rn, operand2ï¼Œå¸¦è¿›ä½çš„åŠ æ³•æŒ‡ä»¤ï¼Œå°†Rn,operand2çš„å€¼ç›¸åŠ ï¼Œç„¶åŽå†åŠ ä¸ŠCPSRå¯„å­˜å™¨çš„Cæ¡ä»¶æ ‡å¿—ä½çš„å€¼ï¼Œæœ€åŽå°†ç»“æžœä¿å­˜åˆ°Rdå¯„å­˜å™¨. SUBæŒ‡ä»¤ï¼šä¸ºå‡æ³•æŒ‡ä»¤ï¼Œä¾‹å¦‚SUB RO,R1,#4å³R0 = R1-4 RSBæŒ‡ä»¤ï¼šé€†å‘å‡æ³•æŒ‡ä»¤ï¼Œå°±æ˜¯è¯´ç”¨operand2 - Rnï¼Œç„¶åŽèµ‹å€¼ç»™Rd é€»è¾‘è¿ç®— ANDæŒ‡ä»¤ï¼šé€»è¾‘ä¸Žï¼Œä¾‹å¦‚AND RO,R0,#1ï¼Œç”¨æ¥æµ‹è¯•R0çš„æœ€ä½Žä½ ORRæŒ‡ä»¤ï¼šé€»è¾‘æˆ–ï¼Œä¾‹å¦‚ORR R0,R0,#0X0Fï¼ŒæŒ‡ä»¤æ‰§è¡ŒåŽä¿ç•™R0çš„ä½Žå››ä½ï¼Œå…¶ä½™ä½æ¸…0 EORæŒ‡ä»¤ï¼šé€»è¾‘å¼‚æˆ–ï¼Œä¾‹å¦‚EOR R0,R0,R0ï¼Œæ‰§è¡ŒåŽR0ä¸º0ï¼ˆä¸¤ä¸ªåŒä½å€¼ä¸ç›¸åŒï¼Œåˆ™å¼‚æˆ–ç»“æžœä¸º1ï¼Œç›¸åŒæ—¶ä¸º0ï¼‰ ORNæŒ‡ä»¤ï¼šORN{cond}{S} Rd,Rn,operand2ï¼Œé€»è¾‘æˆ–éžï¼Œå…ˆå°†æ“ä½œæ•°å–åï¼Œå†ä¸Žç›®æ ‡å¯„å­˜å™¨è¿›è¡Œæˆ–æ“ä½œ BICæŒ‡ä»¤ï¼šBIC{cond}{S} Rd,Rn,operand2ï¼Œä½æ¸…é™¤æŒ‡ä»¤ï¼Œå°†operand2çš„å€¼å–åï¼Œç„¶åŽå°†ç»“æžœä¸ŽRnå¯„å­˜å™¨çš„å€¼ç›¸ â€œä¸Žâ€ å¹¶ä¿å­˜åˆ°Rdå¯„å­˜å™¨ä¸­ æ¯”è¾ƒæŒ‡ä»¤ï¼š CMPæŒ‡ä»¤ï¼šCMP{cond} Rn,operand2ï¼Œä½¿ç”¨Rnå¯„å­˜å™¨å‡åŽ»operand2çš„å€¼ï¼Œä½†CMPæŒ‡ä»¤ä¸ä¿å­˜è®¡ç®—ç»“æžœï¼Œä»…ä»…æ ¹æ®æ¯”è¾ƒé‡ç½®æ ‡å¿—ä½ï¼ˆcpsrï¼‰ï¼š CF : è¿›ä½æ ‡å¿— PF : å¥‡å¶æ ‡å¿— AF : è¾…åŠ©è¿›ä½æ ‡è¯† ZF : 0æ ‡è¯† SF : ç¬¦å·æ ‡è¯† OF : æº¢å‡ºæ ‡è¯† CMNæŒ‡ä»¤ï¼šCMN{cond} Rn,operand2ï¼Œå°†operand2çš„å€¼åŠ åˆ°Rnå¯„å­˜å™¨ä¸Šï¼Œè¿™ä¸ŽADDSçš„æŒ‡ä»¤åŠŸèƒ½ç›¸åŒï¼Œä¸è¿‡CMNæŒ‡ä»¤ä¸ä¿å­˜è®¡ç®—ç»“æžœ TSTæŒ‡ä»¤ï¼šTST{cond} Rn,operand2ï¼Œæµ‹è¯•æŒ‡ä»¤ï¼Œè¿›è¡Œ â€œä¸Žâ€ è¿ç®—ï¼Œä½†ä¸ä¿å­˜è®¡ç®—ç»“æžœï¼Œä»…ä»…æ ¹æ®è®¡ç®—ç»“æžœè®¾ç½®æ ‡å¿—ä½ï¼ˆcpsrï¼‰ TEQæŒ‡ä»¤ï¼šè¿›è¡Œ â€œå¼‚æˆ–â€ è¿ç®—ï¼Œä½†ä¸ä¿å­˜è®¡ç®—ç»“æžœï¼Œä»…ä»…æ ¹æ®è®¡ç®—ç»“æžœè®¾ç½®æ ‡å¿—ä½ ç§»ä½æŒ‡ä»¤ LSLï¼šé€»è¾‘å·¦ç§»ï¼Œå°†æ•´ä¸ªæ“ä½œæ•°å‘å·¦ç§»åŠ¨ä¸¤ä½ï¼Œå³è¾¹è¡¥0,æœ€ç»ˆæ“ä½œä¹Ÿå°±æ˜¯ * 2^n(ç§»ä½)ï¼Œä¾‹å¦‚LSL R1,R0,#2ï¼Œå°†R0å‘å·¦ç§»åŠ¨ä¸¤ä½ï¼Œç»“æžœä¿å­˜åˆ°R1ä¸­. ä¹Ÿå°±æ˜¯ R0 * 2^2 LSRï¼šé€»è¾‘å³ç§»ï¼Œæ•´ä½“å‘å³ç§»ï¼Œå·¦è¾¹è¡¥0ï¼Œæœ€ç»ˆæ“ä½œä¹Ÿå°±æ˜¯ / 2 ^ n(ç§»ä½)ï¼Œä¾‹å¦‚LSR R1,R0,#2ï¼Œå°†R0å‘å³ç§»åŠ¨ä¸¤ä½ï¼Œç»“æžœä¿å­˜åˆ°R1ä¸­. ä¹Ÿå°±æ˜¯ R0 / 2^2 Intelæ ¼å¼ä¸ŽAT&amp;Tæ ¼å¼çš„åŒºåˆ«åœ¨Intelæ ¼å¼çš„æ—¶å€™ï¼Œ[]è¡¨ç¤ºåœ°å€ï¼Œ()è¡¨ç¤ºæ•°æ®ï¼›åœ¨AT&amp;Tæ ¼å¼çš„æ—¶å€™ï¼Œ()è¡¨ç¤ºä¸ºåœ°å€ï¼ˆç¼–è¯‘æ—¶å¯æ·»åŠ ç¼–è¯‘æ¡ä»¶ â€“masm=intelï¼Œæˆ–è€…â€“masm=att æŒ‡å®šæ ¼å¼ï¼‰ï¼š AT&amp;T: -4(%ebp) //ç›¸å½“äºŽ Intel: [ebp - 4] AT&amp;T: foo(,%eax,4) //ç›¸å½“äºŽ Intel: [foo + eax*4] AT&amp;T: foo(,1) //ç›¸å½“äºŽ Intelï¼š[foo] AT&amp;T: %gs:foo //ç›¸å½“äºŽ Intelï¼šgs:foo AT&amp;T: movl -4(%ebp), %eax //ç›¸å½“äºŽ Intel: mov eax, [ebp - 4] AT&amp;T: movl array(, %eax, 4), %eax //ç›¸å½“äºŽ Intel: mov eax, [eax*4 + array] AT&amp;T: movw array(%ebx, %eax, 4), %cx //ç›¸å½“äºŽ Intel: mov cx, [ebx + 4*eax + array] AT&amp;T: movb $4, %fs:(%eax) //ç›¸å½“äºŽ Intel: mov fs:eax, 4 å‡½æ•°ä¸­çš„æŒ‡ä»¤å¥—è·¯push ebp ; //è°ƒç”¨å‡½æ•°å‰ï¼Œå…ˆä¿å­˜å½“å‰EBPï¼Œä¸ºæ ˆå¢žåŠ ä¸€ä¸ªå…ƒç´ ï¼ŒBASEç”¨äºŽé˜²æ­¢æ ˆç©ºåŽç»§ç»­å¼¹æ ˆ mov ebp,esp ; //ç„¶åŽå°†EBPè®¾ä¸ºå½“å‰å †æ ˆæŒ‡é’ˆ sub esp, xxx ; //é¢„ç•™xxxå­—èŠ‚ç»™å‡½æ•°ä¸´æ—¶å˜é‡ï¼Œæ ˆé¡¶æå‡(åœ°å€å˜å°) ... mov esp,ebp ; //å‡½æ•°æ‰§è¡Œå®Œï¼Œå°†EBPï¼ˆè°ƒç”¨å‡½æ•°å‰çš„æ ˆé¡¶ï¼‰èµ‹å›žç»™ESPï¼Œæ ˆé¡¶ä¸‹é™(åœ°å€å˜å¤§) pop ebp ; //ä»Žæ ˆä¸­å–å‡ºEBPï¼Œæ¢å¤è°ƒç”¨å‡½æ•°å‰çš„EBP ret ; //è¿”å›ž iOSä¸Šçš„å®žè·µ cmpæŒ‡ä»¤ä¸­ï¼Œä¸€èˆ¬æŸ¥çœ‹æ ‡å¿—ä½Nå’ŒZï¼ŒN=1è¡¨ç¤ºè¿ç®—ç»“æžœä¸ºè´Ÿæ•°ï¼ŒN=0è¡¨ç¤ºç»“æžœä¸ºæ­£æ•°ï¼ŒZ=1è¡¨ç¤ºè¿ç®—ç»“æžœä¸ºé›¶ï¼ŒZ=0è¡¨ç¤ºç»“æžœä¸ºéžé›¶ã€‚ cpsrï¼Œä¾‹å¦‚å½“cpsrä¸º0x20000000æ—¶ï¼ŒNä¸ºå¯¹åº”äºŽ32ä½ï¼ŒZä½å¯¹åº”äºŽ31ä½ï¼Œå¦‚æžœåˆ†åˆ«éƒ½ä¸º00ï¼Œä¹Ÿå°±æ˜¯è¯´éžè´Ÿæ•°éž0ã€‚ åŠ äº†æ¡ä»¶çš„bæŒ‡ä»¤ä¸€èˆ¬è·Ÿåœ¨cmpæŒ‡ä»¤åŽè°ƒç”¨ï¼Œä¾‹å¦‚cmp x1,x2å’Œbgt testCodeï¼Œbgtçš„åˆ¤æ–­æ¡ä»¶å–å†³äºŽcpsrï¼Œå³è¦è·³è½¬åˆ°testCodeæ‰§è¡Œéœ€è¦x1å¤§äºŽx2ã€‚ æ‰§è¡Œå‡½æ•°é‡‡ç”¨blæŒ‡ä»¤ï¼Œè°ƒç”¨åŽèƒ½è¿”å›žï¼ˆbæŒ‡ä»¤ä¸å…·å¤‡è¿”å›žï¼‰ï¼Œblé¦–å…ˆä¼šå°†ä¸‹ä¸€æ¡çš„æ‰§è¡Œå‘½ä»¤çš„åœ°å€æ”¾åˆ°lrï¼ˆx30ï¼‰ä¸­ï¼Œç„¶åŽæ‰§è¡Œè·³è½¬æŒ‡ä»¤ï¼Œç­‰åˆ°è·³è½¬å‡½æ•°æ‰§è¡Œå®Œæˆï¼Œæ‰§è¡Œè·³è½¬å‡½æ•°çš„retçš„æ—¶å€™å°±ä¼šå›žåˆ°éœ€è¦æ‰§è¡Œä¸‹ä¸€æ¡çš„å‘½ä»¤ã€‚ 64ä½ä¸‹ï¼Œä¸€ä¸ªå¯„å­˜å™¨æœ‰8ä¸ªå­—èŠ‚çš„å®¹é‡ï¼Œldrèµ‹å€¼å¤šå°‘å–å†³äºŽæŽ¥æ”¶æ•°æ®çš„å¯„å­˜å™¨æ˜¯å¤šå°‘å­—èŠ‚ã€‚ ldurä¸ŽldræŒ‡ä»¤æ„æ€ä¸€æ ·ï¼Œåªæ˜¯ç”¨äºŽæ“ä½œè´Ÿæ•°ï¼Œä¾‹å¦‚ldur x1, [x0,#-0x4] ldpï¼Œè¡¨ç¤ºä»Žå†…å­˜ä¸­è¯»å–æ•°æ®æ”¾åˆ°ä¸€å¯¹å†…å­˜ä¸­ï¼Œä¾‹å¦‚ldp w1, w2 [x1, #0x4]ï¼Œå³å°†x1ä¸­æ‰€å­˜çš„åœ°å€åŠ ä¸Š#0x4å¾—åˆ°æ–°æŒ‡å‘åœ°å€ï¼Œä»Žè¿™ä¸ªåœ°å€æŒ‡å‘çš„æ•°æ®å¼€å§‹èµ‹å€¼ç»™w1, w2ï¼Œå…¶ä¸­w1å’Œw2åˆ†åˆ«å ç”¨4ä¸ªå­—èŠ‚é‚£ä¹ˆå°±æ˜¯å…¶ä¸­çš„4ä¸ªå­—èŠ‚èµ‹å€¼ç»™w1ï¼Œå…¶ä¸­çš„4ä¸ªå­—èŠ‚èµ‹å€¼ç»™w2ã€‚ ldpã€ldr ã€ldur éƒ½æ˜¯ä»Žå†…å­˜ä¸­è¯»å–æ•°æ®è¿›è¡Œèµ‹å€¼ã€‚ é›¶å¯„å­˜å™¨ï¼Œé‡Œé¢å­˜å‚¨çš„å€¼éƒ½æ˜¯0ï¼Œæ¯”å¦‚32ä½çš„wzrï¼Œ64ä½çš„xzrã€‚ pcå¯„å­˜å™¨ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰æ‰§è¡Œåˆ°çš„ä»£ç çš„åœ°å€ã€‚ fpã€lrã€spã€pcåœ¨é¡ºåºä¸Šï¼Œåˆ†åˆ«åº”è¯¥æ˜¯x29ã€x30ã€x31ã€x32 å°†Cä»£ç è½¬ä¸ºæ±‡ç¼–çš„ä¸€ç§æ–¹å¼ï¼š xcrun -sdk iphoneos clang -arch arm64 -S Ctest.c -o Ctest.s åœ¨lldbä¸Šå¯ä»¥ç”¨ä»¥ä¸‹å‡ æ¡æŒ‡ä»¤æŸ¥çœ‹ä¿¡æ¯ï¼š # è¯»å–æ‰€æœ‰å¯„å­˜å™¨çŽ°å­˜çš„å†…å®¹ (lldb) register read # è¯»å–å…·ä½“æŸå¯„å­˜å™¨çŽ°å­˜çš„å†…å®¹ (lldb) register read x0 # æŸ¥è¯¢å†…å­˜åœ°å€æ‰€æŒ‡å‘çš„å†…å­˜çš„å€¼ (lldb) x 0x000000016fd1fa4c (lldb) x x0 ï¼ˆx0æ‰€å­˜çš„å†…å®¹ä¸ºå†…å­˜åœ°å€ï¼‰ macOSä¸Šçš„å®žè·µld éœ€è¦æ·»åŠ -lSystemæ ‡è¯†åŽ»é˜²æ­¢æŠ›å‡ºwarning: No version-min specified on command lineé”™è¯¯ï¼Œç„¶åŽä½¿ç”¨ -macosx_version_min ç§»é™¤é”™è¯¯ï¼š ld hello.o -o hello -macosx_version_min 10.13 -lSystem ld hello.o world.o -o hello -macosx_version_min 10.13 -lSystemé«˜çº§è¯­è¨€å¯¹ç…§æ±‡ç¼–è¯­è¨€è§£é‡Šï¼š #include&lt;stdio.h&gt; int main(int argc, char const *argv[]) &#123; int i, j, k; printf(&quot;\n&quot;); for(i=1;i&lt;5;i++) &#123; for(j=1;j&lt;5;j++) &#123; for(k=1;k&lt;5;k++) &#123; if(i!=k&amp;&amp;i!=j&amp;&amp;j!=k) &#123; printf(&quot;%d,%d,%d\n&quot;,i,j,k); &#125; &#125; &#125; &#125; return 0; &#125; ï¼ˆmovxï¼Œxä¸º3ç§æƒ…å†µçš„å­—ç¬¦ï¼š1ï¼Œlç”¨äºŽ32ä½çš„é•¿å­—å€¼ï¼›2ï¼Œwç”¨äºŽ16ä½çš„å­—å€¼ï¼›3ï¼Œbç”¨äºŽ8ä½çš„å­—èŠ‚å€¼ã€‚ï¼‰ macOSä¸­ç¼–è¯‘å‡ºçš„æ–‡ä»¶å¹¶ä¸æ˜¯linuxçš„ELFï¼Œè€Œæ˜¯Mach-Oæ ¼å¼ï¼Œç›¸åº”çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š fileï¼šæŸ¥çœ‹Mach-Oæ–‡ä»¶çš„ç±»åž‹ lipoï¼šå¯¹æž¶æž„çš„ç›¸å…³æ“ä½œ -infoï¼šæŸ¥çœ‹æž¶æž„ -thinï¼šæ‹†é™¤æŸç§æž¶æž„ï¼Œlipo &lt;Mach-O&gt; -thin &lt;æž¶æž„å&gt; -output &lt;è¾“å‡ºæ–‡ä»¶è·¯å¾„&gt; -createï¼šåˆå¹¶å¤šç§æž¶æž„ï¼Œlipo -create &lt;Mach-O1&gt; &lt;Mach-O2&gt; -output &lt;è¾“å‡ºæ–‡ä»¶è·¯å¾„&gt; otoolï¼šæŸ¥çœ‹Mach-Oæ–‡ä»¶ç»“æž„ -Lï¼šæŸ¥çœ‹åŠ¨æ€é“¾æŽ¥åº“ -hï¼šæŸ¥çœ‹æ–‡ä»¶å¤´ä¿¡æ¯ åœ¨ç»ˆç«¯é‡Œç›´æŽ¥è¾“å…¥otoolå³å¯å¾—åˆ°å„ç§å‚æ•°çš„è¯´æ˜Ž ä¹Ÿå¯ä½¿ç”¨å…è´¹å¼€æºçš„å·¥å…·MachOViewï¼ŒæŸ¥çœ‹Mach-Oæ–‡ä»¶ï¼ˆæ”¯æŒèƒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ±‡ç¼–ä»£ç ä¸­æ²¡æœ‰ç¬¦å·æ ‡è¯†ï¼Œåç§»é‡ä¸æ˜¯ä»Ž0å¼€å§‹ï¼Œæ‰€ä»¥æ¯”è¾ƒé€‚åˆç”¨å…¶çœ‹å±€éƒ¨çš„è¯¦ç»†ä¿¡æ¯å’Œå…¶å®ƒç»“æž„ä¸­çš„å†…å®¹ï¼‰MachOView Mach-Oä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š Headerï¼šåŒ…å«å­—èŠ‚é¡ºåºã€æž¶æž„ç±»åž‹ã€åŠ è½½æŒ‡ä»¤çš„æ•°é‡ç­‰ï¼Œä½¿å¾—ç³»ç»Ÿå¯ä»¥å¿«é€Ÿç¡®è®¤ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚å½“å‰æ–‡ä»¶ç”¨äºŽ32ä½è¿˜æ˜¯64ä½ï¼Œå¯¹åº”çš„å¤„ç†å™¨æ˜¯ä»€ä¹ˆã€æ–‡ä»¶ç±»åž‹æ˜¯ä»€ä¹ˆã€‚ Load commandsï¼šæŒ‡ç¤ºåŠ è½½å™¨å¦‚ä½•åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€å¼ åŒ…å«å¾ˆå¤šå†…å®¹çš„è¡¨ï¼Œå†…å®¹åŒ…æ‹¬åŒºåŸŸçš„ä½ç½®ã€ç¬¦å·è¡¨ã€åŠ¨æ€ç¬¦å·è¡¨ç­‰ã€‚æ¯ä¸ªåŠ è½½æŒ‡ä»¤éƒ½åŒ…å«ä¸€ä¸ªå…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æŒ‡ä»¤ç±»åž‹ã€åç§°ã€åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ä½ç½®ç­‰ç­‰ã€‚ Dataï¼šé€šå¸¸æ˜¯å¯¹è±¡æ–‡ä»¶ä¸­æœ€å¤§çš„éƒ¨åˆ†ã€‚ä¸»è¦åŒ…å«ä»£ç ã€æ•°æ®ï¼Œä¾‹å¦‚ç¬¦å·è¡¨ï¼ŒåŠ¨æ€ç¬¦å·è¡¨ç­‰ç­‰ã€‚Data ä¸­åŒ…å«è‹¥å¹²ä¸ª segment (æ®µ)ï¼Œæ¯ä¸ª segment ä¸‹åˆæœ‰è‹¥å¹²ä¸ª section(èŠ‚)ï¼š æ–‡æœ¬æ®µ __TEXTï¼šç±»ä¼¼PEçš„.textæ®µ æ•°æ®æ®µ __DATAï¼šç±»ä¼¼PEçš„.dataæ®µ åŠ¨æ€åº“åŠ è½½ä¿¡æ¯ Dynamic Loader Info å…¥å£å‡½æ•° Function Starts ç¬¦å·è¡¨ Symbol Table åŠ¨æ€åº“ç¬¦å·è¡¨ Dynamic Symbol Table å­—ç¬¦ä¸²è¡¨ String Table Cé€šå¸¸ç”¨GCCç¼–è¯‘ï¼ŒOCé€šå¸¸ç”¨Clangç¼–è¯‘ã€‚è€ŒäºŒè€…ä¹Ÿå…¶å®žæ˜¯å¯ä»¥é€šç”¨çš„ï¼Œå³ç”¨Clangæ¥ç¼–è¯‘Cä»£ç ï¼ŒGCCæ¥ç¼–è¯‘OCä»£ç ã€‚ åè¯é‡Šä¹‰å·¥å…· GCCï¼šGNUç¼–è¯‘å™¨å¥—è£…ï¼ˆGNU Compiler Collectionï¼‰ï¼Œæ˜¯ä¸€å¥—è¯­è¨€ç¼–è¯‘å™¨ï¼Œè·¨å¹³å°ï¼ŒåŽæ¥è¢«Clang+LLVMè¿½èµ¶ã€‚ binutilsæ˜¯ç”¨æ¥å¤„ç†è®¸å¤šæ ¼å¼çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ˜¯ä¸€æ•´å¥—çš„ç¼–ç¨‹è¯­è¨€å·¥å…·ç¨‹åºï¼Œè·¨å¹³å°ã€‚ä¾‹å¦‚æ±‡ç¼–å™¨asã€é“¾æŽ¥å™¨ldã€èŽ·å–ä¿¡æ¯å’Œåæ±‡ç¼–objdumpã€ELFæ–‡ä»¶çš„è§£é‡Šå™¨readelfï¼ˆåªæ”¯æŒLinuxï¼‰ã€åˆ—å‡ºæ€»ä½“å’Œsectionå¤§å°sizeç­‰ã€‚ ç¼–ç  ASCIIï¼šé’ˆå¯¹è‹±æ–‡æ•°å­—å’Œä¸ªåˆ«é€šç”¨ç¬¦å·çš„ç¼–ç  Unicodeï¼šåŸºäºŽASCIIï¼Œå¢žåŠ é’ˆå¯¹ä¸åŒå›½å®¶çš„è¯­è¨€å’Œç¬¦å·çš„ç¼–ç  UTF-8ï¼šåŠ¨æ€ç¼–ç ï¼Œé’ˆå¯¹Unicodeä¸­å¯ç”¨ASCIIç¼–ç çš„æƒ…å†µï¼ŒèŠ‚çœç©ºé—´ CPU 32/64ä½ï¼šä¸€èˆ¬æŒ‡CPUçš„é€šç”¨å¯„å­˜å™¨(GPRsï¼ŒGeneral-Purpose Registers)ä½å®½ï¼ˆäº¦å³æ•°æ®æ€»çº¿çš„ä½å®½ï¼‰ï¼Œå…¶ä»£è¡¨ç€åœ¨å¯„å­˜å™¨ä¸Šçš„å¯»å€èƒ½åŠ›ï¼ŒCPUæœ‰å¤šå°‘æ ¹åœ°å€çº¿å†³å®šç€èƒ½å¯»å€åˆ°å¤šå¤§çš„å†…å­˜åœ°å€ï¼Œ32ä½CPUå¯ä»¥å®šä½2^32ä¸ªå†…å­˜å•å…ƒï¼Œå³å†…å­˜ç©ºé—´å¯ä»¥åŽ»åˆ°4GBã€‚ æ•°æ®æ€»çº¿ï¼šè´Ÿè´£è®¡ç®—æœºä¸­æ•°æ®åœ¨å„ç»„æˆéƒ¨åˆ†ä¹‹é—´çš„ä¼ é€ï¼Œæ•°æ®æ€»çº¿å®½åº¦æ˜¯æŒ‡åœ¨èŠ¯ç‰‡å†…éƒ¨æ•°æ®ä¼ é€çš„å®½åº¦ï¼Œè€Œæ•°æ®æ€»çº¿å®½åº¦åˆ™å†³å®šäº†CPUä¸ŽäºŒçº§ç¼“å­˜ã€å†…å­˜ä»¥åŠè¾“å…¥/è¾“å‡ºè®¾å¤‡ä¹‹é—´ä¸€æ¬¡æ•°æ®ä¼ è¾“çš„ä¿¡æ¯é‡ã€‚ä¾‹å¦‚ï¼Œ8æ ¹æ•°æ®æ€»çº¿ä¸€æ¬¡å¯ä»¥ä¼ è¾“ä¸€ä¸ªå­—èŠ‚ï¼Œ16æ ¹æ•°æ®æ€»çº¿ä¸€æ¬¡å¯ä»¥ä¼ è¾“ä¸¤ä¸ªå­—èŠ‚ã€‚æ•°æ®æ€»çº¿æ˜¯ä¸ºå„éƒ¨ä»¶ä¹‹é—´æä¾›æ•°æ®ä¼ é€çš„é€šè·¯ï¼Œåªæœ‰åœ¨æŽ§åˆ¶æ€»çº¿å’Œåœ°å€æ€»çº¿çš„ä½œç”¨ä¸‹ï¼Œæ•°æ®æ€»çº¿æ‰æœ‰æ„ä¹‰ã€‚ æŽ§åˆ¶æ€»çº¿ï¼šCPUå¯¹å¤–éƒ¨å™¨ä»¶çš„æŽ§åˆ¶æ˜¯é€šè¿‡æŽ§åˆ¶æ€»çº¿æ¥è¿›è¡Œçš„ã€‚æŽ§åˆ¶æ€»çº¿æ˜¯ä¸ªæ€»ç§°ï¼ŒæŽ§åˆ¶æ€»çº¿æ˜¯ä¸€äº›ä¸åŒæŽ§åˆ¶çº¿çš„é›†åˆã€‚æœ‰å¤šå°‘æ ¹æŽ§åˆ¶æ€»çº¿ï¼Œå°±æ„å‘³ç€CPUæä¾›äº†å¯¹å¤–éƒ¨å™¨ä»¶çš„å¤šå°‘ç§æŽ§åˆ¶ã€‚ å†…å­˜ å­—èŠ‚åºï¼šå‡è®¾å¯¹äºŽ0x1234567ï¼Œå†…å­˜åœ°å€ä»Žä½Žåˆ°é«˜çš„è¯ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨å¤„ç†æ˜¯é‡‡ç”¨å°ç«¯å­—èŠ‚åºæ¥æå‡æ•ˆçŽ‡ï¼ˆå³67 45 23 01ï¼‰ï¼Œå…¶å®ƒæƒ…å†µæ‰é‡‡ç”¨å¤§ç«¯å­—èŠ‚åºæ¥æ–¹ä¾¿é˜…è¯»ï¼ˆå³01 23 45 67ï¼‰ã€‚æ‰€ä»¥objdumpæ‰“å°çš„16è¿›åˆ¶æ•°æ®éƒ½æ˜¯æŒ‰å°ç«¯å­—èŠ‚åºæ˜¾ç¤ºã€‚ å †æ ˆ å †æ ˆæ®µåº•éƒ¨ï¼šè¿™ç§åº•éƒ¨è¯´æ³•ä¸€èˆ¬æŒ‡é«˜ä½åœ°å€çš„é¡¶ç‚¹ï¼Œæ¯”å¦‚ä¸€ä¸ªå †æ ˆæ®µçš„åœ°å€ç©ºé—´æ˜¯0xBF801FBC~0xBF802000ï¼Œé‚£ä¹ˆå…¶åº•éƒ¨å°±æ˜¯0xBF802000ã€‚ æ–‡ä»¶ Mach-Oï¼šå³Mach Objectæ–‡ä»¶æ ¼å¼çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨äºŽå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›®æ ‡ä»£ç ï¼ŒåŠ¨æ€åº“ï¼Œå†…æ ¸è½¬å‚¨çš„æ–‡ä»¶æ ¼å¼ã€‚ä½œä¸ºa.outæ ¼å¼çš„æ›¿ä»£ï¼ŒMach-Oæä¾›äº†æ›´å¼ºçš„æ‰©å±•æ€§ï¼Œå¹¶æå‡äº†ç¬¦å·è¡¨ä¸­ä¿¡æ¯çš„è®¿é—®é€Ÿåº¦ã€‚ ã€å›¾ã€‘è¿›ç¨‹åˆå§‹å †æ ˆ glibc å³GNU C Libraryï¼ŒGNUæ——ä¸‹çš„Cæ ‡å‡†åº“ï¼Œå…¶å¤´æ–‡ä»¶ä½äºŽ/usr/includeï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„åŠ¨æ€æ ‡å‡†åº“åœ¨/lib/libc.so.6ï¼Œé™æ€æ ‡å‡†åº“åœ¨/usr/lib/libc.aã€‚ å‘½ä»¤é›†æŸ¥è¯¢ $file foobar.o # æŸ¥æ–‡ä»¶æ ¼å¼ $objdump -h xx.o # æŸ¥çœ‹objectæ–‡ä»¶å†…å®¹ï¼Œ-hæ‰“å°å„æ®µåŸºæœ¬ä¿¡æ¯ï¼Œ-xå¯æ‰“å°æ›´å¤šä¿¡æ¯ $objdump -s -d xx.o # -sä»¥åå…­åˆ¶å½¢å¼æ‰“å°ï¼Œ-då°†æŒ‡ä»¤æ®µåæ±‡ç¼– $objdump -d a.o # -dæŸ¥çœ‹ä»£ç çš„åæ±‡ç¼–ç»“æžœ $objdump -r a.o # -ræŸ¥çœ‹é‡å®šä½è¡¨ $objdump -t libc.a # æŸ¥æ‰¾å‡½æ•°æ‰€åœ¨çš„ç›®æ ‡æ–‡ä»¶ $objdump -t # å‚è€ƒç¬¦å·è¡¨ $size xx.o # æŸ¥çœ‹ELFæ–‡ä»¶å„æ®µé•¿åº¦ $readelf -h SimpleSection.o # -hè¡¨ç¤ºåªæ˜¾ç¤º $readelf -S SimpleSection.o # æ˜¾ç¤ºèŠ‚å¤´ä¿¡æ¯ $readelf -l Lib.so # æŸ¥çœ‹åŠ¨æ€å…±äº«å¯¹è±¡çš„è£…è½½å±žæ€§ï¼ˆæŸ¥çœ‹segmentï¼‰ $readelf -d Lib.so # æŸ¥çœ‹.dynamicæ®µçš„å†…å®¹ $readelf -sD Lib.so # æŸ¥çœ‹åŠ¨æ€ç¬¦å·è¡¨åŠå…¶å“ˆå¸Œè¡¨ $ldd Program1 # æŸ¥çœ‹ä¸»æ¨¡å—æˆ–å…±äº«åº“ä¾èµ–çš„å…±äº«åº“ $readelf -r Lib.so # æŸ¥çœ‹åŠ¨æ€é“¾æŽ¥æ–‡ä»¶çš„é‡å®šä½è¡¨ $readelf -d foo.so | grep TEXTREL # åŒºåˆ†æ˜¯å¦PICçš„æŒ‡ä»¤ $ar -t libc.a # æŸ¥çœ‹é™æ€åº“åŒ…å«çš„æž¶æž„ $ar -x libc.a # è§£åŽ‹ç›®æ ‡æ–‡ä»¶åˆ°å½“å‰ç›®å½• $./SectionMapping.elf &amp; # 1 æŸ¥è¯¢å¯æ‰§è¡Œæ–‡ä»¶çš„è¿›ç¨‹å· $cat /proc/xxxxx/maps # 2 æŸ¥çœ‹è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´åˆ†å¸ƒ $kill xxxxx # 3 ç¼–è¯‘ $gcc -E hello.c -o hello.i # é¢„ç¼–è¯‘ $gcc -S hello.i -o hello.s # æ±‡ç¼–ï¼Œç¿»è¯‘æˆæ±‡ç¼–è¯­è¨€ $as hello.s -o hello.o # ç”Ÿæˆç›®æ ‡æ–‡ä»¶ $gcc -c hello.s -o hello.o # ç¼–è¯‘ã€æ±‡ç¼–åŽŸæ–‡ä»¶ $gcc -c hello.c -o hello.o $gcc -c xx.c # åªç¼–è¯‘ä¸é“¾æŽ¥ $objcopy -I binary -O elf32-i386 -B i386 image.jpg image.o # åª’ä½“æ–‡ä»¶ä½œæ®µ $gcc -static SectionMapping.c -o SectionMapping.elf # é™æ€åº“ç¼–è¯‘ $gcc -fno-common ... # æ‰€æœ‰æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ä¸ä»¥COMMONå—çš„å½¢å¼å¤„ç† $gcc -c -fno-builtin hello.c # å…³é—­å†…ç½®å‡½æ•°ä¼˜åŒ–é€‰é¡¹ $gcc -fPIC -shared -o Lib.so Lib.c # ç¼–è¯‘æˆå…±äº«å¯¹è±¡ï¼Œ-fPICä»£è¡¨ä½¿ç”¨åœ°å€æ— å…³ä»£ç æŠ€æœ¯ $gcc -o Program Program.c ./Lib.so # ç¼–è¯‘é“¾æŽ¥ $gcc main.c b1.so b2.so -o main -Xlinker -rpath ./ # æŒ‡å®šå¯»å€å…±äº«å¯¹è±¡çš„è·¯å¾„ $gcc -shared -fPIC lib.c -Xlinker --version-script lib.ver -o lib.so # æŒ‡å®šè„šæœ¬æ–‡ä»¶ $ld --version-script lib.verz # æŒ‡å®šè„šæœ¬æ–‡ä»¶ $gcc -shared -Wl,-soname,my_soname -o library_name source_files library_files # åˆ›å»ºå…±äº«åº“ é“¾æŽ¥ $ld -static crt1.o crti.o crtbeginT.o hello.o -start-group -lgcc -lgcc_eh -lc -end-group crtend.o crtn.o $ld a.o b.o -e main -o ab #-e mainè¡¨ç¤ºå°†mainå‡½æ•°ä½œä¸ºç¨‹åºå…¥å£ï¼Œå› ä¸ºldé“¾æŽ¥å™¨é»˜è®¤ä»¥_startä¸ºå…¥å£ï¼Œ-o abè¡¨ç¤ºé“¾æŽ¥è¾“å‡ºæ–‡ä»¶åä¸ºabï¼Œé»˜è®¤ä¸ºa.out $ld -T link.script #è‡ªå®šä¹‰é“¾æŽ¥è„šæœ¬ åŽ»æŽ‰è°ƒè¯•ä¿¡æ¯ $strip foo å†…åµŒæ±‡ç¼– asm(&quot;movl $42, %ebx \n\t&quot; &quot;movl $1, %eax \n\t&quot; &quot;int $0x80 \n\t&quot; ); å‚è€ƒæ±‡ç¼–è¯­è¨€å…¥é—¨æ•™ç¨‹ æ±‡ç¼–è¯­è¨€ä¸­LEAä¸ŽMOVæŒ‡ä»¤å°ç»“ ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…» â€“ é“¾æŽ¥ã€è£…è½½ä¸Žåº“ã€‹ Linux æ±‡ç¼–è¯­è¨€å¼€å‘æŒ‡å—]]></content>
      <categories>
        <category>ç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>dynamic</tag>
        <tag>link</tag>
        <tag>register</tag>
        <tag>assembly</tag>
        <tag>library</tag>
        <tag>static</tag>
        <tag>memory</tag>
        <tag>runtime</tag>
        <tag>interrupt</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºæœåŠ¡å™¨]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2F%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[æœ¬åœ°å¼€å‘å®ŒWeb AppåŽï¼Œåªåœ¨æœ¬åœ°èƒ½è·‘èµ·æ¥æ˜¯è¿œè¿œæœªèƒ½ç¬¦åˆå·¥ç¨‹åº”ç”¨çš„éœ€è¦ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œè´¦å·è®¾ç½®ã€çŽ¯å¢ƒæ­å»ºã€å®‰è£…å’Œå¯åŠ¨å¿…è¦çš„æœåŠ¡ã€éƒ¨ç½²è‡ªåŠ¨åŒ–ã€æœåŠ¡è¿›ç¨‹ç®¡ç†ã€WebæœåŠ¡è®¾ç½®ç­‰çš„å·¥ä½œï¼Œè¿™æ ·æ‰èƒ½ä½¿æˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„Webåœ¨è¢«æ­£å¸¸è®¿é—®çš„åŸºç¡€ä¸Šï¼Œæ›´é«˜æ•ˆã€ç¨³å®šåœ°éƒ¨ç½²å’Œå‘å¸ƒã€‚ ä¸‹é¢ä½¿ç”¨é˜¿é‡Œäº‘ECSæœåŠ¡å™¨æ¼”ç¤ºï¼ˆç•¥è¿‡è´­ä¹°ECSã€è´­ä¹°å¼¹æ€§å…¬ç½‘IPã€ECSç»‘å®šIPçš„è¿‡ç¨‹ï¼‰ã€‚ ä¿®æ”¹å¯†ç æ— è®ºæ˜¯Linuxè¿˜æ˜¯Ubuntuï¼Œç¬¬ä¸€æ¬¡ç™»å½•æ—¶å¯èƒ½ä¼šå‡ºçŽ°æç¤ºLogin Incorrectï¼Œè§£å†³åŠžæ³•æ˜¯ äº‘æœåŠ¡å™¨ECS-&gt;å®žä¾‹-&gt;é€‰æ‹©æ“ä½œçš„å®žä¾‹ï¼› ç‚¹å‡»â€œè¿œç¨‹è¿žæŽ¥â€æ—è¾¹çš„æ›´å¤šï¼› é‡ç½®ä¸€æ¬¡å¯†ç ï¼ˆå¯èƒ½éœ€è¦æ‰‹æœºçŸ­ä¿¡éªŒè¯ï¼‰ï¼Œæ³¨æ„è¿™é‡Œçš„å¯†ç ä¿®æ”¹çš„ä¸æ˜¯6ä½æ•°å­—é‚£ä¸ªè¿œç¨‹è¿žæŽ¥çš„å¯†ç ï¼Œè€Œæ˜¯rootè´¦æˆ·çš„å¯†ç ï¼› å¯†ç ä¿®æ”¹æˆåŠŸåŽï¼Œå¿…é¡»æ‰‹åŠ¨é‡å¯ä¸€æ¬¡å®žä¾‹ï¼› ç­‰å¾…é‡å¯æˆåŠŸåŽï¼Œå†æ¬¡è¿žæŽ¥åˆ°è¿œç¨‹ï¼Œè¾“å…¥ root å’Œ åˆšåˆšä¿®æ”¹è¿‡çš„å¯†ç ï¼ˆå¯†ç ä¸æ˜Žæ–‡æ˜¾ç¤ºï¼‰ï¼Œå°±å¯ä»¥æ­£å¸¸ç™»å½•äº†ã€‚ è¿œç¨‹è¿žæŽ¥æœ‰ä¸¤ç§æ–¹å¼è¿žæŽ¥ï¼Œä¸€æ˜¯é€šè¿‡é˜¿é‡Œäº‘ä¸Šæä¾›çš„ç½‘é¡µç‰ˆå‘½ä»¤è¡Œè¿žæŽ¥ï¼Œè€Œæ˜¯æœ¬åœ°å‘½ä»¤è¡Œä¸Šsshè¿žæŽ¥ã€‚ ç½‘é¡µç‰ˆè¿žæŽ¥æ—¶éœ€è¦æ³¨æ„ä¸Žæœ¬åœ°çš„è¾“å…¥æ–¹å¼å·®å¼‚ï¼Œä¸€èˆ¬é€šè¿‡ä¸‹å›¾å³ä¸Šè§’çš„â€å¤åˆ¶å‘½ä»¤è¾“å…¥â€œå®Œæˆï¼Œå› ä¸ºé¡µé¢ä½¿ç”¨éƒ¨åˆ†å­—æ¯ä½œä¸ºå¿«æ·æ–¹å¼ï¼Œæ•…æ— æ³•ç›´æŽ¥è¾“å…¥è¿™äº›å­—æ¯ã€‚ æœ¬åœ°å‘½ä»¤æ–¹å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯sshçš„idå…¬é’¥ä»£æ›¿è¾“å…¥å¯†ç æ¥ç™»å½•è¿œç¨‹ä¸»æœºï¼Œæ­¥éª¤å¦‚ä¸‹ $ ssh-keygen -t rsa //åˆ›å»ºå…¬é’¥åŠç§˜é’¥å¯¹ï¼Œé»˜è®¤è·¯å¾„ä¸º~/.ssh/id_rsa $ ssh-copy-id -i ~/.ssh/id_rsa.pub root@xx.xx.xx.xx //æŠŠå…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœº &amp; ssh root@xx.xx.xx.xx //ç™»å½• è½¯ä»¶æ›´æ–°apt-getçš„åº”ç”¨ apt-getä¸»è¦ç”¨äºŽè‡ªåŠ¨ä»Žäº’è”ç½‘çš„è½¯ä»¶ä»“åº“ä¸­æœç´¢ã€å®‰è£…ã€å‡çº§ã€å¸è½½è½¯ä»¶æˆ–æ“ä½œç³»ç»Ÿã€‚ sudo apt-get update //æ›´æ–°æœ¬æœºä¸­çš„è½¯ä»¶åŒ…çš„æ•°æ®åº“ç¼“å­˜ sudo apt-cache search &lt;name&gt; //æŸ¥æ‰¾åŒ…å«éƒ¨åˆ†å…³é”®å­—çš„è½¯ä»¶åŒ… sudo apt-get install &lt;package_name&gt; //å®‰è£…æŒ‡å®šçš„è½¯ä»¶(è‡ªåŠ¨å®‰è£…ä¾èµ–)ï¼Œ-d åªä¸‹è½½åŒ…ï¼Œä¸è§£åŽ‹å®‰è£… apt-get install package=version //å®‰è£…æŒ‡å®šç‰ˆæœ¬ apt-get source &lt;source_code_name&gt; //ä¸‹è½½è½¯ä»¶åŒ…æºä»£ç  apt-get remove packagename //å¸è½½è½¯ä»¶ï¼ŒåŒæ—¶ä¼šå¸è½½ä¾èµ–ï¼Œä½†ä¿ç•™é…ç½®ï¼Œ--purge åˆ é™¤é…ç½® apt-get clean //æ¸…ç†æ‰€æœ‰çš„ç¼“å­˜æ–‡ä»¶ dpkg -l //æŸ¥æ‰¾å®‰è£…åœ¨æœºå™¨ä¸Šé¢çš„è½¯ä»¶åŒ… å‚è€ƒé“¾æŽ¥ python3çš„å®‰è£… sudo apt-get install python3 //å®‰è£…python3.6ï¼Œå¯æŒ‡å®š3.7ï¼Œç³»ç»Ÿé»˜è®¤æœ‰python2 python3 -V //æŸ¥çœ‹python3çš„ç‰ˆæœ¬å· sudo apt-get install pip3 //å®‰è£…å¯¹åº”3.6çš„ç‰ˆæœ¬ï¼Œ3.7å¯ä½¿ç”¨sudo python3.7 get-pip.py è™šæ‹ŸpyçŽ¯å¢ƒæ­å»º pip3 install virtualenv mkdir awesome-python3-webapp virtualenv venv -p python3 source venv/bin/activate (venv)# pip install aiohttp (venv)# pip install jinja2 cd awesome-python3-webapp ... git init git add . git commit -m &quot;Initial commit&quot; git remote add origin &lt;remote_url&gt; git push -u origin master åŒæ­¥æ–‡ä»¶ä»Žæœ¬åœ°åŒæ­¥åˆ°è¿œç¨‹ rsync -avz -e ssh /Path/to/uploadFile root@xx.xx.xx.xx:/Path/to/file //ä½¿ç”¨é»˜è®¤ç«¯å£ rsync -avz -e &apos;ssh -p 61124&apos; /Path/to/uploadFile/ root@xx.xx.xx.xx:/Path/to/file //æŒ‡å®šç«¯å£ ä»Žè¿œç¨‹åŒæ­¥åˆ°æœ¬åœ° rsync -avzP -e ssh root@xx.xx.xx.xx:/Path/to/downloadFile /Path/to/file rsync -avzP -e &apos;ssh -p 61124&apos; root@xx.xx.xx.xx:/Path/to/downloadFile /Path/to/file å¼€æ”¾ç«¯å£â€œå®žä¾‹â€-&gt;â€æ›´å¤šâ€-&gt;â€ç½‘ç»œå’Œå®‰å…¨ç»„â€-&gt;â€å®‰å…¨ç»„é…ç½®â€-&gt;â€(å®‰å…¨ç»„åˆ—è¡¨)é…ç½®è§„åˆ™â€-&gt;â€æ·»åŠ å®‰å…¨ç»„è§„åˆ™â€ ä¸€èˆ¬åªéœ€è®¾ç½®å…¥è§„åˆ™æ–¹å‘ã€TCPåè®®ã€ç«¯å£èŒƒå›´ã€é»˜è®¤æƒå¯¹è±¡(0.0.0.0/0) æ£€æµ‹åœ¨è¿œç¨‹ä¸»æœºä¸Šä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤æ£€æµ‹æ˜¯å¦èƒ½è®¿é—® curl &lt;ip&gt;:&lt;port&gt; //æˆ–è€…ä½¿ç”¨ wget &lt;ip&gt;:&lt;port&gt; è‹¥å‡ºçŽ°Connection refusedçš„é”™è¯¯ netstat -tnl é…ç½®æ•°æ®åº“mysqlï¼š å®˜ç½‘ä¸‹è½½ ä¸‹è½½å®Œæ³¨æ„ä¿å­˜é»˜è®¤æä¾›çš„å¯†ç ã€‚ ä¿®æ”¹å¯†ç mysqladmin -u root password [password] è®¾ç½®çŽ¯å¢ƒå˜é‡ $ cd ~ $ vim ./.bash_profile &gt; export PATH=$PATH:/usr/local/mysql/bin $ source ~/.bash_profile $ echo $PATHåœ¨ç³»ç»Ÿè®¾ç½®-&gt;MySQL-&gt;æ‰“å¼€æœåŠ¡ ç™»å…¥ $ mysql -u root -pé‡ç½®å¯†ç  &gt; SET PASSWORD FOR [&apos;username&apos;]@[&apos;host&apos;]=PASSWORD(&apos;[newPassword]&apos;);åˆ›å»ºè´¦å· &gt; CREATE USER &apos;[username]&apos;@&apos;[host]&apos; IDENTIFIED BY &apos;[password]&apos;;åˆ é™¤è´¦å· &gt; DROP USER &apos;[username]&apos;@&apos;[host]&apos;;æŽˆæƒ &gt; GRANT [ALL] ON [databasename].[tablename] TO &apos;[username]&apos;@&apos;[host]&apos;å–æ¶ˆæŽˆæƒ &gt; REVOKE [ALL] ON [databasename].[tablename] FROM &apos;[username]&apos;@&apos;[host]&apos;æŸ¥è¯¢åŠåˆ›å»ºåº“/è¡¨ #æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨: &gt;show databases; #é€‰æ‹©ä½¿ç”¨æŸä¸ªæ•°æ®åº“: &gt;use [databaseName]; #åˆ›å»ºæ•°æ®åº“: &gt;create database [databaseName]; #æ˜¾ç¤ºåº“ä¸­çš„æ•°æ®è¡¨: &gt;show tables; #æ˜¾ç¤ºæ•°æ®è¡¨çš„ç»“æž„: &gt;describe [tableName]; #å»ºè¡¨: create table è¡¨å (å­—æ®µè®¾å®šåˆ—è¡¨)ï¼› #åˆ åº“å’Œåˆ è¡¨: drop database åº“å; drop table è¡¨åï¼› #å°†è¡¨ä¸­è®°å½•æ¸…ç©º: delete from è¡¨å; #æ˜¾ç¤ºè¡¨ä¸­çš„è®°å½•: select * from è¡¨å;å¸è½½ $ sudo rm /usr/local/mysql $ sudo rm -rf /usr/local/var/mysql $ sudo rm -rf /usr/local/mysql* $ sudo rm ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist $ sudo rm -rf /Library/StartupItems/MySQLCOM $ sudo rm -rf /Library/PreferencePanes/My* $ subl /etc/hostconfig` # Remove the line MYSQLCOM=-YES- $ rm -rf ~/Library/PreferencePanes/My* $ sudo rm -rf /Library/Receipts/mysql* $ sudo rm -rf /Library/Receipts/MySQL* $ sudo rm -rf /private/var/db/receipts/*mysql* linuxä¸‹å¼€å¯ã€å…³é—­ã€é‡å¯mysqlæœåŠ¡å‘½ä»¤è‹¥å¯åŠ¨åº”ç”¨æ—¶ï¼ŒæŠ¥é“¾æŽ¥ä¸åˆ°mysqlçš„é”™è¯¯(Canâ€™t connect to MySQL server on â€˜x.x.x.xâ€™)ï¼Œå¯æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š è¾“å…¥â€service mysqld statusâ€æŸ¥çœ‹mysqlæœåŠ¡æ˜¯å¦å·²å¯åŠ¨ï¼› æŸ¥è´¦å·æ˜¯å¦å­˜åœ¨ï¼Œä¸”æ˜¯å¦å·²æŽˆæƒç»™å¯¹åº”è¡¨ use mysql; select host,user from user;ï¼› è´¦å·å¯†ç æ˜¯å¦æ­£ç¡® mysql -u username -p passwd å…è®¸ä»»ä½•ä¸»æœºç™»é™†MySQLï¼Œè®¾ç½®/etc/mysql/mysql.conf.d/mysqld.cnf bind-address=0.0.0.0 å’Œ port=3360ï¼› å…³é—­é˜²ç«å¢™ systemctl stop firewalld systemctl status firewalld äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„å¼€æ”¾å¯¹åº”ç«¯å£3360. æŽ§åˆ¶mysqlæœåŠ¡çš„æ“ä½œï¼š 1ï¼‰å¯åŠ¨ ä½¿ç”¨ service å¯åŠ¨ï¼šservice mysql start ä½¿ç”¨ mysqld è„šæœ¬å¯åŠ¨ï¼š/etc/inint.d/mysql start ä½¿ç”¨ safe_mysqld å¯åŠ¨ï¼šsafe_mysql&amp;2ï¼‰åœæ­¢ ä½¿ç”¨ service å¯åŠ¨ï¼šservice mysql stop ä½¿ç”¨ mysqld è„šæœ¬å¯åŠ¨ï¼š/etc/inint.d/mysql stop mysqladmin shutdown3ï¼‰é‡å¯ ä½¿ç”¨ service å¯åŠ¨ï¼šservice mysql restart ä½¿ç”¨ mysqld è„šæœ¬å¯åŠ¨ï¼š/etc/inint.d/mysql restart å››ã€æŸ¥çœ‹mysqlçŠ¶æ€ mysql ç”¨æˆ·ç®¡ç†åˆ›å»ºç”¨æˆ· sudo adduser xx xxä¸ºç”¨æˆ·å ä¼šè‡ªåŠ¨åˆ›å»ºç”¨æˆ·ä¸»ç›®å½• ä¼šè‡ªåŠ¨æŒ‡å®šç³»ç»ŸShellç‰ˆæœ¬ /bin/bash éœ€ç”¨æˆ·æŒ‡å®šå¯†ç  è‡ªåŠ¨è°ƒç”¨ /etc/adduser.conf è‡ªå®šä¹‰å‚æ•° â€“home æŒ‡å®šä¸»ç›®å½• â€“quiet åªæ‰“å°è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ï¼Œå¿½ç•¥å…¶å®ƒä¿¡æ¯ â€“conf æŒ‡å®šconfigurationæ–‡ä»¶ â€“force-badname ç”¨æˆ·ååˆæ³•æ€§å¼±æ£€æŸ¥ æ–¹æ³•2 sudo useradd xx ä»€ä¹ˆéƒ½ä¸æŒ‡å®š è‡ªå®šä¹‰å‚æ•° -d æŒ‡å®šä¸»ç›®å½• -m å¦‚æžœå­˜åœ¨ä¸å†åˆ›å»ºï¼Œä½†æ˜¯æ­¤ç›®å½•å¹¶ä¸å±žäºŽæ–°åˆ›å»ºç”¨æˆ·ï¼›å¦‚æžœä¸»ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™å¼ºåˆ¶åˆ›å»ºï¼› -må’Œ-dä¸€å—ä½¿ç”¨ -s æŒ‡å®šç”¨æˆ·ç™»å½•æ—¶çš„shellç‰ˆæœ¬ -M ä¸åˆ›å»ºä¸»ç›®å½• ä¿®æ”¹å¯†ç  sudo passwd xxåˆ é™¤ç”¨æˆ· sudo userdel xx # è¿žåŒä¸»ç›®å½•ä¸€å¹¶åˆ é™¤ sudo userdel -r xx /etc/passwd ä½¿ç”¨è€…è´¦å·èµ„è®¯ï¼Œå¯ä»¥æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ /etc/shadow ä½¿ç”¨è€…è´¦å·èµ„è®¯åŠ å¯† /etc/group ç¾¤ç»„èµ„è®¯ /etc/default/useradd å®šä¹‰èµ„è®¯ /etc/login.defs ç³»ç»Ÿå¹¿ä¹‰è®¾å®š /etc/skel å®šä¹‰æ¡£çš„ç›®å½• è¿›ç¨‹ç®¡ç†Supervisoræ˜¯ç”¨Pythonå¼€å‘çš„ç›‘æŽ§æœåŠ¡è¿›ç¨‹å·¥å…·ï¼Œå¯ä»¥ç›‘å¬ã€å¯åŠ¨ã€åœæ­¢ã€é‡å¯ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚å½“ä¸€ä¸ªè¿›ç¨‹æ„å¤–è¢«æ€æ­»ï¼Œåˆ©ç”¨Supervisorç›‘å¬åˆ°è¿›ç¨‹æ­»åŽï¼Œä¼šè‡ªåŠ¨å°†å®ƒé‡å¯ï¼Œè‡ªåŠ¨æ¢å¤ï¼Œä¸å†éœ€è¦è‡ªå·±å†™shellè„šæœ¬æ¥æŽ§åˆ¶ã€‚ 1.å®‰è£…Supervisorï¼š yum install supervisor easy_install supervisor supervisord -v2.ä¿®æ”¹é…ç½®ï¼šå®‰è£…å¥½åŽï¼Œ/etc/supervisorä¼šç”Ÿæˆä¸€ä¸ªsupervisord.confæ–‡ä»¶åŠä¸€ä¸ªconf.dæ–‡ä»¶ç›®å½•ã€‚supervisord.confæ˜¯é»˜è®¤çš„é…ç½®ï¼›conf.dä¸­æ˜¯æ”¾æŒ‡å®šè¿›ç¨‹çš„è‡ªå®šä¹‰é…ç½®ã€‚ confæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨[xx]åˆ†éš”å¼€é…ç½®ä¸­çš„æ¨¡å—ï¼Œå…¶ä¸­[include]æ˜¯å¯¼å…¥å…¶å®ƒè‡ªå®šä¹‰çš„è¿›ç¨‹é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤é…ç½®æ˜¯åˆ¶å®š.iniçš„æ ¼å¼ï¼Œäº¦å¯æ˜¯*.confã€‚ æ·»åŠ è‡ªå®šä¹‰é…ç½®ï¼Œæ–°å»ºä¸€ä¸ªå¯¹åº”åº”ç”¨åä¸ºxxçš„xx.confåˆ° /etc/supervisor/conf.d/xx.confï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ [program:xx] command = /srv/xx/www/app.py directory = /srv/xx/www user = userName startsecs = 3 redirect_stderr = true stdout_logfile_maxbytes = 50MB stdout_logfile_backups = 10 stdout_logfile = /srv/xx/log/app.logå› ä¸ºsupervisorä¸èƒ½ç›‘æŽ§åŽå°è¿›ç¨‹ï¼Œæ‰€ä»¥é…ç½®ä¸­çš„command ä¸èƒ½ä¸ºåŽå°è¿è¡Œå‘½ä»¤ã€‚å¦‚æžœ.pyæ–‡ä»¶ä¸­ä¸æŒ‡å®šæ‰§è¡ŒçŽ¯å¢ƒï¼Œä¾‹å¦‚#!/usr/bin/env python3æˆ–#!/srv/xx/venv/bin python3ï¼Œé‚£commandå°±éœ€è¦è®¾ç½®å®Œæ•´çš„æŒ‡ä»¤ /path/python3 /path/xx.py æ‰§è¡Œstartä¹‹å‰å…ˆæŒ‡å®šé…ç½®çš„è·¯å¾„ï¼ˆç›´æŽ¥ä½¿ç”¨supervisorctlå¯èƒ½ä¼šæŠ¥é”™ unix:///var/run/supervisor/supervisor.sock no such fileã€‚æ‰§è¡Œ-c åŽä¹Ÿå…åŽ»äº†startï¼‰ sudo supervisord -c /etc/supervisord.conf sudo supervisorctl -c /etc/supervisord.conf supervisord æ˜¯å¯åŠ¨ supervisor å®ˆæŠ¤è¿›ç¨‹ï¼ˆç±»ä¼¼äºŽ systemd æˆ– init.d è¿™ç§ç”¨äºŽæ‰˜ç®¡è¿›ç¨‹çš„æœåŠ¡ï¼‰ã€‚supervisorctl æ˜¯ supervisord çš„å‘½ä»¤è¡ŒæŽ§åˆ¶å°ï¼Œå®ƒçš„å…¶å®ƒæ“ä½œæŒ‡ä»¤è¿˜åŒ…æ‹¬ supervisorctl status #æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„çŠ¶æ€ supervisorctl stop es #åœæ­¢es supervisorctl start es #å¯åŠ¨es supervisorctl restart es #é‡å¯es supervisorctl update #é…ç½®æ–‡ä»¶ä¿®æ”¹åŽå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤åŠ è½½æ–°çš„é…ç½® supervisorctl reload #é‡æ–°å¯åŠ¨é…ç½®ä¸­çš„æ‰€æœ‰ç¨‹åº ... #eså¯æ¢æˆallï¼Œç®¡ç†é…ç½®ä¸­çš„æ‰€æœ‰è¿›ç¨‹æœ€åŽå¼€å§‹ç›‘å¬æŸè¿›ç¨‹ï¼ˆå½“ç„¶éœ€è¦åœ¨xxè¿›ç¨‹å·²å¼€å¯çš„çŠ¶æ€ä¸‹è¿›è¡Œï¼‰ $ sudo supervisorctl reload $ sudo supervisorctl start xx $ sudo supervisorctl status xx RUNNING pid 1401, uptime 5:01:343.é‡åˆ°çš„é—®é¢˜ 1) å¦‚æžœæ‰§è¡Œ start æŒ‡ä»¤æ—¶æç¤ºspawn errorï¼Œå¯ä»¥æŸ¥è¯¢æ—¥å¿— tail -20 /var/log/supervisor/supervisord.logExit code 127 ä¸€èˆ¬æ„å‘³ç€æ‰¾ä¸åˆ°æŒ‡ä»¤ï¼Œå¯¹commandä¸­çš„æŒ‡ä»¤æ·»åŠ ç»å¯¹è·¯å¾„ã€‚ä¹Ÿå¯èƒ½æ˜¯é…ç½®æ²¡é‡åŠ è½½æˆåŠŸï¼Œå¯å°è¯•é‡å¯supervisordè¿›ç¨‹ï¼ˆå¯å‚è€ƒä¸‹ä¸€ç‚¹é—®é¢˜è§£å†³åŠžæ³•ï¼‰ 2) å¦‚æžœæ‰§è¡Œ supervisord -c æ—¶ï¼Œæç¤ºä»¥ä¸‹é”™è¯¯ï¼šError: Another program is already listening on a port that one of our HTTP servers is configured to use. Shut this program down first before starting supervisord. ä¸€èˆ¬æ˜¯è¿›ç¨‹å·²ç»æ‰“å¼€è¿‡ï¼Œæ€æŽ‰è¿›ç¨‹é‡è¯•å³å¯ ps -ef | grep supervisord kill -s SIGTERM pid3) å¦‚æžœæ‰§è¡Œ start æŒ‡ä»¤æ—¶æç¤º file is not executableï¼Œåˆ™å¯èƒ½æ˜¯æƒé™é—®é¢˜ï¼Œä¿®æ”¹å¯åŠ¨æ–‡ä»¶çš„æƒé™ chmod chmod a+x app.py å³å¯ã€‚ é…ç½®NginxæŠŠé…ç½®æ–‡ä»¶xxæ”¾åˆ°/etc/nginx/sites-available/ç›®å½•ä¸‹ï¼ˆä¸€èˆ¬æ˜¯åœ¨copy defaultæ–‡ä»¶çš„åŸºç¡€ä¸Šä¿®æ”¹ã€‚å¦‚æžœå’Œdefaultç›‘å¬ä¸€æ ·çš„ç«¯å£ç­‰è®¾ç½®ï¼Œåˆ™éœ€è¦å°†defaultåˆ é™¤ï¼Œä¿æŒä¸€ä¸ªåº”ç”¨ä¸€ä¸ªé…ç½®ï¼Œå…¶ä¸­ç›‘å¬çš„ç«¯å£ç­‰è®¾ç½®å¿…é¡»å„ä¸ä¸€æ ·ï¼‰ server &#123; listen 80; #ç›‘å¬80ç«¯å£ root /srv/xx/www; access_log /srv/xx/log/access_log; error_log /srv/xx/log/error_log; # server_name x.xx.com; # é…ç½®åŸŸå # å¤„ç†é™æ€æ–‡ä»¶ /favicon.ico; location /favicon.ico &#123; root /srv/xx/www &#125; # å¤„ç†é™æ€èµ„æº location ~ ^\/static\/.*$ &#123; root /srv/xx/www &#125; # åŠ¨æ€è¯·æ±‚è½¬å‘åˆ°9000ç«¯å£ location / &#123; proxy_pass http://127.0.0.1:9000; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for &#125; &#125; ç„¶åŽåœ¨/etc/nginx/sites-enabled/ç›®å½•ä¸‹åˆ›å»ºè½¯é“¾æŽ¥ sudo ln -s /etc/nginx/sites-available/xxè®©Nginxé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œwebappåº”è¯¥å°±èƒ½æ­£å¸¸è¿è¡Œ sudo /etc/init.d/nginx reload sudo service nginx restart # æˆ–é€šè¿‡serviceé‡å¯nginxæ—¢å¯åšæ­£å‘ä»£ç†ï¼Œä¹Ÿå¯åšåå‘ä»£ç†ï¼ˆåå‘ä»£ç†ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åƒå®¢æˆ·ç«¯è®¿é—®80ç«¯å£ï¼Œå¸®ä½ å®šä½åˆ°9000ç«¯å£ï¼Œè¿™æ ·çš„è½¬å‘åŠŸèƒ½ï¼‰ï¼Œä»¥ä¸Šä¾‹å­ä¸­ç›¸å…³çš„å‚æ•°å¦‚ä¸‹ X-Forwarded-Forï¼Œæ˜¯ç”¨äºŽè®°å½•ä»£ç†ä¿¡æ¯çš„ï¼Œæ¯ç»è¿‡ä¸€çº§ä»£ç†(åŒ¿åä»£ç†é™¤å¤–)ï¼Œä»£ç†æœåŠ¡å™¨éƒ½ä¼šæŠŠè¿™æ¬¡è¯·æ±‚çš„æ¥æºIPè¿½åŠ åœ¨X-Forwarded-Forä¸­ X-Real-IPï¼Œåªè®°å½•çœŸå®žå‘å‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯IP å‚è€ƒä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹Nginx é…ç½®è¯¦è§£éƒ¨ç½²Web App]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>æœåŠ¡å™¨</tag>
        <tag>Web App</tag>
        <tag>nginx</tag>
        <tag>supervisor</tag>
        <tag>fabric</tag>
        <tag>python</tag>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºåšå®¢å›¾åºŠ]]></title>
    <url>%2F%E5%B7%A5%E5%85%B7%2F%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E5%9B%BE%E5%BA%8A%2F</url>
    <content type="text"><![CDATA[åšäº†è‡ªå·±å›¾åºŠåŽï¼Œå†™åšå®¢çœŸçš„å˜å¾—å€çˆ½ã€‚è¿‡ç¨‹è¯´å¤æ‚ç§°ä¸ä¸Šï¼Œä½†ä¹Ÿè€—è´¹äº†ä¸€å®šçš„æ—¶é—´ï¼Œä¸ºé¿å…æ—¥åŽé—å¿˜äº†è€Œåˆéœ€è¦é‡æ–°æ­å»ºæ—¶èƒ½çœç‚¹å¿ƒï¼Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹å§ã€‚ å‡†å¤‡å·¥å…· ICPçš„åŸŸå ä¸ƒç‰›äº‘å­˜å‚¨å™¨ MWeb é…ç½®æ­¥éª¤ç”³è¯·åŸŸåçš„ICPåœ¨é˜¿é‡Œäº‘è´­ä¹°åŸŸååŽï¼Œè¿˜éœ€è´­ä¹°äº‘æœåŠ¡å™¨ECS(è‡³å°‘ä¹°3ä¸ªæœˆ)å’Œå¤–ç½‘IPçš„æœåŠ¡åŽï¼Œå› ä¸ºICPéœ€è¦è¿™3æ ·å†…å®¹ï¼Œä½†åŸŸåæ— éœ€æœ‰å®žè´¨æ€§çš„ç»‘å®šï¼ˆå½“æ—¶æˆ‘çš„åŸŸåç»‘åœ¨github pageä¸Šï¼Œè€ŒECSåˆ™éœ€è¦å’ŒIPå…ˆå…³è”äº†ï¼‰ã€‚ åœ¨ä»–ä»¬å®¶è¿›è¡ŒICPçš„ç”³è¯·å¾ˆæ–¹ä¾¿ï¼Œå¯ä»¥åˆ°ä»–ä»¬å®˜æ–¹çš„å¸®åŠ©ä¸­å¿ƒæŸ¥çœ‹å…·ä½“ç”³è¯·æµç¨‹ã€‚ é˜¿é‡Œäº‘æ–¹é¢åˆå®¡æ—¶å› ä¸ºç«™åã€å¤‡æ³¨ä¸ç¬¦åˆè¦æ±‚è¢«æ‹’è¿‡ä¸€æ¬¡ï¼Œé‡æ–°æäº¤åŽå‡ å¤©å·¥ä½œæ—¥å°±è¿‡å®¡äº†ã€‚ æœ‰æ•ˆæœŸå¬è¯´æ˜¯æ²¡æœ‰é™åˆ¶ï¼Œæš‚æ—¶è¿˜ä¸çŸ¥åŸŸåã€ECSå’ŒIPè¿‡æœŸä¸ç»­çº¦çš„è¯ICPæ˜¯å¦ä¼šå¤±æ•ˆã€‚ æ’ä¸ªé¢˜å¤–è¯ï¼Œå¦‚æžœæ˜¯ç”¨ä½œHexoçš„åšå®¢ï¼Œå¯ä»¥ç›´æŽ¥åœ¨footer.swigæ–‡ä»¶ï¼ˆæœ‰çš„æ‰©å±•åæ˜¯.ejsï¼Œä½äºŽPath/to/blog/themes/hexo/layout/_partialï¼‰ä¸Šçš„&lt;/span&gt;è·Ÿ&lt;/div&gt;ä¹‹é—´åŠ ä¸Šä¸ªç®€å•çš„&lt;a href=&quot;http://www.miitbeian.gov.cn/&quot;&gt;ç²¤ICPå¤‡xxxå·&lt;/a&gt;ã€‚ é…ç½®ä¸ƒç‰›äº‘æœåŠ¡å™¨åœ¨ä¸ƒç‰›åˆ›å»ºä¸ªäººçš„å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨åŽï¼Œå¯¹å…¶é…ç½®èžåˆCDNåŠ é€ŸåŸŸåï¼Œå°†ä½ ä¸ªäººçš„ICPåŸŸåæ˜ å°„åˆ°ä¸ƒç‰›çš„äºŒçº§åŸŸåä¸Šï¼ˆåŒæ—¶éœ€åœ¨é˜¿é‡Œäº‘çš„åŸŸåç®¡ç†ä¸Šé…ç½®å…¶CNAMEï¼‰ã€‚ ç„¶åŽèŽ·å–ä½ ä¸ƒç‰›æœåŠ¡å™¨çš„AKå’ŒSKå¤‡ç”¨ã€‚ æ³¨æ„ï¼Œä¸ƒç‰›ä¸Šå…è´¹çš„å­˜å‚¨ç©ºé—´ 10GBï¼Œæ¯æœˆä¸‹è½½æµé‡ 10GBï¼Œæ¯æœˆ PUT/DELETE 10 ä¸‡æ¬¡è¯·æ±‚ï¼Œæ¯æœˆ GET 100 ä¸‡æ¬¡è¯·æ±‚ã€‚ é…ç½®MWebä¸ƒç‰›ä¸Šä¼ æ–‡ä»¶çš„APIåœ°å€ï¼Œæ ¹æ®ä½ å­˜å‚¨æœåŠ¡å™¨é…ç½®çš„åœ°åŒºé€‰æ‹©æ­£ç¡®çš„APIåœ°å€ã€‚ ç„¶åŽåœ¨MWebçš„åå¥½è®¾ç½®é‡Œçš„å‘å¸ƒæœåŠ¡ä¸Šå¦‚ä¸‹é…ç½® æœ€åŽä½ åªè¦å°†æœ¬åœ°å›¾ç‰‡æ‹–å…¥ä½ ç¼–è¾‘çŠ¶æ€ä¸‹çš„mdæ–‡æ¡£é‡Œå°±èƒ½è‡ªåŠ¨ç”Ÿæˆå¥½mdçš„å›¾ç‰‡æ ¼å¼å’Œå¤–é“¾(ä½ æ‰€é…ç½®çš„åŸŸå+æ–‡ä»¶åè·¯å¾„)ã€‚ å¦‚æžœæ²¡ç”Ÿæˆå¤–é“¾ï¼Œè€Œæ˜¯æ”¾å…¥ä¸€ä¸ªå«Mideaçš„è·¯å¾„ä¸‹ï¼Œåˆ™å¯ä»¥é€šè¿‡èœå•æ -å‘å¸ƒ-å°†æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸€é”®å°†æ‰€æœ‰æ–‡ä¸­çš„æ‰€æœ‰å›¾ç‰‡ä¸Šä¼ ï¼Œä½†åœ°å€è¿˜æ˜¯è¦é€ä¸ªæ›¿æ¢..åŽŸæ¥ä»Žæ ¹æœ¬ä¸Šæœ‰ä¸€ä¸ªå¾ˆéšè”½çš„é…ç½®å¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¦‚ä¸‹å›¾çº¢æ¡†æ‰€ç¤ºï¼Œå‹¾ä¸Šå³å¯è§£å†³æ²¡ç”Ÿæˆå¤–é“¾çš„é—®é¢˜ æ›´è¯¦ç»†çš„é…ç½®è¯´æ˜Žå¯å‚è€ƒè¿™ç¯‡æ–‡ç«  MWebè¿˜æœ‰iOSç‰ˆï¼Œä¸€æ ·éžå¸¸å¥½ç”¨ï¼ŒèŠ±60RMBå†…è´­è§£é”icloud/dropboxçš„åŒæ­¥å’Œå‘å¸ƒæœåŠ¡ä¸¤é¡¹ä¾¿æ·åŠŸèƒ½ï¼Œå¦‚æžœå¯¹è¿™æ–¹é¢éœ€æ±‚ä¸å¤§ï¼Œå¹³æ—¶å¯ä»¥é€šè¿‡airdropåˆ†äº«å°±èƒ½å°†æ–‡æ¡£åŒæ­¥åˆ°Macã€‚]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidå·¥ç¨‹å…¥é—¨]]></title>
    <url>%2FAndroid%2FAndroid%E5%B7%A5%E7%A8%8B%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[æ·±å…¥äº†è§£å¾ˆå¤šAndroidå·¥ç¨‹ä¸Šçš„å†…å®¹æ—¶ï¼Œäº§ç”Ÿäº†å¾ˆå¤šç–‘æƒ‘ï¼Œç”±äºŽæ—¶é—´å®žåœ¨åˆ†ä¸å¼€æ¥ï¼Œæœ¬èº«æ²¡æœ‰å…ˆç³»ç»Ÿåœ°å­¦ä¹ ï¼Œéƒ½æ˜¯é’ˆå¯¹ä¸æ‡‚çš„æŸ¥æŸ¥é—®é—®ï¼Œæ‰€ä»¥è¿™é‡Œç®—æ˜¯æ¥ä¸€ä¸ªAndroidå·¥ç¨‹å…¥é—¨çš„æ‚è°ˆå§ï¼ˆå…¶å®žå«æ‚çƒ©æ¯”è¾ƒåˆä¹Žï¼‰ï¼Œè®°å½•ä¸€äº›æ”¶é›†åˆ°çš„åŽŸç†å’Œæ–¹æ³•ã€ä¸€äº›è‡ªå·±çš„è§‚ç‚¹å’Œé‡åˆ°çš„é—®é¢˜ã€‚ å·¥ç¨‹ç»“æž„Projectä¸ŽModuleçš„åŒºåˆ«Projectç›¸å½“äºŽEclipseé‡Œé¢çš„å·¥ä½œåŒºé—´ï¼ŒModuleç›¸å½“äºŽEclipseé‡Œé¢çš„projectã€‚ASé‡Œé¢çš„é¡¹ç›®ç»“æž„ä¹Ÿå¯ä»¥åƒEclipseä¸€æ ·ï¼Œä¸€ä¸ªProjectæ–°å»ºå¤šä¸ªModuleã€‚ ä¸€èˆ¬çš„ç»„ä»¶åŒ–ç®¡ç†ä¸‹ï¼Œéƒ½ä¼šåœ¨Projectä¸­å»ºå¤šä¸ªæ¿å—åŠŸèƒ½Moduleï¼ŒAppä¹Ÿä½œä¸ºå…¶ä¸­ä¸€ä¸ªModuleæ¥ç®¡ç†ã€‚Projectä¸­çš„build.gradleå…·æœ‰å…¨å±€æ€§ï¼Œè‹¥Moduleçš„build.gradleä¸ŽProjectçš„æœ‰é‡å¤ä¸”å†²çªé¡¹ï¼Œåˆ™ä»¥Projectçš„ä¸ºå‡†ã€‚ ç¬¬ä¸‰æ–¹åº“å¼•ç”¨ project structure-&gt;app-&gt;Dependencies-&gt;â€+â€-&gt;Library dependency-&gt;Search-&gt;OK(è‡ªåŠ¨build) åˆ‡æ¢ä¸ºProjectæ ‘ç»“æž„-&gt;app/libs-&gt;æ”¾å…¥jaråŒ…-&gt;Build project structure-&gt;app-&gt;Dependencies-&gt;â€+â€-&gt;Module dependency-&gt;é€‰æ‹©Module-&gt;OK(è‡ªåŠ¨build) build.gradle(Module:app)-&gt;dependencies-&gt;compile/implementation â€˜package:name:verâ€™ å¤åˆ¶å„æž¶æž„çš„soåˆ°app/libs-&gt;build.gradle(Module:app)æ·»åŠ sourceSets {main {jniLibs.srcDirs =[â€˜libsâ€™]}}-&gt;Build ç›´æŽ¥å¤åˆ¶å„æž¶æž„çš„soåˆ°app/src/main/jniLibs Gradleè¯­æ³•ä¸Šæ˜¯åŸºäºŽGroovyè¯­è¨€ï¼ˆåŸºäºŽJVMçš„æ•æ·å¼€å‘è¯­è¨€ï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºå¼ºç±»åž‹è¯­è¨€Javaçš„å¼±ç±»åž‹ç‰ˆæœ¬ï¼‰ï¼Œåœ¨é¡¹ç›®ç®¡ç†ä¸Šæ˜¯åŸºäºŽAnt(Javaç¼–è¯‘å™¨)å’ŒMavenæ¦‚å¿µçš„é¡¹ç›®è‡ªåŠ¨åŒ–å»ºæž„å·¥å…·ã€‚ Androidå¤šMouduleï¼ˆä¹Ÿå°±æ˜¯gradleä¸­çš„å¤šProject Multi-Projects Buildï¼‰çš„åŸºæœ¬é¡¹ç›®ç»“æž„ï¼š â”œâ”€â”€ app #Android Appç›®å½• â”‚ â”œâ”€â”€ app.iml â”‚ â”œâ”€â”€ build #æž„å»ºè¾“å‡ºç›®å½• â”‚ â”œâ”€â”€ build.gradle #æž„å»ºè„šæœ¬ â”‚ â”œâ”€â”€ libs #soç›¸å…³åº“ â”‚ â”œâ”€â”€ proguard-rules.pro #proguardæ··æ·†é…ç½® â”‚ â””â”€â”€ src #æºä»£ç ï¼Œèµ„æºç­‰ â”œâ”€â”€ module #Android å¦å¤–ä¸€ä¸ªmoduleç›®å½• â”‚ â”œâ”€â”€ module.iml â”‚ â”œâ”€â”€ build #æž„å»ºè¾“å‡ºç›®å½• â”‚ â”œâ”€â”€ build.gradle #æž„å»ºè„šæœ¬ â”‚ â”œâ”€â”€ libs #soç›¸å…³åº“ â”‚ â”œâ”€â”€ proguard-rules.pro #proguardæ··æ·†é…ç½® â”‚ â””â”€â”€ src #æºä»£ç ï¼Œèµ„æºç­‰ â”œâ”€â”€ build â”‚ â””â”€â”€ intermediates â”œâ”€â”€ build.gradle #å·¥ç¨‹æž„å»ºæ–‡ä»¶ â”œâ”€â”€ gradle â”‚ â””â”€â”€ wrapper â”œâ”€â”€ gradle.properties #gradleçš„é…ç½® â”œâ”€â”€ gradlew #gradle wrapper linux shellè„šæœ¬ â”œâ”€â”€ gradlew.bat â”œâ”€â”€ LibSqlite.iml â”œâ”€â”€ local.properties #é…ç½®Androod SDKä½ç½®æ–‡ä»¶ â””â”€â”€ settings.gradle #å·¥ç¨‹é…ç½® Gradleå¤šä¸ªProjectçš„ä¾‹å­ï¼š â”œâ”€â”€ app â”‚ â”œâ”€â”€ build.gradle #æž„å»ºè„šæœ¬ â”œâ”€â”€ module â”‚ â”œâ”€â”€ build.gradle #æž„å»ºè„šæœ¬ â”œâ”€â”€ build.gradle #å·¥ç¨‹æž„å»ºæ–‡ä»¶ â”œâ”€â”€ gradle â”‚ â””â”€â”€ wrapper #å…ˆä¸åŽ»ç®¡å®ƒ â”œâ”€â”€ gradle.properties #gradleçš„é…ç½® â”œâ”€â”€ gradlew #gradle wrapper linux shellè„šæœ¬ â”œâ”€â”€ gradlew.bat â””â”€â”€ settings.gradle #å·¥ç¨‹é…ç½® build.gradleæ˜¯Gradleé»˜è®¤çš„æž„å»ºè„šæœ¬æ–‡ä»¶ï¼Œæ‰§è¡ŒGradleå‘½ä»¤çš„æ—¶å€™ï¼Œä¼šé»˜è®¤åŠ è½½å½“å‰ç›®å½•ä¸‹çš„build.gradleè„šæœ¬æ–‡ä»¶ã€‚ æ¯æ¬¡æž„å»ºè‡³å°‘ç”±ä¸€ä¸ªprojectæž„æˆï¼Œä¸€ä¸ªprojectç”±ä¸€åˆ°å¤šä¸ªtaskæž„æˆã€‚é¡¹ç›®ç»“æž„ä¸­çš„æ¯ä¸ªbuild.gradleæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªprojectï¼Œåœ¨è¿™ç¼–è¯‘è„šæœ¬æ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„taskï¼›task æœ¬è´¨ä¸Šåˆæ˜¯ç”±ä¸€ç»„è¢«é¡ºåºæ‰§è¡Œçš„Actionå¯¹è±¡æž„æˆï¼ŒActionå…¶å®žæ˜¯ä¸€æ®µä»£ç å—ï¼Œç±»ä¼¼äºŽJavaä¸­çš„æ–¹æ³•ã€‚ æ‰§è¡Œæµç¨‹ å’ŒMavenä¸€æ ·ï¼ŒGradleåªæ˜¯æä¾›äº†æž„å»ºé¡¹ç›®çš„ä¸€ä¸ªæ¡†æž¶ï¼ŒçœŸæ­£èµ·ä½œç”¨çš„æ˜¯Pluginã€‚ Gradleåœ¨é»˜è®¤æƒ…å†µä¸‹ä¸ºæˆ‘ä»¬æä¾›äº†è®¸å¤šå¸¸ç”¨çš„Pluginï¼Œå…¶ä¸­åŒ…æ‹¬æœ‰æž„å»ºJavaé¡¹ç›®çš„Pluginï¼Œè¿˜æœ‰Androidç­‰ã€‚ ä¸ŽMavenä¸åŒçš„æ˜¯ï¼ŒGradleä¸æä¾›å†…å»ºçš„é¡¹ç›®ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œåªæ˜¯java Pluginå‘Projectä¸­æ·»åŠ äº†è®¸å¤šTaskï¼Œè¿™äº›Taskä¾æ¬¡æ‰§è¡Œï¼Œä¸ºæˆ‘ä»¬è¥é€ äº†ä¸€ç§å¦‚åŒMavenèˆ¬é¡¹ç›®æž„å»ºå‘¨æœŸã€‚ Gradleæ˜¯ä¸€ç§å£°æ˜Žå¼çš„æž„å»ºå·¥å…·ã€‚åœ¨æ‰§è¡Œæ—¶ï¼ŒGradleå¹¶ä¸ä¼šä¸€å¼€å§‹ä¾¿é¡ºåºæ‰§è¡Œbuild.gradleæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè€Œæ˜¯åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯é…ç½®é˜¶æ®µï¼Œç„¶åŽæ‰æ˜¯å®žé™…çš„æ‰§è¡Œé˜¶æ®µã€‚ é…ç½®é˜¶æ®µï¼ŒGradleå°†è¯»å–æ‰€æœ‰build.gradleæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹æ¥é…ç½®Projectå’ŒTaskç­‰ï¼Œæ¯”å¦‚è®¾ç½®Projectå’ŒTaskçš„Propertyï¼Œå¤„ç†Taskä¹‹é—´çš„ä¾èµ–å…³ç³»ç­‰ã€‚ Gradleä¸ºæ¯ä¸ªbuild.gradleéƒ½ä¼šåˆ›å»ºä¸€ä¸ªç›¸åº”çš„Projecté¢†åŸŸå¯¹è±¡ï¼Œåœ¨ç¼–å†™Gradleè„šæœ¬æ—¶ï¼Œæˆ‘ä»¬å®žé™…ä¸Šæ˜¯åœ¨æ“ä½œè¯¸å¦‚Projectè¿™æ ·çš„Gradleé¢†åŸŸå¯¹è±¡ã€‚åœ¨å¤šProjectçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¼šæ“ä½œå¤šä¸ªProjecté¢†åŸŸå¯¹è±¡ã€‚Gradleæä¾›äº†å¼ºå¤§çš„å¤šProjectæž„å»ºæ”¯æŒã€‚ è¦åˆ›å»ºå¤šProjectçš„Gradleé¡¹ç›®ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨æ ¹ï¼ˆRootï¼‰Projectä¸­åŠ å…¥åä¸ºsettings.gradleçš„é…ç½®æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åº”è¯¥åŒ…å«å„ä¸ªå­Projectçš„åç§°ã€‚Gradleä¸­çš„Projectå¯ä»¥ç®€å•çš„æ˜ å°„ä¸ºAndroidStudioä¸­çš„Moduleã€‚ åœ¨æœ€å¤–å±‚çš„build.gradleã€‚ä¸€èˆ¬å¹²å¾—æ´»æ˜¯ï¼šé…ç½®å…¶ä»–å­Projectçš„ã€‚æ¯”å¦‚ä¸ºå­Projectæ·»åŠ ä¸€äº›å±žæ€§ã€‚ æ¯æ¬¡æž„å»ºçš„æ‰§è¡Œæœ¬è´¨ä¸Šæ˜¯æ‰§è¡Œä¸€ç³»åˆ—çš„taskï¼Œå¹¶ä¸”æŸäº›taskè¿˜éœ€è¦ä¾èµ–å…¶ä»–taskï¼Œè¿™äº›taskçš„ä¾èµ–å…³ç³»éƒ½æ˜¯åœ¨æž„å»ºé˜¶æ®µç¡®å®šçš„ã€‚æ¯æ¬¡æž„å»ºåˆ†ä¸º3ä¸ªé˜¶æ®µï¼š Initialization: åˆå§‹åŒ–é˜¶æ®µ è¿™æ˜¯åˆ›å»ºProjecté˜¶æ®µï¼Œæž„å»ºå·¥å…·æ ¹æ®æ¯ä¸ªbuild.gradleæ–‡ä»¶åˆ›å»ºå‡ºä¸€ä¸ªProjectå®žä¾‹ã€‚åˆå§‹åŒ–é˜¶æ®µä¼šæ‰§è¡Œé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„settings.gradleæ–‡ä»¶ï¼Œæ¥åˆ†æžå“ªäº›é¡¹ç›®å‚ä¸Žæž„å»ºã€‚ Configuration:é…ç½®é˜¶æ®µ è¿™ä¸ªé˜¶æ®µï¼Œé€šè¿‡æ‰§è¡Œæž„å»ºè„šæœ¬æ¥ä¸ºæ¯ä¸ªprojectåˆ›å»ºå¹¶é…ç½®Taskã€‚é…ç½®é˜¶æ®µä¼šåŽ»åŠ è½½æ‰€æœ‰å‚ä¸Žæž„å»ºçš„é¡¹ç›®çš„build.gradleæ–‡ä»¶ï¼Œä¼šå°†æ¯ä¸ªbuild.gradleæ–‡ä»¶å®žä¾‹åŒ–ä¸ºä¸€ä¸ªGradleçš„projectå¯¹è±¡ã€‚ç„¶åŽåˆ†æžprojectä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸‹è½½ä¾èµ–æ–‡ä»¶ï¼Œåˆ†æžprojectä¸‹çš„taskä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ Execution:æ‰§è¡Œé˜¶æ®µ è¿™æ˜¯TaskçœŸæ­£è¢«æ‰§è¡Œçš„é˜¶æ®µï¼ŒGradleä¼šæ ¹æ®ä¾èµ–å…³ç³»å†³å®šå“ªäº›Taskéœ€è¦è¢«æ‰§è¡Œï¼Œä»¥åŠæ‰§è¡Œçš„å…ˆåŽé¡ºåºã€‚taskæ˜¯Gradleä¸­çš„æœ€å°æ‰§è¡Œå•å…ƒï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æž„å»ºï¼Œç¼–è¯‘ï¼Œæ‰“åŒ…ï¼Œdebugï¼Œtestç­‰éƒ½æ˜¯æ‰§è¡Œäº†æŸä¸€ä¸ªtaskï¼Œä¸€ä¸ªprojectå¯ä»¥æœ‰å¤šä¸ªtaskï¼Œtaskä¹‹é—´å¯ä»¥äº’ç›¸ä¾èµ–ã€‚ä¾‹å¦‚æˆ‘æœ‰ä¸¤ä¸ªtaskï¼ŒtaskAå’ŒtaskBï¼ŒæŒ‡å®štaskAä¾èµ–taskBï¼Œç„¶åŽæ‰§è¡ŒtaskAï¼Œè¿™æ—¶ä¼šå…ˆåŽ»æ‰§è¡ŒtaskBï¼ŒtaskBæ‰§è¡Œå®Œæ¯•åŽåœ¨æ‰§è¡ŒtaskAã€‚åœ¨ASå³ä¾§çš„GradleæŒ‰é’®ä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸€äº›åˆ—çš„task build.gradleæ–‡ä»¶åˆ†æžapply plugin: &apos;com.android.application&apos; android &#123; compileSdkVersion 25 buildToolsVersion &quot;25.0.0&quot; defaultConfig &#123; applicationId &quot;me.febsky.demo&quot; minSdkVersion 15 targetSdkVersion 25 versionCode 1 versionName &quot;1.0&quot; testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot; &#125; buildTypes &#123; release &#123; minifyEnabled false proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; &#125; &#125; &#125; dependencies &#123; compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;]) compile &apos;com.android.support:appcompat-v7:25.1.0&apos; &#125; æ–¹æ³•è°ƒç”¨ï¼Œåœ†æ‹¬å·å¯ä»¥çœç•¥ å¦‚æžœæ–¹æ³•å‚æ•°æ˜¯ä¸ªMapï¼Œæ–¹æ‹¬å·å¯ä»¥çœç•¥ é—­åŒ…ä½œä¸ºå‡½æ•°çš„æœ€åŽä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥åœ¨æ‹¬å·å†…æˆ–æ‹¬å·å¤–ï¼Œæ²¡æ‹¬å·æ—¶ä¸ç”¨å…³æ³¨ GroovyåŠ¨æ€çš„ä¸ºæ¯ä¸€ä¸ªå­—æ®µéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆgetterå’Œsetterï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡åƒè®¿é—®å­—æ®µæœ¬èº«ä¸€æ ·è°ƒç”¨getterå’Œsetterã€‚ æ‰€ä»¥ä¸Šé¢çš„apply plugin: &#39;com.android.application&#39;ï¼Œå¯ä»¥çœ‹æˆæ˜¯apply([plugin: &#39;com.android.application&#39;]) Gradleçš„Projectä¹‹é—´çš„ä¾èµ–å…³ç³»æ˜¯åŸºäºŽTaskçš„ï¼Œè€Œä¸æ˜¯æ•´ä¸ªProjectçš„ã€‚ Project:æ˜¯Gradleæœ€é‡è¦çš„ä¸€ä¸ªé¢†åŸŸå¯¹è±¡ï¼Œæˆ‘ä»¬å†™çš„build.gradleè„šæœ¬çš„å…¨éƒ¨ä½œç”¨ï¼Œå…¶å®žå°±æ˜¯é…ç½®ä¸€ä¸ªProjectå®žä¾‹ã€‚åœ¨build.gradleè„šæœ¬é‡Œï¼Œæˆ‘ä»¬å¯ä»¥éšå¼çš„æ“çºµProjectå®žä¾‹ï¼Œæ¯”å¦‚ï¼Œapplyæ’ä»¶ã€å£°æ˜Žä¾èµ–ã€å®šä¹‰Taskç­‰ï¼Œå¦‚ä¸Šé¢build.gradleæ‰€ç¤ºã€‚applyã€dependenciesã€taskç­‰å®žé™…ä¸Šæ˜¯Projectçš„æ–¹æ³•ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªä»£ç å—ã€‚å¦‚æžœéœ€è¦ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºçš„æ“çºµProjectå®žä¾‹ï¼Œæ¯”å¦‚ï¼šproject.ext.myProp = â€˜myValueâ€™ Task:Gradleä¸­çš„Taskè¦ä¹ˆæ˜¯ç”±ä¸åŒçš„Pluginå¼•å…¥çš„ï¼Œè¦ä¹ˆæ˜¯æˆ‘ä»¬è‡ªå·±åœ¨build.gradleæ–‡ä»¶ä¸­ç›´æŽ¥åˆ›å»ºçš„ã€‚Gradleä¿è¯TaskæŒ‰ç…§ä¾èµ–é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªTaskæœ€å¤šåªè¢«æ‰§è¡Œä¸€æ¬¡ã€‚ dependencies:åœ¨Projectçš„gradle dependencies ä¸­ä½¿ç”¨classpathä¸€èˆ¬æ˜¯æŒ‡æ·»åŠ buildscriptæœ¬èº«éœ€è¦è¿è¡Œçš„ä¸œè¥¿ã€‚buildScriptæ˜¯ç”¨æ¥åŠ è½½gradleè„šæœ¬è‡ªèº«éœ€è¦ä½¿ç”¨çš„èµ„æºï¼Œå¯ä»¥å£°æ˜Žçš„èµ„æºåŒ…æ‹¬ä¾èµ–é¡¹ã€ç¬¬ä¸‰æ–¹æ’ä»¶ã€mavenä»“åº“åœ°å€ç­‰ã€‚ åœ¨Appçš„gradle dependencies ä¸­æ·»åŠ åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„ä¾èµ–åŒ…ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„ä¸œè¥¿ã€‚ é¡¹ç›®æ ¹ç›®å½•çš„ build.gradle æ–‡ä»¶ï¼šç”¨æ¥é…ç½®é’ˆå¯¹æ‰€æœ‰æ¨¡å—çš„ä¸€äº›å±žæ€§ã€‚å®ƒé»˜è®¤åŒ…å«2ä¸ªä»£ç å—ï¼šbuildscript{â€¦}å’Œallprojects{â€¦}ã€‚å‰è€…ç”¨äºŽé…ç½®æž„å»ºè„šæœ¬æ‰€ç”¨åˆ°çš„ä»£ç åº“å’Œä¾èµ–å…³ç³»ï¼ŒåŽè€…ç”¨äºŽå®šä¹‰æ‰€æœ‰æ¨¡å—éœ€è¦ç”¨åˆ°çš„ä¸€äº›å…¬å…±å±žæ€§ settings.gradle æ–‡ä»¶ï¼šä¼šåœ¨æž„å»ºçš„ initialization é˜¶æ®µè¢«æ‰§è¡Œï¼Œå®ƒç”¨äºŽå‘Šè¯‰æž„å»ºç³»ç»Ÿå“ªäº›æ¨¡å—éœ€è¦åŒ…å«åˆ°æž„å»ºè¿‡ç¨‹ä¸­ã€‚å¯¹äºŽå•æ¨¡å—é¡¹ç›®ï¼Œ settings.gradle æ–‡ä»¶ä¸æ˜¯å¿…éœ€çš„ã€‚å¯¹äºŽå¤šæ¨¡å—é¡¹ç›®ï¼Œå¦‚æžœæ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œæž„å»ºç³»ç»Ÿå°±ä¸èƒ½çŸ¥é“è¯¥ç”¨åˆ°å“ªäº›æ¨¡å—ã€‚ æ¨¡å—çº§é…ç½®æ–‡ä»¶ build.gradle ï¼šé’ˆå¯¹æ¯ä¸ªmoudle çš„é…ç½®ï¼Œå¦‚æžœè¿™é‡Œçš„å®šä¹‰çš„é€‰é¡¹å’Œé¡¶å±‚ build.gradleå®šä¹‰çš„ç›¸åŒã€‚å®ƒæœ‰3ä¸ªé‡è¦çš„ä»£ç å—ï¼špluginï¼Œandroid å’Œ dependenciesã€‚ Taskç¤ºä¾‹task myTask &#123; doFirst &#123; println &apos;hello&apos; &#125; doLast &#123; println &apos;world&apos; &#125; &#125; è¿™æ®µä»£ç çš„å«ä¹‰æ˜¯ç»™Projectæ·»åŠ ä¸€ä¸ªåä¸ºâ€œmyTaskâ€çš„ä»»åŠ¡ã€‚ç”¨ä¸€ä¸ªé—­åŒ…æ¥é…ç½®è¿™ä¸ªä»»åŠ¡ï¼ŒTaskæä¾›äº†doFirstå’ŒdoLastæ–¹æ³•æ¥ç»™è‡ªå·±æ·»åŠ Actionã€‚ å…¶å®žbuild.gradleè„šæœ¬çš„çœŸæ­£ä½œç”¨ï¼Œå°±æ˜¯é…ç½®ä¸€ä¸ªProjectå®žä¾‹ã€‚åœ¨æ‰§è¡Œbuildè„šæœ¬ä¹‹å‰ï¼ŒGradleä¼šä¸ºæˆ‘ä»¬å‡†å¤‡å¥½ä¸€ä¸ªProjectå®žä¾‹ï¼Œæ‰§è¡Œå®Œè„šæœ¬ä¹‹åŽï¼ŒGradleä¼šæŒ‰ç…§DAGä¾æ¬¡æ‰§è¡Œä»»åŠ¡ã€‚ å¦‚æžœtaskå£°æ˜Žåœ¨æ ¹Projectçš„build.gradleä¸­çš„allprojects()æ–¹æ³•ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªTaskä¼šåº”ç”¨äºŽæ‰€æœ‰çš„Projectã€‚ å¦‚æžœæ˜¯Muliti-Projectçš„æ¨¡å¼ï¼Œä¾èµ–å…³ç³»è¦å¸¦ç€æ‰€å±žçš„Projectï¼Œå¦‚taskA.dependsOn â€˜:other-project:taskCâ€™ å…¶ä¸­taskCä½äºŽå’ŒtaskAä¸åŒçš„Projectä¸­ï¼Œç›¸å¯¹äºŽAndroidStudioæ¥è¯´ï¼Œå°±æ˜¯ä½äºŽä¸åŒçš„Moduleä¸‹çš„build.gradleä¸­ï¼Œè€Œother-projectä¸ºModuleåå­—ã€‚ å…¶å®ƒå®žçŽ° è‡ªå®šä¹‰Pluginï¼šæ¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Pluginéƒ½éœ€è¦å®žçŽ°PluginæŽ¥å£ï¼Œé™¤äº†ç»™Projectç¼–å†™Pluginä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸ºå…¶ä»–Gradleç±»ç¼–å†™Pluginã€‚è¯¥æŽ¥å£å®šä¹‰äº†ä¸€ä¸ªapply()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ“ä½œProjectï¼Œæ¯”å¦‚å‘å…¶ä¸­åŠ å…¥Taskï¼Œå®šä¹‰é¢å¤–çš„Propertyç­‰ã€‚ Gradle Wrapperï¼šé¡¾åæ€ä¹‰ï¼Œå…¶å®žå°±æ˜¯å¯¹Gradleçš„ä¸€å±‚åŒ…è£…ï¼Œä¾¿äºŽåœ¨å›¢é˜Ÿå¼€å‘è¿‡ç¨‹ä¸­ç»Ÿä¸€Gradleæž„å»ºçš„ç‰ˆæœ¬ï¼Œç„¶åŽæäº¤åˆ°gitä¸Šï¼Œç„¶åŽåˆ«äººå¯ä»¥ä¸‹è½½ä¸‹æ¥ï¼Œè¿™æ ·å¤§å®¶éƒ½å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„Gradleç‰ˆæœ¬è¿›è¡Œæž„å»ºï¼Œé¿å…å› ä¸ºGradleç‰ˆæœ¬ä¸ç»Ÿä¸€å¸¦æ¥çš„ä¸å¿…è¦çš„é—®é¢˜ã€‚ï¼ˆæ‰€ä»¥è¦æ˜Žç™½è¿™ä¸ªä¸œè¥¿å¯ä»¥æ²¡æœ‰ï¼Œæœ‰äº†åªæ˜¯ä¸ºäº†ç»Ÿä¸€ç®¡ç†ï¼Œæ›´åŠ æ–¹ä¾¿ï¼‰ å­Moduleçš„ä¾èµ–å±•å¼€ï¼šè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºç»™å…¶å®ƒå­Moduleæˆ–è€…ç»™çˆ¶Projectä¹Ÿèƒ½å¼•ç”¨å­˜åœ¨äºŽå½“å‰å­Moduleä¸­çš„ä¾èµ–libsã€‚åœ¨æ ¹å·¥ç¨‹ï¼ˆå³çˆ¶Projectï¼‰ä¸‹çš„build.gradleä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œæ ¸å¿ƒéƒ¨åˆ†æ˜¯repositoriesä¸­çš„flatDir allprojects &#123; repositories &#123; jcenter() flatDir &#123; dirs project(&apos;:sub_module&apos;).file(&apos;libs&apos;) &#125; &#125; &#125; ç›¸å…³å‡½æ•°Gradle plugin 3.0ä¾èµ–æ–¹å¼å¢žåŠ äº† implementation å’Œ api ï¼Œç”¨ä»¥å–ä»£ compileã€‚æœ‰å·¥ç¨‹ Aã€Bã€C.è®© A ä¾èµ– B (implementationã€api éƒ½å¯ä»¥)ã€‚è‹¥B implementation Cï¼Œåˆ™A ä¸èƒ½è°ƒç”¨ C çš„æ–¹æ³•ã€‚è‹¥ B api Cï¼Œåˆ™A å¯ä»¥è°ƒç”¨ C çš„æ–¹æ³•(åŒ compile)ã€‚ MavenæŠ½å–å…¬å…±Gradleçš„å®žçŽ° åœ¨ç»„ä»¶åŒ–çš„çŽ¯å¢ƒä¸Šåº”ç”¨Mavenæ—¶ï¼Œåº”å°†å„ä¸ªModuleå…±æœ‰çš„å…³äºŽMavençš„é…ç½®å’Œgradleè„šæœ¬å®žçŽ°æŠ½å–ã€‚ ä¸Šå›¾æ˜¯å°†å…¬å…±çš„Mavené…ç½®å’Œè„šæœ¬è¿›è¡Œå…¥åº“ï¼Œæ¯ä¸ªModuleéœ€è¦åº”ç”¨Mavenæ—¶å°±ä»Žgitä¸Šcloneå®ƒä¸‹æ¥ä½œä¸ºå½“å‰Moduleçš„å­æ¨¡å—ã€‚ maven_user.propertiesæ˜¯å­˜æ”¾é€šç”¨çš„Mavené…ç½®ï¼ˆåƒMavenä»“åº“çš„åœ°å€ã€å¸å¯†ç­‰ï¼‰ï¼Œè€Œmaven_pom.propertiesæ˜¯å­˜æ”¾Moduleçš„Mavené…ç½®ï¼ˆå¯åœ¨å·¥ç¨‹ä¸­ç›´æŽ¥æ–°å»ºä¸€ä¸ªFileï¼Œè‡ªå®šä¹‰åŽç¼€ä¸º.propertieså³å¯åˆ›å»ºï¼ŒåŒ…æ‹¬åƒModuleåç§°ã€æè¿°ã€Mavenç»„IDã€æ‰“åŒ…æ–¹å¼ã€ç‰ˆæœ¬å·ç­‰ï¼‰ å·¥ç¨‹å¯¼å…¥è¿™äº›gradleè„šæœ¬åŽï¼Œåƒå›¾ä¸­å³ä¾§çš„gradleæ ä¸­å°±ä¼šå‡ºçŽ°ç›¸å…³Taskï¼ŒåŒ…æ‹¬é»˜è®¤çš„å’Œè‡ªå®šä¹‰çš„ï¼ˆupload-uploadArchiveså°±æ˜¯maven_push.gradleä¸­å®šä¹‰å’Œå®žçŽ°çš„ï¼‰ ProGuardæ˜¯AS SDKé‡Œè‡ªå¸¦çš„å·¥å…·ï¼Œä¸»è¦ä½œç”¨æ˜¯æ··æ·†ä»£ç ï¼Œä½†åŒ…æ‹¬ä»¥ä¸‹4ä¸ªåŠŸèƒ½ï¼š åŽ‹ç¼©(Shrink)ï¼šæ£€æµ‹å¹¶ç§»é™¤ä»£ç ä¸­æ— ç”¨çš„ç±»ã€å­—æ®µã€æ–¹æ³•å’Œç‰¹æ€§ï¼ˆAttributeï¼‰ã€‚ ä¼˜åŒ–(Optimize)ï¼šå¯¹å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ï¼Œç§»é™¤æ— ç”¨çš„æŒ‡ä»¤ã€‚ æ··æ·†(Obfuscate)ï¼šä½¿ç”¨aï¼Œbï¼Œcï¼Œdè¿™æ ·ç®€çŸ­è€Œæ— æ„ä¹‰çš„åç§°ï¼Œå¯¹ç±»ã€å­—æ®µå’Œæ–¹æ³•è¿›è¡Œé‡å‘½åã€‚ é¢„æ£€(Preveirfy)ï¼šåœ¨Javaå¹³å°ä¸Šå¯¹å¤„ç†åŽçš„ä»£ç è¿›è¡Œé¢„æ£€ï¼Œç¡®ä¿åŠ è½½çš„classæ–‡ä»¶æ˜¯å¯æ‰§è¡Œçš„ã€‚ åŽ‹ç¼©çŽ¯èŠ‚ä¼šæ£€æµ‹ä»¥åŠç§»é™¤æ²¡æœ‰ç”¨åˆ°çš„ç±»ã€å­—æ®µã€æ–¹æ³•ä»¥åŠå±žæ€§ã€‚ä¼˜åŒ–çŽ¯èŠ‚ä¼šåˆ†æžä»¥åŠä¼˜åŒ–æ–¹æ³•çš„å­—èŠ‚ç ã€‚æ··æ·†çŽ¯èŠ‚ä¼šç”¨æ— æ„ä¹‰çš„çŸ­å˜é‡åŽ»é‡å‘½åç±»ã€å˜é‡ã€æ–¹æ³•ã€‚è¿™äº›æ­¥éª¤è®©ä»£ç æ›´ç²¾ç®€ï¼Œæ›´é«˜æ•ˆï¼Œä¹Ÿæ›´éš¾è¢«é€†å‘ï¼ˆç ´è§£ï¼‰ã€‚ å·¥ä½œåŽŸç†ProGuarç”±shrinkã€optimizeã€obfuscateå’Œpreveirfyå››ä¸ªæ­¥éª¤ç»„æˆï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®è„šæœ¬æ¥å†³å®šæ‰§è¡Œå…¶ä¸­çš„å“ªå‡ ä¸ªæ­¥éª¤ã€‚ æ··æ·†å°±æ˜¯ç§»é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç ï¼Œç„¶åŽå¯¹ä»£ç é‡Œé¢çš„ç±»ã€å˜é‡ã€æ–¹æ³•é‡å‘½åä¸ºäººå¯è¯»æ€§å¾ˆå·®çš„ç®€çŸ­åå­—ã€‚é‚£ä¹ˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒProGuardæ€Žä¹ˆçŸ¥é“è¿™ä¸ªä»£ç æ²¡æœ‰è¢«ç”¨åˆ°å‘¢ï¼Ÿè¿™é‡Œå¼•å…¥ä¸€ä¸ªEntry Pointï¼ˆå…¥å£ç‚¹ï¼‰æ¦‚å¿µï¼ŒEntry Pointæ˜¯åœ¨ProGuardè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å¤„ç†çš„ç±»æˆ–æ–¹æ³•ã€‚åœ¨åŽ‹ç¼©çš„æ­¥éª¤ä¸­ï¼ŒProGuardä¼šä»Žä¸Šè¿°çš„Entry Pointå¼€å§‹é€’å½’éåŽ†ï¼Œæœç´¢å“ªäº›ç±»å’Œç±»çš„æˆå‘˜åœ¨ä½¿ç”¨ï¼Œå¯¹äºŽæ²¡æœ‰è¢«ä½¿ç”¨çš„ç±»å’Œç±»çš„æˆå‘˜ï¼Œå°±ä¼šåœ¨åŽ‹ç¼©æ®µä¸¢å¼ƒï¼Œåœ¨æŽ¥ä¸‹æ¥çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œé‚£äº›éžEntry Pointçš„ç±»ã€æ–¹æ³•éƒ½ä¼šè¢«è®¾ç½®ä¸ºprivateã€staticæˆ–finalï¼Œä¸ä½¿ç”¨çš„å‚æ•°ä¼šè¢«ç§»é™¤ï¼Œæ­¤å¤–ï¼Œæœ‰äº›æ–¹æ³•ä¼šè¢«æ ‡è®°ä¸ºå†…è”çš„ï¼Œåœ¨æ··æ·†çš„æ­¥éª¤ä¸­ï¼ŒProGuardä¼šå¯¹éžEntry Pointçš„ç±»å’Œæ–¹æ³•è¿›è¡Œé‡å‘½åã€‚é‚£ä¹ˆè¿™ä¸ªå…¥å£ç‚¹æ€Žä¹ˆæ¥å‘¢ï¼Ÿå°±æ˜¯ä»ŽProGuardçš„é…ç½®æ–‡ä»¶æ¥ï¼Œåªè¦è¿™ä¸ªé…ç½®äº†ï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¢«ç§»é™¤ã€‚ ç¼–å†™ProGuardæ–‡ä»¶çš„æ­¥éª¤ï¼š åŸºæœ¬æ··æ·† é’ˆå¯¹APPçš„é‡èº«å®šåˆ¶ é’ˆå¯¹ç¬¬ä¸‰æ–¹jaråŒ…çš„è§£å†³æ–¹æ¡ˆ åŸºæœ¬æ··æ·†æ··æ·†æ–‡ä»¶çš„åŸºæœ¬é…ç½®ä¿¡æ¯ï¼Œä»»ä½•APPéƒ½è¦ä½¿ç”¨ï¼Œå¯ä»¥ä½œä¸ºæ¨¡æ¿ä½¿ç”¨1.åŸºæœ¬æŒ‡ä»¤ # ä»£ç æ··æ·†åŽ‹ç¼©æ¯”ï¼Œåœ¨0å’Œ7ä¹‹é—´ï¼Œé»˜è®¤ä¸º5ï¼Œä¸€èˆ¬ä¸éœ€è¦æ”¹ -optimizationpasses 5 # æ··æ·†æ—¶ä¸ä½¿ç”¨å¤§å°å†™æ··åˆï¼Œæ··æ·†åŽçš„ç±»åä¸ºå°å†™ -dontusemixedcaseclassnames # æŒ‡å®šä¸åŽ»å¿½ç•¥éžå…¬å…±çš„åº“çš„ç±» -dontskipnonpubliclibraryclasses # æŒ‡å®šä¸åŽ»å¿½ç•¥éžå…¬å…±çš„åº“çš„ç±»çš„æˆå‘˜ -dontskipnonpubliclibraryclassmembers # ä¸åšé¢„æ ¡éªŒï¼Œpreverifyæ˜¯proguardçš„4ä¸ªæ­¥éª¤ä¹‹ä¸€ # Androidä¸éœ€è¦preverifyï¼ŒåŽ»æŽ‰è¿™ä¸€æ­¥å¯åŠ å¿«æ··æ·†é€Ÿåº¦ -dontpreverify # æœ‰äº†verboseè¿™å¥è¯ï¼Œæ··æ·†åŽå°±ä¼šç”Ÿæˆæ˜ å°„æ–‡ä»¶ # åŒ…å«æœ‰ç±»å-&gt;æ··æ·†åŽç±»åçš„æ˜ å°„å…³ç³» # ç„¶åŽä½¿ç”¨printmappingæŒ‡å®šæ˜ å°„æ–‡ä»¶çš„åç§° -verbose -printmapping proguardMapping.txt # æŒ‡å®šæ··æ·†æ—¶é‡‡ç”¨çš„ç®—æ³•ï¼ŒåŽé¢çš„å‚æ•°æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ # è¿™ä¸ªè¿‡æ»¤å™¨æ˜¯è°·æ­ŒæŽ¨èçš„ç®—æ³•ï¼Œä¸€èˆ¬ä¸æ”¹å˜ -optimizations !code/simplification/arithmetic,!field/*,!class/merging/* # ä¿æŠ¤ä»£ç ä¸­çš„Annotationä¸è¢«æ··æ·†ï¼Œè¿™åœ¨JSONå®žä½“æ˜ å°„æ—¶éžå¸¸é‡è¦ï¼Œæ¯”å¦‚fastJson -keepattributes *Annotation* # é¿å…æ··æ·†æ³›åž‹ï¼Œè¿™åœ¨JSONå®žä½“æ˜ å°„æ—¶éžå¸¸é‡è¦ï¼Œæ¯”å¦‚fastJson -keepattributes Signature //æŠ›å‡ºå¼‚å¸¸æ—¶ä¿ç•™ä»£ç è¡Œå·ï¼Œåœ¨å¼‚å¸¸åˆ†æžä¸­å¯ä»¥æ–¹ä¾¿å®šä½ -keepattributes SourceFile,LineNumberTable -dontskipnonpubliclibraryclassesç”¨äºŽå‘Šè¯‰ProGuardï¼Œä¸è¦è·³è¿‡å¯¹éžå…¬å¼€ç±»çš„å¤„ç†ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯è·³è¿‡çš„ï¼Œå› ä¸ºç¨‹åºä¸­ä¸ä¼šå¼•ç”¨å®ƒä»¬ï¼Œæœ‰äº›æƒ…å†µä¸‹äººä»¬ç¼–å†™çš„ä»£ç ä¸Žç±»åº“ä¸­çš„ç±»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼Œå¹¶ä¸”å¯¹åŒ…ä¸­å†…å®¹åŠ ä»¥å¼•ç”¨ï¼Œæ­¤æ—¶éœ€è¦åŠ å…¥æ­¤æ¡å£°æ˜Žã€‚ -dontusemixedcaseclassnamesï¼Œè¿™ä¸ªæ˜¯ç»™Microsoft Windowsç”¨æˆ·çš„ï¼Œå› ä¸ºProGuardå‡å®šä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯èƒ½åŒºåˆ†ä¸¤ä¸ªåªæ˜¯å¤§å°å†™ä¸åŒçš„æ–‡ä»¶åï¼Œä½†æ˜¯Microsoft Windowsä¸æ˜¯è¿™æ ·çš„æ“ä½œç³»ç»Ÿï¼Œæ‰€ä»¥å¿…é¡»ä¸ºProGuardæŒ‡å®š-dontusemixedcaseclassnamesé€‰é¡¹ 2.ä¿ç•™ # ä¿ç•™æ‰€æœ‰çš„æœ¬åœ°nativeæ–¹æ³•ä¸è¢«æ··æ·† -keepclasseswithmembernames class * &#123; native &lt;methods&gt;; &#125; # ä¿ç•™äº†ç»§æ‰¿è‡ªActivityã€Applicationè¿™äº›ç±»çš„å­ç±» # å› ä¸ºè¿™äº›å­ç±»ï¼Œéƒ½æœ‰å¯èƒ½è¢«å¤–éƒ¨è°ƒç”¨ # æ¯”å¦‚è¯´ï¼Œç¬¬ä¸€è¡Œå°±ä¿è¯äº†æ‰€æœ‰Activityçš„å­ç±»ä¸è¦è¢«æ··æ·† -keep public class * extends android.app.Activity -keep public class * extends android.app.Application -keep public class * extends android.app.Service -keep public class * extends android.content.BroadcastReceiver -keep public class * extends android.content.ContentProvider -keep public class * extends android.app.backup.BackupAgentHelper -keep public class * extends android.preference.Preference -keep public class * extends android.view.View -keep public class com.android.vending.licensing.ILicensingService # å¦‚æžœæœ‰å¼•ç”¨android-support-v4.jaråŒ…ï¼Œå¯ä»¥æ·»åŠ ä¸‹é¢è¿™è¡Œ -keep public class com.xxxx.app.ui.fragment.** &#123;*;&#125; # ä¿ç•™åœ¨Activityä¸­çš„æ–¹æ³•å‚æ•°æ˜¯viewçš„æ–¹æ³•ï¼Œ # ä»Žè€Œæˆ‘ä»¬åœ¨layouté‡Œé¢ç¼–å†™onClickå°±ä¸ä¼šè¢«å½±å“ -keepclassmembers class * extends android.app.Activity &#123; public void *(android.view.View); &#125; # æžšä¸¾ç±»ä¸èƒ½è¢«æ··æ·† -keepclassmembers enum * &#123; public static **[] values(); public static ** valueOf(java.lang.String); &#125; # ä¿ç•™è‡ªå®šä¹‰æŽ§ä»¶ï¼ˆç»§æ‰¿è‡ªViewï¼‰ä¸è¢«æ··æ·† -keep public class * extends android.view.View &#123; *** get*(); void set*(***); public &lt;init&gt;(android.content.Context); public &lt;init&gt;(android.content.Context, android.util.AttributeSet); public &lt;init&gt;(android.content.Context, android.util.AttributeSet, int); &#125; # ä¿ç•™Parcelableåºåˆ—åŒ–çš„ç±»ä¸è¢«æ··æ·† -keep class * implements android.os.Parcelable &#123; public static final android.os.Parcelable$Creator *; &#125; # ä¿ç•™Serializableåºåˆ—åŒ–çš„ç±»ä¸è¢«æ··æ·† -keepclassmembers class * implements java.io.Serializable &#123; static final long serialVersionUID; private static final java.io.ObjectStreamField[] serialPersistentFields; private void writeObject(java.io.ObjectOutputStream); private void readObject(java.io.ObjectInputStream); java.lang.Object writeReplace(); java.lang.Object readResolve(); &#125; # å¯¹äºŽRï¼ˆèµ„æºï¼‰ä¸‹çš„æ‰€æœ‰ç±»åŠå…¶æ–¹æ³•ï¼Œéƒ½ä¸èƒ½è¢«æ··æ·† -keep class **.R$* &#123; *; &#125; # å¯¹äºŽå¸¦æœ‰å›žè°ƒå‡½æ•°onXXEventçš„ï¼Œä¸èƒ½è¢«æ··æ·† -keepclassmembers class * &#123; void *(**On*Event); &#125; 3.å®šåˆ¶ # ä¿ç•™å®žä½“ç±»å’Œæˆå‘˜ä¸è¢«æ··æ·†(å¯¹äºŽå®žä½“ï¼Œä¿ç•™å®ƒä»¬çš„setå’Œgetæ–¹æ³•ï¼Œå¯¹äºŽbooleanåž‹getæ–¹æ³•ï¼Œæœ‰äººå–œæ¬¢å‘½åisXXXçš„æ–¹å¼) -keep public class com.xxxx.entity.** &#123; public void set*(***); public *** get*(); public *** is*(); &#125; # ä¿ç•™å†…åµŒç±»ä¸è¢«æ··æ·†(å†…åµŒç±»ç»å¸¸ä¼šè¢«æ··æ·†ï¼Œç»“æžœåœ¨è°ƒç”¨çš„æ—¶å€™ä¸ºç©ºå°±å´©æºƒäº†ï¼Œæœ€å¥½çš„è§£å†³æ–¹æ³•å°±æ˜¯æŠŠè¿™ä¸ªå†…åµŒç±»æ‹¿å‡ºæ¥ï¼Œå•ç‹¬æˆä¸ºä¸€ä¸ªç±»ã€‚å¦‚æžœä¸€å®šè¦å†…ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±å¿…é¡»åœ¨æ··æ·†çš„æ—¶å€™ä¿ç•™ï¼Œ$ç¬¦å·ç”¨æ¥åˆ†å‰²å†…åµŒç±»ä¸Žå…¶æ¯ä½“çš„æ ‡å¿—ã€‚) -keep class com.example.xxx.MainActivity$* &#123; *; &#125; # å¯¹WebViewçš„å¤„ç† -keepclassmembers class * extends android.webkit.webViewClient &#123; public void *(android.webkit.WebView, java.lang.String, android.graphics.Bitmap); public boolean *(android.webkit.WebView, java.lang.String) &#125; -keepclassmembers class * extends android.webkit.webViewClient &#123; public void *(android.webkit.webView, java.lang.String) &#125; # ä¿ç•™JSæ–¹æ³•ä¸è¢«æ··æ·†ï¼ˆJSInterfaceæ˜¯MainActivityçš„å­ç±»ï¼‰ -keepclassmembers class com.example.xxx.MainActivity$JSInterface1 &#123; &lt;methods&gt;; &#125; 4.å¤„ç†åå°„åœ¨ç¨‹åºä¸­ä½¿ç”¨SomeClass.class.methodè¿™æ ·çš„é™æ€æ–¹æ³•ï¼Œåœ¨ProGuardä¸­æ˜¯åœ¨åŽ‹ç¼©è¿‡ç¨‹ä¸­è¢«ä¿ç•™çš„ï¼Œé‚£ä¹ˆå¯¹äºŽClass.forName(â€œSomeClassâ€)å‘¢ï¼ŒSomeClassä¸ä¼šè¢«åŽ‹ç¼©è¿‡ç¨‹ä¸­ç§»é™¤ï¼Œå®ƒä¼šæ£€æŸ¥ç¨‹åºä¸­ä½¿ç”¨çš„Class.forNameæ–¹æ³•ï¼Œå¯¹å‚æ•°SomeClassæ³•å¤–å¼€æ©ï¼Œä¸ä¼šè¢«ç§»é™¤ã€‚ä½†æ˜¯åœ¨æ··æ·†è¿‡ç¨‹ä¸­ï¼Œæ— è®ºæ˜¯Class.forName(â€œSomeClassâ€)ï¼Œè¿˜æ˜¯SomeClass.classï¼Œéƒ½ä¸èƒ½è’™æ··è¿‡å…³ï¼ŒSomeClassè¿™ä¸ªç±»åç§°ä¼šè¢«æ··æ·†ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¦åœ¨ProGuard.cfgæ–‡ä»¶ä¸­ä¿ç•™è¿™ä¸ªç±»åç§°ã€‚åœ¨æ··æ·†çš„æ—¶å€™ï¼Œè¦åœ¨é¡¹ç›®ä¸­æœç´¢ä¸€ä¸‹ä¸Šè¿°æ–¹æ³•ï¼Œå°†ç›¸åº”çš„ç±»æˆ–è€…æ–¹æ³•çš„åç§°è¿›è¡Œä¿ç•™è€Œä¸è¢«æ··æ·†ã€‚ Class.forName(&quot;SomeClass&quot;) SomeClass.class SomeClass.class.getField(&quot;someField&quot;) SomeClass.class.getDeclaredField(&quot;someField&quot;) SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] &#123;&#125;) SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] &#123; A.class &#125;) SomeClass.class.getMethod(&quot;someMethod&quot;, new Class[] &#123; A.class, B.class &#125;) SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] &#123;&#125;) SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] &#123; A.class &#125;) SomeClass.class.getDeclaredMethod(&quot;someMethod&quot;, new Class[] &#123; A.class, B.class &#125;) AtomicIntegerFieldUpdater.newUpdater(SomeClass.class, &quot;someField&quot;) AtomicLongFieldUpdater.newUpdater(SomeClass.class, &quot;someField&quot;) AtomicReferenceFieldUpdater.newUpdater(SomeClass.class, SomeType.class, &quot;someField&quot;) 5.è‡ªå®šä¹‰Viewä½†å‡¡åœ¨Layoutç›®å½•ä¸‹çš„XMLå¸ƒå±€æ–‡ä»¶é…ç½®çš„è‡ªå®šä¹‰Viewï¼Œéƒ½ä¸èƒ½è¿›è¡Œæ··æ·†ã€‚ä¸ºæ­¤è¦éåŽ†Layoutä¸‹çš„æ‰€æœ‰çš„XMLå¸ƒå±€æ–‡ä»¶ï¼Œæ‰¾åˆ°é‚£äº›è‡ªå®šä¹‰Viewï¼Œç„¶åŽç¡®è®¤å…¶æ˜¯å¦åœ¨ProGuardæ–‡ä»¶ä¸­ä¿ç•™ã€‚æœ‰ä¸€ç§æ€è·¯æ˜¯ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰Viewæ—¶ï¼Œå‰é¢éƒ½å¿…é¡»åŠ ä¸Šæˆ‘ä»¬çš„åŒ…åï¼Œæ¯”å¦‚com.a.b.customeviewï¼Œæˆ‘ä»¬å¯ä»¥éåŽ†æ‰€æœ‰Layoutä¸‹çš„XMLå¸ƒå±€æ–‡ä»¶ï¼ŒæŸ¥æ‰¾æ‰€æœ‰åŒ¹é…com.a.bçš„æ ‡ç­¾å³å¯ã€‚ ç¬¬ä¸‰æ–¹jaråŒ…æˆ‘ä»¬åœ¨Androidé¡¹ç›®ä¸­ä¸å¯é¿å…è¦ä½¿ç”¨å¾ˆå¤šç¬¬ä¸‰æ–¹æä¾›çš„SDKï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¿™äº›SDKæ˜¯ç»è¿‡ProGuardæ··æ·†çš„ï¼Œè€Œæˆ‘ä»¬æ‰€éœ€è¦åšçš„å°±æ˜¯é¿å…è¿™äº›SDKçš„ç±»å’Œæ–¹æ³•åœ¨æˆ‘ä»¬APPè¢«æ··æ·†ã€‚1.é’ˆå¯¹android-support-v4.jarçš„è§£å†³æ–¹æ¡ˆ # é’ˆå¯¹android-support-v4.jarçš„è§£å†³æ–¹æ¡ˆ -libraryjars libs/android-support-v4.jar -dontwarn android.support.v4.** -keep class android.support.v4.** &#123; *; &#125; -keep interface android.support.v4.app.** &#123; *; &#125; -keep public class * extends android.support.v4.** -keep public class * extends android.app.Fragment 2.å…¶ä»–çš„ç¬¬ä¸‰æ–¹jaråŒ…çš„è§£å†³æ–¹æ¡ˆå–å†³äºŽç¬¬ä¸‰æ–¹åŒ…çš„æ··æ·†ç­–ç•¥ï¼Œä¸€èˆ¬éƒ½æœ‰åœ¨å„è‡ªçš„SDKä¸­æœ‰å…³äºŽæ··æ·†çš„è¯´æ˜Žæ–‡å­—ï¼Œæ¯”å¦‚æ”¯ä»˜å®ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸æ˜¯æ¯ä¸ªç¬¬ä¸‰æ–¹SDKéƒ½éœ€è¦-dontwarn æŒ‡ä»¤ï¼Œè¿™å–å†³äºŽæ··æ·†æ—¶ç¬¬ä¸‰æ–¹SDKæ˜¯å¦å‡ºçŽ°è­¦å‘Šï¼Œéœ€è¦çš„æ—¶å€™å†åŠ ä¸Šã€‚ # å¯¹alipayçš„æ··æ·†å¤„ç† -libraryjars libs/alipaysdk.jar -dontwarn com.alipay.android.app.** -keep public class com.alipay.** &#123; *; &#125; æ³¨æ„äº‹é¡¹1.å¦‚ä½•ç¡®ä¿æ··æ·†ä¸ä¼šå¯¹é¡¹ç›®äº§ç”Ÿå½±å“æµ‹è¯•å·¥ä½œè¦åŸºäºŽæ··æ·†åŒ…è¿›è¡Œï¼Œæ‰èƒ½å°½æ—©å‘çŽ°é—®é¢˜æ¯å¤©å¼€å‘å›¢é˜Ÿçš„å†’çƒŸæµ‹è¯•ï¼Œä¹Ÿè¦åŸºäºŽæ··æ·†åŒ…å‘ç‰ˆå‰ï¼Œé‡ç‚¹çš„åŠŸèƒ½å’Œæ¨¡å—è¦é¢å¤–çš„æµ‹è¯•ï¼ŒåŒ…æ‹¬æŽ¨é€ï¼Œåˆ†äº«ï¼Œæ‰“èµ 2.æ‰“åŒ…æ—¶å¿½ç•¥è­¦å‘Šå½“å¯¼å‡ºåŒ…çš„æ—¶å€™ï¼Œå‘çŽ°å¾ˆå¤šcould not reference classä¹‹ç±»çš„warningä¿¡æ¯ï¼Œå¦‚æžœç¡®è®¤Appåœ¨è¿è¡Œä¸­å’Œé‚£äº›å¼•ç”¨æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå¯ä»¥æ·»åŠ -dontwarn æ ‡ç­¾ï¼Œå°±ä¸ä¼šæç¤ºè¿™äº›è­¦å‘Šä¿¡æ¯äº† 3.å¯¹äºŽè‡ªå®šä¹‰ç±»åº“çš„æ··æ·†å¤„ç†æ¯”å¦‚æˆ‘ä»¬å¼•ç”¨äº†ä¸€ä¸ªå«åšAndroidLibçš„ç±»åº“ï¼Œæˆ‘ä»¬éœ€è¦å¯¹Libä¹Ÿè¿›è¡Œæ··æ·†ï¼Œç„¶åŽåœ¨ä¸»é¡¹ç›®çš„æ··æ·†æ–‡ä»¶ä¸­ä¿ç•™AndroidLibä¸­çš„ç±»å’Œç±»çš„æˆå‘˜ã€‚ 4.ä½¿ç”¨annotationé¿å…æ··æ·†å¦ä¸€ç§ç±»æˆ–è€…å±žæ€§è¢«æ··æ·†çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨annotation @keep @keepPublicGetterSetters public class Bean&#123; public boolean booleanProperty; public int intProperty; public String stringProperty; &#125; 5.åœ¨é¡¹ç›®ä¸­æŒ‡å®šæ··æ·†æ–‡ä»¶åˆ°æœ€åŽï¼Œå‘çŽ°æ²¡æœ‰ä»‹ç»å¦‚ä½•åœ¨é¡¹ç›®ä¸­æŒ‡å®šæ··æ·†æ–‡ä»¶ã€‚åœ¨é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªproject.propertiesæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å†™è¿™ä¹ˆä¸€å¥è¯ï¼Œå°±å¯ä»¥ç¡®ä¿æ¯æ¬¡æ‰‹åŠ¨æ‰“åŒ…ç”Ÿæˆçš„apkæ˜¯æ··æ·†è¿‡çš„ã€‚proguard.config=proguard.cfgå…¶ä¸­ï¼Œproguard.cfgæ˜¯æ··æ·†æ–‡ä»¶çš„åç§°ã€‚ NativeJNI å®šä¹‰ï¼šJava Native Interfaceï¼Œå³ Javaæœ¬åœ°æŽ¥å£ ä½œç”¨ï¼šä½¿å¾—Javaä¸Žæœ¬åœ°å…¶ä»–ç±»åž‹è¯­è¨€ï¼ˆå¦‚Cã€C++ï¼‰äº¤äº’ï¼Œå³åœ¨Javaä»£ç é‡Œè°ƒç”¨Cã€C++ç­‰è¯­è¨€çš„ä»£ç æˆ–Cã€C++ä»£ç è°ƒç”¨ Java ä»£ç  ç‰¹æ€§ï¼š JNIæ˜¯Javaè°ƒç”¨Nativeè¯­è¨€çš„ä¸€ç§ç‰¹æ€§ JNIæ˜¯å±žäºŽJavaçš„ï¼Œä¸ŽAndroidæ— ç›´æŽ¥å…³ç³» å®žçŽ°ï¼š åœ¨Javaä¸­å£°æ˜ŽNativeæ–¹æ³•ï¼ˆå³éœ€è¦è°ƒç”¨çš„æœ¬åœ°æ–¹æ³•ï¼‰ ç¼–è¯‘ä¸Šè¿°Javaæºæ–‡ä»¶javacï¼ˆå¾—åˆ° .classæ–‡ä»¶ï¼‰ é€šè¿‡javahå‘½ä»¤å¯¼å‡ºJNIçš„å¤´æ–‡ä»¶ï¼ˆ.hæ–‡ä»¶ï¼‰ ä½¿ç”¨Javaéœ€è¦äº¤äº’çš„æœ¬åœ°ä»£ç å®žçŽ°åœ¨Javaä¸­å£°æ˜Žçš„Nativeæ–¹æ³•ï¼Œå¦‚Javaéœ€è¦ä¸ŽC++äº¤äº’ï¼Œé‚£ä¹ˆå°±ç”¨C++å®žçŽ°Javaçš„Nativeæ–¹æ³• ç¼–è¯‘.soåº“æ–‡ä»¶ é€šè¿‡Javaå‘½ä»¤æ‰§è¡Œ Javaç¨‹åºï¼Œæœ€ç»ˆå®žçŽ°Javaè°ƒç”¨æœ¬åœ°ä»£ç  åœ¨JNI_OnLoadä¸­æ³¨å†Œ jint JNI_OnLoad(JavaVM* vm, void* reserved) &#123; //æ·»åŠ JNINativeMethodæ–¹æ³• static const JNINativeMethod gMethods[] = &#123; &#123;&quot;getUrl&quot;, &quot;()Ljava/lang/String;&quot;, (jstring*)getUrl&#125;, &#123;&quot;setData&quot;,&quot;([BI)V&quot;,(void*)setData&#125; &#125;; //æ³¨å†Œ static string className = &quot;path/to/className&quot;; gJavaVM = vm; JNIEnv* env = NULL; if ((*vm)-&gt;GetEnv(vm, (void**) &amp;env, JNI_VERSION_1_6) != JNI_OK) &#123; return -1; &#125; assert(env != NULL); jclass clazz = (*env)-&gt;FindClass(env, className); if (clazz == NULL) &#123; return -1; &#125; if ((*env)-&gt;RegisterNatives(env, clazz, gMethods, numMethods) &lt; 0) &#123; return -1; &#125; return JNI_VERSION_1_6; &#125; è¿”å›žå€¼åŠå‚æ•°ç±»åž‹çš„é€šé…è¯´æ˜Ž NDK å®šä¹‰ï¼šNative Development Kitï¼Œæ˜¯ Androidçš„ä¸€ä¸ªå·¥å…·å¼€å‘åŒ…ï¼ŒNDKæ˜¯å±žäºŽAndroidçš„ï¼Œä¸ŽJavaå¹¶æ— ç›´æŽ¥å…³ç³» ä½œç”¨ï¼šå¿«é€Ÿå¼€å‘Cã€C+ * ä½œç”¨ï¼šå¿«é€Ÿå¼€å‘Cã€C+ * ä½œç”¨ï¼šå¿«é€Ÿå¼€å‘Cã€C++çš„åŠ¨æ€åº“ï¼Œå¹¶è‡ªåŠ¨å°†soå’Œåº”ç”¨ä¸€èµ·æ‰“åŒ…æˆAPKã€‚å³å¯é€šè¿‡NDKåœ¨Androidä¸­ä½¿ç”¨JNIä¸Žæœ¬åœ°ä»£ç ï¼ˆå¦‚Cã€C++ï¼‰äº¤äº’ å®žçŽ°ï¼š é…ç½®Android NDKçŽ¯å¢ƒ åˆ›å»ºAndroidé¡¹ç›®ï¼Œå¹¶ä¸ŽNDKè¿›è¡Œå…³è” åœ¨Android é¡¹ç›®ä¸­å£°æ˜Žæ‰€éœ€è¦è°ƒç”¨çš„Nativeæ–¹æ³• ä½¿ç”¨Androidéœ€è¦äº¤äº’çš„æœ¬åœ°ä»£ç å®žçŽ°åœ¨Androidä¸­å£°æ˜Žçš„Nativeæ–¹æ³•ï¼Œæ¯”å¦‚ Android éœ€è¦ä¸ŽC++äº¤äº’ï¼Œé‚£ä¹ˆå°±ç”¨C++å®žçŽ°Javaçš„Nativeæ–¹æ³• é€šè¿‡ ndk - bulid å‘½ä»¤ç¼–è¯‘äº§ç”Ÿ.soåº“æ–‡ä»¶ ç¼–è¯‘ Android Studioå·¥ç¨‹ï¼Œä»Žè€Œå®žçŽ°Android è°ƒç”¨æœ¬åœ°ä»£ç  Gradleçš„é…ç½®Moduleçš„gradleæ–‡ä»¶: apply plugin: &apos;com.android.library&apos; apply from: &quot;$&#123;project.rootDir&#125;/config/maven_push.gradle&quot; android &#123; compileSdkVersion 28 buildToolsVersion &quot;28.0.3&quot; defaultConfig &#123; minSdkVersion 14 targetSdkVersion 28 ndk&#123; moduleName &quot;framework&quot; &#125; &#125; buildTypes &#123; release &#123; minifyEnabled false//ç¼©å‡å­—ç¬¦çš„æ··æ·†-é’ˆå¯¹javaå±‚ &#125; &#125; ... &#125; task clearJar(type: Delete) &#123; delete &quot;build/outputs/libs/&quot; &#125; def getVersionName() &#123; return project.ext.mCurVersion &#125; task makeJar(type: ProGuardTask, dependsOn: &quot;build&quot;) &#123; // æœªæ··æ·†çš„jarè·¯å¾„ injars &apos;build/intermediates/packaged-classes/release/classes.jar&apos; // æ··æ·†åŽçš„jarè¾“å‡ºè·¯å¾„ outjars &quot;build/outputs/libs/efun-utils-$&#123;getVersionName()&#125;.jar&quot; // æ··æ·†åè®® configuration &apos;proguard-rules.pro&apos; &#125; task makeJar(type: Copy) &#123; from(&apos;build/intermediates/packaged-classes/release/&apos;) into(&apos;build/outputs/libs/&apos;) include(&apos;classes.jar&apos;) rename (&apos;classes.jar&apos;, &quot;efun-task-$&#123;getVersionName()&#125;.jar&quot;) &#125; ext.ndk = &apos;ndk&apos; task localProperty &#123; //æ³¨æ„ï¼šæŒ‡å®šNDKå®žè´¨è·¯å¾„æ˜¯é€šè¿‡local.propertiesæ–‡ä»¶ä¸­çš„ä¸ºå‡†ï¼ˆä¹Ÿå¯ä»¥åœ¨project structä¸­è®¾ç½®-cmd+;ï¼‰ ndk = &quot;/Path/to/android-ndk-r18b/ndk-build&quot; &#125; task buildJni &lt;&lt; &#123; System.out.println(&quot;ndk:&quot;+ndk); exec &#123; commandLine ndk &#125; &#125; preBuild.dependsOn buildJni Makeçš„é…ç½®åœ¨Linuxä¸‹ç¼–è¯‘ç»å¸¸è¦å†™ä¸€ä¸ªMakefileæ–‡ä»¶ï¼Œ å¯ä»¥æŠŠè¿™ä¸ªMakefileæ–‡ä»¶ç†è§£æˆä¸€ä¸ªç¼–è¯‘é…ç½®æ–‡ä»¶ï¼Œå®ƒä¿å­˜ç€å¦‚ä½•ç¼–è¯‘çš„é…ç½®ä¿¡æ¯ï¼Œå³æŒ‡å¯¼ç¼–è¯‘å™¨å¦‚ä½•æ¥ç¼–è¯‘ç¨‹åºï¼Œå¹¶å†³å®šç¼–è¯‘çš„ç»“æžœæ˜¯ä»€ä¹ˆã€‚ è€ŒAndroid.mkæ–‡ä»¶æ˜¯é’ˆå¯¹Androidçš„Makefileæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯GNU Makefileçš„ä¸€å°éƒ¨åˆ†ï¼Œä¼šè¢«ç¼–è¯‘ç³»ç»Ÿè§£æžä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚å¯ä»¥åœ¨æ¯ä¸€ä¸ªAndroid.mk fileä¸­å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å‡ ä¸ªæ¨¡å—ä¸­ä½¿ç”¨åŒä¸€ä¸ªæºä»£ç æ–‡ä»¶ã€‚ç¼–è¯‘ç³»ç»Ÿä¸ºä½ å¤„ç†è®¸å¤šç»†èŠ‚é—®é¢˜ã€‚ LOCAL_PATH := $(call my-dir) include $(CLEAR_VARS) LOCAL_LDLIBS += -L$(SYSROOT)/usr/lib -llog LOCAL_MODULE := efunframework-3.0 LOCAL_SRC_FILES := certificate.c \ md5.c \ secret_key.c \ include $(BUILD_SHARED_LIBRARY) é¦–å…ˆå¿…é¡»å®šä¹‰å¥½LOCAL_PATHå˜é‡ã€‚ç„¶åŽæ¸…é™¤æ‰€æœ‰LOCAL_XXå˜é‡çš„å€¼ã€‚ å®å‡½æ•°my-dir, ç”±ç¼–è¯‘ç³»ç»Ÿæä¾›ï¼Œç”¨äºŽè¿”å›žå½“å‰è·¯å¾„ï¼ˆå³åŒ…å«Android.mk fileæ–‡ä»¶çš„ç›®å½•ï¼‰ã€‚ å®CLEAR_VARSç”±ç¼–è¯‘ç³»ç»Ÿæä¾›ï¼ŒæŒ‡å®šè®©GNU MAKEFILEä¸ºä½ æ¸…é™¤è®¸å¤šLOCAL_XXXå˜é‡ï¼Œå› ä¸ºæ‰€æœ‰çš„ç¼–è¯‘æŽ§åˆ¶æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ªGNU MAKEæ‰§è¡ŒçŽ¯å¢ƒä¸­ï¼Œæ‰€æœ‰çš„å˜é‡éƒ½æ˜¯å…¨å±€çš„ã€‚ LOCAL_SRC_FILES:æ˜¯æœ¬æ¬¡éœ€è¦ç¼–è¯‘çš„æºæ–‡ä»¶ã€‚ LOCAL_SHARED_LIBRARIES:æ˜¯æœ¬æ¬¡ç¼–è¯‘éœ€è¦é“¾æŽ¥çš„åŠ¨æ€é“¾æŽ¥åº“æ–‡ä»¶ï¼Œå³.soæ–‡ä»¶ã€‚ LOCAL_STATIC_LIBRARIES:æ˜¯æœ¬æ¬¡ç¼–è¯‘è¦é“¾æŽ¥çš„é™æ€é“¾æŽ¥åº“ã€‚ LOCAL_LDLIBS:æ˜¯æœ¬æ¬¡ç¼–è¯‘çš„é“¾æŽ¥é€‰é¡¹ï¼Œç›¸å½“äºŽgcc -låŽçš„å‚æ•°ã€‚ LOCAL_CFLAGS:åŒæ ·æ˜¯ç¼–è¯‘é€‰é¡¹ï¼Œç›¸å½“äºŽgcc -OåŽé¢çš„å‚æ•°ã€‚ LOCAL_MODULE:æ˜¯ç”Ÿæˆçš„æ¨¡å—åï¼Œè¿™ä¸ªå˜é‡å¿…é¡»å®šä¹‰ï¼Œè¡¨ç¤ºmakeåŽå°†è¦ç”Ÿæˆçš„æ–‡ä»¶çš„åå­—ã€‚ include:å¤šä»¥è¿™æ ·çš„å½¢å¼å‡ºçŽ°ï¼Œå¦‚:include $( CLEAR_VARS)ã€include $(BUILD_SHARED_LIBRARY)ï¼Œå…¶å®žè¿™ä¸ªincludeå¯ä»¥ç†è§£æˆâ€æ‰§è¡Œâ€çš„æ„æ€ï¼Œæ¯”å¦‚æ¸…é™¤ä¸€äº›å˜é‡ã€ç”Ÿæˆå…±äº«åº“ï¼Œå³ç”Ÿæˆ.soæ–‡ä»¶ã€‚ AAR &amp; JARä½¿ç”¨Android Studioå¯¹å·¥ç¨‹è¿›è¡Œç¼–è¯‘åŽï¼Œä¼šåŒæ—¶ç”Ÿæˆjarä¸Žaaræ–‡ä»¶ã€‚ ä½ç½®jar: /build/intermediates/bundles/debug(release)/classes.jar aar: /build/outputs/aar/libraryname.aar åŒºåˆ« jar ä¸­åªåŒ…å«äº†classæ–‡ä»¶ä¸Žæ¸…å•æ–‡ä»¶ã€‚ aarä¸­é™¤äº†åŒ…å«jarä¸­çš„classæ–‡ä»¶è¿˜åŒ…å«å·¥ç¨‹ä¸­ä½¿ç”¨çš„æ‰€æœ‰èµ„æºï¼ŒclassåŠresèµ„æºæ–‡ä»¶å…¨éƒ¨åŒ…å«ã€‚ å¦‚æžœåªæ˜¯ä¸€ä¸ªç®€å•çš„ç±»åº“é‚£ä¹ˆä½¿ç”¨ç”Ÿæˆçš„* .jaræ–‡ä»¶å³å¯ï¼›å¦‚æžœä½ çš„æ˜¯ä¸€ä¸ªUIåº“ï¼ŒåŒ…å«ä¸€äº›è‡ªå·±å†™çš„æŽ§ä»¶å¸ƒå±€æ–‡ä»¶ä»¥åŠå­—ä½“ç­‰èµ„æºæ–‡ä»¶é‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨*.aaræ–‡ä»¶ã€‚ ä½¿ç”¨jar æ‹·è´åˆ° libs ç›®å½•ï¼Œå¹¶åœ¨gradleæ–‡ä»¶ä¸­æ·»åŠ  dependencies &#123; compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;) implementation fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;) //gradle 3.0+ &#125; aar æœ‰ä¸¤ç§æ–¹å¼ï¼š æœ¬åœ°ä½¿ç”¨ï¼šæ‹·è´åˆ°libsç›®å½•ï¼Œå¹¶åœ¨gradleæ–‡ä»¶ä¸­æ·»åŠ  repositories &#123; flatDir &#123; dirs &apos;libs&apos; &#125; &#125; dependencies &#123; compile(name:&apos;genius&apos;, ext:&apos;aar&apos;) &#125; ç½‘ç»œåŠ è½½ï¼šå°†aarå‘å¸ƒåˆ°mavenCentralä»“åº“ï¼Œåœ¨gradleæ–‡ä»¶ä¸­æ·»åŠ  repositories &#123; maven &#123; url &quot;http://xxx.com/project&quot; &#125; &#125; dependencies &#123; classpath &apos;com.android.tools.build:gradle:3.2.1&apos; &#125; å¤šå±‚Moduleä¾èµ–æœ¬åœ°AARAndroid Studioå¤šå±‚Moduleä¾èµ–æœ¬åœ°AARï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å‡ºå‘ç”Ÿé”™è¯¯ï¼Œæ‰¾ä¸åˆ°AARï¼ˆModuleA libsä¸­æœ‰c.aarï¼ŒModuleBä¾èµ–ModuleAï¼‰æ­¤æ—¶éœ€è¦åœ¨ModuleBçš„build.gradleä¸­æ·»åŠ  repositories &#123; flatDir &#123; dirs &apos;../ModuleA/libs&apos;,&apos;libs&apos; &#125; &#125; åŒæ—¶åœ¨dependenciesä¸­æ·»åŠ aaråç§° compile(name:&apos;c&apos;, ext:&apos;aar&apos;) soåŠ å›ºsoï¼šshared objectï¼Œå³æ˜¯ç”±ç³»ç»ŸåŠ¨æ€åŠ è½½çš„å…±äº«ç›®æ ‡æ–‡ä»¶ã€‚ ç ´åELF headeræˆ–è€…åˆ é™¤Section header å¯¹è¦ä¿æŠ¤çš„soå‡½æ•°æˆ–è€…sectionè¿›è¡ŒåŠ å¯†ï¼ŒæŠŠè§£å¯†å‡½æ•°æ”¾åˆ°å¦å¤–ä¸€ä¸ªsoä¸­ è‡ªå®šä¹‰çš„sectionå¹¶åŠ å¯†ï¼Œload soåº“æ—¶åœ¨mainå‡½æ•°ä¹‹å‰æŠŠè‡ªå®šä¹‰sectionè§£å¯† NDKç¼–è¯‘å·¥å…·ä¸­å¯ä»¥é›†æˆLLVM-Obfuscatorï¼Œéœ€è¦ä¿®æ”¹äº¤å‰å·¥å…·é“¾çš„ä»£ç å’Œä¸€äº›é…ç½®å‚æ•°ï¼Œæ··æ·†ä»£ç  å®žçŽ°å‚è€ƒ JVMjava -server -Xms3550M -Xmx3550M -XX:ReservedCodeCacheSize=1024m -jar apktool_2.4.0.jar b â€˜Path/to/unzip/documentâ€™ -clientï¼Œ-serverè¿™ä¸¤ä¸ªå‚æ•°ç”¨äºŽè®¾ç½®è™šæ‹Ÿæœºä½¿ç”¨ä½•ç§è¿è¡Œæ¨¡å¼ï¼Œclientæ¨¡å¼å¯åŠ¨æ¯”è¾ƒå¿«ï¼Œä½†è¿è¡Œæ—¶æ€§èƒ½å’Œå†…å­˜ç®¡ç†æ•ˆçŽ‡ä¸å¦‚serveræ¨¡å¼ï¼Œé€šå¸¸ç”¨äºŽå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚ç›¸åï¼Œserveræ¨¡å¼å¯åŠ¨æ¯”clientæ…¢ï¼Œä½†å¯èŽ·å¾—æ›´é«˜çš„è¿è¡Œæ€§èƒ½ã€‚åœ¨ windowsä¸Šï¼Œç¼ºçœçš„è™šæ‹Ÿæœºç±»åž‹ä¸ºclientæ¨¡å¼ï¼Œå¦‚æžœè¦ä½¿ç”¨ serveræ¨¡å¼ï¼Œå°±éœ€è¦åœ¨å¯åŠ¨è™šæ‹Ÿæœºæ—¶åŠ -serverå‚æ•°ï¼Œä»¥èŽ·å¾—æ›´é«˜æ€§èƒ½ï¼Œå¯¹æœåŠ¡å™¨ç«¯åº”ç”¨ï¼ŒæŽ¨èé‡‡ç”¨serveræ¨¡å¼ï¼Œå°¤å…¶æ˜¯å¤šä¸ªCPUçš„ç³»ç»Ÿã€‚åœ¨ Linuxï¼ŒSolarisä¸Šç¼ºçœé‡‡ç”¨serveræ¨¡å¼ã€‚ -Xmsè®¾ç½®è™šæ‹Ÿæœºå¯ç”¨å†…å­˜å †çš„åˆå§‹å¤§å°ï¼Œç¼ºçœå•ä½ä¸ºå­—èŠ‚ï¼Œè¯¥å¤§å°ä¸º1024çš„æ•´æ•°å€å¹¶ä¸”è¦å¤§äºŽ1MBï¼Œå¯ç”¨k(K)æˆ–m(M)ä¸ºå•ä½æ¥è®¾ç½®è¾ƒå¤§çš„å†…å­˜æ•°ã€‚åˆå§‹å †å¤§å°ä¸º2MBã€‚ä¾‹å¦‚ï¼š-Xms6400Kï¼Œ-Xms256M -Xmxè®¾ç½®è™šæ‹Ÿæœºå†…å­˜å †çš„æœ€å¤§å¯ç”¨å¤§å°ï¼Œç¼ºçœå•ä½ä¸ºå­—èŠ‚ã€‚è¯¥å€¼å¿…é¡»ä¸º1024æ•´æ•°å€ï¼Œå¹¶ä¸”è¦å¤§äºŽ2MBã€‚å¯ç”¨k(K)æˆ–m(M)ä¸ºå•ä½æ¥è®¾ç½®è¾ƒå¤§çš„å†…å­˜æ•°ã€‚ç¼ºçœå †æœ€å¤§å€¼ä¸º64MBã€‚ä¾‹å¦‚ï¼š-Xmx81920Kï¼Œ-Xmx80Må½“åº”ç”¨ç¨‹åºç”³è¯·äº†å¤§å†…å­˜è¿è¡Œæ—¶è™šæ‹ŸæœºæŠ›å‡ºjava.lang.OutOfMemoryError: Java heap spaceé”™è¯¯ï¼Œå°±éœ€è¦ä½¿ç”¨-Xmxè®¾ç½® The -X options are non-standard and subject to change without notice.è¾“å…¥æŒ‡ä»¤ java -X æŸ¥çœ‹ https://xinklabi.iteye.com/blog/837435 é—®é¢˜é›† error=13, Permission denied åœ¨Macçš„Android Studio IDEä¸Šï¼Œè‹¥æç¤ºè¯¥é”™è¯¯ï¼Œå¯é’ˆå¯¹æç¤ºä¸­çš„é—®é¢˜è·¯å¾„ä¿®æ”¹è®¿é—®æƒé™chmod +x /Users/MyUserName/Library/Android/sdk/tools/androidchmod +x /Users/MyUserName/PathTo/Android/android-ndk-r18b You have not accepted the license agreements of the following SDK components è‡ªåŠ¨åŒæ„æ‰€æœ‰ä¸‹è½½çš„SDKçš„licenseå³å¯è§£å†³ï¼Œyes | sdkmanager â€“licensesyes | sudo ~/Library/Android/sdk/tools/bin/sdkmanager â€“licenses]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Gradle</tag>
        <tag>Module</tag>
        <tag>ProGuard</tag>
        <tag>Native</tag>
        <tag>JNI</tag>
        <tag>NDK</tag>
        <tag>AAR</tag>
        <tag>JAR</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¢é˜Ÿç®¡ç†å®žè·µ]]></title>
    <url>%2F%E7%AE%A1%E7%90%86%2F%E5%9B%A2%E9%98%9F%E7%AE%A1%E7%90%86%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[ç®¡ç†ç†è®ºå®šä¹‰ç®¡ç†çš„å®šä¹‰ï¼šç•Œå®šä¼ä¸šçš„ä½¿å‘½ï¼Œå¹¶æ¿€åŠ±å’Œç»„ç»‡äººåŠ›èµ„æºåŽ»å®žçŽ°è¿™ä¸ªä½¿å‘½ã€‚ æ ¸å¿ƒæœ¬è´¨æ˜¯æœ€å¤§èŒƒå›´åœ°æ¿€å‘ä»–äººçš„å–„æ„ã€‚ ç®¡ç† = æ­£ç¡®å†³ç­– + 100%æœä»Žæ„è¯† = (ç›®æ ‡ + ç»„ç»‡) + æ¿€åŠ±å–„æ„æ‰§è¡Œã€‚ å›¢é˜ŸåŠä¸ªäººç±»åž‹å›¢é˜Ÿçš„ç±»åž‹ æ£’çƒé˜Ÿï¼šå„å¸å…¶èŒï¼Œéžå›¢é˜Ÿç»„åˆ è¶³çƒé˜Ÿï¼šæœ‰åˆ†å·¥æœ‰åä½œï¼Œç›®çš„ä¸€è‡´ ç½‘çƒé˜Ÿï¼šçµæ´»åˆ†å·¥ï¼Œè¦æ±‚ä¸¥æ ¼çš„å›¢é˜Ÿ é¦–å…ˆéœ€è¦è®¤æ¸…ç»„å‘˜æ‰€å±žçš„å›¢é˜Ÿç±»åž‹ï¼Œå¦‚æžœå›¢é˜Ÿè¦è½¬å˜å¿…é¡»çªå˜ï¼Œè€Œä¸èƒ½æ¸å˜ã€‚æ£’çƒé˜Ÿå‘˜ä¸éœ€è¦ã€ä¹Ÿä¸å–œæ¬¢å¤ªå¤šè·Ÿåˆ«äººé…åˆï¼Œç½‘çƒå‘˜è¿½æ±‚æœ€ç´§å¯†çš„å›¢é˜Ÿèžåˆï¼Œè¶³çƒé˜Ÿå‘˜å‰é”‹çŸ¥é“å›žé˜²åŽå«çŸ¥é“åŠ©æ”»ã€‚ å®‰æŽ’åŽŸåˆ™ä¸æ˜¯ç»å¯¹å¾—å¯¹å·å…¥åº§ï¼Œå¯ä»¥å®‰æŽ’ä¸€äº›å¯¹äºŽçŽ°æœ‰è§’è‰²èµ·é”»ç‚¼ä½œç”¨çš„ä»»åŠ¡ï¼ˆåŒæ‰“ç½‘çƒï¼‰æ¥äº’è¡¥ä»–çš„æ„è¯†ã€‚ ä¸ªäººçš„è§’è‰² ç®¡ç†è€…ï¼šé€šè¿‡ä»–äººå®Œæˆå·¥ä½œï¼Œæ ¸å¿ƒè´£ä»»åŸ¹å…»ä»–äººæˆé•¿ï¼› é¢†å¯¼è€…ï¼šè¥é€ æ°›å›´æé«˜ç»©æ•ˆï¼Œåˆ›é€ æ¿€åŠ±ï¼Œæå‡ä¼ä¸šæ–‡åŒ–ï¼› æ‰§è¡Œè€…ï¼šå‡ºç»“æžœã€‚ æ¯ä¸ªäººèº«ä¸Šéƒ½æœ‰ä»¥ä¸Šä¸‰ç§è§’è‰²ã€‚ ç›®æ ‡åªæœ‰ååŒå·¥ä½œä¸æ˜¯å›¢é˜Ÿï¼Œå›¢é˜Ÿä¸€å®šæ˜¯ç›®æ ‡è‡´åŠ›äºŽä¸šç»©ã€‚ å¹³è¡¡çŸ›ç›¾è¦å¹³è¡¡å¥½ä¸ªäººä¸»ä¹‰å’Œå›¢é˜Ÿçš„çŸ›ç›¾ï¼š å®¹çº³ä¸ªäººçš„ä¸åŒä¸Žé›†ä½“ä¸€è‡´çš„ç›®æ ‡ï¼› é¼“åŠ±å›¢é˜Ÿæˆå‘˜é—´çš„ç›¸äº’æ”¯æŒå’Œå¯¹æŠ—ï¼› ä¸šç»©ä¸Žå­¦ä¹ å‘å±•ï¼› ç®¡ç†è€…æƒå¨ä¸Žæˆå‘˜çš„åˆ¤æ–­åŠ›å’Œè‡ªæ²»åŠ›ï¼› â€œ1358â€ç®¡ç†ç²¾é«“ï¼šå…³äºŽç®¡ç†çš„ä¸€ä¸ªå®šä¹‰ã€ç®¡ç†çš„ä¸‰å¤§ä»»åŠ¡ã€ç®¡ç†è€…çš„äº”é¡¹å·¥ä½œå’Œä¼ä¸šéœ€è¦è®¾å®šç›®æ ‡çš„å…«å¤§é¢†åŸŸã€‚ ç§˜ç±åŠç¦å¿ŒSMARTå¤§ç›®æ ‡æ‹†æˆé˜¶æ®µå°ç›®æ ‡è¥é€ å…¬å¹³çš„å›¢é˜Ÿæ°›å›´ï¼Œæ˜Žç¡®å›¢é˜Ÿåˆ¶åº¦ å¦‚æžœè¯´ç›®æ ‡å¯¼å‘çš„ç»©æ•ˆè€ƒæ ¸æ˜¯çœ‹å¾—è§çš„æ‰‹ï¼Œé‚£ä¹ˆå…¬å¹³çš„å›¢é˜Ÿæ°›å›´å’Œåˆ¶åº¦åŒ–çš„åˆ¶åº¦ï¼Œå°±æ˜¯å¦å¤–ä¸€åªçœ‹ä¸è§çš„æ‰‹ã€‚åˆ¶åº¦çš„å‘æŒ¥æ æ†æ•ˆåº”å’ŒæŒç»­æ•ˆåº”çš„ä½œç”¨ï¼Œèƒ½è®©ä½ çš„å›¢é˜ŸæŒç»­ç§‘å­¦çš„é«˜æ•ˆå·¥ä½œã€‚ æˆå°±æ¿€åŠ±ã€è´£ä»»ç»™äºˆã€ä¿¡ä»»ã€å°Šé‡è®¤åŒã€å®‰å…¨æ‰¿è¯ºã€è‡ªç”±ä¸ŽæŽˆæƒã€ç›¸å¯¹å…¬å¹³ã€ä¸ªäººå…¬å¹³ã€å‘å±•ç©ºé—´ã€‚å¸®åŠ©æˆå‘˜æˆé•¿ ç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯å»ºç«‹åœ¨å­ç³»ç»Ÿçš„ä¸ç¨³å®šæ€§ä¹‹ä¸Šï¼Œå¤§åž‹ç»„ç»‡æœ€å¤§çš„é—®é¢˜å°±æ˜¯è„†å¼±æ€§å˜å¾—æžå¼ºï¼Œè¶Šå¤æ‚çš„ç»„ç»‡è„†å¼±æ€§è¶Šå¼ºã€‚ å¤æ‚éƒ½æ˜¯è‡ªä¸‹è€Œä¸Šçš„äº§ç”Ÿï¼Œè€Œä¸æ˜¯è‡ªä¸Šè€Œä¸‹ã€‚æ²Ÿé€šåé¦ˆ ä¹”å“ˆé‡Œè§†çª—-è‡ªæˆ‘æ„è¯†çš„å‘çŽ°ï¼šå¼€æ”¾åŒºã€éšè”½åŒºã€ç›²ç›®åŒºã€æœªçŸ¥åŒºã€‚äººçš„æœ‰æ•ˆæ²Ÿé€šå°±æ˜¯è¿™å››ä¸ªåŒºåŸŸçš„æœ‰æœºèžåˆï¼› å¤§å®¶åœ¨æ²Ÿé€šä¸­ä¸€å®šè¦æ³¨æ„ï¼Œéžè¯­è¨€æ²Ÿé€šçš„æŠ€å·§æ€§ï¼Œåœ¨æ²Ÿé€šä¸­è‚¢ä½“å’Œæ€åº¦æ˜¯è¿œè¿œè¶…è¿‡è¯­è¨€çš„èƒ½åŠ›çš„ï¼› è®¾å®šå†…éƒ¨åé¦ˆæœºåˆ¶ï¼šå‘¨ä¼š(æ€»ç»“)ã€æœˆæœ«ä¼šè®®ã€‚ç®¡ç†å›¢é˜Ÿæƒ…ç»ªï¼Œå­¦ä¼šæŽˆæƒå’Œå®¹å¿ å­¦ä¼šæŽˆæƒå’Œå®¹å¿æ‰èƒ½æé«˜å›¢é˜Ÿå‡èšåŠ›å’Œå½’å±žæ„Ÿã€‚ æŽˆæƒåŽæ‰æ˜¯ç®¡ç†çš„å¼€å§‹ã€‚å‡ºé”™æ—¶è¦å­¦ä¼šå®¹å¿ï¼Œæ­£ç¡®æ—¶è¦ä¸è¦åå•¬èµžç¾Žã€‚è¦çŸ¥é“ï¼Œæ‰¹è¯„æ—¶æ‰æ˜¯æœ€å¥½çš„æ‹‰è¿‘ä½ å’Œæˆå‘˜å…³ç³»çš„æ—¶åˆ»ï¼ŒåŒæ—¶ï¼Œè¦ç®¡ç†å¥½å›¢é˜Ÿæƒ…ç»ªã€‚ 4Aæ¨¡åž‹ï¼š è¯†åˆ«æƒ…ç»ª(Aware)å…³æ³¨è¡Œä¸ºå˜åŒ–ï¼Œè¯†åˆ«ç‰¹å¾è¡Œä¸ºï¼› æŽ¥å—æƒ…ç»ª(Accept)æŽ¥å—è€Œä¸åŽ‹åˆ¶ï¼Œç†è§£å››ä¸ªé˜¶æ®µï¼› åˆ†æžæƒ…ç»ª(Analyze)æ‰¾å‡ºæƒ…ç»ªæ¥æºï¼ŒæŠ“ä½ä¸‰ç§å¿ƒæ€ï¼› è°ƒæ•´æƒ…ç»ª(Adjust)åŠæ—¶å¦è¯šæ²Ÿé€šï¼Œå…³æ³¨å›¢é˜Ÿç›®æ ‡ã€‚å‘ä¸Šç®¡ç†åŠäººæ‰å‚¨å¤‡ ç»´åº¦åˆ’åˆ†ï¼š å‘ä¸‹â€”ç®¡ç†ä¸‹å±žï¼› å‘ä¸Šâ€”ç®¡ç†ä¸Šå¸ï¼› æ°´å¹³â€”ç®¡ç†å¹³çº§ï¼› å‘å¤–â€”ç®¡ç†é¡¾å®¢ã€ä¾›åº”å•†ç­‰å¤–éƒ¨åˆ©ç›Šç›¸å…³è€…ï¼› å‘å†…â€”ç®¡ç†è‡ªå·±ã€‚ ç®¡ç†è€…çš„ç¦å¿Œï¼ˆæœ‰æ•ˆçš„ç®¡ç†è€…ï¼‰ï¼š ä¸çŸ«æƒ…éª„å‚²ï¼› ä¸è£…Bï¼› ä¸è£…è€å¤§ï¼› ä¸åšç¼©å¤´é¾Ÿï¼› ä¸æŒ‡æ‰‹åˆ’è„šï¼› ä¸æ‹–åŽè…¿ï¼› ä¸æ‰°ä¹±å†›å¿ƒï¼› ä¸ä½¿åï¼› ä¸å†…è®§ï¼› ä¸å¹²æ“è›‹äº‹ï¼› ä¸è´¬ä½Žåˆ«äººï¼› ä¸å„è‡ªä¸ºæ”¿ã€‚ æ¨¡åž‹äººå²—åŒ¹é…æ¨¡åž‹ ä»·å€¼è§‚ï¼› çŸ¥è¯†æŠ€èƒ½ï¼› è¡Œä¸ºèƒ½åŠ›ã€‚ å†°å±±æ¨¡åž‹ çŸ¥è¯†ã€æŠ€èƒ½ï¼›ï¼ˆè¡¨è¾¾èƒ½åŠ›ã€ç»„ç»‡èƒ½åŠ›ã€å†³ç­–èƒ½åŠ›ã€å­¦ä¹ èƒ½åŠ›ï¼‰ â€”â€”-æ°´é¢ä¸Šâ€”â€”- ç¤¾ä¼šè§’è‰²ï¼šæ€åº¦ã€ä»·å€¼è§‚ï¼›ï¼ˆç®¡ç†è€…ã€ä¸“å®¶ã€æ•™å¸ˆï¼›åˆä½œç²¾ç¥žã€çŒ®èº«ç²¾ç¥žï¼‰ è‡ªæˆ‘æ¦‚å¿µï¼›ï¼ˆè‡ªä¿¡å¿ƒã€ä¹è§‚ç²¾ç¥žï¼‰ ç‰¹è´¨ã€å“è´¨ï¼›ï¼ˆæ­£ç›´ã€è¯šå®žã€è´£ä»»å¿ƒï¼‰ åŠ¨æœºã€‚ï¼ˆæˆå°±éœ€æ±‚ã€äººé™…äº¤å¾€éœ€æ±‚ï¼‰ 3D+Eæ¨¡åž‹ Doï¼ˆèŒè´£ï¼‰ï¼šå²—ä½èŒè´£å†…å®¹è¦æ±‚ï¼› Displayï¼ˆèƒ½åŠ›ï¼‰ï¼šèƒœä»»ç´ è´¨è¦æ±‚ï¼›ï¼ˆä¸“ä¸šçŸ¥è¯†ã€æŠ€èƒ½è¦æ±‚ï¼‰ Deliverï¼ˆä¸šç»©ï¼‰ï¼šç»©æ•ˆè€ƒæ ¸æŒ‡æ ‡ï¼Œå²—ä½ç»©æ•ˆè¡¨çŽ°ï¼› Experienceï¼ˆç»éªŒï¼‰ï¼šä»»èŒç»éªŒè¦æ±‚ã€‚ å›¢é˜Ÿæˆé•¿æ¨¡åž‹ æˆç«‹æœŸï¼šç¤¼è²Œã€æ¾æ•£è§‚æœ›ã€ç­‰å¾…ã€ä¿å®ˆã€å ¤é˜²ï¼› å†²çªæœŸï¼šäº’ç›¸äº‰åµã€å†²çªã€é—®é¢˜å‡ºçŽ°ã€ç«žäº‰ã€æ‹‰å¸®ç»“æ´¾ï¼› å‘å±•æœŸï¼šæœ‰ç»„ç»‡ã€æŠ€èƒ½å¢žé•¿ã€é—®é¢˜è§£å†³ã€å†²çªæ¶ˆé™¤ã€è¾“å…¥å’Œåé¦ˆã€æœ‰é™è§„åˆ™å’Œæ–¹æ³•ï¼› æˆç†ŸæœŸï¼šåˆä½œã€æˆç†Ÿã€é«˜æ•ˆã€çµæ´»ã€å¼€æ”¾ã€ä¿¡ä»»ã€‚ ç®¡ç†è€…æˆé•¿æ¨¡åž‹ è®¤çŸ¥è‡ªæˆ‘ é¢†å¯¼è§’è‰²è®¤çŸ¥ å“è¶Šé¢†å¯¼åŠ›æ¨¡åž‹ é¢†å¯¼é£Žæ ¼ä¸Žç®¡ç†æƒ…å¢ƒ ç®¡ç†è‡ªæˆ‘ é¢†å¯¼ç´ å…»ä¿®ç‚¼ æ€§æ ¼ä¸Žé¢†å¯¼åŠ› ç®¡ç†å›¢é˜Ÿ å›¢é˜Ÿä¸šç»©ç®¡ç† å›¢é˜Ÿæ–‡åŒ–å»ºè®¾ å‘˜å·¥æ¿€åŠ±ä¸ŽæŽˆæƒ å‘˜å·¥åŸ¹è®­è¾…å¯¼ å­¦ä¹ åž‹å›¢é˜Ÿå»ºè®¾ äººé™…äº’åŠ¨ æ²Ÿé€šæŠ€å·§ï¼ˆä¸­ã€é«˜çº§ï¼‰ é«˜æ•ˆä¼šè®®ç®¡ç† è·¨éƒ¨é—¨æ²Ÿé€šæŠ€å·§ ç®¡ç†å®žè·µåˆ’åˆ†å›¢é˜Ÿç±»åž‹ æ£’çƒåž‹ï¼š é—®é¢˜ï¼šç¼ºä¹å…±åŒç»´æŠ¤ä¸€ä¸ªâ€œçƒâ€çš„æ„è¯†ï¼Œä½†å‰ææ˜¯ä»–ä»¬ä¹Ÿäº¤æµå¾—å¤ªå°‘ï¼›ï¼ˆycã€lsyï¼‰ å®‰æŽ’ï¼šå¯¹æŽ¥æ¸¸æˆï¼Œè§£å†³é—®é¢˜ï¼Œç ”ç©¶ï¼›ï¼ˆå¶å°”å®‰æŽ’äº’è¡¥ä»»åŠ¡-åˆ†äº«ç ”ç©¶æˆæžœï¼‰ è¶³çƒåž‹ï¼š é—®é¢˜ï¼šæœ‰ç»´æŠ¤ä¸€ä¸ªâ€œçƒâ€çš„æ„è¯†ï¼Œä½†åªçœ‹è§è‡ªå·±å·²çŸ¥çš„éƒ¨åˆ†ï¼Œèµ°ä¸å‡ºåœˆå­ï¼ˆttsã€hzwã€hwxï¼‰ å®‰æŽ’ï¼šå¼€å‘å¯¹æ¡†æž¶å½±å“åº¦ä½Žçš„ä¸­å°åž‹éœ€æ±‚é¡¹ç›® ç½‘çƒåž‹ï¼š é—®é¢˜ï¼šæ—¢çŸ¥é“ç›®æ ‡ï¼Œä¹ŸçŸ¥é“æ‰©å±•ï¼Œçµæ´»å˜åŒ–(yjlã€htc)ï¼Œä½†å¯èƒ½å­˜åœ¨ä¸»åŠ¨æ€§é—®é¢˜(czh) å®‰æŽ’ï¼šæž¶æž„è®¾è®¡ã€å¼€å‘æ¶‰åŠé¢å¹¿çš„åŠŸèƒ½é¡¹ç›® è®¾å®šç›®æ ‡ åˆ¶å®šå›¢é˜Ÿç›®æ ‡ï¼ˆç»„é•¿ç»™å‡ºè§„åˆ’ï¼‰ åˆ¶å®šä¸ªäººç›®æ ‡ï¼ˆéœ€åˆ‡åˆå›¢é˜Ÿå¤§ç›®æ ‡çš„æ–¹å‘ï¼Œç”±ä¸ªäººåˆ¶å®šä¸»ç®¡å¤å®¡ï¼Œä¸å¼ºåˆ¶ä½†ä¸Žæ™‹å‡æŒ‚é’©ï¼‰ ç®¡ç†æƒ…ç»ª åº”ç”¨4Aæ¨¡åž‹ï¼ˆåŒ…æ‹¬ä¸»ç®¡åŠæ‰€æœ‰ä¸‹å±žï¼Œä¸»ç®¡è¿˜éœ€ç»™ä¸‹å±žåšæŒ‡å¼•ï¼‰ï¼› åˆ»æ„ä¿æŒè®°ä½ï¼Œå‡ºé”™éœ€è¦æ‰¹åˆ¤ï¼Œä½†è¦æ³¨æ„å¿ä½ä¸ªäººæƒ…ç»ªï¼Œåšå¾—å¥½è¦æ³¨æ„èµžæ‰¬ï¼› æ‰“ç ´å­ç³»ç»Ÿçš„ç¨³å®šæ€§(å¸®åŠ©æˆé•¿) æœ«å°¾æ·˜æ±°åˆ¶ æœ«å°¾çš„åˆ¶åº¦ï¼šæŽ’åç»´åº¦(ä¸Šçº§è¯„ã€è‡ªè¯„ã€äº’è¯„)ã€è€ƒå¯Ÿå²—(åŽ»ç»©æ•ˆ/é™è–ª)ï¼Ÿ æ¿€åŠ± æ ¹æ®ä¸ªäººåˆ¶å®šçš„ç›®æ ‡ï¼ˆè‡ªå®škpiï¼‰çš„ä»·å€¼ç­‰çº§ã€å®Œæˆè´¨é‡åŠæ—¶é—´ã€å¯¹å¾…ç»“æžœçš„æ€åº¦ä¸‰æ–¹é¢è¿›è¡Œè¯„ä¼°ï¼Œç»™ç›¸åº”çš„é¼“åŠ±å¥–åŠ±ã€‚ å†åˆ’åˆ†ä¸€å±‚æ•´ä½“åˆ©ç›Šã€å¥–ç½šçš„ç»‘å®šï¼Ÿ ä»»å‘½é‡‡ç”¨äººå²—åŒ¹é…æ¨¡åž‹ã€å†°å±±æ¨¡åž‹ã€3D+Eæ¨¡åž‹è¯„ä¼° è‡ªæˆ‘æå‡æ—¶åˆ»æ³¨æ„ç®¡ç†è€…æˆé•¿æ¨¡åž‹çš„å¡‘é€  åˆ¶å®šå›¢é˜Ÿçš„è§„åˆ™ã€åŽŸåˆ™ã€‚ã€‚ã€‚å¾… REFï¼šæ€Žä¹ˆæ‰èƒ½åšå¥½å›¢é˜Ÿç®¡ç†ï½œæ–¹æ³•è®ºåŠ æ¨¡åž‹æ¡ˆä¾‹]]></content>
      <categories>
        <category>ç®¡ç†</category>
      </categories>
      <tags>
        <tag>Manager</tag>
        <tag>Model</tag>
        <tag>Role</tag>
        <tag>Target</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•ˆçŽ‡å·¥å…·åŠæŠ€å·§æ”¶å½•]]></title>
    <url>%2F%E5%B7%A5%E5%85%B7%2F%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E5%8F%8A%E6%8A%80%E5%B7%A7%E6%94%B6%E5%BD%95%2F</url>
    <content type="text"><![CDATA[è½¬æ¢è„‘å›¾æ–‡ä»¶æ ¼å¼nodemindæ ‡å‡†æ ¼å¼è½¬æ¢å·¥å…·/path/to/text-to-freemind /path/to/text.txt &gt; freemind.mmtext.txté‡Œç”¨tabå¯¹æ¯è¡Œè¿›è¡Œç¼©è¿›ï¼Œç¼©è¿›é‡ä¸Žè¡Œæ‰€åœ¨ç±»åˆ«å¯¹åº”ã€‚https://github.com/wbolster/text-to-freemind Googleæœç´¢æŠ€å·§1.æœç´¢åˆ°çš„ç»“æžœâ€œä¸œæ‹¼è¥¿å‡‘â€ï¼Œä½¿ç”¨â€â€è¿›è¡Œå®Œå…¨åŒ¹é…ä½¿ç”¨æ–¹æ³•ï¼šâ€å…³é”®å­—â€ï¼Œé€šè¿‡ç»™å…³é”®å­—åŠ åŒå¼•å·çš„æ–¹æ³•ï¼Œå¾—åˆ°çš„æœç´¢ç»“æžœå°±æ˜¯å®Œå…¨æŒ‰ç…§å…³é”®å­—çš„é¡ºåºæ¥æœã€‚ 2.ä¸æƒ³è¦æœç´¢æŸä¸ªå…³é”®è¯ï¼Œä½¿ç”¨-æŽ’é™¤å…³é”®å­—ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— -æŽ’é™¤å…³é”®å­— ã€‚Tipï¼š-åŽé¢æ²¡æœ‰ç©ºæ ¼ã€‚ 3.è®°ä¸æ¸…æ¥šå®Œæ•´çš„å…³é”®è¯ï¼Œä½¿ç”¨*è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— * å…³é”®å­— 4.åªæƒ³åœ¨æŸä¸ªç½‘ç«™ä¸ŠæŸ¥æ‰¾ï¼Œä½¿ç”¨siteæŒ‡å®šç½‘ç«™ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— site:ç½‘å€ï¼ˆç½‘å€ä¸­çš„åŸŸæˆ–è€…è·¯å¾„ç­‰ä¹Ÿå¯ä½¿ç”¨*é€šé…ï¼‰ 5.åªæƒ³æœç´¢æŸç±»åž‹æ–‡ä»¶ï¼Œä½¿ç”¨filetypeæŒ‡å®šæ–‡ä»¶ç±»åž‹ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— filetype:æ–‡ä»¶ç±»åž‹ 6.æˆ–é€»è¾‘æœç´¢ï¼Œç”¨ ORä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— OR å…³é”®å­— 7.æœªèƒ½å‡†ç¡®åˆ¤æ–­å…³é”®è¯ï¼Œä½¿ç”¨ ~ è¿›è¡ŒåŒä¹‰è¯æœç´¢ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— ~æŽ’é™¤å…³é”®å­— 8.ä¸¤ä¸ªæ•°å€¼é—´æœç´¢ï¼Œä½¿ç”¨ â€œ.. â€è¿›è¡Œæœç´¢ä½¿ç”¨æ–¹æ³•ï¼šå…³é”®å­— 10.. 20 ã€‚Tipï¼šæ³¨æ„..åŽè·Ÿç©ºæ ¼ 9.åœ¨ç½‘é¡µæ ‡é¢˜ã€é“¾æŽ¥å’Œä¸»ä½“ä¸­æœç´¢å…³é”®è¯ä½¿ç”¨æ–¹æ³•ï¼šintitle: å…³é”®å­— / inurl: å…³é”®å­— / intext: å…³é”®å­— 10.æœç´¢ç›¸å…³ç½‘ç«™ä½¿ç”¨æ–¹æ³•ï¼šrelated: ç½‘å€ 11.ç›´æŽ¥ç¿»è¯‘æ–‡æœ¬ä½¿ç”¨æ–¹æ³•ï¼štranslate: å…³é”®å­— ã€‚Tipï¼šåªæ”¯æŒä¸­æ–‡ï¼Ÿ]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>tool</tag>
        <tag>skill</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŽç«¯æœåŠ¡å™¨æ¦‚å¿µäº†è§£ä¸‹]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2F%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A6%82%E5%BF%B5%E4%BA%86%E8%A7%A3%E4%B8%8B%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦æ˜¯æ”¶å½•äº›åŽç«¯èŠ‚ç‚¹çš„æ¦‚å¿µï¼Œé€šè¿‡äº†è§£æ¥å¸®åŠ©é˜…è¯»åŽç«¯çš„æŠ€æœ¯èµ„è®¯ã€æŽ’æŸ¥ç³»ç»Ÿé—®é¢˜ã€é¡¹ç›®éœ€æ±‚ä¼šè®®æ•´ä½“è®¨è®ºç­‰æƒ…å¢ƒä¸Šå¯ä»¥å¯¹åŽç«¯ç›¸å…³çš„å†…å®¹èƒ½æœ‰ä¸€å®šè®¤çŸ¥åº¦ï¼Œæ€è€ƒä¸Žè‡ªèº«é¢†åŸŸçš„ç›¸å…³æ€§ï¼Œè€Œä¸è‡³äºŽé”™è¿‡ä¸€äº›ä¼˜ç§€çš„æ€ç»´è§’åº¦å’Œè®¾è®¡ç†å¿µã€å®šä½é—®é¢˜å±€é™ã€ç›¸å…³è®®é¢˜å‚ä¸Žåº¦ä½Žç­‰æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ‰©å……çŸ¥è¯†é¢ï¼Œå­¦ä¹ åŽç«¯çš„å¯¼ç´¢ã€‚ CGIå…ˆçœ‹ä¸€ä¸ªæ™®é€šçš„ç½‘ç»œè¯·æ±‚æµç¨‹ï¼š Client -&gt; Web Server -&gt; CGIsClient &lt;- Web Server &lt;- CGIs åœ¨ä¸Šé¢çš„æµç¨‹ä¸­ï¼ŒWeb Serverï¼šå¦‚æžœæ˜¯é™æ€é¡µé¢ç›´æŽ¥è¿”å›žå“åº”ï¼Œå¦‚æžœæ˜¯åŠ¨æ€é¡µé¢åˆ™æå–è¯·æ±‚ä¿¡æ¯å‘é€ç»™CGIç¨‹åºã€‚CGIsï¼šå¤šä¸ªé€šç”¨ç½‘å…³æŽ¥å£(Common Gateway Interface)çš„è¿›ç¨‹å“åº”è¯·æ±‚ï¼› CGIçš„ç‰¹æ€§ï¼š Http åè®®åªå­˜åœ¨äºŽWeb Clientå’ŒWeb Serverä¹‹é—´ï¼Œä¸ŽCGIç¨‹åºä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ï¼› Web Serverä¸ŽCGIç¨‹åºä¹‹é—´çš„æ•°æ®ä¼ è¾“éµå¾ªçš„æ˜¯CGIè§„èŒƒï¼› Web Serverå’ŒCGIç¨‹åºè¿è¡Œåœ¨åŒä¸€ä¸ªä¸»æœºä¸Šï¼Œæ¯ä¸ªCGIè¯·æ±‚Web Serveréƒ½ä¼šforkä¸€ä¸ªæ–°çš„CGIç¨‹åºçš„è¿›ç¨‹ï¼Œç­‰åˆ°è¯·æ±‚å¤„ç†å®Œæ¯•åˆ™è¯¥è¿›ç¨‹ç»“æŸï¼› å¦‚æžœæ˜¯è¯·æ±‚åŠ¨æ€é¡µé¢ï¼ˆè‡³äºŽå¦‚ä½•åˆ¤æ–­æ˜¯é™æ€é¡µé¢è¿˜æ˜¯åŠ¨æ€é¡µé¢åˆ™æ˜¯åœ¨Web Serverä¸­é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼‰ï¼Œé€šè¿‡è§£æžè¯¥è¯·æ±‚æºå¸¦çš„ä¿¡æ¯ï¼Œå¹¶ä¾æ®CGIè§„èŒƒå°†è¿™äº›ä¿¡æ¯æ‰“åŒ…åˆ°CGIè§„å®šçš„å˜é‡ä¸­ï¼Œç„¶åŽåœ¨Web Serverä¸­è°ƒç”¨OSä¸­å¯¹åº”çš„CGIç¨‹åºæ¥è§£æžè¯¥CGIè¯·æ±‚ï¼Œç„¶åŽç”Ÿæˆç›¸åº”çš„é¡µé¢è¿”å›žç»™Web ServeræœåŠ¡å™¨ï¼Œç„¶åŽWeb Serverå†å°†è¯¥å†…å®¹è¿”å›žç»™å®¢æˆ·ç«¯ï¼› CGIç¨‹åºä¸å¯¹Webå®¢æˆ·ç«¯å¼€æ”¾ï¼ŒCGIç¨‹åºæ˜¯ä¸ŽOSæœ‰å…³çš„ï¼Œéœ€è¦æ ¹æ®OSçš„çŽ¯å¢ƒä½¿ç”¨é€‚å½“çš„è¯­è¨€æ¥å¼€å‘ï¼Œæ‰€ä»¥å¯¹ç³»ç»Ÿå¹³å°çš„ç§»æ¤ä¸å‹å¥½ï¼Œéœ€æ›´æ”¹ä»£ç æˆ–é‡æ–°ç¼–è¯‘ã€‚ é€šä¿—æ¥è®²è§£çš„è¯ï¼Œå°±æ˜¯ï¼Œä¸€ä¸ªHTTPè¯·æ±‚åˆ°è¾¾ä¸€å°æœåŠ¡å™¨çš„80ç«¯å£(Web Server)çš„æ—¶å€™ï¼Œéœ€è¦æœ‰ä¸ªç¨‹åºæ¥å“åº”è¿™ä¸ªè¯·æ±‚ã€‚æ‰€è°“HTTP responseï¼Œå…¶å®žåªæ˜¯è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œå®ƒçš„è¾“å…¥æ˜¯HTTP request headerï¼Œå®ƒçš„è¿”å›žæ˜¯HTTP responseã€‚ç¨‹åºè¿è¡Œæ–¹å¼çš„åŒºåˆ«ã€HTTP request headerçš„ä¼ é€’æ–¹å¼åŒºåˆ«å°±æ˜¯CGIã€WSGIä»¥åŠå…¶ä»–å„ç§GIçš„åŒºåˆ«ã€‚å¦‚æžœæ˜¯CGIï¼Œé€šå¸¸æ¥è¯´æ˜¯ä¸€ä¸ªweb serverï¼ˆä¾‹å¦‚apacheã€nginxï¼‰æŽ¥æ”¶åˆ°è¯·æ±‚åŽï¼Œå°†è¯·æ±‚ä¸­çš„HTTP request headeræŒ‰ç…§ä¸€å®šè§„åˆ™è®¾ç½®æˆçŽ¯å¢ƒå˜é‡ï¼Œç„¶åŽå¯åŠ¨ä¸€ä¸ªç¨‹åºï¼ˆPythonè„šæœ¬ï¼‰ï¼Œå°†stdoutçš„è¾“å‡ºï¼ˆå…¶ä¸­åŒ…å«HTTP response headerï¼‰å½“æˆHTTP responseè¿”å›žç»™å®¢æˆ·ç«¯ã€‚ FastCGIFastCGIæ˜¯å¯¹CGIçš„ä¸€ä¸ªä»Žæœ¬è´¨ä¸Šæ”¹å˜çš„ä¼˜åŒ–ã€‚ FastCGIç¨‹åºåªæœ‰ä¸€ä¸ªè¿›ç¨‹æ¥å¤„ç†CGIè¯·æ±‚ï¼Œè€Œä¸”å¤„ç†å®Œè¯¥è¯·æ±‚ä¹‹åŽä¹Ÿä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚ FastCGIç¨‹åºå…è®¸è¿è¡Œåœ¨ä¸åŒçš„ä¸»æœºä¹‹ä¸Šï¼Œè€ŒWeb Serverå’ŒFastCGIä¹‹é—´é€šè¿‡TCPè¿žæŽ¥è¿›è¡Œé€šä¿¡ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ä½¿Web Serverå’ŒFastCGIç¨‹åºç‹¬ç«‹é…ç½®å’Œå¯åŠ¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡æé«˜ç³»ç»Ÿçš„ä¼¸ç¼©æ€§å’Œæ‰©å±•æ€§ã€‚ Servletå¯¹äºŽç”ŸæˆåŠ¨æ€é¡µé¢å’Œè¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼ŒCGIå’ŒServletæ˜¯ä¸¤ä¸ªå¯å®žçŽ°çš„é€‰é¡¹ã€‚è€Œå¯¹äºŽservletæ¥è¯´ï¼Œè™½ç„¶ç›®å‰Java EEæœ‰äº›å¼å¾®ï¼Œä½†ä½œä¸ºå®žçŽ°å¾®æœåŠ¡çš„å‰æ²¿æ¡†æž¶Spring Bootä»ç„¶æ˜¯å»ºç«‹åœ¨Servletçš„åŸºç¡€ä¹‹ä¸Šã€‚ Servletè¿è¡Œåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¯¹äºŽæ¯ä¸ªè¯·æ±‚åˆ™ä¼šç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ï¼Œç”±è¿™äº›ç‹¬ç«‹çš„çº¿ç¨‹å¤„ç†å¯¹åº”çš„HTTPè¯·æ±‚ï¼ŒServletæ‰§è¡Œå®Œæ¯•åŽä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯é©»ç•™åœ¨å†…å­˜ä¸­ç›´åˆ°Servlet Containerå…³é—­ï¼Œä»¥ä¾¿èƒ½éšæ—¶å¤„ç†HTTPè¯·æ±‚ã€‚Servletæ˜¯ç”±å¤šä¸ªçº¿ç¨‹å¤„ç†è¯·æ±‚ï¼Œæ‰€ä»¥å„ä¸ªè¯·æ±‚ä¹‹é—´å¯ä»¥è¿›è¡Œå¾ˆå®¹æ˜“çš„è¿›è¡Œæ•°æ®å…±äº«ã€‚ä½†å¦‚æžœå°†ç¼–è¯‘ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ç§»åŠ¨åˆ°å¦å¤–çš„ä¸»æœºæˆ–è€…å¦å¤–çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œåªè¦æ˜¯å­˜åœ¨JVMå°±ä»ç„¶å¯ä»¥è¿è¡Œã€‚ Servletå’ŒJSPä¸¤è€…åˆ†å·¥åä½œï¼ŒServletä¾§é‡äºŽè§£å†³è¿ç®—å’Œä¸šåŠ¡é€»è¾‘é—®é¢˜ï¼ŒJSPåˆ™ä¾§é‡äºŽè§£å†³å±•ç¤ºé—®é¢˜ã€‚ å®¹å™¨ä¸€å¥è¯æ¦‚æ‹¬å®¹å™¨ï¼šå®¹å™¨å°±æ˜¯å°†è½¯ä»¶æ‰“åŒ…æˆæ ‡å‡†åŒ–å•å…ƒï¼Œä»¥ç”¨äºŽå¼€å‘ã€äº¤ä»˜å’Œéƒ¨ç½²ã€‚é€šä¿—å½¢å®¹ï¼šå®¹å™¨å°±æ˜¯ä¸€ä¸ªå­˜æ”¾ä¸œè¥¿çš„åœ°æ–¹ï¼Œå°±åƒä¹¦åŒ…å¯ä»¥è£…å„ç§æ–‡å…·ã€è¡£æŸœå¯ä»¥æ”¾å„ç§è¡£æœã€éž‹æž¶å¯ä»¥æ”¾å„ç§éž‹å­ä¸€æ ·ã€‚æˆ‘ä»¬çŽ°åœ¨æ‰€è¯´çš„å®¹å™¨å­˜æ”¾çš„ä¸œè¥¿å¯èƒ½æ›´åå‘äºŽåº”ç”¨æ¯”å¦‚ç½‘ç«™ã€ç¨‹åºç”šè‡³æ˜¯ç³»ç»ŸçŽ¯å¢ƒã€‚ å®¹å™¨è™šæ‹ŸåŒ–çš„æ˜¯æ“ä½œç³»ç»Ÿè€Œä¸æ˜¯ç¡¬ä»¶ï¼Œå®¹å™¨ä¹‹é—´æ˜¯å…±äº«åŒä¸€å¥—æ“ä½œç³»ç»Ÿèµ„æºçš„ã€‚è™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åŽï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿã€‚å› æ­¤å®¹å™¨çš„éš”ç¦»çº§åˆ«ä¼šç¨ä½Žä¸€äº›ã€‚ å®¹å™¨é•œåƒæ˜¯è½»é‡çš„ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ… ï¼ŒåŒ…å«è½¯ä»¶è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼šä»£ç ã€è¿è¡Œæ—¶çŽ¯å¢ƒã€ç³»ç»Ÿå·¥å…·ã€ç³»ç»Ÿåº“å’Œè®¾ç½®ã€‚ å®¹å™¨åŒ–è½¯ä»¶é€‚ç”¨äºŽåŸºäºŽLinuxå’ŒWindowsçš„åº”ç”¨ï¼Œåœ¨ä»»ä½•çŽ¯å¢ƒä¸­éƒ½èƒ½å¤Ÿå§‹ç»ˆå¦‚ä¸€åœ°è¿è¡Œã€‚ å®¹å™¨èµ‹äºˆäº†è½¯ä»¶ç‹¬ç«‹æ€§ï¼Œä½¿å…¶å…å—å¤–åœ¨çŽ¯å¢ƒå·®å¼‚ï¼ˆä¾‹å¦‚ï¼Œå¼€å‘å’Œé¢„æ¼”çŽ¯å¢ƒçš„å·®å¼‚ï¼‰çš„å½±å“ï¼Œä»Žè€Œæœ‰åŠ©äºŽå‡å°‘å›¢é˜Ÿé—´åœ¨ç›¸åŒåŸºç¡€è®¾æ–½ä¸Šè¿è¡Œä¸åŒè½¯ä»¶æ—¶çš„å†²çªã€‚ Djangoåœ¨å®¹å™¨ä¸­ï¼Œå¦‚æžœæ˜¯Djangoè·‘åœ¨uWSGiã€unicornä¹‹ç±»çš„å®¹å™¨é‡Œï¼Œé‚£ä¹ˆç¨‹åºæ˜¯ä¸€ä¸ªå¸¸é©»è¿›ç¨‹ï¼Œweb serverå’ŒPythonè¿›ç¨‹ç”¨WSGIåè®®ä¼ é€’HTTP request headerä¿¡æ¯ï¼Œç„¶åŽè¿”å›žç»™ç”¨æˆ·ã€‚å¦‚æžœæ˜¯Djangoçš„dev serverï¼Œå®ƒä½¿ç”¨Pythonè‡ªå¸¦çš„wsgirefæ¨¡å—å®žçŽ°äº†ä¸€ä¸ªç®€å•çš„HTTP server ï¼ˆdjango/django/core/servers/basehttp.py at master è·¯ django/django è·¯ GitHubï¼‰ï¼Œå“åº”HTTPè¯·æ±‚ã€‚ åŒæ ·Servletæ˜¯å—æŽ§äºŽå¦ä¸€ä¸ªç”±Javaå®žçŽ°çš„å®¹å™¨ï¼ŒTomcatå°±æ˜¯è¿™æ ·ä¸€ä¸ªå®¹å™¨ã€‚ å®¹å™¨èƒ½ä¸ºServletæä¾›ï¼š é€šä¿¡æ”¯æŒï¼šåˆ©ç”¨å®¹å™¨æä¾›çš„æ–¹æ³•ï¼Œä½ èƒ½è½»æ¾åœ°è®©servleä¸ŽWebæœåŠ¡å™¨å¯¹è¯ã€‚ ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šå®¹å™¨æŽ§åˆ¶ç€servletçš„ç”Ÿä¸Žæ­»ã€‚å®ƒä¼šè´Ÿè´£åŠ è½½ç±»ã€å®žä¾‹å’Œåˆå§‹åŒ–servletã€è°ƒç”¨servletæ–¹æ³•ï¼Œå¹¶ä½¿servletå®žä¾‹èƒ½å¤Ÿè¢«åžƒåœ¾å›žæ”¶ã€‚ å¤šçº¿ç¨‹æ”¯æŒï¼šå®¹å™¨ä¼šè‡ªåŠ¨åœ°ä¸ºå®ƒæŽ¥æ”¶çš„æ¯ä¸ªservletè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„javaçº¿ç¨‹ã€‚é’ˆå¯¹å®¢æˆ·æœºçš„è¯·æ±‚ï¼Œå¦‚æžœservletå·²ç»è¿è¡Œå®Œç›¸åº”çš„HTTPæœåŠ¡æ–¹æ³•ï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¼šç»“æŸï¼ˆä¹Ÿå°±æ˜¯ä¼šæ­»æŽ‰ï¼‰ã€‚ å£°æ˜Žæ–¹å¼å®žçŽ°å®‰å…¨ï¼šåˆ©ç”¨å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨XMLéƒ¨ç½²æè¿°æ–‡ä»¶é…ç½®ï¼ˆå’Œä¿®æ”¹ï¼‰å®‰å…¨æ€§ï¼Œè€Œä¸å¿…å°†å…¶ç¡¬ç¼–ç å†™åˆ°servletï¼ˆæˆ–å…¶ä»–ï¼‰ç±»ä»£ç ä¸­ã€‚ JSPæ”¯æŒï¼šè´Ÿè´£æŠŠJSPä»£ç ç¿»è¯‘æˆçœŸæ­£çš„javaã€‚ DockerDocker æ˜¯ä¸–ç•Œé¢†å…ˆçš„è½¯ä»¶å®¹å™¨å¹³å°ã€‚ Docker ä½¿ç”¨ Google å…¬å¸æŽ¨å‡ºçš„ Go è¯­è¨€ è¿›è¡Œå¼€å‘å®žçŽ°ï¼ŒåŸºäºŽ Linux å†…æ ¸ çš„cgroupï¼Œnamespaceï¼Œä»¥åŠAUFSç±»çš„UnionFSç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±žäºŽæ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ ç”±äºŽéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºŽå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿›ç¨‹ï¼Œå› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚Dockeæœ€åˆå®žçŽ°æ˜¯åŸºäºŽ LXC. Docker èƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œé‡å¤æ€§ä»»åŠ¡ï¼Œä¾‹å¦‚æ­å»ºå’Œé…ç½®å¼€å‘çŽ¯å¢ƒï¼Œä»Žè€Œè§£æ”¾äº†å¼€å‘äººå‘˜ä»¥ä¾¿ä»–ä»¬ä¸“æ³¨åœ¨çœŸæ­£é‡è¦çš„äº‹æƒ…ä¸Šï¼šæž„å»ºæ°å‡ºçš„è½¯ä»¶ã€‚ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼ŒæŠŠè‡ªå·±çš„åº”ç”¨æ”¾å…¥å®¹å™¨ã€‚å®¹å™¨è¿˜å¯ä»¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€å¤åˆ¶ã€åˆ†äº«ã€ä¿®æ”¹ï¼Œå°±åƒç®¡ç†æ™®é€šçš„ä»£ç ä¸€æ ·ã€‚ Dockerçš„æ€æƒ³ï¼š é›†è£…ç®± æ ‡å‡†åŒ–ï¼š â‘ è¿è¾“æ–¹å¼ â‘¡ å­˜å‚¨æ–¹å¼ â‘¢ APIæŽ¥å£ éš”ç¦» Dockerçš„åŸºæœ¬æ¦‚å¿µï¼š é•œåƒï¼ˆImageï¼‰ å®¹å™¨ï¼ˆContainerï¼‰ ä»“åº“ï¼ˆRepositoryï¼‰ ä½¿ç”¨Dockerçš„ä¼˜ç‚¹ï¼š Docker çš„é•œåƒæä¾›äº†é™¤å†…æ ¸å¤–å®Œæ•´çš„è¿è¡Œæ—¶çŽ¯å¢ƒï¼Œç¡®ä¿äº†åº”ç”¨è¿è¡ŒçŽ¯å¢ƒä¸€è‡´æ€§ï¼Œä»Žè€Œä¸ä¼šå†å‡ºçŽ° â€œè¿™æ®µä»£ç åœ¨æˆ‘æœºå™¨ä¸Šæ²¡é—®é¢˜å•Šâ€ è¿™ç±»é—®é¢˜ï¼›â€”â€”ä¸€è‡´çš„è¿è¡ŒçŽ¯å¢ƒ å¯ä»¥åšåˆ°ç§’çº§ã€ç”šè‡³æ¯«ç§’çº§çš„å¯åŠ¨æ—¶é—´ã€‚å¤§å¤§çš„èŠ‚çº¦äº†å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ—¶é—´ã€‚â€”â€”æ›´å¿«é€Ÿçš„å¯åŠ¨æ—¶é—´ é¿å…å…¬ç”¨çš„æœåŠ¡å™¨ï¼Œèµ„æºä¼šå®¹æ˜“å—åˆ°å…¶ä»–ç”¨æˆ·çš„å½±å“ã€‚â€”â€”éš”ç¦»æ€§ å–„äºŽå¤„ç†é›†ä¸­çˆ†å‘çš„æœåŠ¡å™¨ä½¿ç”¨åŽ‹åŠ›ï¼›â€”â€”å¼¹æ€§ä¼¸ç¼©ï¼Œå¿«é€Ÿæ‰©å±• å¯ä»¥å¾ˆè½»æ˜“çš„å°†åœ¨ä¸€ä¸ªå¹³å°ä¸Šè¿è¡Œçš„åº”ç”¨ï¼Œè¿ç§»åˆ°å¦ä¸€ä¸ªå¹³å°ä¸Šï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿è¡ŒçŽ¯å¢ƒçš„å˜åŒ–å¯¼è‡´åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œçš„æƒ…å†µã€‚â€”â€”è¿ç§»æ–¹ä¾¿ ä½¿ç”¨ Docker å¯ä»¥é€šè¿‡å®šåˆ¶åº”ç”¨é•œåƒæ¥å®žçŽ°æŒç»­é›†æˆã€æŒç»­äº¤ä»˜ã€éƒ¨ç½²ã€‚â€”â€”æŒç»­äº¤ä»˜å’Œéƒ¨ç½² å®¹å™¨ä¸Žè™šæ‹Ÿæœºçš„åŒºåˆ«ï¼šå®¹å™¨æ˜¯ä¸€ä¸ªåº”ç”¨å±‚æŠ½è±¡ï¼Œç”¨äºŽå°†ä»£ç å’Œä¾èµ–èµ„æºæ‰“åŒ…åœ¨ä¸€èµ·ã€‚å¤šä¸ªå®¹å™¨å¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼Œå…±äº«æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä½†å„è‡ªä½œä¸ºç‹¬ç«‹çš„è¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´ä¸­è¿è¡Œ ã€‚ä¸Žè™šæ‹Ÿæœºç›¸æ¯”ï¼Œ å®¹å™¨å ç”¨çš„ç©ºé—´è¾ƒå°‘ï¼ˆå®¹å™¨é•œåƒå¤§å°é€šå¸¸åªæœ‰å‡ åå…†ï¼‰ï¼Œçž¬é—´å°±èƒ½å®Œæˆå¯åŠ¨ ã€‚è™šæ‹Ÿæœº (VM) æ˜¯ä¸€ä¸ªç‰©ç†ç¡¬ä»¶å±‚æŠ½è±¡ï¼Œç”¨äºŽå°†ä¸€å°æœåŠ¡å™¨å˜æˆå¤šå°æœåŠ¡å™¨ã€‚ ç®¡ç†ç¨‹åºå…è®¸å¤šä¸ª VM åœ¨ä¸€å°æœºå™¨ä¸Šè¿è¡Œã€‚æ¯ä¸ªVMéƒ½åŒ…å«ä¸€æ•´å¥—æ“ä½œç³»ç»Ÿã€ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ã€å¿…è¦çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“èµ„æºï¼Œå› æ­¤ å ç”¨å¤§é‡ç©ºé—´ ã€‚è€Œä¸” VM å¯åŠ¨ä¹Ÿååˆ†ç¼“æ…¢ ã€‚ å¹¶å‘é‡1Må¸¦å®½åˆ°åº•èƒ½å®¹çº³å¤šå°‘äººåŒæ—¶åœ¨çº¿å‘¢ï¼Ÿ å¯¹äºŽä¸€å°ä¸­ä½Žç«¯æœåŠ¡å™¨é€šå¸¸æ”¯æŒåœ¨çº¿äººæ•°æœ€é«˜ä¸º2000äººå·¦å³ï¼Œè€Œä¸”åªé€‚åˆæ™®é€šç½‘ç«™å»ºè®¾åŽçš„æœåŠ¡å™¨å’Œæ–‡å­—åž‹è®ºå›ï¼Œä¸åŒ…æ‹¬å›¾ç‰‡ç±»ã€ä¸‹è½½ç±»ã€è§†é¢‘ç±»ç­‰ã€‚å¦‚æžœæ˜¯å…¶ä»–ç±»åž‹çš„ç½‘ç«™ï¼Œé‚£å°±è¦è€ƒè™‘æ›´é«˜é…ç½®çš„æœåŠ¡å™¨ä»¥åŠæ›´å¤§çš„å¸¦å®½ã€‚ â€œå…±äº«å®½å¸¦â€å’Œâ€œç‹¬äº«å®½å¸¦â€åœ¨ç§Ÿç”¨æœåŠ¡å™¨æ—¶ä¸€å®šè¦äº†è§£â€œå…±äº«å®½å¸¦â€å’Œâ€œç‹¬äº«å®½å¸¦â€çš„åŒºåˆ«ã€‚æœ‰äº›æœåŠ¡å™¨çš„å¸¦å®½é…ç½®æ˜¯å…±äº«å¸¦å®½æˆ–è€…ç‹¬äº«å¸¦å®½ï¼Œè€Œå…±äº«å¸¦å®½å°±æ˜¯æœ‰ä¸€å®šæ•°é‡çš„ç”¨æˆ·åœ¨ä½¿ç”¨ï¼Œè€Œç‹¬äº«å¸¦å®½å°±åªæœ‰è‡ªå·±åœ¨ä½¿ç”¨ï¼Œä½†ç‹¬äº«å¸¦å®½çš„è´¹ç”¨æ˜¯æ¯”ç‹¬äº«é«˜å‡ºè®¸å¤šã€‚ åœ¨çº¿äººæ•°çš„å› ç´ 1ï¼‰è®¿é—®é‡2ï¼‰ç½‘ç«™ç±»åž‹ å¦‚æžœæ˜¯å‡ºæ–‡å­—çš„ç½‘ç«™ï¼ˆå¦‚å°è¯´ç«™ï¼‰ï¼Œ1Må¸¦å®½å¸¦åŠ¨æ—¥å‡5000IPï¼Œè¿˜å‹‰å¼ºã€‚å¦‚æžœæ˜¯æ™®é€šç½‘ç«™æœ‰å›¾ç‰‡ï¼Œæœ‰æ–‡å­—ã€è®ºå›ã€æ–°é—»èµ„è®¯ç±»åž‹ç½‘ç«™å¤§æ¦‚1Mèƒ½å¸¦1000IPã€‚è€ƒè™‘åˆ°é«˜å³°æœŸå¹¶å‘ï¼Œ1Mé«˜å³°æœŸè¿˜ä¼šå¡ï¼ˆå‡è®¾1000IPåŒæ—¶å¹¶å‘ï¼Œåªæœ‰1KBå¸¦å®½/ç”¨æˆ·ï¼‰ã€‚ å‚è€ƒå…¬å¼ æ”¯æŒè¿žæŽ¥æ•° = æœåŠ¡å™¨å¸¦å®½/é¡µé¢å°ºå¯¸å¤§å° æ‰“å¼€ç½‘ç«™8ç§’åŽŸåˆ™ è¯„åˆ¤ç”¨æˆ·ä»ŽæœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶çš„é€Ÿåº¦ é¡µé¢çš„æ ‡å‡†å°ºå¯¸å¤§å°ä¸ºï¼ˆå‡è®¾60KBï¼‰ é€šè¿‡è®¡ç®—å¤§è‡´ç»“æžœæ˜¯ï¼Œ1Mbpsçš„å¸¦å®½ï¼ˆæœåŠ¡å™¨çš„1Må¸¦å®½æœ€å¿«ä¸Šä¸‹é€Ÿåº¦èƒ½è¾¾åˆ°1M/sï¼‰ï¼Œè·Ÿä¸€èˆ¬å®¶ç”¨çš„å¸¦å®½ç¨æœ‰åŒºåˆ«ï¼Œæ”¯æŒçš„è¿žæŽ¥æ•°ä¸ºï¼š17ä¸ªï¼ˆ=1M/60Kï¼‰ã€‚å› æ­¤ï¼ŒN Må¸¦å®½å¯ä»¥æ”¯æŒçš„åŒæ—¶åœ¨çº¿äººæ•°å¤§æ¦‚ä¸ºN*17ä¸ªã€‚æ‰€ä»¥ï¼Œ1Må¸¦å®½çš„æœåŠ¡å™¨ï¼Œæ—¥å‡3000IPä»¥ä¸‹åº”è¯¥æ²¡é—®é¢˜ã€‚å½“ç„¶å¦‚æžœç½‘ç«™æ¯ä¸ªé¡µé¢éƒ½æ¯”è¾ƒå¤§çš„è¯ï¼Œé‚£å°±æ²¡è¿™ä¹ˆå¤šäº†ã€‚ æœåŠ¡å™¨ æœåŠ¡å™¨çš„è´¨é‡ï¼šæœåŠ¡å™¨åˆ†ä¸ºé«˜ä¸­ä½Žä¸‰ç§ã€‚ä¸åŒåž‹å·å“ç‰Œçš„æœåŠ¡å™¨èƒ½å¤Ÿæ‰¿å—çš„æµé‡æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥ï¼Œè¿™æ˜¯å½±å“åŒæ—¶åœ¨çº¿è®¿é—®æ•°é‡çš„åŽŸå› ä¹‹ä¸€ã€‚ å®½å¸¦çš„å¤§å°ï¼šå‡è‹¥æœåŠ¡å™¨ä¿è¯çš„æœ€å¤§å¸¦å®½æ˜¯5M (å³5Mbit/s)ï¼Œç›¸åº”æœåŠ¡å™¨çš„æ•°æ®æœ€é«˜ä¼ è¾“é€Ÿåº¦åº”ä¸º5Mbit/s x 1024/8=640KBï¼Œ1åˆ†é’Ÿæµé‡å¤§çº¦640 x 60=38400KBã€‚å‡è®¾æ¯Žä¸ªç”¨æˆ·1åˆ†é’Ÿå†…å§‹ç»ˆå ç”¨10KBçš„æµé‡ï¼Œå³è¯¥1åˆ†é’Ÿå†…æ”¯æŒå ç”¨è¿™æ ·çš„æµé‡çš„åŒæ—¶åœ¨çº¿è®¿é—®äººæ•°ä¸º3840äººï¼ˆè§†é¢‘ç±»å¤§æµé‡ç½‘ç«™ä¸åœ¨æ­¤ä¾‹ï¼‰ã€‚ä½†å¹¶ä¸èƒ½ä¿è¯æ¯ä¸ªç”¨æˆ·åœ¨1åˆ†é’Ÿå†…åªæœ‰ä¸€æ¬¡åˆ°è¯¥ç«™çš„é“¾æŽ¥ï¼Œå‡å¦‚æ¯ä¸ªç”¨æˆ·åœ¨1åˆ†é’Ÿå†…æœ‰ä¸¤æ¬¡æˆ–ä»¥ä¸Šåˆ°è¯¥ç«™çš„é“¾æŽ¥ï¼‰æ¯ä¸ªé“¾æŽ¥å§‹ç»ˆå ç”¨10KBçš„æµé‡ï¼‰ï¼Œé‚£ä¹ˆæ”¯æŒåœ¨çº¿äººæ•°åº”è¯¥åœ¨2000ä»¥ä¸‹ã€‚]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>CGI</tag>
        <tag>Servlet</tag>
        <tag>å®¹å™¨</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆä¸ƒï¼‰å°æ€»ç»“]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%83%EF%BC%89%E5%B0%8F%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[ä¸€è¿ž6ç¯‡ï¼Œå…±12ç§è®¾è®¡æ¨¡å¼å·²ç»ä»‹ç»å®Œäº†ï¼Œå…¶å®žè¿™äº›éƒ½æ˜¯æœ€åŸºæœ¬çš„æ¨¡å¼ï¼Œä½†ä¹Ÿæ˜¯æœ€é‡è¦çš„æ¨¡å¼ï¼Œå› ä¸ºå¤–é¢å…¶å®ƒå„ç§çš„æ¨¡å¼æ¯”è¾ƒå¤šæ˜¯ä»Žè¿™äº›åŸºç¡€çš„æ¨¡å¼ä¸Šè¿›è¡Œå˜ä½“æ‰€å¾—çš„ã€‚ è™½ç„¶æœ¬ç³»åˆ—æ˜¯ä½¿ç”¨Javaå®žçŽ°ï¼Œä½†ä¸Žå…¶å®ƒè¯­è¨€çš„æ€è·¯æ˜¯å…±é€šçš„ï¼Œåªæ˜¯å¯èƒ½å…¶å®ƒè¯­è¨€æœ‰æ›´å¥½çš„è¯­æ³•æˆ–APIå¸®åŠ©æ¨¡å¼çš„å®žçŽ°è€Œä¼šæœ‰äº›è®¸ä¸ä¸€æ ·è€Œå·²ã€‚ å¸Œæœ›åŽé¢è¿˜èƒ½ç»§ç»­åœ¨è¿™ä»‹ç»ä¸Šæ›´å¤§é¢†åŸŸä¸Šçš„è®¾è®¡æ¨¡å¼ï¼Œä¾‹å¦‚åº”ç”¨æ¨¡å¼ã€ä¸šåŠ¡æµç¨‹æ¨¡å¼ã€ç”¨æˆ·ç•Œé¢è®¾è®¡æ¨¡å¼ã€ç»„ç»‡æ¨¡å¼ã€æž¶æž„æ¨¡å¼ç­‰ç­‰ã€‚ çŽ°åœ¨æ¥åšä¸€ä¸ªç®€å•çš„å›žé¡¾æ€»ç»“ã€‚ åŸºç¡€çš„æ¨¡å¼ ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ï¼šå°è£…å¯ä»¥äº’æ¢çš„è¡Œä¸ºï¼Œå¹¶ä½¿ç”¨å§”æ‰˜æ¥å†³å®šè¦ä½¿ç”¨å“ªä¸€ä¸ªï¼ˆå§”æ‰˜å³æ˜¯ä¸€å®žä¾‹å¯¹è±¡ï¼‰ã€‚ è£…é¥°è€…æ¨¡å¼ï¼ˆDecoratorï¼‰ï¼šåŒ…è£…ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥æä¾›æ–°æ–°çš„è¡Œä¸ºã€‚ é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰ï¼šå°è£…å¯¹è±¡ï¼Œå¹¶æä¾›ä¸åŒçš„æŽ¥å£ã€‚ å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰ï¼šç®€åŒ–ä¸€ç¾¤ç±»çš„æŽ¥å£ã€‚ å‘½ä»¤æ¨¡å¼ï¼ˆCommandï¼‰ï¼šå°è£…è¯·æ±‚æˆä¸ºå¯¹è±¡ã€‚ çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰ï¼šå°è£…äº†åŸºäºŽçŠ¶æ€çš„è¡Œä¸ºï¼Œå¹¶ä½¿ç”¨å§”æ‰˜åœ¨è¡Œä¸ºä¹‹é—´åˆ‡æ¢ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplateMethodï¼‰ï¼šç”±å­ç±»å†³å®šå¦‚ä½•å®žçŽ°ä¸€ä¸ªç®—æ³•ä¸­çš„æ­¥éª¤ã€‚ è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰ï¼šåœ¨å¯¹è±¡çš„é›†åˆä¹‹ä¸­æ¸¸èµ°ï¼Œè€Œä¸æš´éœ²é›†åˆçš„å®žçŽ°ã€‚ ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰ï¼šå®¢æˆ·ç”¨ä¸€ç›´çš„æ–¹å¼å¤„ç†å¯¹è±¡é›†åˆå’Œå•ä¸ªå¯¹è±¡ã€‚ å·¥åŽ‚æ–¹æ³•æ¨¡å¼ï¼ˆFatoryMethodï¼‰ï¼šç”±å­ç±»å†³å®šè¦åˆ›å»ºçš„å…·ä½“ç±»æ˜¯å“ªä¸€ä¸ªã€‚ æŠ½è±¡å·¥åŽ‚æ¨¡å¼ï¼ˆAbstractFatoryï¼‰ï¼šå…è®¸å®¢æˆ·ç«¯åˆ›å»ºå¯¹è±¡çš„å®¶æ—ï¼Œè€Œæ— éœ€æŒ‡å®šä»–ä»¬çš„å…·ä½“ç±»ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰ï¼šè®©å¯¹è±¡èƒ½å¤Ÿåœ¨çŠ¶æ€æ”¹å˜æ—¶è¢«é€šçŸ¥ã€‚ ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ï¼šåŒ…è£…å¯¹è±¡ï¼Œä»¥æŽ§åˆ¶å¯¹æ­¤å¯¹è±¡çš„è®¿é—®ã€‚ å…¶å®ƒçš„æ¨¡å¼ å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰ï¼ˆåœ¨æœ¬ç³»åˆ—ä¸­å®ƒæ²¡æœ‰å‡ºçŽ°ï¼Œå› ä¸ºè¿™ä¸ªæ¨¡å¼ç®—æ˜¯å®¶å–»æˆ·æ™“ï¼Œä¸è¿‡ä½¿ç”¨æ—¶è¿˜æ˜¯æœ‰ä¸€äº›æ³¨æ„ç‚¹çš„ï¼Œä¾‹å¦‚çº¿ç¨‹å®‰å…¨ï¼Œå¦‚ä½•å®žçŽ°æ›´é«˜æ•ˆç­‰ï¼‰ æ¡¥æŽ¥æ¨¡å¼ï¼ˆBridgeï¼‰ ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilderï¼‰ è´£ä»»é“¾æ¨¡å¼ï¼ˆChainOfResponsibilityï¼‰ è‡é‡æ¨¡å¼ï¼ˆFlyweightï¼‰ è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreterï¼‰ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediatorï¼‰ï¼ˆåœ¨æˆ‘ä»¬iOSçš„å·¥ç¨‹ä¸­å°±ä½¿ç”¨åˆ°è¿™ä¸ªæ¨¡å¼ï¼Œæ¥å»ºç«‹èµ·ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŽ»æŽ§åˆ¶ä¸åŒç»„ä»¶é—´çš„ç›¸äº’è®¿é—®ï¼‰ å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰ åŽŸåž‹æ¨¡å¼ï¼ˆPrototypeï¼‰ è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰ è¿˜æœ‰å¤§åé¼Žé¼Žçš„MVCï¼Œå®ƒå…¶å®žæ˜¯ä¸€ç§å¤åˆæ¨¡å¼ã€‚è§†å›¾ï¼ˆViewï¼‰å’ŒæŽ§åˆ¶å™¨ï¼ˆControllerï¼‰å®žçŽ°äº†ç­–ç•¥æ¨¡å¼ï¼Œè§†å›¾é€šè¿‡æ›´æ¢æŽ§åˆ¶å™¨æ”¹å˜è¡Œä¸ºï¼›è§†å›¾åˆ™é‡‡å–ç»„åˆæ¨¡å¼æ¥æž„å»ºæ•´ä½“ï¼Œä¾‹å¦‚çª—å£å°±æ˜¯ç»„åˆèŠ‚ç‚¹ï¼ŒæŒ‰é’®ç­‰å°±æ˜¯å¶èŠ‚ç‚¹ï¼›æ¨¡åž‹åˆ™å®žçŽ°äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œç›¸å…³çš„å¯¹è±¡å°†æŒç»­æ›´æ–°ï¼Œä¾‹å¦‚è§†å›¾åˆ·æ–°ï¼ˆä½†iOSçš„å¤šæ•°ä¾‹å­ä¸­å¹¶ä¸æå€¡è¿™æ ·ç›´æŽ¥é€šçŸ¥è§†å›¾ï¼Œè€Œæ˜¯å…ˆé€šçŸ¥æŽ§åˆ¶å™¨ï¼Œç”±æŽ§åˆ¶å™¨æ”¹å˜è§†å›¾ï¼‰ã€‚ æ¨¡å¼åˆ†ç±» åˆ›å»ºåž‹ Singleton AbstractFatory FatoryMethod Prototype Builder è¡Œä¸ºåž‹ TemplateMethod Iterator Command Observer State Strategy Mediator Visitor Memento Interpreter ChainOfResponsibility ç»“æž„åž‹ Decorator Composite Facade Proxy Adapter Flyweight Bridge è®¾è®¡åŽŸåˆ™ å°è£…å˜åŒ– å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿ é’ˆå¯¹æŽ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å®žçŽ°ç¼–ç¨‹ ä¸ºäº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆè®¾è®¡è€ŒåŠªåŠ› ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ ä¾èµ–æŠ½è±¡ï¼Œä¸è¦ä¾èµ–å…·ä½“ç±» åªå’Œæœ‹å‹äº¤è°ˆ åˆ«æ‰¾æˆ‘ï¼Œæˆ‘ä¼šæ‰¾ä½  ç±»åº”è¯¥åªæœ‰ä¸€ä¸ªæ”¹å˜çš„ç†ç”± æ³¨æ„å®žé™…åº”ç”¨ä¸­ï¼Œä¸è¦ä¸ºäº†ä½¿ç”¨æ¨¡å¼è€Œä½¿ç”¨ï¼Œè¦ä½¿ç”¨æ»¡è¶³éœ€æ±‚çš„æœ€ç®€å•è§£å†³æ–¹æ¡ˆã€‚å¤§å¤šæ•°çš„æ¨¡å¼éƒ½æ˜¯çŽ°æœ‰æ¨¡å¼çš„å˜ä½“ï¼Œè€Œéžæ–°æ¨¡å¼ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿä¾æ®è‡ªå·±çš„éœ€è¦é‡‡ç”¨æˆ–è°ƒæ•´ã€‚ æœ€åŽæ„Ÿè°¢ã€ŠHead Firstã€‹è¿™æœ¬ä¹¦çš„ä½œè€…ï¼Œåˆ—å‡ºé‚£ä¹ˆå¤šç”ŸåŠ¨æœ‰è¶£çš„æ¡ˆä¾‹å’Œè§£é‡Šï¼Œæ¯ä¸ªç« èŠ‚ä¸­éƒ½æœ‰æ‹¿ç›¸ä¼¼æ¨¡å¼è¿›è¡Œå¯¹æ¯”è¯´æ˜Žï¼Œç”±æµ…å…¥æ·±çš„ä»‹ç»é€šä¿—æ˜“æ‡‚ï¼Œè®©æˆ‘ä»¬å–œæ¬¢ä¸Šè®¾è®¡æ¨¡å¼ï¼Œå–œæ¬¢ä¸Šå¯¹ä¼˜é›…ä»£ç çš„è¿½æ±‚ã€‚ æœ¬ç³»åˆ—çš„ä»£ç åœ°å€ï¼šæˆ³è¿™é‡Œ]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆå…­ï¼‰å‘½ä»¤æ¨¡å¼ & è§‚å¯Ÿè€…æ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%85%AD%EF%BC%89%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%20%26%20%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å‘½ä»¤æ¨¡å¼åº”ç”¨åœºæ™¯ä½¿ç”¨å¤šåŠŸèƒ½çš„é¥æŽ§å™¨æ‰“å¼€ä¸€ä¸ªç”µç¯ public interface Command &#123; public void execute(); &#125; public class LightOnCommand implements Command &#123; Light light; public LigitOnCommand(Light light) &#123; this.light = light; &#125; public void execute() &#123; light.on(); &#125; &#125; public class SimpleRemoteControl &#123; Command slot; public SimpleRemoteControl() &#123; &#125; public void setCommand(Command command) &#123; slot = command; &#125; public void buttonWasPressed() &#123; slot.execute(); &#125; &#125; public class RemoteControlTest &#123; public static void main(String[] args) &#123; SimpleRemoteControl remote = new SimpleRemoteControl(); Light light = new Light(); LightOnCommand lightOn = new LightOnCommand(light); remote.setCommand(lightOn); remote.buttonWasPressed(); &#125; &#125; é¥æŽ§å™¨æ˜¯è°ƒç”¨è€…ï¼Œç”µç¯æ˜¯æŽ¥æ”¶è€…ã€‚åˆ›å»ºä¸€ä¸ªå‘½ä»¤å¹¶å°†æŽ¥æ”¶è€…ä¼ ç»™å‘½ä»¤ï¼Œç„¶åŽå°†å‘½ä»¤ä¼ ç»™è°ƒç”¨è€…ã€‚è¿™æ ·ï¼Œå°†å‘å‡ºè¯·æ±‚çš„å¯¹è±¡å’Œæ‰§è¡Œè¯·æ±‚çš„å¯¹è±¡è§£è€¦ï¼Œé€šè¿‡å‘½ä»¤å¯¹è±¡æ²Ÿé€šã€‚ ä¸€ä¸ªå‘½ä»¤å¯¹è±¡é€šè¿‡åœ¨ç‰¹å®šæŽ¥æ”¶è€…ä¸Šç»‘å®šä¸€ç»„åŠ¨ä½œæ¥å°è£…ä¸€ä¸ªè¯·æ±‚ï¼Œå…¶å®ƒå¯¹è±¡ä¸çŸ¥é“ç©¶ç«Ÿå“ªä¸ªæŽ¥æ”¶è€…è¿›è¡Œäº†å“ªäº›åŠ¨ä½œï¼ŒåªçŸ¥é“è°ƒç”¨executeæ–¹æ³•ï¼Œè¯·æ±‚çš„ç›®çš„å°±èƒ½è¾¾åˆ°ã€‚ æ€»ç»“å‘½ä»¤æ¨¡å¼å°†â€œè¯·æ±‚â€å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—æˆ–è€…æ—¥å¿—æ¥å‚æ•°åŒ–å…¶å®ƒå¯¹è±¡ï¼Œå‘½ä»¤æ¨¡å¼ä¹Ÿæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚ è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯æ°”è±¡ç«™å°†æ•°æ®ä¼ è¾“åˆ°æ˜¾ç¤ºè£…ç½®ä¸Šæ˜¾ç¤º æ–¹æ¡ˆä¸€é”™è¯¯çš„ç¤ºèŒƒ public class WeatherData1 &#123; public void measurementsChanged() &#123; float temp = getTemperature(); float pressure = getPressure(); displayer1.update(temp, pressure); displayer2.update(temp, pressure); &#125; &#125; è¿™æ ·å°±è€¦åˆäº†å…·ä½“çš„å¯¹è±¡displayer1å’Œdisplayer2äº† æ–¹æ¡ˆäºŒåº”ç”¨è§‚å¯Ÿè€… public interface Subject &#123; public void registerObserver(Observer o); public void removeObserver(Observer o); public void notifyObservers(); &#125; public interface Observer &#123; public void update(float temp, float pressure); &#125; public interface DisplayElement &#123; public void display(); &#125; public class WeatherData2 implements Subject &#123; private ArrayList observers; private float temperature; private float pressure; public WeatherData() &#123; observers = new ArrayList(); &#125; public void registerObserver(Observer o) &#123; observers.add(o); &#125; public void removeObserver(Observer o) &#123; int i = observers.indexOf(o); if (i &gt;=0) &#123; observers.remove(i); &#125; &#125; public void notifyObservers() &#123; for (int i = 0; i &lt; observers.size(); i++) &#123; Observer observer = (Observer)observers.get(i); observer.update(temperature, pressure); &#125; &#125; public void measurementsChanged() &#123; notifyObservers(); &#125; public void setMeasurements(float temperature, float pressure) &#123; this.temperature = temperature; this.pressure = pressure; measurementsChanged(); &#125; &#125; public class Displayer1 implements Observer, DisplayElement &#123; private float temperature; private Subject weatherData; public Displayer1(Subject weatherData) &#123; this.weatherData = weatherData; weatherData.registerObserver(this); &#125; public void update(float temperature, float pressure) &#123; this.temperature = temperature; display(); &#125; public void display() &#123; //... æ˜¾ç¤ºçš„å®žçŽ° &#125; &#125; æ–¹æ¡ˆä¸‰è¿˜å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå†…ç½®è§‚å¯Ÿæ–¹å¼å®žçŽ° import java.util.Observable; import java.util.Observer; public class WeatherData3 implements Observable &#123; private float temperature; private float pressure; public WeatherData() &#123; &#125; //ä¸å†éœ€è¦è®°ä½è§‚å¯Ÿè€…çš„æ•°æ®ç»“æž„ public void measurementsChanged() &#123; setChanged(); //é€šçŸ¥è§‚å¯Ÿè€…å‰å…ˆæ ‡è®°çŠ¶æ€æ”¹å˜äº†ï¼ˆç³»ç»ŸAPIï¼‰ notifyObservers(); //é€šçŸ¥è§‚å¯Ÿè€…ï¼ˆç³»ç»ŸAPIï¼‰ &#125; public void setMeasurements(float temperature, float pressure) &#123; this.temperature = temperature; this.pressure = pressure; measurementsChanged(); &#125; &#125; public class Displayer2 implements Observer, DisplayElement &#123; private float temperature; Observable observable; public Displayer1(Observable observable) &#123; this.observable = observable; observable.addObserver(this); &#125; public void update(Observer obs, Object arg) &#123; if (obs instanceof WeatherData3) &#123; WeatherData3 weatherData = (WeatherData3)obs; this.temperature = weatherData.getTemperature(); display(); &#125; &#125; public void display() &#123; //... æ˜¾ç¤ºçš„å®žçŽ° &#125; &#125; å¯è§ç³»ç»Ÿå†…ç½®çš„è§‚å¯Ÿæ–¹å¼ï¼Œå·²ç»å¸®æˆ‘ä»¬å®šä¹‰äº†æ³¨å†Œè§‚å¯Ÿè€…ã€é€šçŸ¥è§‚å¯Ÿè€…åŠå…¶è§¦å‘çš„æ›´æ–°æ–¹æ³•ã€‚åªæ˜¯ç‰¹åˆ«éœ€è¦æ³¨æ„setChanged()è¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨çŠ¶æ€æ”¹å˜åŽå…ˆè°ƒç”¨ï¼ŒåŽå†è°ƒç”¨notifyObservers()ã€‚ æ€»ç»“è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆå››ï¼‰çŠ¶æ€æ¨¡å¼ & ä»£ç†æ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%9B%9B%EF%BC%89%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%20%26%20%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[çŠ¶æ€æ¨¡å¼åº”ç”¨åœºæ™¯åˆ¶ä½œä¸€éƒ¨ç³–æžœæœºï¼Œæ‹¥æœ‰æŠ•é’±ã€é€€é’±ã€æ£€æŸ¥ç³–æžœã€å‘æ”¾ç³–æžœçš„ç¨‹åºã€‚ æ–¹æ¡ˆä¸€åœ¨ä¸åŒçš„æ“ä½œä¸‹ï¼Œå…ˆæ ¹æ®å½“å‰æ‰€åœ¨çš„çŠ¶æ€ä½œå‡ºå¯¹åº”çš„å“åº” public class GumballMachine1 &#123; final static int SOLD_OUT = 0; final static int NO_QUARTER = 1; final static int HAS_QUARTER = 2; final static int SOLD = 3; int state = SOLD_OUT; int count = 0; public GumballMachine(int count) &#123; this.count = count; if (count &gt; 0) &#123; state = NO_QUARTER; &#125; &#125; public void insertQuarter() &#123; if (state == HAS_QUARTER) &#123; System.out.println(&quot;You can&apos;t insert another quarter&quot;); &#125; else if (state == NO_QUARTER) &#123; state = HAS_QUARTER; System.out.println(&quot;You inserted a quarter&quot;); &#125; else if (state == SOLD_OUT) &#123; System.out.println(&quot;You can&apos;t insert a quarter, the machine is sold out&quot;); &#125; else if (state == SOLD) &#123; System.out.println(&quot;Please wait, we&apos;re already giving you a gumball&quot;); &#125; &#125; public void ejectQuarter() &#123; if (state == HAS_QUARTER) &#123; System.out.println(&quot;Quarter returned&quot;); state = NO_QUARTER; &#125; else if (state == NO_QUARTER) &#123; System.out.println(&quot;You haven&apos;t inserted a quarter&quot;); &#125; else if (state == SOLD) &#123; System.out.println(&quot;Sorry, you already turned the crank&quot;); &#125; else if (state == SOLD_OUT) &#123; System.out.println(&quot;You can&apos;t eject, you haven&apos;t inserted a quarter yet&quot;); &#125; &#125; public void turnCrank() &#123; if (state == SOLD) &#123; System.out.println(&quot;Turning twice doesn&apos;t get you another gumball&quot;); &#125; else if (state == NO_QUARTER) &#123; System.out.println(&quot;You turned but there&apos;s no quarter&quot;); &#125; else if (state == SOLD_OUT) &#123; System.out.println(&quot;Your turned, but there are no gumballs&quot;); &#125; else if (state == HAS_QUARTER) &#123; System.out.println(&quot;You turned...&quot;); state = SOLD; dispense(); &#125; &#125; public void dispense() &#123; if (state == SOLD) &#123; System.out.println(&quot;A gumball comes rolling out the slot&quot;); count = count - 1; if (count == 0) &#123; System.out.println(&quot;Oops, out of gumballs&quot;); state = SOLD_OUT; &#125; else &#123; state = NO_QUARTER; &#125; &#125; else if (state == NO_QUARTER) &#123; System.out.println(&quot;You need to pay first&quot;); &#125; else if (state == SOLD_OUT) &#123; System.out.println(&quot;No gumball dispensed&quot;); &#125; else if (state == HAS_QUARTER) &#123; System.out.println(&quot;No gumball dispensed&quot;); &#125; &#125; &#125; åŸºäºŽæ–¹æ¡ˆä¸€ï¼Œå½“è¿™ä¸ªç³–æžœæœºæœ‰æ–°çš„éœ€æ±‚ï¼Œéœ€è¦å¤šåŠ å…¥ä¸€ä¸ªâ€œèµ¢å®¶â€çš„çŠ¶æ€ï¼Œå°±è¦åœ¨æ¯ä¸ªæ–¹æ³•ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„æ¡ä»¶åˆ¤æ–­æ¥å¤„ç†ï¼Œä¸šåŠ¡é€»è¾‘ä¹Ÿä¼šæ›´åŠ æ··ä¹±ã€‚ æ–¹æ¡ˆäºŒå®šä¹‰ä¸€ä¸ªçŠ¶æ€æŽ¥å£ï¼Œå°†æ¯ä¸ªå…·ä½“çš„çŠ¶æ€å°è£…æˆä¸€ä¸ªç±»å®žçŽ°è¯¥æŽ¥å£ public interface State &#123; public void insertQuarter(); public void ejectQuarter(); public void turnCrank(); public void dispense(); &#125; public class NoQuarterState implements State &#123; GumballMachine2 gumballMachine; public NoQuarterState(GumballMachine2 gumballMachine) &#123; this.gumballMachine = gumballMachine; &#125; public void insertQuarter() &#123; System.out.println(&quot;You inserted a quarter&quot;); gumballMachine.setState(gumballMachine.getHasQuarterState()); //è¿™æ ·è®¾ç½®æ˜¯ä¸ºäº†å‡è½»å¯¹å…¶å®ƒçŠ¶æ€ç±»çš„ä¾èµ– &#125; public void ejectQuarter() &#123; System.out.println(&quot;You haven&apos;t inserted a quarter&quot;); &#125; public void turnCrank() &#123; System.out.println(&quot;You turned but there&apos;s no quarter&quot;); &#125; public void dispense() &#123; System.out.println(&quot;You need to pay first&quot;); &#125; &#125; public class WinnerState implements State &#123; public void dispense() &#123; System.out.println(&quot;You&apos;re a winner, you get two gumballs for your quarter&quot;); gumballMachine.releaseBall(); if (gumballMachine.getCount() == 0) &#123; gumballMachine.setState(gumballMachine.getSoldOutState()); &#125; else &#123; gumballMachine.releaseBall(); if (gumballMachine.getCount() &gt; 0) &#123; gumballMachine.setState(gumballMachine.getNoQuarterState()); &#125; else &#123; System.out.println(&quot;Oops, out of gumballs&quot;); gumballMachine.setState(gumballMachine.getSoldOutState()); &#125; &#125; &#125; //... å…¶å®ƒæŽ¥å£æ–¹æ³•å®žçŽ°æŠ¥é”™ä¿¡æ¯ï¼Œå’Œå®žä¾‹å¯¹è±¡ &#125; public class HasQuarterState implements State &#123; Random randomWinner = new Random(System.currentTimeMillis()); public void turnCrank() &#123; System.out.println(&quot;You turned...&quot;); int winner = randomWinner.nextInt(10); if ((winner == 0) &amp;&amp; (gumballMachine.getCount() &gt; 1)) &#123; gumballMachine.setState(gumballMachine.getWinnerState()); &#125; else &#123; gumballMachine.setState(gumballMachine.getSoldState()); &#125; &#125; //... å…¶å®ƒæŽ¥å£æ–¹æ³•å®žçŽ°æŠ¥é”™ä¿¡æ¯ï¼Œå’Œå®žä¾‹å¯¹è±¡ &#125; //åŒç†ï¼Œå†å®žçŽ°å…¶å®ƒçŠ¶æ€ç±»ã€‚ public class GumballMachine2 &#123; State soldOutState; State noQuarterState; State hasQuarterState; State soldState; State winnerState; State state = soldOutState; int count = 0; public GumballMachine(int numberGumballs) &#123; soldOutState = new SoldOutState(this); noQuarterState = new NoQuarterState(this); hasQuarterState = new HasQuarterState(this); soldState = new SoldState(this); this.count = numberGumballs; if (numberGumballs &gt; 0) &#123; state = noQuarterState; &#125; &#125; public void insertQuarter() &#123; state.insertQuarter(); &#125; public void ejectQuarter() &#123; state.ejectQuarter(); &#125; public void turnCrank() &#123; state.turnCrank(); state.dispense(); &#125; void setState(State state) &#123; this.state = state; &#125; int getCount() &#123; return this.count; &#125; void releaseBall() &#123; System.out.println(&quot;A gumball comes rolling out the slot&quot;); if (count != 0) &#123; count = count - 1; &#125; &#125; &#125; ç»è¿‡æ–¹æ¡ˆäºŒçš„ä¼˜åŒ–åŽï¼Œå°†çŠ¶æ€å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œå¹¶å°†åŠ¨ä½œå§”æ‰˜åˆ°ä»£è¡¨å½“å‰çŠ¶æ€çš„å¯¹è±¡ã€‚è€Œæ•´ä½“ä»£ç åˆ™æ¸…æ™°ç®€æ´äº†ï¼Œä»£ç é€»è¾‘çš„åˆ’åˆ†æ›´åˆ°ä½(å±€éƒ¨åŒ–)ï¼Œæ›´æ”¹ä»£ç æ–¹ä¾¿ä¸”ä¸æ˜“å½±å“å…¶å®ƒçŠ¶æ€ã€‚ æ€»ç»“çŠ¶æ€æ¨¡å¼å…è®¸å¯¹è±¡åŸºäºŽå†…éƒ¨çŠ¶æ€è€Œæ‹¥æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œåœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚ä½†çŠ¶æ€æ¨¡å¼æ˜¯é€šè¿‡å¢žåŠ ç±»çš„æ•°ç›®ä»£ä»·æ¥èŽ·å–å¼¹æ€§çš„ã€‚ å»¶ä¼¸ï¼Œå’Œç­–ç•¥æ¨¡å¼å¯¹æ¯”ï¼Œä¸»è¦æ˜¯ä»–ä»¬çš„æ„å›¾ä¸ä¸€æ ·ï¼ˆä»–ä»¬çš„ç±»å›¾æ˜¯ä¸€è‡´çš„ï¼‰ï¼Œç­–ç•¥æ¨¡å¼é€šå¸¸ä¼šç”¨è¡Œä¸ºæˆ–ç®—æ³•æ¥é…ç½®Contextç±»ï¼ŒçŠ¶æ€æ¨¡å¼å…è®¸Contextéšç€çŠ¶æ€æ”¹å˜è€Œæ”¹å˜è¡Œä¸ºã€‚ ä»£ç†æ¨¡å¼åº”ç”¨åœºæ™¯å¯¹ç³–æžœæœºçš„é”€å”®æƒ…å†µåšç›‘æŽ§ é¦–å…ˆè§£é‡Šä¸€ä¸‹ï¼Œè¿™é‡Œçš„ä»£ç†å’ŒObjective-Cä¸­æ‰€è¯´çš„ä»£ç†ï¼ˆDelegateï¼‰æ˜¯æœ‰åŒºåˆ«çš„ï¼Œåœ¨ä¸‹é¢çš„å»¶ä¼¸éƒ¨åˆ†å†åšè¯¦ç»†è¯´æ˜Žã€‚ //æœåŠ¡ç«¯çš„å®žçŽ° import java.rmi.*; import java.io.*; import java.rmi.server.*; public interface GumballMachineRemote extends Remote &#123; public int getCount() throws RemoteException; //å› ä¸ºæ˜¯è¿œç¨‹æ“ä½œï¼Œæ‰€ä»¥å¾—å£°æ˜Žå¼‚å¸¸ public String getLocation() throws RemoteException; public State getState() throws RemoteException; &#125; public interface State extends Serializable &#123; //åªæœ‰æ‰©å±•äº†åºåˆ—åŒ–æŽ¥å£æ‰å¯ä»¥åœ¨ç½‘ç»œä¸Šä¼ é€ public void insertQuarter(); public void ejectQuarter(); public void turnCrank(); public void dispense(); &#125; public class NoQuarterState implements State &#123; transient GumballMachine3 gumballMachine; //ä¸ºäº†ä¸è®©GumballMachineåŠ å…¥åˆ°åºåˆ—åŒ–ï¼Œä½¿ç”¨transientå…³é”®å­—ä¿®é¥°å„ä¸ªStateå®žçŽ°ç±»ä¸­çš„è¯¥å®žä¾‹å˜é‡ //... å…¶å®ƒæ–¹æ³•çš„å®žçŽ° &#125; //è®©GumballMachineç»§æ‰¿UnicastRemoteObjectï¼Œä½¿å…¶æˆä¸ºè¿œç¨‹æœåŠ¡ public class GumballMachine3 extends UnicastRemoteObject implements GumballMachineRemote &#123; public GumballMachine(String location, int numberGumballs) throws RemoteException &#123; //... &#125; //... GumballMachineRemoteè¿œç¨‹æŽ¥å£çš„å®žçŽ°ï¼Œrmiç³»ç»Ÿä¼šè‡ªåŠ¨é’ˆå¯¹è¿™äº›æŽ¥å£ç”Ÿæˆå¯è¢«è¿œç¨‹è®¿é—®çš„æ–¹æ³• &#125; //å®¢æˆ·ç«¯çš„å®žçŽ° public class GumballMonitor &#123; GumballMachineRemote machine; public GumballMonitor(GumballMachineRemote machine) &#123; this.machine = machine; &#125; public void report() &#123; try &#123; System.out.println(machine.getLocation()); System.out.println(machine.getCount()); System.out.println(machine.getState()); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; &#125; //æµ‹è¯•ç¨‹åº public class test1 &#123; void test() throws Exception &#123; try &#123; GumballMachineRemote machine = (GumballMachineRemote) Naming.lookup(&quot;rmi://xx.xx.com/gumballmachine&quot;); GumballMonitor monitor = new GumballMonitor(machine); monitor.report(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125; è¿™é‡Œï¼ŒGumballMachineRemoteå°±æ˜¯ä¸€ä¸ªè¿œç¨‹ä»£ç†ã€‚ æ€»ç»“ä»£ç†æ¨¡å¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªæ›¿èº«æˆ–å ä½ç¬¦ä»¥è®¿é—®è¿™ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿æŽ§åˆ¶æˆ–ç®¡ç†è®¿é—®ã€‚ å»¶ä¼¸ï¼Œä»£ç†è¿˜æœ‰å¾ˆå¤šå˜ä½“ï¼Œä¾‹å¦‚è™šæ‹Ÿä»£ç†ï¼ˆæŽ§åˆ¶è®¿é—®å®žä¾‹åŒ–å¼€é”€å¤§çš„å¯¹è±¡ï¼‰ã€ä¿æŠ¤ä»£ç†ï¼ˆåŸºäºŽè°ƒç”¨è€…æŽ§åˆ¶å¯¹è±¡æ–¹æ³•çš„è®¿é—®ï¼‰ã€é˜²ç«å¢™ä»£ç†ã€ç¼“å­˜ä»£ç†ç­‰ã€‚ ä»£ç†æ¨¡å¼ä¸Žè£…é¥°è€…æ¨¡å¼çš„åŒºåˆ«ï¼Œè£…é¥°è€…æ¨¡å¼åªèƒ½è£…é¥°ç‚¹ç¼€ï¼Œä¸ä¼šå®žä¾‹åŒ–ä»»ä½•å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸ºå¯¹è±¡åŠ ä¸Šè¡Œä¸ºï¼Œè€Œä»£ç†åˆ™æ˜¯é€šè¿‡åˆ›å»ºä»£ç†å¯¹è±¡æŽ§åˆ¶è®¿é—®ã€‚ Objective-Cä¸­çš„ä»£ç†æ˜¯æŒ‡å®žçŽ°ä¸€ä¸ªåè®®ï¼ˆæŽ¥å£ï¼‰çš„å¯¹è±¡ï¼Œé€šè¿‡å§”æ‰˜è¿™ä¸ªå¯¹è±¡åŽ»æ‰§è¡Œåè®®ä¸­çš„æ–¹æ³•ï¼Œè€Œæ— éœ€å…³ç³»è¯¥å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œä½†å®ƒå¹¶æ²¡æœ‰æ˜¯è°çš„æ›¿èº«æˆ–å ä½ç¬¦çš„æ„æ€ï¼Œä¹Ÿä¸æ˜¯ç”¨äºŽæŽ§åˆ¶è®¿é—®ã€‚ Javaå†…ç½®çš„ä»£ç†æ”¯æŒå¯å»ºç«‹åŠ¨æ€ä»£ç†(åå°„)ï¼Œå°†è°ƒç”¨åˆ†é…åˆ°æ‰€é€‰çš„å¤„ç†å™¨ï¼Œä¸‹é¢å†æä¾›ä¸€ä¸ªç”¨åŠ¨æ€ä»£ç†çš„å®žçŽ°ä¿æŠ¤ä»£ç†ä¾‹å­ public interface PersonBean &#123; void setName(String name);//æƒ³è¦æŽ§åˆ¶åˆ«äººä¸èƒ½è®¾ç½®ï¼Œè‡ªå·±èƒ½è®¾ç½® void setHotOrNotRating(int rating);//æƒ³è¦æŽ§åˆ¶è‡ªå·±ä¸èƒ½è®¾ç½®ï¼Œåˆ«äººèƒ½è®¾ç½® &#125; public class PersonBeanImpl implements PersonBean &#123; String name; int rating; public void setName(String name) &#123; this.name = name; &#125; public void setHotOrNotRating(int rating) &#123; this.rating += rating; &#125; &#125; //import java.lang.reflect.* public class OwnerInvocationHandler implements InvocationHandler &#123; PersonBean person; public OwnerInvocationHandler(PersonBean person) &#123; this.person = person; &#125; //åŠ¨æ€ä»£ç†çš„ä»»ä½•æŽ¥å£æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè°ƒç”¨è¯¥invokeæ–¹æ³• public Object invoke(Object proxy, Method method, Object[] args) throws IllegalAccessException &#123; try &#123; if (method.getName().startWith(&quot;get&quot;)) &#123; return method.invoke(person,args); &#125; else if (method.getName().equals(&quot;setHotOrNotRating&quot;)) &#123; throw new IllegalAccessException(); &#125; else if (method.getName().startWith(&quot;set&quot;)) &#123; return method.invoke(person,args); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null; &#125; &#125; public class NoOwnerInvocationHandler implements InvocationHandler &#123; PersonBean person; public OwnerInvocationHandler(PersonBean person) &#123; this.person = person; &#125; public Object invoke(Object proxy, Method method, Object[] args) throws IllegalAccessException &#123; try &#123; if (method.getName().startWith(&quot;get&quot;)) &#123; return method.invoke(person,args); &#125; else if (method.getName().equals(&quot;setHotOrNotRating&quot;)) &#123; return method.invoke(person,args); //ä¸ŽOwnerInvocationHandlerç›¸å &#125; else if (method.getName().startWith(&quot;set&quot;)) &#123; throw new IllegalAccessException(); //ä¸ŽOwnerInvocationHandlerç›¸å &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null; &#125; &#125; //è¿™æ ·å°±æ— éœ€é¢å¤–å®šä¹‰ä»£ç†ç±»ï¼Œåœ¨ä½¿ç”¨æ—¶é€šè¿‡ä¸‹é¢çš„Javaå†…ç½®ä»£ç†æ”¯æŒæ–¹æ³•èŽ·å–åŠ¨æ€çš„ä»£ç† public class test2 &#123; PersonBean getOwnerProxy(PersonBean person) &#123; return (PersonBean) Proxy.newProxyInstance(person.getClass().getClassLoader(),person.getClass().getInterfaces(),new OwnerInvocationHandler(person)); &#125; PersonBean getNoOwnerProxy(PersonBean person) &#123; return (PersonBean) Proxy.newProxyInstance(person.getClass().getClassLoader(),person.getClass().getInterfaces(),new NoOwnerInvocationHandler(person)); &#125; &#125;]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆäº”ï¼‰å·¥åŽ‚æ¨¡å¼ & è£…é¥°è€…æ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%BA%94%EF%BC%89%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%20%26%20%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å·¥åŽ‚æ¨¡å¼åº”ç”¨åœºæ™¯åˆ›å»ºä¸åŒç±»åž‹çš„æŠ«è¨å¯¹è±¡ æ–¹æ¡ˆä¸€ç›´æŽ¥newå‡ºå…·ä½“ç±»åž‹çš„å¯¹è±¡ public class PizzaStore1 &#123; Pizza orderPizza(String type) &#123; Pizza pizza; if (type.equals(&quot;cheese&quot;)) &#123; pizza = new CheesePizza(); &#125; else if (type.equals(&quot;clam&quot;)) &#123; pizza = new ClamPizza(); &#125; pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); return pizza; &#125; &#125; æ–¹æ¡ˆäºŒå°†å…·ä½“(ç›´æŽ¥è€¦åˆã€å®žçŽ°)çš„ã€ä¼šå˜åŒ–çš„åˆ›å»ºå¯¹è±¡éƒ¨åˆ†æŠ½ç¦»ï¼ŒåŒ…è£…è¿›ä¸€ä¸ªç±»ï¼Œè¿™å¸¸è¢«ç§°ä¸ºâ€œé™æ€å·¥åŽ‚â€ï¼ˆæˆ–å«â€œç®€å•å·¥åŽ‚â€ï¼‰ã€‚å®ƒçš„ç¼ºç‚¹æ˜¯ä¸èƒ½é€šè¿‡ç»§æ‰¿æ¥æ”¹å˜åˆ›å»ºæ–¹æ³•çš„è¡Œä¸ºã€‚ public class PizzaStore2 &#123; SimplePizzaFactory factory; public PizzaStore(SimplePizzaFactory factory) &#123; this.factory = factory; &#125; Pizza orderPizza(String type) &#123; Pizza pizza = factory.createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); return pizza; &#125; &#125; public class SimplePizzaFactory &#123; public Pizza createPizza(String type) &#123; Pizza pizza = null; if (type.equals(&quot;cheese&quot;)) &#123; pizza = new CheesePizza(); &#125; else if (type.equals(&quot;clam&quot;)) &#123; pizza = new ClamPizza(); &#125; return pizza; &#125; &#125; é€šè¿‡æ–¹æ¡ˆäºŒå°è£…å‡ºæ¥çš„åˆ›å»ºæŠ«è¨ç®€å•å·¥åŽ‚ï¼Œå°†å…·ä½“çš„å®žçŽ°è§£è€¦å‡ºæ¥åªä¾èµ–æŽ¥å£äº†ï¼Œå…¶å®ƒåˆ†åº—ä¹Ÿå¯ä»¥å¤ç”¨äº†ï¼Œä¿®æ”¹è¦åˆ›å»ºçš„ç±»åž‹æ—¶ä¹Ÿæ›´å°é—­ã€‚ å‡è‹¥PizzaStoreå¼€å§‹æžåŠ ç›Ÿåº—ï¼Œä¸åŒçš„åŠ ç›Ÿåº—ä¼šæ ¹æ®å½“åœ°çš„å£å‘³è°ƒæ•´æä¾›Pizzaçš„ç§ç±»ï¼Œåœ¨ç®€å•å·¥åŽ‚ä¸­å†æ ¹æ®å¤šä¸€ä¸ªåœ°åŒºæ ‡è¯†åŽ»åˆ¤æ–­å°±ä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œè€¦åˆè¶Šæ¥è¶Šä¸¥é‡ã€‚ æ–¹æ¡ˆä¸‰ä½¿ç”¨â€œå·¥åŽ‚æ–¹æ³•â€ï¼Œæ¥ç›‘æŽ§åˆ›å»ºçš„æŠ«è¨è´¨é‡ï¼ˆå½“ç„¶è¿˜æ˜¯å¯ä»¥ç»§æ‰¿æ–¹æ¡ˆäºŒä¸­çš„ç®€å•å·¥åŽ‚ï¼Œæä¾›ä¸åŒçš„å­ç±»å·¥åŽ‚ç»™PizzaStoreæ¥åˆ›å»ºï¼Œè¿™ä¹Ÿæ˜¯å·¥åŽ‚æ–¹æ³•ï¼Œä½†PizzaStoreå°±æ— æ³•è¿‡å¤šåœ°å¹²é¢„åˆ›å»ºçš„è¿‡ç¨‹ï¼‰ public abstract class PizzaStore3 &#123; public Pizza orderPizza(String type) &#123; Pizza pizza; pizza = createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); return pizza; &#125; abstract Pizza createPizza(String type); &#125; public class NYPizzaStore3 extends PizzaStore3 &#123; Pizza createPizza(String type) &#123; if (type.equals(&quot;cheese&quot;)) &#123; return new NYStyleCheesePizza(); &#125; else if (type.equals(&quot;clam&quot;)) &#123; return new NYStyleClamPizza(); &#125; &#125; &#125; public class ChicagoPizzaStore3 extends PizzaStore3 &#123; Pizza createPizza(String type) &#123; if (type.equals(&quot;cheese&quot;)) &#123; return new ChicagoStyleCheesePizza(); &#125; else if (type.equals(&quot;clam&quot;)) &#123; return new ChicagoStyleClamPizza(); &#125; &#125; &#125; å·¥åŽ‚æ–¹æ³•(æ¨¡å¼)é€šè¿‡è®©å­ç±»å†³å®šè¯¥åˆ›å»ºçš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œè¾¾åˆ°å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹å°è£…çš„ç›®çš„ã€‚ è¿™é‡Œè¿˜æ¶‰åŠä¸€ä¸ªæ¶‰åŠåŽŸåˆ™â€œåä¾èµ–å€’ç½®åŽŸåˆ™â€ï¼Œå¯ä»¥æŒ‰ä¸‹é¢ä¸‰ç‚¹æ–¹é’ˆåŽ»éµå¾ªï¼š1ï¼‰å˜é‡ä¸å¯ä»¥æŒæœ‰å…·ä½“ç±»çš„å¼•ç”¨ï¼›2ï¼‰ä¸è¦è®©ç±»æ´¾ç”Ÿè‡ªå…·ä½“ç±»ï¼›3ï¼‰ä¸è¦è¦†ç›–åŸºç±»ä¸­å·²å®žçŽ°çš„æ–¹æ³•ã€‚ ä¸Šé¢çš„æ–¹æ¡ˆäºŒå’Œæ–¹æ¡ˆä¸‰ä¸­çš„å·¥åŽ‚æˆ–è€…å·¥åŽ‚æ–¹æ³•ä¸­ï¼Œéƒ½è¿˜æ˜¯ä¾èµ–äº†å…·ä½“ç±»(å³ NY or Chicago è¿™ä¸¤ä¸ªåœ°åŒºç§ç±»çš„æŠ«è¨)ï¼Œå¹¶ä¸ç¬¦åˆâ€œåä¾èµ–å€’ç½®åŽŸåˆ™â€ï¼Œè‹¥æœªæ¥é™¤cheeseå’Œclamå¤–è¿˜å¤šäº†3ç§æŠ«è¨ï¼Œé‚£è¿™ä¸¤ä¸ªåœ°åŒºçš„æŠ«è¨æ€»å’Œå°±ä»Ž4ä¸ªå¢žè‡³10ä¸ª æ–¹æ¡ˆå››ä¼˜åŒ–å·¥åŽ‚ä¸­çš„ä¾èµ–å…³ç³» public interface PizzaIngredientFactory &#123; public Dough createDough(); public Sauce createSauce(); &#125; public class NYPizzaIngredientFactory implements PizzaIngredientFactory &#123; public Dough createDough() &#123; return new ThinCrustDough(); &#125; public Sauce createSauce() &#123; return new MarinaraSauce(); &#125; &#125; public class ChicagoPizzaIngredientFactory implements PizzaIngredientFactory &#123; public Dough createDough() &#123; return new ThickCrustDough(); &#125; public Sauce createSauce() &#123; return new PlumTomatoSauce(); &#125; &#125; public abstract class Pizza &#123; String name; Dough dough; Sauce sauce; abstract void prepare(); //... å…¶å®ƒæ–¹æ³• &#125; public class CheesePizza extends Pizza &#123; PizzaIngredientFactory ingredientFactory; public CheesePizza(PizzaIngredientFactory ingredientFactory) &#123; this.ingredientFactory = ingredientFactory; &#125; void prepare() &#123; //æŠ½è±¡å·¥åŽ‚åœ¨æ­¤èµ·å…³é”®ä½œç”¨äº† dough = ingredientFactory.createDough(); sauce = ingredientFactory.createSauce(); &#125; //... å…¶å®ƒæ–¹æ³• &#125; public class ClamPizza extends Pizza &#123; PizzaIngredientFactory ingredientFactory; public ClamPizza(PizzaIngredientFactory ingredientFactory) &#123; this.ingredientFactory = ingredientFactory; &#125; void prepare() &#123; dough = ingredientFactory.createDough(); sauce = ingredientFactory.createSauce(); &#125; //... å…¶å®ƒæ–¹æ³• &#125; public class NYPizzaStore4 extends PizzaStore3 &#123; protected Pizza createPizza(String type) &#123; Pizza pizza = null; PizzaIngredientFactory ingredientFactory = new NYPizzaIngredientFactory(); if (type.equals(&quot;cheese&quot;)) &#123; //ï¼ˆé—´æŽ¥ï¼‰åº”ç”¨æŠ½è±¡å·¥åŽ‚ï¼ˆä¼ ç»™äº§å“æ¥ä½¿ç”¨ï¼‰ pizza = new CheesePizza(ingredientFactory); &#125; else if (type.equals(&quot;clam&quot;)) &#123; pizza = new ClamPizza(ingredientFactory); &#125; return pizza; &#125; &#125; public class ChicagoPizzaStore4 extends PizzaStore3 &#123; protected Pizza createPizza(String type) &#123; Pizza pizza = null; PizzaIngredientFactory ingredientFactory = new ChicagoPizzaIngredientFactory(); if (type.equals(&quot;cheese&quot;)) &#123; pizza = new CheesePizza(ingredientFactory); &#125; else if (type.equals(&quot;clam&quot;)) &#123; pizza = new ClamPizza(ingredientFactory); &#125; return pizza; &#125; &#125; è¿™ä¸ªå°±æ˜¯â€œæŠ½è±¡å·¥åŽ‚æ¨¡å¼â€ï¼Œé€šè¿‡é‡‡å–å¯¹è±¡çš„ç»„åˆçš„æ–¹å¼å®žçŽ°ï¼ˆå·¥åŽ‚ä¸Žäº§å“ç»„åˆï¼Œäº§å“ä½¿ç”¨ä¸åŒçš„å·¥åŽ‚åˆ›å»ºé…ä»¶æ—ï¼‰ï¼ŒçŽ°åœ¨å³ä½¿æŠ«è¨çš„åŸºæœ¬ç§ç±»å¢žè‡³5ä¸ªï¼Œä¹Ÿä¸è‡³äºŽè¦å¦å¤–ä¸º2ä¸ªä¸åŒåœ°åŒºåŒæ—¶æ–°å¢ž6(2x3)ç§åœ°åŒºæ€§æŠ«è¨ï¼Œä¹Ÿå°±æ˜¯è¯´ç±»çš„å¢žé‡åªæœ‰åŸºæœ¬ç§ç±»çš„3ä¸ªæ–°æŠ«è¨ã€‚ åŒæ—¶å¯ä»¥çœ‹åˆ°ï¼ŒNYPizzaIngredientFactoryå’ŒChicagoPizzaIngredientFactoryé‡Œå…¶å®žéƒ½ç”¨åˆ°äº†â€œå·¥åŽ‚æ–¹æ³•æ¨¡å¼â€ï¼Œåªæ˜¯æ–¹æ³•ä¸æ­¢ä¸€ä¸ªï¼Œè€Œæ˜¯åŒ…æ‹¬äº†åˆ›å»ºè¿™ä¸ªäº§å“çš„å®¶æ—çš„å¤šä¸ªæ–¹æ³•ã€‚ æ€»ç»“å·¥åŽ‚æ–¹æ³•æ¨¡å¼æ˜¯å®šä¹‰å‡ºä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æŽ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šè¦å®žä¾‹åŒ–çš„ç±»æ˜¯å“ªä¸€ä¸ªï¼Œè®©ç±»æŠŠå®žä¾‹åŒ–æŽ¨è¿Ÿåˆ°å­ç±»ã€‚æŠ½è±¡å·¥åŽ‚æ¨¡å¼æä¾›ä¸€ä¸ªæŽ¥å£ï¼Œç”¨äºŽåˆ›å»ºç›¸å…³æˆ–è€…ä¾èµ–å¯¹è±¡çš„å®¶æ—ï¼Œè€Œä¸éœ€è¦æ˜Žç¡®æŒ‡å®šå…·ä½“ç±»ã€‚ è£…é¥°è€…æ¨¡å¼åº”ç”¨åœºæ™¯è®¡ç®—æœ‰nç§è°ƒæ–™å¯æ·»åŠ çš„é¥®å“çš„ä»·æ ¼ æ–¹æ¡ˆä¸€ä¸ºæ¯ç§è°ƒæ–™éƒ½åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„å¸ƒå°”å€¼ï¼Œç”¨äºŽåœ¨è®¡ä»·æ—¶åˆ¤æ–­æ˜¯å¦ç®—ä¸Šå¯¹åº”è°ƒæ–™çš„ä»·æ ¼ã€‚ æ­¤æ–¹æ¡ˆå°±ä¸è´´ä»£ç å‡ºæ¥äº†ï¼Œå› ä¸ºå¤ªå¤šçš„if-elseï¼Œæ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ã€‚ï¼ˆè‹¥ä¸ä½¿ç”¨è¯¥æ–¹æ¡ˆï¼Œä¹Ÿåº”è¯¥ä¸è‡³äºŽå¯¹æ¯ä¸ªè°ƒæ–™åˆ›å»ºä¸€ä¸ªå­ç±»æ¥è§£å†³if-elseå¤šçš„é—®é¢˜å§ï¼‰ æ–¹æ¡ˆäºŒå°†ä¸åŒçš„è°ƒæ–™å®šä¸ºä¸åŒçš„è£…é¥°è€…ï¼Œå°†é¥®å“å®šä¸ºè¢«è£…é¥°è€…ï¼Œæ ¹æ®éœ€è¦å¯åŒ…è£¹å¤šå±‚çš„è£…é¥°(å³æ·»åŠ å¤šç§è°ƒæ–™) public abstract class Beverage &#123; //å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯æŽ¥å£ String description = &quot;Unknown beverage&quot;; public String getDescription() &#123; return description; &#125; public abstract double cost(); &#125; public abstract class CondimentDecorator extends Beverage &#123; public abstract String getDescription(); &#125; //åŸºç¡€é¥®å“ï¼ˆç¬¬ä¸€å±‚è¢«è£…é¥°çš„ï¼‰ public class Espresso extends Beverage &#123; public Espresso() &#123; description = &quot;Espresso&quot;; &#125; public double cost() &#123; return 1.99; &#125; &#125; public class HouseBlend extends Beverage &#123; public HouseBlend() &#123; description = &quot;HouseBlend&quot;; &#125; public double cost() &#123; return 0.89; &#125; &#125; //è°ƒæ–™ï¼ˆ/é¥®å“ï¼Œç¬¬nå±‚è¢«è£…é¥°çš„ï¼Œä¹Ÿæ˜¯è£…é¥°ç¬¬n-1å±‚çš„ï¼‰ public class Mocha extends CondimentDecorator &#123; Beverage beverage; public Mocha(Beverage beverage) &#123; this.beverage = beverage; &#125; public String getDescription() &#123; return beverage.getDescription() + &quot;, Mocha&quot;; &#125; public double cost() &#123; return 0.20 + beverage.cost(); &#125; &#125; è£…é¥°è€…å¯ä»¥åœ¨è¢«è£…é¥°è€…çš„è¡Œä¸ºå‰é¢æˆ–/ä¸ŽåŽé¢åŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºï¼Œç”šè‡³å°†è¢«è£…é¥°è€…çš„è¡Œä¸ºæ•´ä¸ªå–ä»£æŽ‰ï¼Œè€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚ å¯ä»¥ä½¿ç”¨æ— æ•°ä¸ªè£…é¥°è€…åŽ»åŒ…è£…ä¸€ä¸ªç»„ä»¶ï¼Œå› ä¸ºè£…é¥°è€…ä¸€èˆ¬å¯¹ç»„ä»¶çš„å®¢æˆ·æ˜¯é€æ˜Žçš„ï¼Œé™¤éžå®¢æˆ·ä¾èµ–çš„ç»„ä»¶æ˜¯å…·ä½“ç±»åž‹ï¼Œå½“ç„¶ç®€å•çš„åªåŒ…ä¸€å±‚ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆä¸ä¸€å®šè¦ä½¿ç”¨ä¸Šé¢ä¾‹å­ä¸­çš„åµŒå¥—åŒç±»çš„å®žä¾‹å¯¹è±¡åœ¨ç±»ä¸­ï¼‰ã€‚ æ€»ç»“è£…é¥°è€…æ¨¡å¼åŠ¨æ€åœ°å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œè‹¥è¦æ‰©å±•åŠŸèƒ½ï¼Œè£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚è¿™æ˜¯ä¸€ä¸ªç¬¦åˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­åŽŸåˆ™çš„æ¨¡å¼ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆä¸‰ï¼‰é€‚é…å™¨æ¨¡å¼ & å¤–è§‚æ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%89%EF%BC%89%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%20%26%20%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[é€‚é…å™¨æ¨¡å¼åº”ç”¨åœºæ™¯é¸­å­ä¸­æœ‰ç»¿å¤´é¸­ã€çº¢å¤´é¸­ç­‰ï¼ŒçŽ°åœ¨è¿˜ç¼ºä¸€ç‚¹é¸­å­çš„å“ç§ï¼Œæƒ³ç”¨ç«é¸¡å†’å……é¸­å­ã€‚ public interface Duck &#123; public void quack(); public void fly(); &#125; //ç»¿å¤´é¸­ public class MallardDuck implements Duck &#123; public void quack() &#123; System.out.println(&quot;Quack&quot;); &#125; public void fly() &#123; System.out.println(&quot;I&apos;m flying&quot;); &#125; &#125; //ç«é¸¡ public interface Turkey &#123; public void gobble(); public void fly(); &#125; public class WildTurkey implements Turkey &#123; public void gobble() &#123; System.out.println(&quot;Gobble gobble&quot;); &#125; public void fly() &#123; System.out.println(&quot;I&apos;m flying a short distance&quot;); &#125; &#125; //é€‚é…å™¨ public class TurkeyAdapter implements Duck &#123; Turkey turkey; public TurkeyAdapter(Turkey turkey) &#123; this.turkey = turkey; &#125; public void quack() &#123; turkey.gobble(); &#125; public void fly() &#123; for (int i=0; i &lt; 5; i++) &#123; turkey.fly(); &#125; &#125; &#125; å®¢æˆ·é€šè¿‡ç›®æ ‡æŽ¥å£è°ƒç”¨é€‚é…å™¨çš„æ–¹æ³•å¯¹é€‚é…å™¨å‘å‡ºè¯·æ±‚ï¼Œé€‚é…å™¨ä½¿ç”¨è¢«é€‚é…è€…æŽ¥å£æŠŠè¯·æ±‚è½¬æ¢æˆè¢«é€‚é…è€…çš„ä¸€ä¸ªæˆ–å¤šä¸ªè°ƒç”¨æŽ¥å£ï¼Œå®¢æˆ·æŽ¥æ”¶åˆ°è°ƒç”¨çš„ç»“æžœï¼Œä½†å¹¶æœªå¯Ÿè§‰è¿™ä¸€åˆ‡æ˜¯é€‚é…å™¨åšèµ·è½¬æ¢ä½œç”¨ã€‚ é€‚é…å™¨æ¨¡å¼æ˜¯å°†ä¸€ä¸ªç±»çš„æŽ¥å£ï¼Œè½¬æ¢æˆå®¢æˆ·æœŸæœ›çš„å¦ä¸€ä¸ªæŽ¥å£ã€‚é€‚é…å™¨è®©åŽŸæœ¬æŽ¥å£ä¸å…¼å®¹çš„ç±»å¯ä»¥åˆä½œæ— é—´ã€‚ æ€»ç»“å½“éœ€è¦ä½¿ç”¨çŽ°æœ‰çš„ç±»è€Œå…¶æŽ¥å£ä¸ç¬¦åˆéœ€è¦æ—¶ï¼Œä½¿ç”¨é€‚é…å™¨ã€‚ å»¶ä¼¸ï¼Œé€‚é…å™¨æ¨¡å¼æœ‰ä¸¤ç§å½¢å¼ï¼Œå¯¹è±¡é€‚é…å’Œç±»é€‚é…ï¼Œç±»é€‚é…å…¶å®žå°±æ˜¯ç”¨(java)å¤šé‡ç»§æ‰¿å®žçŽ°ï¼Œæ•ˆæžœä¸€æ ·ä½†ä¸å¤Ÿçµæ´»ã€‚å’Œè£…é¥°è€…æ¯”è¾ƒï¼Œé€‚é…å™¨æ˜¯åŒ…è£…äº†ä¸€ä¸ªå¯¹è±¡å¹¶æ”¹å˜å®ƒçš„æŽ¥å£ï¼Œè£…é¥°è€…æ˜¯å°†å¯¹è±¡åŒ…è£…èµ·æ¥åŽå¢žåŠ æ–°è¡Œä¸ºå’Œè´£ä»»ã€‚ å¤–è§‚æ¨¡å¼åº”ç”¨åœºæ™¯ å‡è®¾æƒ³çœ‹ä¸€å‡ºç”µå½±å¤§ç‰‡ï¼Œä½†çœ‹ä¹‹å‰è¦å‡†å¤‡ä¸€å¤§å †æ“ä½œï¼Œæ‰§è¡Œå¦‚ä¸‹ popper.on(); popper.pop(); lights.dim(10); screen.down(); projector.on(); projector.setInput(dvd); projector.wideScreenMode(); amp.on(); amp.setDvd(dvd); amp.setSurroundSound(); amp.setVolume(5); dvd.on(); dvd.play(movie); å½“ä½ æƒ³å…³é—­æ—¶ï¼Œåˆæ˜¯ä¸€å †æ“ä½œã€‚ æˆ‘ä»¬ä½¿ç”¨ç»„åˆçš„æ–¹å¼å°†å„ä¸ªå­ç³»ç»Ÿæ±‡é›†èµ·æ¥ï¼Œç„¶åŽå®žçŽ°ç»Ÿä¸€ä¸ªçš„æŽ¥å£æ¥ä¼˜åŒ– public class HomeTheaterFacade &#123; Amplifier amp; Tuner tuner; DvdPlayer dvd; CdPlayer cd; Projector projector; TheaterLights lights; Screen screen; PopcornPopper popper; public HomeTheaterFacade(Amplifier amp,Tuner tuner,DvdPlayer dvd,CdPlayer cd,Projector projector,Screen screen,TheaterLights lights,PopcornPopper popper) &#123; this.amp = amp; this.tuner = tuner; this.dvd = dvd; this.cd = cd; this.projector = projector; this.screen = screen; this.lights = lights; this.popper = popper; &#125; public void watchMovie(String movie) &#123; System.out.println(&quot;Get ready to watch a movie ... &quot;); popper.on(); popper.pop(); lights.dim(10); screen.down(); projector.on(); projector.setInput(dvd); projector.wideScreenMode(); amp.on(); amp.setDvd(dvd); amp.setSurroundSound(); amp.setVolume(5); dvd.on(); dvd.play(movie); &#125; public void endMovie() &#123; System.out.println(&quot;Shutting movie theater down ... &quot;); popper.off(); lights.on(); screen.up(); projector.off(); amp.off(); dvd.stop(); dvd.eject(); dvd.off(); &#125; &#125; è¿™æ ·å°±å®žçŽ°äº†å¤–è§‚æ¨¡å¼äº†ã€‚å¤–è§‚æ¨¡å¼æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æŽ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æŽ¥å£ã€‚å¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æŽ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªåŒ…è£…äº†å¤šä¸ªè¢«é€‚é…è€…çš„é€‚é…å™¨ã€‚ å¤–è§‚æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼çš„è®¾è®¡åŽŸåˆ™æ˜¯ï¼Œæœ€å°‘çŸ¥è¯†åŽŸåˆ™ï¼ˆåˆå«â€œå¢¨å¿’è€³æ³•åˆ™â€ï¼‰ï¼Œåªå’Œä½ çš„å¯†å‹è°ˆè¯ï¼Œä¸è¦è®©å¤ªå¤šçš„ç±»è€¦åˆåœ¨ä¸€èµ·ï¼Œé¿å…ä¿®æ”¹ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†è€Œå½±å“åˆ°å…¶å®ƒéƒ¨åˆ†ã€‚ å†ä¸¾ä¸€äº›é¿å…è€¦åˆè¿‡å¤šç±»çš„ç¤ºä¾‹ public float getTemp1() &#123; Thermometer thermometer = station.getThermometer(); return thermometer.getTemperature(); &#125; public float getTemp2() &#123; return station.getTemperature(); &#125; æ€»ç»“å½“éœ€è¦ç®€åŒ–å¹¶ç»Ÿä¸€ä¸€ä¸ªå¾ˆå¤§çš„æŽ¥å£æˆ–è€…ä¸€ç¾¤å¤æ‚çš„æŽ¥å£æ—¶ï¼Œä½¿ç”¨å¤–è§‚ï¼Œä»Žä¸€ä¸ªå¤æ‚çš„å­ç³»ç»Ÿä¸­è§£è€¦ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆäºŒï¼‰è¿­ä»£å™¨æ¨¡å¼ & ç»„åˆæ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%BA%8C%EF%BC%89%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F%20%26%20%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è¿­ä»£å™¨æ¨¡å¼åº”ç”¨åœºæ™¯å‡è®¾æœ‰è¥¿é¤å’Œç…Žé¥¼ä¸¤ç§èœå•ï¼Œéœ€è¦æ‹›å¾…å‘˜æ‰“å°å‡ºè¿™ä¸¤ç§èœå•çš„æ‰€æœ‰èœå“é¡¹ç›®ã€‚ æ–¹æ¡ˆä¸€æš´éœ²å‡ºé›†åˆç»™å¤–éƒ¨è¿›è¡ŒéåŽ† public class MenuItem &#123; String name; String description; boolean vegetarian; double price; public MenuItem(String name, String description, boolean vegetarian, double price) &#123; this.name = name; this.description = description; this.vegetarian = vegetarian; this.price = price; &#125; public String getName() &#123; return name; &#125; public String getDescription() &#123; return description; &#125; public String getPrice() &#123; return price; &#125; public String isVegetarian() &#123; return vegetarian; &#125; &#125; public class PancakeHouseMenu1 &#123; //ç…Žé¥¼èœå• ArrayList menuItems; public PancakeHouseMenu() &#123; menuItems = new ArrayList(); addItem(&quot;K&amp;B&apos;s Pancake Breakfast&quot;,&quot;Pancakes with scrambled eggs, and toast&quot;,true,2.99); addItem(&quot;Regular Pancake Breakfast&quot;,&quot;Pancakes with fried eggs, sausage&quot;,false,2.99); addItem(&quot;Blueberry Pancakes&quot;,&quot;Pancakes made with fresh blueberries&quot;,true,3.49); addItem(&quot;Waffles&quot;,&quot;Walfles, with yoiur choice of blueberries or strawberries&quot;,true,3.59); &#125; public void addItem(String name, String description, boolean vegetarian, double price) &#123; MenuItem menuItem = new MenuItem(name, description, vegetarian, price); menuItems.add(menuItem); &#125; public ArrayList getMenuItems() &#123; return menuItems; &#125; &#125; public class DinerMenu1 &#123; //è¥¿é¤èœå• static final int MAX_ITEMS = 6; int numberOfItems; MenuItem[] menuItems; public DinerMenu() &#123; menuItems = new MenuItem[MAX_ITEMS]; addItem(&quot;Vegetarian BLT&quot;,&quot;(Fakin&apos;) Bacon with lettuce &amp; tomato on whole wheat&quot;,true,2.99); addItem(&quot;BLT&quot;,&quot;Bacon with lettuce &amp; tomato on whole wheat&quot;,false,2.99); addItem(&quot;Soup of the day&quot;,&quot;Soup of the day, with a side of potato salad&quot;,false,3.29); addItem(&quot;Hotdog&quot;,&quot;A hot dog, with saurkraut, relish, onions, topped with cheese&quot;,false,3.05); &#125; public void addItem(String name, String description, boolean vegetarian, double price) &#123; MenuItem menuItem = new MenuItem(name, description, vegetarian, price); if (numberOfItems &gt;= MAX_ITEMS) &#123; System.err.println(&quot;Sorry, menu is full! Can&apos;t add item to menu&quot;); &#125; else &#123; menuItems[numberOfItems] = menuItem; numberOfItems += 1; &#125; &#125; public MenuItem[] getMenuItems() &#123; return menuItems; &#125; &#125; public class Waitress1 &#123; //æ‹›å¾…å‘˜ public void printMenu() &#123; PancakeHouseMenu1 pancakeHouseMenu = new PancakeHouseMenu1(); ArrayList breakfastItems = pancakeHouseMenu.getMenuItems(); DinerMenu1 dinerMenu = new DinerMenu1(); MenuItem[] lunchItems = dinerMenu.getMenuItems(); //éœ€è¦ç”¨ä¸¤ä¸ªforå¾ªçŽ¯åˆ†åˆ«éåŽ†ä¸¤ç§ä¸åŒç±»åž‹çš„èœå•é¡¹é›†åˆ(èœå•) for (int i = 0; i &lt; breakfastItems.size(); i++) &#123; MenuItem menuItem = (MenuItem)breakfastItems.get(i); System.out.print(menuItem.getName()+&quot; &quot;); System.out.println(menuItem.getPrice()+&quot; &quot;); System.out.println(menuItem.getDescription()); &#125; for (int j = 0; j &lt; lunchItems.length; j++) &#123; MenuItem menuItem = lunchItems[j]; System.out.print(menuItem.getName()+&quot; &quot;); System.out.println(menuItem.getPrice()+&quot; &quot;); System.out.println(menuItem.getDescription()); &#125; &#125; &#125; ä»Žä¸Šé¢çš„æ–¹æ¡ˆä¸€çœ‹ï¼Œæ‹›å¾…å‘˜çš„æ‰“å°èœå•å®žçŽ°ä¸­å¸¦æœ‰ä¸¤æ¬¡å¾ªçŽ¯ï¼Œä¸”æ†ç»‘äºŽå…·ä½“çš„é›†åˆç±»åž‹ã€‚ æ–¹æ¡ˆäºŒåˆ©ç”¨è¿­ä»£å™¨æ”¹è¿› ä¸ºäº†è®©æ‹›å¾…å‘˜æ›´æ–¹ä¾¿åœ°éåŽ†èœå•ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªè¿­ä»£å™¨æŽ¥å£ï¼Œç„¶åŽåˆ†åˆ«å®žçŽ°ç…Žé¥¼å’Œè¥¿é¤ä¸¤ç§å…·ä½“çš„è¿­ä»£å™¨ã€‚è¿™æ ·æ‹›å¾…å‘˜ä½¿ç”¨è¿­ä»£å™¨éåŽ†æ—¶å°±å¯ä»¥è°ƒç”¨ç»Ÿä¸€çš„æŽ¥å£è€Œä¸ç”¨å…³å¿ƒè¿™ä¸¤ç§èœå•å†…çš„å·®å¼‚å¤„ç†ï¼Œå¾ªçŽ¯ä»£ç ä¹Ÿå› æ­¤å˜æˆåªæœ‰ä¸€ä¸ªã€‚ public interface Iterator &#123; boolean hasNext(); Object next(); &#125; public class DinerMenuIterator2 implements Iterator &#123; MenuItem[] items; int position = 0; public DinerMenuIterator(MenuItem[] items) &#123; this.items = items; &#125; public Object next() &#123; MenuItem menuItem = items[position]; position += 1; return menuItem; &#125; public boolean hasNext() &#123; if (position &gt;= items.length || items[position] == null) &#123; return false; &#125; else &#123; return true; &#125; &#125; &#125; åŒç†ï¼Œå®žçŽ° PancakeHouseMenuIterator2ã€‚ public class DinerMenu2 &#123; //... public Iterator createIterator() &#123; return new DinerMenuIterator2(menuItems); &#125; &#125; DinerMenuåŽ»æŽ‰äº†getMenuItemsæ–¹æ³•ï¼Œå› ä¸ºä¸å†ä»¥æš´éœ²å‡ºå†…éƒ¨çš„å®žçŽ°ç»™å¤–éƒ¨è¿›è¡ŒéåŽ†ï¼Œæ”¹ä¸ºæä¾›å°è£…å¥½éåŽ†é€»è¾‘çš„è¿­ä»£å™¨ç»™å¤–éƒ¨ç›´æŽ¥ä½¿ç”¨ã€‚åŒç†ï¼Œå†ä¸º PancakeHouseMenu2 æ·»åŠ  createIterator æ–¹æ³•ã€‚ public class Waitress2 &#123; PancakeHouseMenu2 pancakeHouseMenu; DinerMenu2 dinerMenu; public Waitress(PancakeHouseMenu2 pancakeHouseMenu, DinerMenu2 dinerMenu) &#123; this.pancakeHouseMenu = pancakeHouseMenu; this.dinerMenu = dinerMenu; &#125; public void printMenu() &#123; Iterator pancakeIterator = pancakeHouseMenu.createIterator(); Iterator dinerIterator = dinerMenu.createIterator(); System.out.println(&quot;Menu\n---\nBreakfast&quot;); printMenu(pancakeIterator); System.out.println(&quot;\nLunch&quot;); printMenu(dinerIterator); &#125; private void printMenu(Iterator iterator) &#123; while (iterator.hasNext()) &#123; MenuItem menuItem = (MenuItem)iterator.next(); System.out.print(menuItem.getName()+&quot;, &quot;); System.out.print(menuItem.getPrice()+&quot; -- &quot;); System.out.print(menuItem.getDescription()); &#125; &#125; &#125; ä»Žä¸Šé¢çœ‹ï¼Œæ–¹æ¡ˆäºŒä¸­ï¼Œæ‹›å¾…å‘˜ä»ç„¶æ†ç»‘äºŽä¸¤ä¸ªå…·ä½“çš„èœå•ç±»ï¼Œæˆ‘ä»¬åº”è¯¥åšå¾—æ›´é’ˆå¯¹æŽ¥å£ç¼–ç¨‹ï¼Œè§£è€¦æ‹›å¾…å‘˜å’Œå…·ä½“èœå•çš„å…³ç³»ã€‚ æ–¹æ¡ˆä¸‰åˆ©ç”¨java.util.Iterator ç³»ç»Ÿæœ¬èº«æœ‰è¿­ä»£å™¨ç›¸å…³æŽ¥å£å’Œå·²å®žçŽ°çš„ç±»å¯ç›´æŽ¥åˆ©ç”¨ï¼ŒåŒæ—¶æœ¬æ¬¡æŠ½è±¡å‡ºèœå•æŽ¥å£ä¾›æ‹›å¾…å‘˜ä½¿ç”¨ï¼Œè§£è€¦æ‹›å¾…å‘˜å’Œç…Žé¥¼è¥¿é¤ä¸¤ä¸ªå…·ä½“èœå•çš„å…³ç³»ã€‚ public interface Menu &#123; public Iterator createIterator(); &#125; public class PancakeHouseMenu3 implements Menu &#123; //ç…Žé¥¼èœå• ArrayList menuItems; public PancakeHouseMenu() &#123; menuItems = new ArrayList(); addItem(&quot;K&amp;B&apos;s Pancake Breakfast&quot;,&quot;Pancakes with scrambled eggs, and toast&quot;,true,2.99); addItem(&quot;Regular Pancake Breakfast&quot;,&quot;Pancakes with fried eggs, sausage&quot;,false,2.99); addItem(&quot;Blueberry Pancakes&quot;,&quot;Pancakes made with fresh blueberries&quot;,true,3.49); addItem(&quot;Waffles&quot;,&quot;Walfles, with yoiur choice of blueberries or strawberries&quot;,true,3.59); &#125; public void addItem(String name, String description, boolean vegetarian, double price) &#123; MenuItem menuItem = new MenuItem(name, description, vegetarian, price); menuItems.add(menuItem); &#125; public Iterator createIterator() &#123; return menuItems.iterator(); //å› ArrayListæ”¯æŒIteratoræŽ¥å£ï¼Œæ•…ç›´æŽ¥å…åŽ» PancakeHouseMenuIterator3 çš„å®žçŽ°ã€‚ &#125; &#125; public class DinerMenu3 implements Menu &#123; //... public Iterator createIterator() &#123; return new DinerMenuIterator3(menuItems); //å› æ•°ç»„listï¼ˆMenuItems[]ï¼‰ä¸æ”¯æŒIteratoræŽ¥å£ï¼Œæ•…ä»éœ€å®žçŽ° DinerMenuIterator3 &#125; &#125; public class DinerMenuIterator3 implements Iterator &#123; //... //è¿˜éœ€å®žçŽ° java.util.Iterator çš„remove public void remove() &#123; if (position &lt;= 0) &#123; throw new IllegalStateException(&quot;You can&apos;t remove an item until you&apos;ve done at least one next()&quot;); &#125; if (items[position-1] != null) &#123; for (int i = position-1; i &lt; (items.length-1); i++) &#123; items[i] = items[i+1]; &#125; items[items.length-1] = null; &#125; &#125; &#125; public class Waitress3 &#123; Menu pancakeHouseMenu; Menu dinerMenu; public Waitress(Menu pancakeHouseMenu, Menu dinerMenu) &#123; this.pancakeHouseMenu = pancakeHouseMenu; this.dinerMenu = dinerMenu; &#125; &#125; ä¸ºäº†æ¼”ç¤ºHashtableçš„Iteratorï¼Œå†æ·»åŠ ä¸€ä¸ªå’–å•¡èœå• public class CafeMenu implements Menu &#123; Hashtable menuItems = new Hashtable(); public CafeMenu() &#123;&#125; public void addItem(String name, String description, boolean vegetarian, double price) &#123; MenuItem menuItem = new MenuItem(name, description, vegetarian, price); menuItems.put(menuItem.getName(), menuItem); &#125; public Iterator createIterator() &#123; return MenuItems.values().iterator(); &#125; &#125; å†ä¼˜åŒ–ä¸€ä¸‹æ‹›å¾…å‘˜ï¼Œä½¿ä»–ä¸ç”¨åœ¨æ¯æ¬¡å¢žå‡èœå•æ—¶éƒ½è¦æ”¹åˆ°å†…éƒ¨çš„ä»£ç ã€‚è¿™ä¹Ÿæ˜¯å¾—ç›ŠäºŽMenuæŽ¥å£çš„è¯žç”Ÿ public class Waitress4 &#123; ArrayList menus; public Waitress(ArrayList menus) &#123; this.menus = menus; &#125; public void printMenu() &#123; Iterator menuIterator = menus.iterator(); while(menuIterator.hasNext()) &#123; Menu menu = (Menu)menuIterator.next(); printMenu(menu.createIterator()); &#125; &#125; private void printMenu(Iterator iterator) &#123; //... &#125; &#125; æ€»ç»“è¿­ä»£å™¨æ¨¡å¼æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²å…¶å†…éƒ¨çš„è¡¨ç¤ºã€‚æŠŠæ¸¸èµ°çš„ä»»åŠ¡æ”¾åœ¨è¿­ä»£å™¨ä¸Šï¼Œè€Œä¸æ˜¯èšåˆï¼Œç®€åŒ–äº†èšåˆçš„æŽ¥å£å’Œå®žçŽ°ï¼Œè®©è´£ä»»å„å¾—å…¶æ‰€ã€‚ å»¶ä¼¸ï¼Œç±»çš„æ¯ä¸ªè´£ä»»éƒ½æœ‰æ”¹å˜çš„æ½œåœ¨åŒºåŸŸï¼Œè¶…è¿‡ä¸€ä¸ªè´£ä»»ï¼Œæ„å‘³ç€è¶…è¿‡ä¸€ä¸ªæ”¹å˜çš„åŒºåŸŸï¼Œåº”å°½é‡è®©æ¯ä¸ªç±»ä¿å­˜å•ä¸€è´£ä»»ï¼Œå³ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å˜åŒ–çš„åŽŸå› ã€‚ ç»„åˆæ¨¡å¼åº”ç”¨åœºæ™¯åŸºäºŽä¸Šä¸€èŠ‚çš„è¿­ä»£å™¨æ¨¡å¼ä¸­çš„èœå•ä¾‹å­ï¼Œå‡è®¾è¦åŽ†éèœå•çš„èœå•é¡¹ä¸­ï¼Œå¯èƒ½è¿˜æœ‰å­èœå•ï¼Œç»§ç»­æ‰“å°åŒ…æ‹¬å­èœå•é‡Œçš„æ‰€æœ‰èœå•é¡¹ã€‚ é¦–å…ˆå®šä¹‰ä¸€ä¸ªèœå•é¡¹å’Œå­èœå•çš„æŠ½è±¡ç±»ï¼Œå¯ä»¥ä½œä¸ºä¸ªåˆ«å¯¹è±¡å’Œå¯¹è±¡ç»„åˆçš„çˆ¶ç±»ï¼Œä½¿å…¶å¯è¢«ç»Ÿä¸€çš„å¤„ç†ã€‚ public abstract class MenuComponent1 &#123; public void add(MenuComponent1 menuComponent) &#123; throw new UnsupportedOperationException();&#125; public void remove(MenuComponent1 menuComponent) &#123; throw new UnsupportedOperationException();&#125; public MenuComponent1 getChild(int i) &#123; throw new UnsupportedOperationException();&#125; public String getName() &#123; throw new UnsupportedOperationException();&#125; public String getDescription() &#123; throw new UnsupportedOperationException();&#125; public String getPrice() &#123; throw new UnsupportedOperationException();&#125; public String isVegetarian() &#123; throw new UnsupportedOperationException();&#125; public void print() &#123; throw new UnsupportedOperationException();&#125; &#125; public class MenuItem1 extends MenuComponent1 &#123; //... public void print() &#123; System.out.print(&quot; &quot;+getName()); if (isVegetarian()) &#123; System.out.print(&quot;(v)&quot;); &#125; System.out.print(&quot;, &quot;+getPrice()); System.out.print(&quot; -- &quot;+getDescription()); &#125; &#125; public class Menu1 extends MenuComponent1 &#123; ArrayList menuComponents = new ArrayList(); String name; String description; public Menu(String name, String description) &#123; this.name = name; this.description = description; &#125; public void add(MenuComponent1 menuComponent) &#123; menuComponent.add(menuComponent);&#125; public void remove(MenuComponent1 menuComponent) &#123; menuComponent.remove(menuComponent);&#125; public MenuComponent1 getChild(int i) &#123; return (MenuComponent)menuComponent.get(i);&#125; public String getName() &#123; return name; &#125; public String getDescription() &#123; return description; &#125; public void print() &#123; System.out.print(&quot;\n &quot;+getName()); System.out.print(&quot;, &quot;+getDescription()); System.out.print(&quot;----------------&quot;); Iterator iterator = menuComponents.iterator(); while(iterator.hasNext()) &#123; MenuComponent1 menuComponent = (MenuComponent)iterator.next(); menuComponent.print(); //å¦‚æžœå…ƒç´ æ˜¯(å­)èœå•ï¼Œåˆ™äº§ç”Ÿé€’å½’æ•ˆæžœ &#125; &#125; &#125; public class Waitress &#123; MenuComponent1 allMenus; public Waitress(MenuComponent1 allMenus) &#123; this.allMenus = allMenus; &#125; public void printMenu() &#123; allMenus.print(); &#125; &#125; public class MenuTestDrive &#123; public static void main(String args[]) &#123; MenuComponent1 pancakeHouseMenu = new Menu1(&quot;Pancake House Menu&quot;,&quot;Breakfast&quot;); MenuComponent1 dinerMenu = new Menu1(&quot;Diner Menu&quot;,&quot;Lunch&quot;); MenuComponent1 cafeMenu = new Menu1(&quot;Cafe Menu&quot;,&quot;Dinner&quot;); MenuComponent1 dessertMenu = new Menu1(&quot;Dessert Menu&quot;,&quot;Dessert of course&quot;); MenuComponent1 allMenus = new Menu1(&quot;All Menus&quot;,&quot;All menus combined&quot;); allMenus.add(pancakeHouseMenu); allMenus.add(dinerMenu); allMenus.add(cafeMenu); dinerMenu.add(new MenuItem1(&quot;Pasta&quot;,&quot;Spaghetti with Marinara Sauce, and a slice of sourdough bread&quot;,true,3.89)); dinerMenu.add(dessertMenu); dessertMenu.add(new MenuItem1(&quot;Apple Pie&quot;,&quot;Apple pie with a flakey crust, topped with vanilla ice cream&quot;,true,1.59)); Waitress waitress = new Waitress((allMenus)); waitress.printMenu(); &#125; &#125; ä¸Šé¢ä½¿ç”¨äº†æ ‘çŠ¶ç»“æž„è®¾è®¡èœå•ç»„ä»¶MenuComponentï¼ŒMenuç±»æ˜¯ç»„ä»¶çš„å…¶ä¸­ä¸€ä¸ªå…·ä½“å®žçŽ°ï¼Œå¹¶å¯ä»¥å¾€ä¸Šé¢æ·»åŠ èœå•ç»„ä»¶MenuComponentï¼Œå®žçŽ°åµŒå¥—å­˜å‚¨ã€‚ ä¸Šé¢çš„å®žçŽ°ä¸­æ²¡æœ‰æä¾›éåŽ†çš„å…ƒç´ ï¼Œå¦‚æžœè¦æä¾›å‡ºæ¥åˆ™éœ€è¦åšä¸€å¥—è¿™ä¸ªæ ‘çš„è¿­ä»£å™¨ã€‚ å‡è®¾çŽ°åœ¨è¦æ‰¾å‡ºæ‰€æœ‰ç´ é£Ÿèœå“ï¼Œåšä¸€ä¸‹æ”¹é€  public abstract class MenuComponent2 &#123; //... public Iterator createIterator() &#123;&#125;; &#125; public class Menu2 extends MenuComponent2 &#123; //... public Iterator createIterator() &#123; return new CompositeIterator(menuComponents.iterator()); &#125;; &#125; public class MenuItem2 extends MenuComponent2 &#123; //... public Iterator createIterator() &#123; return new NullIterator(); // ä¸ºäº†ä¿æŒä¸€è‡´æ€§å’Œå®‰å…¨æ€§ï¼Œæä¾›ç©ºè¿­ä»£å™¨ç»™å¤–éƒ¨éåŽ†æ—¶è¿›è¡Œå‡è°ƒç”¨ï¼ˆå› ä¸ºå¤–éƒ¨åªè®¤èœå•ç»„ä»¶çš„æŽ¥å£ï¼Œè€Œä¸ä¼šç†ä¼šå…·ä½“å®žçŽ°æ˜¯å¦æ”¯æŒï¼‰ &#125;; &#125; public class NullIterator implements Iterator &#123; public Object next() &#123; return null; &#125; public boolean hasNext() &#123; return false; &#125; public void remove() &#123; throw new UnsupportedOperationException(); &#125; &#125; //æ ‘(ç»„åˆ)è¿­ä»£å™¨ public class CompositeIterator implements Iterator &#123; Stack stack = new Stack(); //ç”¨æ¥å­˜æ”¾æ•´ä¸ªç»„åˆé‡Œé¢çš„æ‰€æœ‰è¿­ä»£å™¨ public CompositeIterator(Iterator iterator) &#123; stack.push(iterator); &#125; public Object next() &#123; if (hasNext()) &#123; Iterator iterator = (Iterator) stack.peek(); //ä½¿ç”¨æ ˆé¡¶çš„è¿­ä»£å™¨åŽ†éï¼Œä¸€ä¸ªè¿­ä»£å™¨åŽ†éå®ŒåŽhasNextå†…ä¼šè‡ªåŠ¨æ›´æ–°æ ˆé¡¶çš„è¿­ä»£å™¨ MenuComponent component = (MenuComponent) iterator.next(); if (component instanceof Menu) &#123; stack.push(component.createIterator()); //å°†å­èœå•çš„è¿­ä»£å™¨æŽ¨å…¥æ ˆ &#125; return component; &#125; else &#123; return null; &#125; &#125; public boolean hasNext() &#123; if (stack.empty()) &#123; return false; &#125; else &#123; Iterator iterator = (Iterator) stack.peek(); if (!iterator.hasNext()) &#123; stack.pop(); return hasNext(); //é€’å½’ &#125; else &#123; return true; &#125; &#125; &#125; public void remove() &#123; throw new UnsupportedOperationException(); &#125; &#125; public class Waitress2 &#123; //... public void printVegetarianMenu() &#123; Iterator iterator = allMenus.createIterator(); while(iterator.hasNext()) &#123; MenuComponent2 menuComponent2 = (MenuComponent2)iterator.next(); try &#123; if (menuComponent2.isVegetarian()) &#123; menuComponent2.print(); &#125; &#125; catch (UnsupportedOperationException e) &#123; &#125; &#125; &#125; &#125; æ€»ç»“ç»„åˆæ¨¡å¼å…è®¸å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æž„æ¥è¡¨çŽ°â€œæ•´ä½“/éƒ¨åˆ†â€å±‚æ¬¡ç»“æž„ã€‚ç»„åˆèƒ½è®©å®¢æˆ·ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†ä¸ªåˆ«å¯¹è±¡ä»¥åŠå¯¹è±¡ç»„åˆã€‚ä½¿ç”¨ç»„åˆç»“æž„ï¼Œæˆ‘ä»¬èƒ½æŠŠç›¸åŒçš„æ“ä½œåº”ç”¨åœ¨ç»„åˆå’Œä¸ªåˆ«å¯¹è±¡ä¸Šï¼Œå³å¿½ç•¥å¯¹è±¡ç»„åˆå’Œä¸ªåˆ«å¯¹è±¡ä¹‹é—´çš„å·®åˆ«ã€‚ ç»„åˆæ¨¡å¼ä»¥å•ä¸€è´£ä»»è®¾è®¡åŽŸåˆ™æ¢å–äº†é€æ˜Žæ€§ï¼Œä½†å¤±åŽ»äº†ç›¸å¯¹çš„å®‰å…¨æ€§ï¼Œå³æ˜¯è°ƒç”¨è€…å¯èƒ½ä¼šå¯¹ä¸€ä¸ªå…ƒç´ åšå‡ºä¸æ°å½“æˆ–æ²¡æ„ä¹‰çš„æ“ä½œæ–¹æ³•è°ƒç”¨ï¼Œè¿™ä¸ªæ˜¯å…¸åž‹çš„æŠ˜è¡·æ¡ˆä¾‹ã€‚ å»¶ä¼¸ï¼šç»„ä»¶è¿˜å¯ä»¥æœ‰æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ–¹ä¾¿åå‘æ¸¸èµ°ï¼›æœ‰é¡ºåºçš„å­èŠ‚ç‚¹ï¼Œå¢žåˆ èŠ‚ç‚¹æ–¹æ³•éœ€é¢å¤–è®¾è®¡ï¼›ç¼“å­˜èµ·éœ€è¦åŽ†éè®¡ç®—çš„ç»“æžœï¼ŒèŠ‚çœå¼€æ”¯ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitæ‰‹å†Œ]]></title>
    <url>%2F%E5%B7%A5%E5%85%B7%2FGit%E6%89%8B%E5%86%8C%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€äº›å¸¸ç”¨çš„Gitå‘½ä»¤æ–¹ä¾¿ä½¿ç”¨æ—¶æŸ¥è¯¢ï¼Œä»¥åŠç®€å•äº¤ä»£å¯¹åº”çš„åŽŸç†ï¼Œä¾¿äºŽæ“ä½œæ—¶ç†è§£å®žé™…æ„ä¹‰ã€‚ æœ¬åœ°åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯newBranchName git checkout -b bugFix git branch bugFix git checkout bugFix ä½¿ç”¨æŒ‡å®šåˆ†æ”¯åˆ›å»ºåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢ git checkout -b special master æäº¤ç‰ˆæœ¬ git commit å‡è®¾åœ¨masterä¸Šè¦åˆå¹¶å›žbugFixçš„æäº¤ç‰ˆæœ¬ git merge bugFix ä¸Žä¸Šä¸€ä¸ªæŒ‡ä»¤åŒç­‰æ•ˆæžœï¼Œåˆ†æ”¯ç»“æž„ä¼šæ›´æ¸…æ™°çš„å˜åŸº(åœ¨bugFixä¸Šè¿›è¡Œï¼Œä½†å› å®‰å…¨æ€§å’Œå¯è·Ÿè¸ªæ€§é—®é¢˜è€Œå»ºè®®å°‘ç”¨ã€‚æŒ‡ä»¤å¯ä»¥è§£è¯»ä¸ºâ€œå˜åŸºåˆ°xxåˆ†æ”¯ä¸Šâ€œï¼ŒåŽå¯å¸¦ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºä½¿ç”¨å“ªä¸ªåˆ†æ”¯è¿›è¡Œå˜åŸº) git rebase master æŸ¥çœ‹å½“å‰HEADæŒ‡å‘çš„å¼•ç”¨ï¼Œä¸€èˆ¬çš„æŒ‡å‘æ˜¯HEAD-&gt;master-&gt;versionHash git symbolic-ref HEAD æŸ¥çœ‹æäº¤è®°å½•çš„å“ˆå¸Œå€¼ git log ç›¸å¯¹å¼•ç”¨åˆ‡æ¢ï¼Œåˆ‡æ¢åˆ°masterçš„ä¸Šä¸€æ¬¡(å¦‚æžœä¸Šä¸€æ¬¡æœ‰ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œå¯æ·»åŠ æ•°å­—æŒ‡å®š)å’Œå‰3æ¬¡çš„æäº¤è®°å½•ï¼Œæˆ–æŒ‡å®šhash(æ”¯æŒåªè¾“å…¥å‰4ä½)ï¼Œè¿˜å¯ä»¥é“¾å¼æ“ä½œ git checkout master^ git checkout master~3 git checkout f2e1 git checkout HEAD~^2~2 å¼ºåˆ¶å˜æ›´åˆ†æ”¯æŒ‡å‘çš„æäº¤ï¼ˆç›¸å¯¹å¼•ç”¨æ–¹å¼ï¼‰ git branch -f master HEAD~3 å›žé€€ç‰ˆæœ¬ï¼Œæ”¹å†™æœ¬åœ°åŽ†å² git reset HEAD~1 æ’¤é”€è¿œç«¯çš„æ›´æ”¹ï¼Œè¿˜åŽŸç‰ˆæœ¬ git revert HEAD å¤åˆ¶ç‰ˆæœ¬ï¼ŒæŽ§åˆ¶é¡ºåº git cherry-pick C2 C4 äº¤äº’å¼çš„rebaseï¼Œåœ¨ä¸æ¸…æ¥šç‰ˆæœ¬hashæ—¶åˆæƒ³ç”¨cherry-pickæŒ‰é¡ºåºå¤åˆ¶ç‰ˆæœ¬æ—¶ä½¿ç”¨(ä¼šåœ¨viç¼–è¾‘æ–‡ä»¶ä¸‹é…ç½®è¦å¤åˆ¶çš„ç‰ˆæœ¬çš„é¡ºåºï¼Œåˆ©ç”¨å‚æ•°â€“interactiveæˆ–-i) git rebase -i branch/HEAD~4 è‹¥æ¼æŽ‰äº†æ–‡ä»¶æ²¡æœ‰åŠ ï¼Œæˆ–è€…æäº¤ä¿¡æ¯å†™é”™äº†ï¼Œæƒ³è¦æ’¤æ¶ˆåˆšæ‰çš„æäº¤æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ â€“amend é€‰é¡¹é‡æ–°æäº¤ã€‚å¦‚æžœåˆšæ‰æäº¤å®Œæ²¡æœ‰ä½œä»»ä½•æ”¹åŠ¨ï¼Œç›´æŽ¥è¿è¡Œæ­¤å‘½ä»¤çš„è¯ï¼Œç›¸å½“äºŽæœ‰æœºä¼šé‡æ–°ç¼–è¾‘æäº¤è¯´æ˜Ž git commit --amend æ°¸ä¹…æŒ‡å‘æäº¤ç‰ˆæœ¬çš„Tag git tag tagV1 verC1 æŸ¥æ‰¾æœ€è¿‘çš„æ ‡ç­¾ï¼Œè¾“å‡ºæ ·å¼ï¼Œ&lt;tag&gt;_&lt;numCommits&gt;_g&lt;hash&gt;ï¼ˆhashæ˜¯ä¸‹é¢refçš„å“ˆå¸Œå€¼ï¼‰ git describe &lt;ref&gt; å¼ºåˆ¶å˜æ›´åˆ†æ”¯æŒ‡å‘ git branch -f feature C2 è¿œç¨‹å…‹éš†æœ¬åœ°è·¯å¾„æ—¶æ˜¯çœŸæ­£çš„æ‹·è´ï¼Œå…‹éš†è¿œç«¯æ—¶æ˜¯å¤åˆ¶è¿œç«¯çš„ç‰ˆæœ¬åˆ°æœ¬åœ°å½¢æˆå…³è”ã€‚è€Œä¸”å…‹éš†åŽï¼Œæœ¬åœ°ä¼šè‡ªåŠ¨å°†è¿œç«¯åˆ†æ”¯å‘½åä¸ºorigin/masterï¼Œoriginæ˜¯è¿œç«¯ä»“åº“çš„é»˜è®¤åç§°ï¼Œæ‰€ä»¥æœ¬åœ°çš„masteråˆ†æ”¯å¹¶ä¸æ˜¯é¡¹ç›®çš„çœŸæ­£masteråˆ†æ”¯ï¼Œè‹¥å°è¯•æ‰‹åŠ¨åˆ‡æ¢åˆ°origin/masterï¼Œåªä¼šäº§ç”Ÿä¸Žå…¶ç›¸åŒå¼•ç”¨çš„åˆ†ç¦»HEADçŠ¶æ€ï¼Œå› ä¸ºGitä¸å…è®¸ç›´æŽ¥åœ¨è¿œç«¯é¡¹ç›®ä¸Šæ“ä½œã€‚ git clone git_url ä»Žè¿œç¨‹ä»“åº“èŽ·å–æ•°æ®ï¼ˆä¸‹è½½ç¼ºå¤±çš„æäº¤è®°å½•ï¼Œå¹¶æ›´æ–°æœ¬åœ°çš„è¿œç¨‹åˆ†æ”¯æŒ‡é’ˆã€‚ä½†ä¸ä¼šæ”¹åŠ¨æœ¬åœ°ä»“åº“çš„çŠ¶æ€ï¼Œå› ä¸ºæ€•ä½ è¿˜æ²¡å®Œæˆæœ¬åœ°çš„ç‰ˆæœ¬ï¼‰ git fetch git fetch origin foo æŠ“å–è¿œç¨‹ä»“åº“çš„æ›´æ–°å¹¶åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯æ–°å»ºä¸€ä¸ªç‰ˆæœ¬æäº¤è®°å½•ï¼ˆ=fetch + mergeï¼‰ã€‚å¦‚æžœä¸æƒ³ç”¨åˆå¹¶çš„æ–¹å¼ï¼Œå¯ä»¥åœ¨åŽé¢åŠ ä¸Šå‚æ•°â€“rebaseï¼Œå°†æœ¬åœ°å½“å‰çš„æäº¤è®°å½•å˜åŸºåˆ°è¿œç«¯çš„åç¦»åŽ†å²çš„æäº¤è®°å½•ä¸Šï¼Œè¿™æ ·çš„æäº¤è½¨è¿¹çº¿ä¼šç›¸å¯¹æ¸…æ™°ã€‚ git pull git pull --rebase å°†æœ¬åœ°å˜æ›´ä¸Šä¼ åˆ°æŒ‡å®šçš„è¿œç¨‹ä»“åº“ã€‚è‹¥ä½¿ç”¨æŒ‡å®šsourceå’Œdestinationçš„æ–¹å¼æ—¶ (æ¯”è¾ƒå°‘ç”¨åˆ°)ï¼Œéœ€è¦éµå¾ªä¸‹é¢çš„æ ¼å¼ï¼Œä½¿ç”¨å†’å·åˆ†éš”ï¼Œdestinationæ˜¯æŒ‡éœ€æ›´æ–°çš„è¿œç«¯åˆ†æ”¯åç§°ï¼Œä½†ä¸éœ€åŠ origin/å‰ç¼€æ ‡è¯†ï¼Œè€ŒåŽŸæ¥å·²ç»åœ¨è·Ÿè¸ªè¯¥è¿œç«¯çš„åŒåæœ¬åœ°åˆ†æ”¯ä¸ä¼šæœ‰æ‰€å˜åŠ¨ï¼Œsourceåˆ™å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªæäº¤è®°å½•ã€‚ git push git push &lt;remote&gt; &lt;place&gt; git push origin master git push origin &lt;source&gt;:&lt;destination&gt; è¿½è¸ªè¿œç¨‹åˆ†æ”¯ï¼ˆä¸‹é¢æŒ‡ä»¤æ„æ€æ˜¯åˆ›å»ºåˆ†æ”¯fooï¼Œå¹¶é€šè¿‡å‚æ•°-uè®¾ç½®è·Ÿè¸ªorigin/masterï¼Œå¦‚æžœå½“å‰å°±åœ¨fooä¸Šè¿˜å¯ä»¥çœç•¥æŽ‰fooï¼‰ git branch -u origin/master foo åˆ é™¤è¿œç«¯åˆ†æ”¯ï¼›åˆ›å»ºæœ¬åœ°åˆ†æ”¯ã€‚ git push origin :foo git fetch origin :bar åˆ—å‡ºè¿œç¨‹ä¸»æœº (å¦‚ origin) git remote git remote -v å…³è”è¿œç¨‹åˆ†æ”¯(é»˜è®¤master) git remote add origin url.git ç­‰ç­‰Githubæˆ–ä¸€äº›gitç®¡ç†å·¥å…·ï¼Œè¿œç¨‹ä»“åº“æ˜¯ä¸å…è®¸ä»£ç è´¡çŒ®è€…ç›´æŽ¥pushçš„(ä½œè€…è‡ªå·±çš„æœ¬åœ°åˆ™æ²¡æœ‰é™åˆ¶)ï¼Œè€Œæ˜¯å‘èµ·ä¸€ä¸ªpull requestï¼Œè®©é¡¹ç›®ä½œè€…è‡ªå·±fetch&amp;merge/pullè´¡çŒ®è€…ä»£ç (åƒæ˜¯åè¿‡æ¥ä¸€æ ·ï¼Œè¦åˆå¹¶å¤–éƒ¨çš„ä»£ç æ—¶ï¼Œå¤–éƒ¨çš„ä»£ç è§†ä½œä¸€ä¸ªè¿œç«¯ä»“åº“ï¼Œè€Œå®ƒåˆ™æ˜¯è´¡çŒ®è€…åœ¨å¼€å‘å‰æœŸè¿›è¡Œforkæ‰€åˆ›å»ºï¼Œforkç±»ä¼¼clone)ã€‚ å…³äºŽ rebase çš„ä¼˜ç¼ºç‚¹ï¼šä¼˜ç‚¹:Rebase ä½¿ä½ çš„æäº¤æ ‘å˜å¾—å¾ˆå¹²å‡€, æ‰€æœ‰çš„æäº¤éƒ½åœ¨ä¸€æ¡çº¿ä¸Šç¼ºç‚¹:Rebase ä¿®æ”¹äº†æäº¤æ ‘çš„åŽ†å²(æ¯”å¦‚, æäº¤ C1 å¯ä»¥è¢« rebase åˆ° C3 ä¹‹åŽã€‚è¿™çœ‹èµ·æ¥ C1 ä¸­çš„å·¥ä½œæ˜¯åœ¨ C3 ä¹‹åŽè¿›è¡Œçš„ï¼Œä½†å®žé™…ä¸Šæ˜¯åœ¨ C3 ä¹‹å‰ã€‚)å¦‚æžœå–œæ¬¢ä¿ç•™æäº¤åŽ†å²ï¼Œå¯ä»¥é€‰ç”¨mergeä»£æ›¿ã€‚ å…¶å®ƒä¸€äº›pullçš„ä½¿ç”¨ä¾‹å­ï¼ˆå¤æ‚ç‰ˆçš„fetch + mergeï¼‰ git pull origin foo = git fetch origin foo; git merge o/foo git pull origin bar~1:bugFix = git fetch origin bar~1:bugFix; git merge bugFix æ°¸ä¹…è®°ä½å¯†ç ï¼›æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ git config --global credential.helper store git config user.name git config user.email åˆ é™¤å¯†ç ï¼Œåªè¦åœ¨ä»“åº“çš„.git/configæ–‡ä»¶ä¸­åˆ é™¤[credential] helper = storeè¿™è¡Œå†…å®¹å³å¯ï¼Œè¿™æ ·æ¯æ¬¡å¯¹gitæºæäº¤è®°å½•ç‰ˆæœ¬æ—¶éƒ½éœ€è¦è¾“å…¥å¯†ç ã€‚ä¿®æ”¹å¯†ç åˆ™æ˜¯å…ˆåˆ é™¤è¯¥é¡¹ï¼Œç„¶åŽæ“ä½œä¸€æ¬¡gitæºï¼Œå†è¡¥å›žè¯¥é¡¹ï¼Œè¿™æ ·ä¸‹æ¬¡è¾“çš„æ–°å¯†ç å°±è¢«è®°å½•èµ·æ¥äº†ã€‚ Refæ„Ÿè°¢è¿™ä¸ªGitå®žæ“ç»ƒä¹ ç½‘ç«™è¿˜æœ‰ä¸€å³°å¤§çš„Gitè¿œç¨‹æ“ä½œè¯¦è§£Git Book]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆä¸€ï¼‰ç­–ç•¥æ¨¡å¼ & æ¨¡æ¿æ–¹æ³•æ¨¡å¼]]></title>
    <url>%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%80%EF%BC%89%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%20%26%20%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ä»¥å¾€åœ¨å¼€å‘æˆ–è€…é‡æž„ä»£ç çš„æ—¶å€™ï¼Œä¼šç»å¸¸ç”¨ä¸Šä¸€äº›æŠ€å·§æ¥è¾¾åˆ°æŠ½è±¡å’Œè§£è€¦ç­‰ç›®çš„ï¼Œä½†å¹¶æ²¡æœ‰ç³»ç»Ÿåœ°è¯¦ç»†äº†è§£å’Œåˆ†ç±»æ€»ç»“è¿‡ç¨‹ä¸­æ‰€ç”¨åˆ°çš„æ–¹æ³•ï¼ŒçŽ°åœ¨å›žè¿‡å¤´æ¥çœ‹ä¸€äº›è®¾è®¡æ¨¡å¼çš„æ–¹æ³•è®ºï¼Œå€Ÿé‰´å‰äººæ€»ç»“çš„å¼€å‘ç»éªŒï¼Œæ„Ÿè§¦è¿˜è›®å¤§çš„ã€‚è€Œä¸”åœ¨äº†è§£è¿™äº›æ­£ç»Ÿã€ä¸“ä¸šçš„æ–¹æ³•è®ºåŽï¼ŒåŽç»­ä¸Žå…¶å®ƒç¨‹åºå‘˜åœ¨æ²Ÿé€šä»£ç è®¾è®¡æ—¶å°±æœ‰æ›´é«˜æ•ˆçš„è¯­è¨€åŽ»æè¿°äº†ï¼Œå½“ç„¶å‰ææ˜¯å¤§å®¶éƒ½å¯¹è¿™æœ‰æ‰€äº†è§£ã€‚ ä¸Šä¸€å¹´åˆå¯¹å…¬å¸çš„iOSé¡¹ç›®è¿›è¡Œäº†ä¸€æ¬¡å¤§é‡æž„åŽï¼Œä»Šå¹´åˆæœ‰è®¡åˆ’è¦å¯¹Androidé‚£è¾¹çš„é¡¹ç›®ä¹Ÿè¿›è¡Œä¸€æ¬¡ä¼˜åŒ–é‡æž„ï¼Œè¿™æ¬¡å¿…é¡»å¾—åœ¨è¡ŒåŠ¨å‰æ¢³ç†æ¢³ç†è¿™è®¾è®¡æ¨¡å¼çš„çŸ¥è¯†ï¼Œå°½é‡åœ¨å·¥ä½œä¸­éœ€è¦çš„åœ°æ–¹æ¸…æ™°åˆç†åœ°åº”ç”¨èµ·æ¥ã€‚ è¿™ä¸ªç³»åˆ—ä¸»è¦éƒ½æ˜¯å‚è€ƒã€ŠHead Firstã€‹ï¼Œä¹Ÿæ˜¯æŒ‰ä¹¦æœ¬ä¸Šæ‰€ç”¨çš„è¯­è¨€Javaæ¥åšDemoï¼ˆåˆä¹Žæˆ‘æŽ¥ä¸‹æ¥æžAndroidå‘¢ï¼‰ã€‚å¥½ï¼Œé‚£å°±å¼€å§‹å§~ï¼ˆä¸ºäº†èŠ‚çœç¯‡å¹…ï¼Œä¸‹é¢æ–¹æ³•ä½“ä¸­çš„è§„èŒƒä¼šæœ‰æ‰€å°†å°±ï¼‰ ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯å·²çŸ¥æœ‰çˆ¶ç±»é¸­å­å’Œå®ƒçš„ä¸€äº›å­ç±»ï¼Œå¦‚é’å¤´é¸­ã€æ©¡çš®é¸­ç­‰ï¼Œèµ·åˆå®žçŽ°éœ€æ±‚æ—¶ï¼Œä»–ä»¬éƒ½è¿˜æ²¡æœ‰é£žç¿”åŠŸèƒ½ï¼ŒçŽ°åœ¨æƒ³å¯¹èƒ½é£žç¿”çš„å­ç±»æ·»åŠ é£žæ–¹æ³•å®žçŽ°ã€‚ æ–¹æ¡ˆä¸€åˆ©ç”¨ç»§æ‰¿å®žçŽ°çš„è¯ï¼Œå¦‚ä¸‹ public abstract class Duck1 &#123; public void quack() &#123;System.out.println(&quot;quack&quot;);&#125; public void swim() &#123;System.out.println(&quot;swim&quot;);&#125; public abstract void display(); public void fly() &#123;System.out.println(&quot;fly&quot;);&#125;; &#125; public class MallardDuck1 extends Duck1 &#123; //é’å¤´é¸­ public void display() &#123;System.out.println(&quot;MallardDuck display&quot;);&#125; &#125; public class RedheadDuck1 extends Duck1 &#123; //çº¢å¤´é¸­ public void display() &#123;System.out.println(&quot;RedheadDuck display&quot;);&#125; &#125; public class RubberDuck1 extends Duck1 &#123; //æ©¡çš®é¸­ public void display() &#123;System.out.println(&quot;RubberDuck display&quot;);&#125; @Override public void quack() &#123;System.out.println(&quot;squeak&quot;);&#125; &#125; public class DecoyDuck1 extends Duck1 &#123; //è¯±åˆ©é¸­ public void display() &#123;System.out.println(&quot;RubberDuck display&quot;);&#125; @Override public void quack() &#123; &#125; &#125; ä»Žä¸Šé¢çš„ä»£ç çœ‹ï¼Œè¦æ·»åŠ ä¸€ä¸ª fly æ–¹æ³•ï¼Œå…¶å®žæ˜¯ä¸é€‚åˆç›´æŽ¥åœ¨çˆ¶ç±» Duck ä¸­é€šè¿‡ç»§æ‰¿çš„æ–¹å¼å®žçŽ°è€Œè®©å­ç±»èŽ·å¾—æ­¤æ–¹æ³•ï¼Œå› ä¸ºå¹¶éžæ‰€æœ‰å­ç±»é¸­å­éƒ½ä¼šé£žã€‚è‹¥ä¸ºä½¿å¤§éƒ¨åˆ†èƒ½é£žçš„é¸­å­å­ç±»å¯ä»¥å¤ç”¨ fly æ–¹æ³•è€Œç¡¬è¦åœ¨çˆ¶ç±»ä¸­æ·»åŠ ï¼Œåˆ™ä¸€äº›ä¸ä¼šé£žé¸­å­å­ç±»éœ€è¦é‡å†™ fly æ–¹æ³•æ”¹ä¸ºä»€ä¹ˆéƒ½ä¸åšã€‚åŒæ—¶å‘çŽ°ï¼Œå·²ç»å®žçŽ°äº†çš„ quack æ–¹æ³•ä¹Ÿæ˜¯ä¸Ž fly ä¸€æ ·çš„æƒ…å†µã€‚ æ–¹æ¡ˆäºŒåˆ©ç”¨æŽ¥å£æ”¹è¿›ï¼Œå¦‚ä¸‹ public interface FlyBehavior &#123; public void fly(); &#125; public interface QuackBehavior &#123; public void quack(); &#125; public abstract class Duck2 &#123; public void swim() &#123;System.out.println(&quot;swim&quot;);&#125; public abstract void display(); &#125; public class MallardDuck2 extends Duck2 implements FlyBehavior, QuackBehavior &#123; //é’å¤´é¸­ public void display() &#123;System.out.println(&quot;MallardDuck display&quot;);&#125; public void fly() &#123;System.out.println(&quot;MallardDuck fly&quot;);&#125;; public void quack() &#123;System.out.println(&quot;MallardDuck quack&quot;);&#125;; &#125; public class RedheadDuck2 extends Duck2 implements FlyBehavior, QuackBehavior &#123; //çº¢å¤´é¸­ public void display() &#123;System.out.println(&quot;RedheadDuck display&quot;);&#125; public void fly() &#123;System.out.println(&quot;RedheadDuck fly&quot;);&#125;; public void quack() &#123;System.out.println(&quot;RedheadDuck quack&quot;);&#125;; &#125; public class RubberDuck2 extends Duck2 implements QuackBehavior &#123; //æ©¡çš®é¸­ public void display() &#123;System.out.println(&quot;RubberDuck display&quot;);&#125; public void quack() &#123;System.out.println(&quot;RubberDuck quack&quot;);&#125;; &#125; public class DecoyDuck2 extends Duck2 &#123; //è¯±åˆ©é¸­ public void display() &#123;System.out.println(&quot;DecoyDuck display&quot;);&#125; &#125; è¿™æ ·ä¿®æ”¹åŽï¼Œä¼šå‘çŽ°é‡å¤çš„ä»£ç å¤šäº†ï¼Œåƒ fly å’Œ quack æŽ¥å£æ–¹æ³•ï¼Œè‹¥å­ç±»å¾ˆå¤šä¸”å¤§éƒ¨åˆ†éƒ½å®žçŽ°äº† fly æˆ– quack æŽ¥å£çš„æ—¶å€™ï¼ˆå³ä½¿æœ‰éƒ¨åˆ†çš„å®žçŽ°ä¸ä¸€æ ·ï¼‰ï¼Œåœ¨éœ€è¦è°ƒæ•´ fly æˆ– quack çš„å®žçŽ°æ—¶è¦æ”¹åŠ¨åˆ°çš„åœ°æ–¹å°±ä¼šå˜å¾—å¾ˆå¤šäº†ã€‚ æ–¹æ¡ˆä¸‰åˆ©ç”¨ç»„åˆçš„å½¢å¼æ”¹è¿›ï¼Œå¦‚ä¸‹ public interface FlyBehavior &#123; public void fly(); &#125; public class FlyWithWings implements FlyBehavior &#123; public void fly() &#123;System.out.println(&quot;Fly with wings&quot;);&#125; &#125; public class FlyNoWay implements FlyBehavior &#123; public void fly() &#123;System.out.println(&quot;Can&apos;t fly&quot;);&#125; &#125; public interface QuackBehavior &#123; public void quack(); &#125; public class Qucak implements QuackBehavior &#123; public void quack() &#123;System.out.println(&quot;Quack&quot;);&#125; &#125; public class Squeak implements QuackBehavior &#123; public void quack() &#123;System.out.println(&quot;Squeak&quot;);&#125; &#125; public class MuteQuack implements QuackBehavior &#123; public void quack() &#123;System.out.println(&quot;Silence&quot;);&#125; &#125; public abstract class Duck3 &#123; FlyBehavior flyBehavior; QuackBehavior quackBehavior; void performFly() &#123; flyBehavior.fly(); &#125; void performQuack() &#123; quackBehavior.quack(); &#125; public void swim() &#123;System.out.println(&quot;swim&quot;);&#125; public abstract void display(); &#125; public class MallardDuck3 extends Duck3 &#123; //é’å¤´é¸­ public MallardDuck3() &#123; quackBehavior = new Qucak(); flyBehavior = new FlyWithWings(); &#125; public void display() &#123;System.out.println(&quot;MallardDuck display&quot;);&#125; &#125; public class RedheadDuck3 extends Duck &#123; //çº¢å¤´é¸­ public RedheadDuck3() &#123; quackBehavior = new Qucak(); flyBehavior = new FlyWithWings(); &#125; public void display() &#123;System.out.println(&quot;RedheadDuck display&quot;);&#125; &#125; public class RubberDuck3 extends Duck &#123; //æ©¡çš®é¸­ public RubberDuck3() &#123; quackBehavior = new Squeak(); flyBehavior = new FlyNoWay(); &#125; public void display() &#123;System.out.println(&quot;RubberDuck display&quot;);&#125; &#125; public class DecoyDuck3 extends Duck &#123; //è¯±åˆ©é¸­ public DecoyDuck3() &#123; quackBehavior = new MuteQuack(); flyBehavior = new FlyNoWay(); &#125; public void display() &#123;System.out.println(&quot;DecoyDuck display&quot;);&#125; &#125; çŽ°åœ¨ï¼Œé£žç¿”å’Œå•¼å«çš„åŠ¨ä½œå§”æ‰˜äº†ä¸¤ä¸ªæŠ½è±¡çš„å®žä¾‹å˜é‡åŽ»å¤„ç†ã€‚è€Œä¸”åœ¨ Duck ä¸­æ·»åŠ ä¸¤ä¸ªå®žä¾‹å˜é‡çš„ set æ–¹æ³•ï¼Œæ›´æ˜¯å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è®¾å®šè¿™ä¸¤ç§è¡Œä¸ºã€‚ è¿™æ€»ç»“å‡º3ä¸ªè®¾è®¡åŽŸåˆ™: æ‰¾å‡ºå˜åŒ–ä¹‹å¤„ç‹¬ç«‹å‡ºæ¥ï¼Œå°è£…å˜åŒ–ï¼› é’ˆå¯¹æŽ¥å£ç¼–ç¨‹è€Œä¸è¦é’ˆå¯¹å®žçŽ°ç¼–ç¨‹ï¼ˆå³æ˜¯å¯¹æ–¹æ³•è¿›è¡ŒæŠ½ç¦»æŠ½è±¡æˆæŽ¥å£åŽä½¿ç”¨ï¼Œè‹¥åœ¨çˆ¶ç±»æˆ–å­ç±»ä¸­ç›´æŽ¥å®žçŽ°åŽä½¿ç”¨å°±ä¼šå› å¤ªè¿‡äºŽé€šç”¨è€Œå¤±åŽ»äº†çµæ´»æ€§ï¼‰ï¼› å¤šç»„åˆï¼Œå°‘ç»§æ‰¿ã€‚ æ€»ç»“ç­–ç•¥æ¨¡å¼ï¼Œå°±æ˜¯ä¸€å¥—ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºŽä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼åº”ç”¨åœºæ™¯å‡è®¾æœ‰èŒ¶å’Œå’–å•¡ä¸¤ä¸ªç±»(å¦‚ä¸‹æ‰€ç¤ºä»£ç )ï¼Œå®ƒä»¬åœ¨å†²æ³¡çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰éƒ¨åˆ†æ­¥éª¤æ–¹æ³•å®žçŽ°æ˜¯é‡å¤çš„ï¼ŒçŽ°åœ¨éœ€è¦è¿›è¡Œä¼˜åŒ–æŠ½å–å‡ºå…¬å…±çš„ä»£ç ã€‚ public class Coffee1 &#123; void prepareRecipe() &#123; boilWater(); brewCoffeeGrinds(); pourInCup(); addSugarAndMilk(); &#125; void boilWater() &#123;System.out.println(&quot;Boiling water&quot;);&#125; void brewCoffeeGrinds() &#123;System.out.println(&quot;Dripping Coffee through filter&quot;);&#125; void pourInCup() &#123;System.out.println(&quot;Pouring into cup&quot;);&#125; void addSugarAndMilk() &#123;System.out.println(&quot;Adding Sugar and Milk&quot;);&#125; &#125; public class Tea1 &#123; void prepareRecipe() &#123; boilWater(); steepTeaBag(); pourInCup(); addLemon(); &#125; void boilWater() &#123;System.out.println(&quot;Boiling water&quot;);&#125; void steepTeaBag() &#123;System.out.println(&quot;Steeping the tea&quot;);&#125; void pourInCup() &#123;System.out.println(&quot;Pouring into cup&quot;);&#125; void addLemon() &#123;System.out.println(&quot;Adding Lemon&quot;);&#125; &#125; æ–¹æ¡ˆä¸€åˆ›å»ºä¸€ä¸ªå’–å•¡å› é¥®æ–™çš„åŸºç±»ï¼Œå°†å’–å•¡å’ŒèŒ¶çš„å…¬å…±æ–¹æ³•æŠ½å–åˆ°æ­¤åŸºç±»ä¸­ï¼Œå®ƒä»¬å„è‡ªå®žçŽ°è‡ªå·±ç‰¹æœ‰çš„æ­¥éª¤æ–¹æ³• public abstract class CaffeineBeverage2 &#123; void prepareRecipe() &#123; boilWater(); pourInCup(); &#125; public void boilWater() &#123;System.out.println(&quot;Boiling water&quot;);&#125; public void pourInCup() &#123;System.out.println(&quot;Pouring into cup&quot;);&#125; &#125; public class Coffee2 extends CaffeineBeverage2 &#123; void prepareRecipe() &#123; boilWater(); brewCoffeeGrinds(); pourInCup(); addSugarAndMilk(); &#125; void brewCoffeeGrinds() &#123;System.out.println(&quot;Dripping Coffee through filter&quot;);&#125; void addSugarAndMilk() &#123;System.out.println(&quot;Adding Sugar and Milk&quot;);&#125; &#125; public class Tea2 extends CaffeineBeverage2 &#123; void prepareRecipe() &#123; boilWater(); steepTeaBag(); pourInCup(); addLemon(); &#125; void steepTeaBag() &#123;System.out.println(&quot;Steeping the tea&quot;);&#125; void addLemon() &#123;System.out.println(&quot;Adding Lemon&quot;);&#125; &#125; æ­¤æ—¶ï¼Œä¼šå‘çŽ° prepareRecipe å¹¶æ²¡æœ‰å®Œå…¨æŠ½å–åˆ°åŸºç±»ï¼Œå› ä¸ºå­ç±»çš„ prepareRecipe å®žçŽ°é‡Œé¢æ˜¯åŒ…å«å­ç±»ç‰¹æœ‰çš„æ­¥éª¤æ–¹æ³•ï¼ŒåŸºç±»ä¸­çš„ prepareRecipe å…¶å®žå¹¶æ²¡ä»€ä¹ˆå®žè´¨çš„æ„ä¹‰ï¼Œåªæ˜¯åŒ…å«ä¸ŠåŸºç±»çŸ¥é“çš„å…¬å…±æ­¥éª¤æ–¹æ³•ï¼Œå…·æœ‰çœŸæ­£æ„ä¹‰çš„åªèƒ½é å­ç±»é‡å†™çš„ prepareRecipeã€‚ ä½†è¿™æ—¶é—®é¢˜åˆæ¥äº†ï¼Œå­ç±»é‡å†™çš„ prepareRecipe æ–¹æ³•é‡Œè¿˜æ˜¯å­˜åœ¨é‡å¤çš„ä»£ç ï¼Œå°±æ˜¯ boilWater å’Œ pourInCup è¿™ä¸¤ä¸ªæ­¥éª¤ï¼Œè€Œä¸”å¦‚æžœ prepareRecipe å…¶ä¸­çš„å®žçŽ°å˜åŠ¨ï¼ˆä¾‹å¦‚æ­¥éª¤é¡ºåºç­‰æ”¹å˜ï¼‰é‚£è¦æ”¹çš„åœ°æ–¹å°±å¾ˆå¤šäº†ï¼ˆæ¯ä¸€ä¸ªå­ç±»é‡Œï¼‰ï¼Œéœ€è¦å†è¿›ä¸€æ­¥æŠ½è±¡ prepareRecipe ã€‚ æ–¹æ¡ˆäºŒæŠ½è±¡å‡ºç‰¹æ€§çš„æ­¥éª¤æ–¹æ³• public abstract class CaffeineBeverage3 &#123; void prepareRecipe() &#123; boilWater(); brew(); pourInCup(); addCondiments(); &#125; public void boilWater() &#123;System.out.println(&quot;Boiling water&quot;);&#125; public void pourInCup() &#123;System.out.println(&quot;Pouring into cup&quot;);&#125; abstract void brew(); abstract void addCondiments(); &#125; public class Coffee3 extends CaffeineBeverage3 &#123; public void brew() &#123;System.out.println(&quot;Dripping Coffee through filter&quot;);&#125; public void addCondiments() &#123;System.out.println(&quot;Adding Sugar and Milk&quot;);&#125; &#125; public class Tea3 extends CaffeineBeverage3 &#123; public void brew() &#123;System.out.println(&quot;Steeping the tea&quot;);&#125; public void addCondiments() &#123;System.out.println(&quot;Adding Lemon&quot;);&#125; &#125; æŠ½è±¡å‡ºç‰¹æ€§çš„æ­¥éª¤æ–¹æ³•åŽï¼ŒprepareRecipe å¯ä»¥å®Œå…¨æŠ½å–åˆ°åŸºç±»ä¸­å®žçŽ°äº†ï¼Œè€ŒåŸºç±»ä¹Ÿä¸ç”¨å…³æ³¨ä¸¤ä¸ªæŠ½è±¡æ­¥éª¤æ–¹æ³• brew å’Œ addCondiments çš„å…·ä½“å®žçŽ°ã€‚ è¿™é‡Œå’–å•¡å’ŒèŒ¶ç»è¿‡ä¸¤æ¬¡çš„æ–¹æ³•æŠ½å–åŽï¼Œç®—æ³•åŽŸæœ¬åœ¨è¿™ä¸¤ä¸ªå­ç±»ä¸­æŽ§åˆ¶çš„ï¼Œæ”¹ç”±åŸºç±»å’–å•¡å› é¥®æ–™ä¸»å¯¼ï¼Œä»Žè€Œå¯ä»¥ä¿æŠ¤å’Œçº¦æŸè¿™ä¸ªç®—æ³•çš„æ¡†æž¶ï¼Œå³æ˜¯åŸºç±»æ›´ä¸“æ³¨äºŽç®—æ³•æœ¬èº«ï¼Œå­ç±»æä¾›å®Œæ•´çš„å®žçŽ°ã€‚ è¿™ä¸ªä¾‹å­ä¸­æ˜¯åœ¨ç»§æ‰¿çš„å…³ç³»ä¸Šæ¼”ç¤ºçš„ï¼Œå®žé™…æƒ…å†µå¯èƒ½ä¼šæœ‰å˜ç§ï¼Œä¾‹å¦‚ç®—æ³•æœ¬èº«å¹¶ä¸åœ¨åŸºç±»ä¸Šï¼Œè€Œæ˜¯åœ¨å¦å¤–ä¸€ä¸ªç‹¬ç«‹ç±»ä¸Šå®žçŽ°ï¼Œå®Œæ•´çš„å®žçŽ°é€šè¿‡æŽ¥å£ï¼ˆiOSä¸Šå¯¹åº”çš„æ˜¯åè®®ï¼‰åŽ»èŽ·å–ã€‚ æœ€åŽï¼Œå…³äºŽè¿™ä¸ªä¾‹å­ä¸­å­ç±»å®žçŽ°çš„å®Œæ•´æ­¥éª¤æ–¹æ³•ï¼Œæœ‰æ—¶å€™å­ç±»å¯èƒ½æƒ³è¦åŠ¨æ€æŽ§åˆ¶æ˜¯å¦æ‰§è¡Œè¿™ä¸ªæ­¥éª¤ï¼Œæ‰€ä»¥è®¾è®¡è€…åœ¨æ¨¡æ¿ç®—æ³•ä¸­å¯¹äºŽå¯é€‰æ‰§è¡Œçš„æ­¥éª¤ï¼Œåº”è¯¥æä¾›é’©å­hookç»™å­ç±»åŽ»è‡ªè¡Œå†³å®šæ˜¯å¦æ‰§è¡Œï¼ˆåŸºç±»æˆ–ç®—æ³•æ‰€åœ¨çš„ç±»ä¸Šå¯ä»¥å®žçŽ°é»˜è®¤æˆ–ç©ºçš„é’©å­æ–¹æ³•ï¼Œç­‰å­ç±»é€‰æ‹©é‡å†™ï¼‰ï¼Œå¦‚ä¸‹ä¾‹ public abstract class CaffeineBeverageWithHook &#123; void prepareRecipe() &#123; boilWater(); brew(); pourInCup(); if (customerWantsCondiments()) &#123; addCondiments(); &#125; &#125; abstract void brew(); abstract void addCondiments(); public void boilWater() &#123;System.out.println(&quot;Boiling water&quot;);&#125; public void pourInCup() &#123;System.out.println(&quot;Pouring into cup&quot;);&#125; boolean customerWantsCondiments() &#123; return true; &#125; &#125; public class CoffeeWithHook extends CaffeineBeverageWithHook &#123; public void brew() &#123;System.out.println(&quot;Dripping Coffee through filter&quot;);&#125; public void addCondiments() &#123;System.out.println(&quot;Adding Sugar and Milk&quot;);&#125; public boolean customerWantsCondiments() &#123; String answer = getUserInput(); if (answer.toLowerCase().startsWith(&quot;y&quot;)) &#123; return true; &#125; else &#123; return false; &#125; &#125; private String getUserInput() &#123; String answer = null; System.out.print(&quot;Would you like milk and sugar with your coffee (y/n)?&quot;); BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); try &#123; answer = in.readLine(); &#125; catch (IOException ioe) &#123; System.err.println(&quot;IO error trying to read your answer&quot;); &#125; if (answer == null) &#123; return &quot;no&quot;; &#125; return answer; &#125; &#125; ä¸€èˆ¬ï¼Œéƒ½æ˜¯åº•å±‚ç»„ä»¶ï¼ˆå…·ä½“å®žçŽ°è€…ï¼‰æŒ‚é’©åˆ°é«˜å±‚ç»„ä»¶ï¼ˆæŠ½è±¡æ‰§è¡Œè€…ï¼‰ä¸Šï¼Œ å¦å¤–éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œç®—æ³•é‡Œçš„æ­¥éª¤åˆ‡å‰²å¾—å¤ªç»†å°±ä¼šè®©å­ç±»å®žçŽ°çš„æ­¥éª¤æ–¹æ³•éº»çƒ¦å¤æ‚ï¼Œä½†å¤ªç²—å¤ªå°‘å°±ä¼šæ¯”è¾ƒæ²¡æœ‰å¼¹æ€§ï¼Œè¿™ä¸ªéœ€è¦æŠ˜è¡·è€ƒè™‘ã€‚ æ€»ç»“æ¨¡æ¿æ–¹æ³•æ¨¡å¼å…¶å®žæ˜¯å®šä¹‰äº†ä¸€ä¸ªç®—æ³•çš„å¤§çº²ï¼Œå®šä¹‰äº†ç®—æ³•çš„æ­¥éª¤ï¼Œå¹¶ç”±å®ƒçš„å­ç±»æˆ–æŽ¥å£å®žçŽ°è€…å®šä¹‰å…¶ä¸­çš„æŸäº›æ­¥éª¤çš„å†…å®¹ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ä»£ç å¤ç”¨çš„æŠ€å·§ï¼Œå½“ä¸­çš„æŠ½è±¡ç±»å¯ä»¥å®šä¹‰å…·ä½“æ–¹æ³•ã€æŠ½è±¡æ–¹æ³•å’Œé’©å­ï¼Œä¸ºé˜²æ­¢å­ç±»æ”¹å˜æ¨¡æ¿æ–¹æ³•ï¼Œå¯ä»¥å°†æ¨¡æ¿æ–¹æ³•å£°æ˜Žä¸ºfinalã€‚ å»¶ä¼¸ï¼Œå¯¹æ¯”ä¸€ä¸‹ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼æœ‰ç‚¹ç›¸ä¼¼ï¼Œä½†æ˜¯ç­–ç•¥æ¨¡å¼é€šè¿‡ç»„åˆå§”æ‰˜å¯¹è±¡çš„å½¢å¼æ˜¯å¯ä»¥åŠ¨æ€æ›´æ¢ç®—æ³•ä¸­çš„å®žçŽ°æ­¥éª¤ï¼Œä¸è¿‡ç®—æ³•çš„å°è£…å› ä¸ºæ•£è½åœ¨å­ç±»è€Œæ²¡æœ‰ç»å¯¹çš„æŽ§åˆ¶æƒï¼Œä¼šè¾ƒå®¹æ˜“å‡ºçŽ°é‡å¤ä»£ç ã€‚è€Œå·¥åŽ‚æ–¹æ³•åˆ™æ˜¯æ¨¡æ¿æ–¹æ³•çš„ä¸€ç§ç‰¹æ®Šç‰ˆæœ¬ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flutterå¼€å‘ï¼ˆå®žè·µç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%2FFlutter%E5%BC%80%E5%8F%91%EF%BC%88%E5%AE%9E%E8%B7%B5%E7%AF%87%EF%BC%89%2F</url>
    <content type="text"><![CDATA[çŽ¯å¢ƒæ­å»ºiOS å…‹éš†Flutteré¡¹ç›®git clone -b beta https://github.com/flutter/flutter.git å°†flutteråŠ å…¥pathä½¿ç”¨zshçš„åŒå­¦è¦æ³¨æ„ï¼Œä¿®æ”¹.zshrcæ‰æœ‰æ•ˆï¼Œè€Œä¸æ˜¯.bash_profileã€‚ export PATH=[å…‹éš†é¡¹ç›®çš„ç›®å½•]/flutter/bin:$PATH å®‰è£…iOSä¾èµ–çš„å·¥å…· $ brew install --HEAD libimobiledevice $ brew install ideviceinstaller ios-deploy cocoapods å®‰è£…VS Codeä¸‹è½½åœ°å€ åœ¨VSä¸­å®‰è£…Dartä»¥åŠFlutterè‹¥Androidä¹Ÿä½¿ç”¨VS Codeçš„è¯ï¼Œä¹Ÿæ˜¯åŒæ ·éœ€è¦è¯¥æ­¥éª¤ã€‚ è¿è¡ŒFlutterçš„çŽ¯å¢ƒæ£€æŸ¥ç¬¬ä¸€æ¬¡è¿è¡ŒflutteræŒ‡ä»¤æ—¶ä¼šä¸‹è½½é¢å¤–çš„å†…å®¹å’Œç¼–è¯‘å‡ºflutterå·¥å…·ï¼Œéœ€è¦ç­‰ä¸€æ®µæ—¶é—´ã€‚ flutter doctor Android åˆå§‹åŒ–é¡¹ç›®åœ¨ASçš„åå¥½è®¾ç½®çš„æ’ä»¶èœå•ä¸­é€‰æ‹©æµè§ˆä»“åº“ï¼Œå†é€‰æ‹©å®‰è£…Flutteræ’ä»¶ï¼ŒåŒæ—¶ä¹Ÿå®‰è£…Dartæ’ä»¶ï¼Œç„¶åŽé‡å¯ã€‚å‚è€ƒ å®‰è£…adbåŠä½¿ç”¨ brew cask install android-platform-tools adb devices adb install /Path/to/app-debug.apk é€šè¿‡flutter doctorçš„æŒ‡å¼•æ¥åŒæ„lisence åˆ›å»ºå·¥ç¨‹Appå¼€å‘åˆ›å»ºçº¯Flutterçš„Appå·¥ç¨‹ flutter create myApp å¦‚æžœåœ¨Appé‡Œå¯¼å…¥äº†åŒ…(package)æˆ–è€…æ’ä»¶(plugin)ï¼Œæ‰§è¡Œflutter packages getå‘½ä»¤åŽï¼Œä»¥iOSä¸ºä¾‹ï¼Œæ’ä»¶çš„å¹³å°æºç ä¼šåœ¨ä¸‹å›¾çš„æ–°å»ºè·¯å¾„ä¸Šå­˜æ”¾å¹¶å¼•ç”¨ï¼Œå¦‚ä¸‹å›¾ åŽŸèº«åœ¨ä¸‹é¢çš„è·¯å¾„ä¸­ /Users/user/.pub-cache/hosted/pub.dartlang.org åœ¨Appç¼–è¯‘æ—¶ï¼ŒåŒ…æˆ–è€…æ’ä»¶çš„libä¸­çš„dartä»¥åŠpluginä¸­çš„platform(iOS/Android)ä»£ç å°±è¢«ä¸€å¹¶ç¼–è¯‘åˆ°App.frameworkä¸­ åŒ…åŠæ’ä»¶å¼€å‘Flutterçš„åŒ…ï¼Œæ˜¯æŒ‡é€šè¿‡åˆ©ç”¨pubspec.yamlæ–‡ä»¶å‘å¸ƒç‰ˆæœ¬çš„å½¢å¼æä¾›çº¯Dartçš„ä¾èµ–Flutteræ¡†æž¶å®žçŽ°çš„åº“ç»™Flutterçš„Appä½¿ç”¨ï¼Œæˆ–è€…æä¾›ç»™Native Appä¸­çš„Flutter Moduleä½¿ç”¨ã€‚ flutter create --template=package hello Flutterçš„æ’ä»¶ï¼Œå…¶å®žå®ƒä¹Ÿç®—æ˜¯åŒ…çš„ä¸€ç§ï¼Œæ˜¯æŒ‡æä¾›å¯è®¿é—®NativeåŠŸèƒ½çš„DartæŽ¥å£åº“ï¼Œä¸­é—´é€šè¿‡channelæŠ€æœ¯å®žçŽ°é€šä¿¡ï¼Œæ’ä»¶åŒæ ·å¯ä»¥é€šè¿‡å‘å¸ƒç‰ˆæœ¬æä¾›ã€‚ flutter create --template=plugin -i objc -a java plugin_template -i -a å‚æ•°æ˜¯åˆ†åˆ«æŒ‡å®šiOSå’ŒAndroidä¸¤å¹³å°ä»£ç ä½¿ç”¨çš„è¯­è¨€ï¼ˆé¢„è®¾åˆ°æ¨¡æ¿ä¸­ï¼‰ã€‚ æ··åˆå¼€å‘æ··åˆå¼€å‘æ˜¯åœ¨Native Appçš„åŸºç¡€ä¸Šï¼ŒåµŒå…¥Flutterçš„æ¨¡å—ï¼Œå…±åŒå¼€å‘ã€‚ flutter create -t module my_flutter è‹¥æƒ³åœ¨æ··åˆå¼€å‘ä¸­è§£é™¤å¯¹Flutterçš„ä¾èµ–ï¼Œå¯ä»¥å…ˆæ¥çœ‹çœ‹Flutterå®ƒæ‰€ä¾èµ–çš„æ–‡ä»¶ï¼š Flutteråº“å’Œå¼•æ“Žï¼šFlutter.frameworkï¼ˆflutter.jarï¼‰ï¼› Flutterå·¥ç¨‹çš„äº§ç‰©ï¼šApp.frameworkï¼ˆvm/isolate_snapshot_data/instrï¼‰ï¼ŒAppå’ŒModuleæœ€åŽçš„äº§ç‰©éƒ½æ˜¯è¿™ç§å½¢å¼ï¼› Flutter Pluginï¼šç¼–è¯‘å‡ºå„ç§Pluginçš„frameworkï¼Œå†…å«æ’ä»¶çš„Dartä»¥åŠå“åº”å®ƒçš„OCä»£ç ï¼ˆiOS:GeneratedPluginRegistrant.m; Android:GeneratedPluginRegistrant.javaï¼‰ã€‚ å°†è¿™ä¸‰éƒ¨åˆ†çš„ç¼–è¯‘ç»“æžœæŠ½å–å‡ºæ¥ï¼Œæ‰“åŒ…æˆä¸€ä¸ªSDKä¾èµ–çš„å½¢å¼æä¾›ç»™Nativeå·¥ç¨‹ï¼Œå°±å¯ä»¥è§£é™¤Nativeå·¥ç¨‹å¯¹Flutterå·¥ç¨‹çš„ç›´æŽ¥ä¾èµ–äº†ã€‚ è¿è¡Œè°ƒè¯•è¿è¡Œflutter run ç¼–è¯‘flutter build ios --no-codesign [--simulator] #é’ˆå¯¹æ¨¡æ‹Ÿå™¨ flutter build apk ç¬¬ä¸€æ¬¡æ‰“å¼€Flutterçš„Androidå·¥ç¨‹åŽï¼Œç‚¹å‡»make projectæŒ‰é’®å…ˆæž„é€ é¡¹ç›®ï¼Œå®žè´¨å°±æ˜¯é€šè¿‡gradleæ‹‰å–å¯¹åº”ä¾èµ–çš„åº“ï¼Œè€ŒiOSå·¥ç¨‹è‹¥æ— podfileåˆ™å¯ä»¥ç›´æŽ¥è¿è¡Œç¼–è¯‘ï¼Œå¦åˆ™éœ€å…ˆæ‰§è¡Œpod installå‘½ä»¤ã€‚ çƒ­é‡è½½ctrl+s/cmd+sï¼Œä¿å­˜æ–‡ä»¶å˜æ›´ï¼Œå³å¯è§¦å‘çƒ­é‡è½½ï¼Œæˆ–è€…ç‚¹å‡»è¿è¡Œæ—¶å·¥å…·æ ä¸­çš„reloadæŒ‰é’®ã€‚ ä½†æ˜¯åœ¨ä»¥ä¸‹æƒ…å†µä¼šå¯¼è‡´é‡è½½å¤±è´¥ï¼š ç¼–è¯‘é”™è¯¯ï¼› æŽ§ä»¶ç±»åž‹ä»ŽStatelessWidgetåˆ°StatefulWidgetçš„è½¬æ¢ï¼› å…¨å±€å˜é‡å’Œé™æ€æˆå‘˜å˜é‡çš„å˜æ›´ã€‚ ä¿®æ”¹äº†mainå‡½æ•°ä¸­åˆ›å»ºçš„æ ¹æŽ§ä»¶èŠ‚ç‚¹ï¼› æŸä¸ªç±»ä»Žæ™®é€šç±»åž‹è½¬æ¢æˆæžšä¸¾ç±»åž‹ï¼Œæˆ–è€…ç±»åž‹çš„æ³›åž‹å‚æ•°åˆ—è¡¨å˜åŒ–ï¼› é‡åˆ°çš„é—®é¢˜iOS åœ¨iOSç«¯è·‘pod installæ—¶ï¼Œæç¤º/Path/To/ExistingApp/Flutter/engineè·¯å¾„æ— æ•ˆï¼Œéœ€è¦è‡ªè¡Œå…ˆåœ¨ExistingAppé¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºFlutteræ–‡ä»¶å¤¹ï¼› iOSç¼–è¯‘æŠ¥é”™ï¼ŒFlutterPluginRegistrant Targetä¸­çš„GeneratedPluginRegistrant.hæç¤º#import &lt;Flutter/Flutter.h&gt;æ‰¾ä¸åˆ°ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸ºè¯¥Targetå¼•ç”¨ä¸ŠFlutter.frameworkï¼Œæˆ–å°†App Build Phasesä¸­çš„Run Scriptç§»åˆ°Check Pods Mnifest.lockä¹‹åŽï¼› iOSç¼–è¯‘æŠ¥é”™ï¼Œæç¤º /packages/flutter_tools/bin/xcode_backend.sh: No such file or directoryï¼Œæ­¤æ—¶è¦åœ¨BuildSettingsä¸­çš„User-Definedä¸­è®¾ç½®çŽ¯å¢ƒå˜é‡FLUTTER_ROOTï¼Œå€¼flutter sdkçš„è·¯å¾„ï¼ˆåŒ…å«packagesæ–‡ä»¶å¤¹ï¼‰ï¼Œå…¶å¯¹åº”App Run Scriptè„šæœ¬ä¸­çš„$FLUTTER_ROOTï¼› å¦‚ä½•åˆ‡æ¢è®¾å¤‡ï¼Œè‹¥Macä¸Šæœ‰å¤šä¸ªXcodeï¼Œä¸”VScodeä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„iPhoneæ¨¡æ‹Ÿå™¨æ—¶ï¼Œä¼šæœ‰ä»¥ä¸‹æŠ¥é”™ï¼Œæ­¤æ—¶ï¼Œåœ¨VScodeæœ€åº•ä¸‹çš„å·¥å…·æ¡ä¸­ç‚¹å‡»è®¾å¤‡è¿›è¡Œåˆ‡æ¢ï¼Œå¦‚ä¸‹å›¾ä¸­çš„iPhoneX 12.0(ios)å¯åˆ‡æ¢ä¸ºiPhoneX(ios Emulator) Code Signing Warning: â€œRunnerâ€ isnâ€™t code signed but requires entitlements. It is not possible to add entitlements to a binary without signing it. Xcode10è¿è¡ŒæŠ¥é”™ï¼Œåœ¨File-&gt;Workspace Settings-&gt;Build System æ”¹æˆ Legacy Build Systemå³å¯ã€‚å‚è€ƒ Multiple commands produce â€˜/Users/Library/Developer/Xcode/DerivedData/Runner-dunimcekkdlkcxevvsirtjrlpkdg/Build/Products/Debug-iphonesimulator/Runner.app/Frameworks/Flutter.frameworkâ€™: 1) Target â€˜Runnerâ€™ has copy command from â€˜/Users/Flutter/plugin_template/example/ios/Flutter/Flutter.frameworkâ€™ to â€˜/Users/Library/Developer/Xcode/DerivedData/Runner-dunimcekkdlkcxevvsirtjrlpkdg/Build/Products/Debug-iphonesimulator/Runner.app/Frameworks/Flutter.frameworkâ€™2) That command depends on command in Target â€˜Runnerâ€™: script phase â€œ[CP] Embed Pods Frameworksâ€ App.frameworkä¸­çš„dartä»£ç æ²¡æ›´æ–°æ—¶ï¼Œåœ¨debugæ¨¡å¼ä¸‹åœ¨vsä¸Šreloadä¸€ä¸‹å³å¯ã€‚ è¿è¡Œå´©æºƒï¼Œæç¤º Image Not Foundã€‚Flutterå·¥ç¨‹ç”Ÿæˆçš„App.frameworkå’ŒFlutter.frameworkå¯¼å…¥åº”ç”¨å·¥ç¨‹åŽè¿è¡Œå´©æºƒã€‚åœ¨Embedded Binariesä¸­æ·»åŠ ä¸ŠApp.frameworkå’ŒFlutter.frameworkå³å¯è§£å†³ã€‚ Library not loaded: @rpath/App.framework. Reason: Image Not Found å±•ç¤ºFlutterViewControlleråŽæ²¡æœ‰å†…å®¹æ˜¾ç¤ºï¼ŒåŒæ—¶æŠ¥é”™äº†ã€‚å°†Flutter(æ’ä»¶)å·¥ç¨‹ä¸­çš„flutter_assetså¤åˆ¶åˆ°åº”ç”¨å·¥ç¨‹ï¼Œä¸”ä»¥ç»å¯¹è·¯å¾„æ·»åŠ ï¼Œflutter_assetsåœ¨ä¸ŽäºŒè¿›åˆ¶æ–‡ä»¶åŒçº§ç›®å½•ä¸‹ã€‚ [VERBOSE-2:engine.cc(112)]Engine run configuration was invalid.[VERBOSE-2:FlutterViewController.mm(437)] Could not launch engine with configuration. æ— æ³•åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè·‘releaseç›¸å…³çš„ä»£ç æš‚æ—¶è¿˜ä¸æ”¯æŒåœ¨æ¨¡æ‹Ÿå™¨ä¸Šå¯åŠ¨releaseæ¨¡å¼æˆ–è·‘å¼•ç”¨äº†releaseæ¨¡å¼ä¸‹ç”Ÿæˆçš„Flutter Appåº“çš„é¡¹ç›®ã€‚è€Œåˆä¸ºä»€ä¹ˆä¸€å®šè¦è·‘releaseæ¨¡å¼å‘¢ï¼Œå› ä¸ºdebugæ¨¡å¼ç”Ÿæˆçš„Flutter.frameworkå«dartçš„è™šæ‹Ÿæœºè¿›è¡ŒJITï¼Œè‹¹æžœæš‚æ—¶è¿˜ä¸å…è®¸è¯¥åŠ¨æ€ç¼–è¯‘ï¼ˆå¯ä»¥çš„è¯çƒ­æ›´ä¹Ÿå°±å·²ç»ç”¨ä¸Šäº†ï¼‰ã€‚debugæ¨¡å¼æ˜¯æ–¹ä¾¿æˆ‘ä»¬reloadè°ƒè¯•ï¼Œä¸ç”¨é‡å¤åœæ­¢å’Œè¿è¡Œå·¥ç¨‹é¡¹ç›®ã€‚å‚è€ƒ æ— æ³•åœ¨çœŸæœºä¸Šå®‰è£…ç¼–è¯‘é€šè¿‡åŽåœ¨å®‰è£…é˜¶æ®µæŠ¥é”™ï¼Œæ›¿æ¢ä¸ºdebugæ¨¡å¼ä¸‹ç”Ÿæˆçš„App.frameworkå’ŒFlutter.frameworkåˆ™èƒ½æ­£å¸¸å®‰è£…ï¼ˆä½†è¿è¡Œæ—¶ä¼šå´©æºƒï¼Œå› ä¸ºdebugæ¨¡å¼ä¸‹å¯¼å‡ºçš„App.frameworkä¸å«arm7så’Œarm64çš„çœŸæœºæ¡†æž¶ï¼‰ã€‚è€Œæ¢å›žè‡ªè¡Œåœ¨Generated.xcconfigä¿®æ”¹FLUTTER_BUILD_MODEå’ŒFLUTTER_FRAMEWORK_DIRä¸ºreleaseå€¼(å…·ä½“å€¼ä¸ºreleaseå’Œpath/to/flutter/bin/cache/artifacts/engine/ios-release)ï¼Œé€šè¿‡è¿è¡ŒFlutteré¡¹ç›®åŽæå‡ºçš„App.frameworkå’ŒFlutter.frameworkåˆ™ç»§ç»­æŠ¥é”™ã€‚åŽæ¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¼–è¯‘Flutteré¡¹ç›®å†æå–App.frameworkå’ŒFlutter.frameworkå³è§£å†³ã€‚æ‰§è¡Œä¸‹é¢è¿™æ¡æŒ‡ä»¤ä¼šè‡ªåŠ¨æ›´æ–°Generated.xcconfigä¸­ä¸Šè¿°æåˆ°çš„é¡¹ä¸ºreleaseå€¼ï¼Œè¿™æ ·ç¼–è¯‘å¾—åˆ°çš„frameworkæ‰æœ‰æ•ˆã€‚ flutter build ios --no-codesign --release å‚è€ƒé“¾æŽ¥å‚è€ƒé“¾æŽ¥ app installation failed. Could not inspect the application package Android Androidåœ¨gradle buildæ—¶æç¤ºé”™è¯¯ï¼Œå°†.flutter/packages/flutter_tools/gradle/flutter.gradleä¸­çš„maven {...}ä¸€æ®µç§»åˆ°jcenter()ä¹‹ä¸Šå³å¯ã€‚å‚è€ƒ flutter Could not find lint-gradle-api.jar com.android.tools.lint:lint-gradle-api:26.1.2` Configuration(Target)çš„Android Appä¸­æç¤ºPlease select Android SDKï¼Œæ­¤æ—¶è¿è¡Œé€‰é¡¹ File -&gt; Sync Project with Gradle Filesï¼ˆåœ¨ä¸»é¢æ¿çš„å³ä¸Šè§’ä¹Ÿæœ‰ä¾¿æ·æŒ‰é’®ï¼‰å³å¯è§£å†³ã€‚å‚è€ƒ Androidä¸‹ï¼ŒNo Target Device Foundï¼Œæ²¡æœ‰è®¾å¤‡å¯ç”¨ï¼Œåœ¨ Edit Configurationsä¸­ï¼Œå³ä¸‹æ–¹çš„ Deployment Target é€‰é¡¹é€‰æ‹©Open Select Deployment Target Dialogå³å¯ã€‚å‚è€ƒ æž„å»ºåŠå®šä½Androidçš„apkæ–‡ä»¶ã€‚èœå•é€‰é¡¹ Build-&gt;Build APKï¼šæ˜¯éšæœºç”Ÿæˆç­¾åçš„æž„å»ºï¼Œè€Œ Build-&gt;Generate Signed APKï¼šæ˜¯æŒ‡å®šç­¾åçš„æž„å»º(ç­¾åä¸ºsha1æ–‡ä»¶)ã€‚æž„å»ºå®Œæ¯•åŽï¼Œåœ¨å¼¹å‡ºçš„Tipsä¸­ç‚¹å‡»Localé“¾æŽ¥å¯æ‰¾åˆ°APKæ‰€åœ¨ä½ç½®ï¼ˆflutterProject/build/host/outputs/apkï¼‰ åŠŸèƒ½å®žçŽ°é—®é¢˜é€æ˜ŽèƒŒæ™¯å®˜æ–¹æŽ¢ç©¶ä¸­ï¼ˆè·Ÿè¿›ï¼‰: https://github.com/flutter/flutter/issues/9321 Flutterä¸Šè°ƒç”¨åŽŸç”Ÿæ¡¥æŽ¥å£æŠ¥é”™æ²¡æ‰¾åˆ°æ–¹æ³• Dart Error Unhandled exception MissingPluginException No implementation found for method ç”±äºŽæ·»åŠ channelçš„æ³¨å†Œè¡¨å¯¹è±¡æ²¡ä¸Žä½œä¸ºFlutterè§†å›¾æ˜¾ç¤ºçš„å¯¹è±¡ï¼ˆå®žçŽ°FlutterPluginåè®®çš„FlutterViewControllerï¼‰ä¸€è‡´ã€‚ å³æ˜¯ä¸‹é¢è¯¥æ–¹æ³•ä¸­ï¼Œç”Ÿæˆregisterçš„flutterViewControllerï¼ˆregister=[flutterViewController registrarForPlugin:pluginName]ï¼‰åœ¨æ˜¾ç¤ºæ—¶ï¼Œæ‰èƒ½ä½¿ç”¨efun_flutter_pluginè¯¥channelåè°ƒç”¨EFFlutterModuleä¸­çš„ä»£ç†æ–¹æ³• + (void)registerWithRegistrar:(NSObject&lt;FlutterPluginRegistrar&gt;*)registrar &#123; FlutterMethodChannel* channel = [FlutterMethodChannel methodChannelWithName:@&quot;efun_flutter_plugin&quot; binaryMessenger:[registrar messenger]]; [registrar addMethodCallDelegate:[EFFlutterModule shareInstance] channel:channel]; &#125; æ‹‰ä¼¸listViewå­é¡¹ä½¿ç”¨itemExtentå±žæ€§ï¼Œä¸ºlistViewå†…å®¹æŒ‡å®šé«˜åº¦ã€‚ é™åˆ¶listViewæ»‘åŠ¨å°†itemExtentè®¾ä¸ºæŒ‡å®šé«˜åº¦åŽï¼Œå†é…åˆshrinkWrapè®¾ä¸ºtrueï¼Œä½†æ­¤æ—¶ä»å¯èƒ½è¿˜æ˜¯å¯ä»¥æ‰‹åŠ¨æ»‘åŠ¨åˆ°listViewï¼Œè¿™æ—¶å°†listViewçš„paddingè®¾ä¸ºEdgeInsets.zeroå³å¯è§£å†³ï¼Œå› ä¸ºlistViewå†…å®¹çš„åº•éƒ¨é»˜è®¤å¤šå‡ºä¸€ä¸ªpaddingçš„ç™½è‰²æ ï¼Œè‹¥æ­¤é«˜åº¦è¶…å‡ºå±å¹•çš„è¯listViewè¿˜æ˜¯å¯ä»¥è¢«æ‰‹åŠ¨æ»‘åŠ¨ï¼Œç„¶åŽè¿˜æœ‰è®¾ç½®ä¸Šcontrollerå±žæ€§ï¼ˆæ— éœ€å®žçŽ°ç›‘å¬ï¼‰ï¼Œè¿™æ ·å°±æ—¢èƒ½é™åˆ¶æ»‘åŠ¨ä¹Ÿèƒ½æœ‰æ•ˆä½¿é”®ç›˜å¼¹å‡ºåŽç•Œé¢è‡ªåŠ¨ä¸Šç§»ã€‚ åŽŸç”Ÿè·³è½¬åˆ°Flutterç™½å±1ç§’ ææ—©æ³¨å†Œ é‡‡ç”¨releaseä¸‹çš„AOTæ¨¡å¼ è·³è½¬Routeæ— æ•ˆNavigator.pushNamed(context, arguments[&apos;route&apos;]);ä»¥ä¸Šçš„contextå¿…é¡»ä¸ºå½“å‰æ¸²æŸ“Viewä¸­çš„contextï¼Œå¦åˆ™pushæ— æ•ˆã€‚ ä»ŽNativeèŽ·å–åˆ°çš„å­—å…¸æ— æ³•ç›´æŽ¥å¤åˆ¶ç»™Map _InternalLinkedHashMap&lt;dynamic, dynamic&gt;â€™ is not a subtype of type â€˜Map&lt;String, dynamic&gt; var resultValues = Map&lt;String, String&gt;.from(result);å‚è€ƒ æ”¶èµ·é”®ç›˜ä¸”æ¸…é™¤ç„¦ç‚¹FocusScope.of(context).requestFocus(new FocusNode());ä¸ºScrollViewæ·»åŠ æ»‘åŠ¨äº‹ä»¶ç›‘å¬ScrollController scrollController = ScrollController(); scrollController.addListener(scrolledListView); ListView(controller: scrollController,...); Null scrolledListView() { scrollController.jumpTo(scrollController.position.minScrollExtent); }éšä¸–æ»‘åŠ¨ScrollViewåˆ°æŒ‡å®šä½ç½®scrollController.jumpTo(scrollController.position.minScrollExtent);èŽ·å–TextFieldçš„textå€¼var textController = TextEditingController(); textfield = TextField( controller: controller, ... ); String wanted = textController.textTextFieldçš„è£…é¥°TextField( decoration: InputDecoration( hintText: placeholder, fillColor: Colors.white, filled: true, contentPadding: EdgeInsets.fromLTRB(5.0, 5.0, 5.0, 5.0), border: new OutlineInputBorder( borderRadius: BorderRadius.circular(5.0), ), ) );TextFieldè¾“å…¥å¯†æ–‡TextField( obscureText: true, ... );ä¸ºèƒŒæ™¯æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬GestureDetector( onTap: () {}, child: backgroundWidget )æ˜¾ç¤ºTextfieldFlutterä¸­çš„Textfieldå¿…é¡»ç”¨MaterialAppåŒ…è£¹çš„ScaffoldåŒ…è£¹çš„Widgetæ¥åŒ…è£¹ï¼Œæ‰èƒ½æ˜¾ç¤ºï¼Œå¦åˆ™æ¸²æŸ“æŠ¥é”™ã€‚ æŒ‰æ¯”ä¾‹åˆ†å‰²çš„è‡ªåŠ¨çº¦æŸåœ¨Columnæˆ–è€…Rowä¸­ï¼Œçš„Widgetå‡ä½¿ç”¨ExpandedåŒ…è£¹ï¼Œä¸”å¯¹æ¯ä¸ªExpandedè®¾ç½®å…¶flexå±žæ€§ï¼Œå…¶æ¯”ä¾‹å°±ç­‰äºŽå®ƒçš„flexåœ¨å…¶æ‰€åœ¨çš„Columnæˆ–Rowä¸­æ‰€æœ‰Expandedçš„flexæ€»å’Œçš„å æ¯”ï¼ŒåŒæ—¶åœ¨Expandedä¸­çš„æŽ§ä»¶åˆ™ä¼šè¢«è‡ªåŠ¨ä¼¸ç¼©ã€‚ å‡åŒ€åˆ†å¸ƒColomnæˆ–Rowçš„å­é¡¹ï¼š mainAxisAlignment: MainAxisAlignment.spaceEvenlyèŽ·å–å±å¹•SizeWidget build(BuildContext context) { Size size = MediaQuery.of(context).size; ... return widget }å®šä¹‰å¯ç»§æ‰¿çš„æˆå‘˜å˜é‡final platformMethodChannel = MethodChannel(&apos;com.fun.global/ui&apos;);å¾€Nativeä¼ å€¼try { Map&lt;String, String&gt; map = { &quot;email&quot;: email, &quot;password&quot;: password }; final String result = await methodChannel.invokeMethod(&apos;#methodName&apos;,map); //ä¸ä¸€å®šè¿”å›žStringï¼ŒçŽ°ä¸ºç¤ºä¾‹ print(result); } on PlatformException catch (e) { String message = &quot;exception: ${e.message}.&quot;; print(message); } æ¸å˜åŠ¨ç”»Navigator.push( context, PageRouteBuilder( pageBuilder: (BuildContext context, _, __) { return EmailLoginView(); }, transitionsBuilder: (___, Animation&lt;double&gt; animation, ____, Widget child) { return FadeTransition( opacity: Tween&lt;double&gt;(begin: 0.0, end: 1.0).animate(animation), child: child, ); }, transitionDuration: Duration(milliseconds: 500),), );å‚è€ƒ å€’è®¡æ—¶Future&lt;Null&gt; onTapSendVerificationCodeButton() async &#123; if (_seconds == 0) &#123; setState(() &#123; _startTimer(); &#125;); else &#123; return; &#125; &#125; _startTimer() &#123; _seconds = 60; _timer = new Timer.periodic(new Duration(seconds: 1), (timer) &#123; if (_seconds == 0) &#123; _cancelTimer(); return; &#125; _seconds--; _sendButtonTitle = &apos;$_seconds(s)&apos;; setState(() &#123;&#125;); if (_seconds == 0) &#123; _sendButtonTitle = &apos;å‘é€éªŒè¯ç &apos;; &#125; &#125;); &#125; _cancelTimer() &#123; _timer?.cancel(); &#125; Indicatorå…ˆå¯¹Stateè°ƒç”¨setState((){â€¦})å¯¹ç•Œé¢åˆ·æ–°ï¼Œåœ¨setStateçš„å›žè°ƒå—ä¸­å°†Indicatoræ·»åŠ åˆ°Stackçš„é¡¶å±‚(childrençš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œå‰é¢çš„å…ƒç´ ä¸ºåŽŸæ¥Widget)ï¼Œä¸€èˆ¬é€šè¿‡ä¸€ä¸ªçŠ¶æ€å˜é‡æŽ§åˆ¶è¯¥Stackæ˜¯å¦è¦æ·»åŠ Indicatorã€‚https://codingwithjoe.com/flutter-how-to-build-a-modal-progress-indicator/ èŽ·å–å¹³å°ä¿¡æ¯import &apos;dart:io&apos;; Platform.isIOS;è‡ªå®šä¹‰è·¯ç”±è·³è½¬åŠ¨ç”»class MyCustomRoute&lt;T&gt; extends MaterialPageRoute&lt;T&gt; &#123; MyCustomRoute(&#123; WidgetBuilder builder, RouteSettings settings &#125;) : super(builder: builder, settings: settings); @override Widget buildTransitions(BuildContext context, Animation&lt;double&gt; animation, Animation&lt;double&gt; secondaryAnimation, Widget child) &#123; if (settings.isInitialRoute) return child; // Fades between routes. (If you don&apos;t want any animation, // just return child.) return new FadeTransition(opacity: animation, child: child); &#125; &#125; class MyApp extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( onGenerateRoute:(RouteSettings settings) &#123; switch (settings.name) &#123; case &apos;/&apos;: return new MyCustomRoute( builder: (_) =&gt; new HomeView(), settings: settings, ); case &apos;/emailLoginView&apos;: return new MyCustomRoute( builder: (_) =&gt; EmailLoginView(), settings: settings, ); &#125; &#125;, ); &#125; &#125; æ³¨æ„MaterialAppä¸­çš„homeå’Œrouteså‚æ•°å¯¹onGenerateRouteçš„å½±å“ã€‚ Androidç«¯çš„è¾“å…¥æ³•ä¸å“åº”åœ¨activityç”Ÿå‘½å‘¨æœŸonResumeä¹‹åŽåˆ›å»ºæ˜¾ç¤ºçš„flutterViewï¼Œè¾“å…¥æ³•ä¸ä¼šå“åº”ã€‚è¿™ä¸ªæ˜¯flutterçš„bugã€‚è§£å†³æ–¹æ³•æ˜¯ï¼Œæ”¹ä¸€ä¸‹windowçš„å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼Œä¾‹å¦‚éšè—å†æ˜¾ç¤ºã€‚ æ¡¥Flutter ä¾§ï¼š class GlobalBridge &#123; static const MethodChannel global_ui_channel = const MethodChannel(&apos;com.fun.global/ui&apos;); //è®¾ç½®é€šé“å¯¹Flutterçš„å›žè°ƒ static void registerChannel() &#123; global_ui_channel.setMethodCallHandler(handleMethodCall); &#125; //åŽŸç”Ÿè°ƒFlutterçš„å¤„ç† static Future&lt;dynamic&gt; handleMethodCall(MethodCall methodCall) async &#123; if (method == &apos;xxx&apos;) &#123; ... &#125; &#125; //Flutterè°ƒNative static Future&lt;dynamic&gt; callMethod(String method,[dynamic arguments]) &#123; return global_ui_channel.invokeMethod(method,arguments); &#125; Native ä¾§ï¼ˆiOSï¼‰ï¼š //è®¾ç½®Flutterçš„æ’ä»¶å + (void)registerWithRegistry:(NSObject&lt;FlutterPluginRegistry&gt;*)registry &#123; NSObject&lt;FlutterPluginRegistrar&gt;* registrar = [registry registrarForPlugin:@&quot;global_plugin&quot;]; [[self class] registerWithRegistrar:registrar]; &#125; //èŽ·å–æ¡¥é€šé“å¹¶è®¾ç½®é€šé“å¯¹Nativeçš„å›žè°ƒ + (void)registerWithRegistrar:(NSObject&lt;FlutterPluginRegistrar&gt;*)registrar &#123; FlutterMethodChannel *globalUiChannel = [FlutterMethodChannel methodChannelWithName:@&quot;com.fun.global/ui&quot; binaryMessenger:[registrar messenger]]; [registrar addMethodCallDelegate:[EFNGlViewNavigator sharedNavigator] channel:globalUiChannel]; [EFNGlViewNavigator sharedNavigator].globalUiChannel = globalUiChannel; &#125; //Flutterè°ƒåŽŸç”Ÿçš„å¤„ç† - (void)handleMethodCall:(FlutterMethodCall*)call result:(FlutterResult)result &#123; NSString *method = call.method; if ([method isEqualToString:@&quot;#request_bindFacebook&quot;]) &#123; [SomeClass requestWithCompletion:^(NSDictionary * _Nullable resultDict, NSError * _Nullable error) &#123; result(resultDict); &#125;]; &#125; &#125; //åŽŸç”Ÿè°ƒFlutter - (void)callFlutterMethod:(NSString *)method arguments:(id)arguments result:(nullable FlutterResult)callback &#123; if (method.length&gt;0) &#123; [self.globalUiChannel invokeMethod:method arguments:arguments result:callback]; &#125; &#125; è°ƒè¯•åœ¨mainå‡½æ•°ä¸­è®¾ç½®debugPaintSizeEnabledä¸ºtrue import &apos;dart:developer&apos;; void main() { debugPaintSizeEnabled=true; }cmd+shift+pï¼Œç„¶åŽè¾“å…¥Flutter Toggle Debug Paintingï¼Œå¼€å¯Debug Paintingæ¨¡å¼ å‚è€ƒ å…¶å®ƒå›½é™…åŒ–ï¼šå‚è€ƒå¼‚æ­¥ï¼šå‚è€ƒæž„é€ ï¼šå‚è€ƒalertDialogï¼šå‚è€ƒæ­£åˆ™è¡¨è¾¾å¼ï¼šå‚è€ƒAppUiDemoï¼šå‚è€ƒæ•ˆçŽ‡ï¼šå‚è€ƒéšè—çŠ¶æ€æ ï¼šå‚è€ƒ æ€»ç»“æ•´ä½“çš„çŽ¯å¢ƒæ­å»ºã€å¼€å‘æµç¨‹å¹¶ä¸å¤æ‚ï¼ŒDartè¯­è¨€ä¸Šæ‰‹ä¹Ÿå¾ˆå¿«ã€‚çƒ­é‡è½½å¯¹äºŽè°ƒè¯•Appçš„UIçœŸçš„æ˜¯ä¸€å¤§ç¦éŸ³ï¼Œä¸è¿‡åœ¨Moduleçš„æ··åˆå¼€å‘æ¨¡å¼ä¸‹ï¼Œè¦æƒ³ä¸ŽåŽŸç”Ÿèµ·åˆ°è”è°ƒä¸”èƒ½ç»§ç»­ä½¿ç”¨çƒ­é‡è½½åŠŸèƒ½çš„è¿™éƒ¨åˆ†è¿˜æ²¡æžæ¸…æ¥šæ€Žä¹ˆå¼„ã€‚Flutterçš„UIæ­å»ºä½“éªŒä¸Šä¹Ÿå¾ˆå¥½ï¼Œç»è¿‡å°è£…ï¼Œæ•´ä½“ç»“æž„è¿˜æ˜¯å¯ä»¥å¾ˆæ¸…æ™°åœ°è¢«é˜…è¯»ï¼Œæ—¢æœ‰é«˜çš„æ­å»ºæ•ˆçŽ‡ä¹Ÿæœ‰é«˜çš„æ˜“è¯»æ€§ã€‚è¿™æ¬¡å®žè·µä¸»è¦æ˜¯ä¸ŽåŽŸç”Ÿäº¤äº’ã€Flutter UIæ•ˆæžœï¼ŒåŽç»­è¿˜è¦äº†è§£ç½‘ç»œã€æ•°æ®å­˜å‚¨ç­‰ä¸€äº›å…³é”®éƒ¨åˆ†ã€‚å¸Œæœ›Flutterèƒ½ç»§ç»­ä¿æŒçŽ°åœ¨é«˜çƒ­çš„çŠ¶æ€å‘å±•ï¼Œé€ ç¦è·¨å¹³å°çš„å¼€å‘è€…ï¼Œä¸è¦åœ¨æŸå¤©å’Œå“ªä¸ªå¹³å°çš„è´¢ä¸»é—¹ç¿»äº†è€ŒæŠ›å¼ƒå…¼å®¹å½±å“å¤§å®¶ã€‚ Ref:Flutterä¸­æ–‡ç½‘ Flutter iOSçŽ¯å¢ƒæ­å»º ä»‹ç»è§†é¢‘ FlutteråŽŸç†ä¸Žå®žè·µ ä¸è¦ä¸€çŸ¥åŠè§£ï¼Œæ·±å…¥ç†è§£flutterçš„ç¼–è¯‘åŽŸç†ï¼Œå¥½å— ä¸ºä»€ä¹ˆFlutterä¼šé€‰æ‹© Dart ï¼Ÿ ä»€ä¹ˆæ˜¯ LLVMï¼ŸSwift, Rust, Clang ç­‰è¯­è¨€èƒŒåŽçš„æ”¯æŒ Dart-on-LLVMæ­ç§˜Flutter Hot Reload å¼€å‘åŒ…ä¸Žæ’ä»¶Add-Flutter-to-existing-apps [iOSåŽŸç”Ÿé¡¹ç›®é›†æˆ](Flutter https://juejin.im/post/5b4615576fb9a04fb614d382) é—²é±¼flutteræ··åˆå·¥ç¨‹æŒç»­é›†æˆçš„æœ€ä½³å®žè·µ Flutteræ–°é”ä¸“å®¶ä¹‹è·¯ï¼šæ··åˆå¼€å‘ç¯‡ Change iOS rootViewController with Flutter Flutteræ¡†æž¶åŸºç¡€ åœ¨Flutterä¸­æž„å»ºå¸ƒå±€ MaterialAppä½¿ç”¨è¯¦è§£ Flutterä¸­çš„çŠ¶æ€ç®¡ç† Hummingbird: Building Flutter for the Web]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Flutter</tag>
        <tag>iOS</tag>
        <tag>Dart</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flutterå¼€å‘ï¼ˆä»‹ç»ç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%2FFlutter%E5%BC%80%E5%8F%91%EF%BC%88%E4%BB%8B%E7%BB%8D%E7%AF%87%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ä»‹ç»1. Flutteræ˜¯ä»€ä¹ˆï¼Ÿ Flutteræ˜¯è°·æ­Œçš„æ˜¯ä¸€æ¬¾å®Œå…¨å…è´¹ã€å¼€æºçš„ç§»åŠ¨UIæ¡†æž¶ï¼Œå…¶å®žä¹Ÿå°±æ˜¯ç§»åŠ¨åº”ç”¨ç¨‹åºSDKï¼Œé‡Œé¢åŒ…å«æ¡†æž¶ã€æŽ§ä»¶å’Œä¸€äº›å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿåœ¨iOSå’ŒAndroidä¸Šæž„å»ºç›¸å¯¹é«˜è´¨é‡çš„åŽŸç”Ÿç”¨æˆ·ç•Œé¢ï¼Œå®ƒä¹Ÿå¯ä»¥ä¸ŽçŽ°æœ‰çš„ä»£ç ä¸€èµ·å·¥ä½œã€‚ ç®€å•æ¥è¯´ï¼ŒFlutterå¯ä»¥ç”¨ä¸€å¥—ä»£ç åŒæ—¶æž„å»ºAndroidå’ŒiOSåº”ç”¨ï¼Œå¹¶ä¸”å¯ä»¥è¾¾åˆ°åŽŸç”Ÿåº”ç”¨ä¸€æ ·çš„æ€§èƒ½ã€‚ 2. ä½¿ç”¨ä»€ä¹ˆè¯­è¨€ï¼Ÿ Dartï¼Œå®ƒæ˜¯ä¸€é—¨åŠ¨æ€ç±»åž‹æˆ–è€…è¯´æ˜¯å¯é€‰ç±»åž‹çš„è¯­è¨€ï¼Œå¯é€‰ç±»åž‹çš„æ„æ€æ˜¯æ—¢å¯ä»¥æ˜¯åŠ¨æ€ç±»åž‹ä¹Ÿå¯ä»¥æ˜¯é™æ€ç±»åž‹ã€‚å¦‚æžœä½ æƒ³ä½“éªŒDartè¯­è¨€ï¼Œä½†åˆä¸æƒ³åœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£…Dartå¼€å‘çŽ¯å¢ƒï¼Œé‚£ä½ å¯ä»¥ä½¿ç”¨Googleæä¾›çš„Dartäº‘ç¼–è¯‘æœåŠ¡â€”â€”DartPad DartPadæ˜¯ä¸€ä¸ªè‡ªç”±ã€å¼€æ”¾çš„æºç æœåŠ¡ï¼Œå¸®åŠ©å¼€å‘äººå‘˜å­¦ä¹ Dartè¯­è¨€ï¼Œè¿›å…¥DartPadçš„æºä»£ç ä¼šè¢«å‘é€åˆ°è°·æ­Œäº‘è®¡ç®—å¹³å°ä¸Šè¿è¡Œï¼ŒæœåŠ¡å™¨ä¼šå°†æºä»£ç è¿›è¡Œç¼–è¯‘å¹¶å¤„ç†æˆJavaScriptè¿”å›žç»™æµè§ˆå™¨ï¼Œç¼–è¯‘äº§ç”Ÿçš„é”™è¯¯å’Œè­¦å‘Šä¹Ÿä¼šè¿”å›ž 3. å“åº”å¼è®¾è®¡ Flutteré‡‡ç”¨å“åº”å¼ç•Œé¢å¼€å‘ï¼Œä»¥äº‹ä»¶æ•°æ®æµä½œä¸ºæ ¸å¿ƒå¼€å‘æ¨¡åž‹ã€‚å®ƒçš„ç•Œé¢åªèƒ½è¢«æè¿°è€Œä¸èƒ½è¢«æ“ä½œï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸ç”¨çš„TextView.setText()è¿™æ ·çš„APIæ“ä½œæ˜¯ä¸å­˜åœ¨çš„ã€‚Flutterä¸­ä½¿ç”¨Widgetæ¥æè¿°ç•Œé¢ï¼ŒWidgetåªæ˜¯ç•Œé¢çš„é…ç½®ä¿¡æ¯ï¼Œå½“æ•°æ®æ”¹å˜æ—¶ï¼Œéœ€è¦é‡æ–°åˆ›å»ºWidgetåŽ»æ›´æ–°ç•Œé¢ï¼Œè¿™æ ·è™½ç„¶Widgetä¼šåˆ›å»ºé”€æ¯å¾—éžå¸¸é¢‘ç¹ï¼Œä½†Flutterä½¿ç”¨çš„Dartè™šæ‹Ÿæœºèƒ½é«˜æ•ˆå¤„ç†è¿™ç§çŸ­å‘¨æœŸçš„è½»é‡å¯¹è±¡ã€‚ å¯èƒ½è¿™é‡Œæœ‰äººå¯¹å“åº”å¼ç¼–ç¨‹è¿˜ä¸äº†è§£ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œå“åº”å¼ç¼–ç¨‹æœ¬è´¨æ˜¯åŸºäºŽè§‚å¯Ÿè€…æ¨¡å¼å®žçŽ°çš„ï¼Œå®ƒåœ¨ç•Œé¢å¼€å‘ä¸Šçš„åº”ç”¨ç›®çš„ä¸ŽMVVMæœ‰ç±»ä¼¼ä¹‹å¤„ï¼Œä½†å› MVVMå®žçŽ°Modelå’ŒViewåŒå‘ç»‘å®šæ—¶æœ‰ä¸€å®šç¨‹åº¦çš„çŠ¶æ€æ··ä¹±ï¼Œæ‰€ä»¥åŽæ¥ç»“åˆå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³å‚¬ç”Ÿäº†å“åº”å¼ç•Œé¢å¼€å‘ï¼Œå°†MVVMä¸­çš„VMä½¿ç”¨äº‹ä»¶æ•°æ®æµæ›¿ä»£äº†ï¼Œä½¿Modelåˆ©ç”¨äº‹ä»¶æµå›žåˆ°æœ€åˆçš„äº‹ä»¶é©±åŠ¨ï¼Œå†åˆ©ç”¨æ•°æ®æµæ¥é©±åŠ¨Viewåˆ·æ–°ï¼Œè¿™é‡Œçš„äº‹ä»¶æµå¯ä»¥ç±»æ¯”ä¸ºè¢«ç›‘å¬è€…ï¼Œæ•°æ®æµå¯ä»¥ç±»æ¯”ä¸ºç›‘å¬è€…é¢„è®¾çš„å›žè°ƒå‡½æ•°ã€‚ ï¼ˆå“åº”å¼æ˜¯ä¸Žå¼‚æ­¥æ•°æ®æµäº¤äº’çš„ç¼–ç¨‹èŒƒå¼ï¼Œæ€è·¯æ˜¯é™¤äº†ç‚¹å‡»å’Œæ‚¬åœ(hover)çš„äº‹ä»¶ï¼Œä½ è¿˜å¯ä»¥ç»™å…¶ä»–ä»»ä½•äº‹ç‰©åˆ›å»ºæ•°æ®æµã€‚æ•°æ®æµæ— å¤„ä¸åœ¨ï¼Œä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥æˆä¸ºä¸€ä¸ªæ•°æ®æµï¼Œä¾‹å¦‚å˜é‡ã€ç”¨æˆ·è¾“å…¥ã€å±žæ€§ã€ç¼“å­˜ã€æ•°æ®ç»“æž„ç­‰ç­‰ï¼Œä½ å¯ä»¥ç›‘å¬è¿™æ ·çš„æ•°æ®æµï¼Œå¹¶åšå‡ºç›¸åº”çš„ååº”ï¼‰ 4. çƒ­é‡è½½ åªéœ€è¦ç‚¹å‡»ä¿å­˜æˆ–è€…â€œHot Reloadâ€æŒ‰é’®ï¼Œå°±å¯ä»¥ç«‹å³æ›´æ–°åˆ°æ­£åœ¨è¿è¡Œçš„è®¾å¤‡ä¸Šï¼Œä¸éœ€è¦é‡æ–°ç¼–è¯‘Appï¼Œç”šè‡³ä¸éœ€è¦é‡å¯Appï¼Œç«‹å³å°±å¯ä»¥çœ‹åˆ°æ›´æ–°åŽçš„æ ·å¼ã€‚ ä¼˜ç‚¹ç¼ºç‚¹1. ä¼˜ç‚¹ Flutter æœ€å—æ¬¢è¿Žçš„åŠŸèƒ½ä¹‹ä¸€æ˜¯å…¶æžé€Ÿçƒ­é‡è½½ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒFlutter ä½¿ç”¨ JIT ç¼–è¯‘å™¨ï¼Œé€šå¸¸å¯ä»¥åœ¨ä¸€ç§’ä¹‹å†…é‡æ–°åŠ è½½å¹¶ç»§ç»­æ‰§è¡Œä»£ç ã€‚åªè¦æœ‰å¯èƒ½ï¼Œåº”ç”¨ç¨‹åºçŠ¶æ€åœ¨é‡æ–°åŠ è½½æ—¶ä¿ç•™ä¸‹æ¥ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºå¯ä»¥ä»Žåœæ­¢çš„åœ°æ–¹ç»§ç»­ã€‚ åŒæ—¶Flutterä»¥ 60fps è¿è¡Œï¼Œä½¿ç”¨ Flutter åˆ›å»ºçš„ç”¨æˆ·ç•Œé¢çš„æ€§èƒ½è¿œè¿œä¼˜äºŽä½¿ç”¨å…¶ä»–è·¨å¹³å°å¼€å‘æ¡†æž¶åˆ›å»ºçš„ç”¨æˆ·ç•Œé¢ï¼Œä¸ä»…ä»…æ¯”è·¨å¹³å°çš„åº”ç”¨ç¨‹åºå¥½ï¼Œè€Œä¸”å’Œæœ€å¥½çš„åŽŸç”Ÿåº”ç”¨ç¨‹åºä¸€æ ·å¥½ã€‚ ä¸€èˆ¬ç§»åŠ¨åº”ç”¨ä¸Šå¯¼è‡´å¡é¡¿ä¸¥é‡çš„åŽŸå› è¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯æºäºŽåžƒåœ¾å›žæ”¶çš„å¤„ç†ä¸Šï¼Œäº‹å®žä¸Šï¼Œè¿™åªæ˜¯è®¿é—®å…±äº«èµ„æºï¼ˆå†…å­˜ï¼‰çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œåœ¨å¾ˆå¤šè¯­è¨€ä¸­éƒ½éœ€è¦ä½¿ç”¨é”ï¼Œä½†åœ¨å›žæ”¶å¯ç”¨å†…å­˜æ—¶ï¼Œé”ä¼šé˜»æ­¢æ•´ä¸ªåº”ç”¨ç¨‹åºè¿è¡Œã€‚ä½†æ˜¯ Dart å‡ ä¹Žå¯ä»¥åœ¨æ²¡æœ‰é”çš„æƒ…å†µä¸‹æ‰§è¡Œåžƒåœ¾å›žæ”¶ã€‚Dart ä½¿ç”¨å…ˆè¿›çš„åˆ†ä»£åžƒåœ¾å›žæ”¶å’Œå¯¹è±¡åˆ†é…æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆå¯¹äºŽåˆ†é…è®¸å¤šçŸ­æš‚çš„å¯¹è±¡ï¼ˆå¯¹äºŽ Flutter è¿™æ ·çš„ååº”å¼ç”¨æˆ·ç•Œé¢æ¥è¯´éžå¸¸å®Œç¾Žï¼ŒFlutter ä¸ºæ¯å¸§é‡å»ºä¸å¯å˜è§†å›¾æ ‘ï¼‰éƒ½ç‰¹åˆ«å¿«é€Ÿã€‚Dart å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆå‡¹å‡¸åˆ†é…ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸éœ€è¦é”ï¼‰ã€‚è¿™ä¹Ÿä¼šå¸¦æ¥æµç•…çš„æ»šåŠ¨å’ŒåŠ¨ç”»æ•ˆæžœï¼Œè€Œä¸ä¼šå‡ºçŽ°å¡é¡¿ã€‚ å¦å¤–ï¼Œåœ¨ Flutter çš„ç•Œé¢å¸ƒå±€ä¸Šï¼Œæ˜¯ç›´æŽ¥é€šè¿‡ Dart ç¼–ç æ¥å®šä¹‰ï¼Œä¸éœ€è¦ä½¿ç”¨ XML æˆ–æ¨¡æ¿è¯­è¨€ï¼Œä¹Ÿä¸éœ€è¦ä½¿ç”¨å¯è§†åŒ–è®¾è®¡å™¨ä¹‹ç±»çš„å·¥å…·ï¼Œæ˜¯ä¸€ç§å¯é˜…è¯»å³å¯è§†çš„ä½“éªŒã€‚ Flutter å†…ç½®äº†å¯¹Material Designå’ŒCupertino (iOS-flavor)çš„ UI ç»„ä»¶åº“ï¼Œä¹Ÿæä¾›äº†å¯å®šåˆ¶çš„ UI ç»„ä»¶ï¼Œä¸å†å—åˆ¶äºŽOEMæŽ§ä»¶çš„é™åˆ¶ 2. ç¼ºç‚¹ å¢žåŠ äº†åŒ…ä½“ï¼ŒAndroidç‰ˆFlutteråº”ç”¨ç¨‹åºï¼ˆæ²¡æœ‰Material Componentsï¼Œåªæ˜¯ä¸€ä¸ªCenteræž„å»ºçš„å•ä¸ªwidgetçš„åº”ç”¨ï¼‰çš„å¤§å°ï¼Œå¹¶å°†å…¶æ‰“åŒ…ä¸ºreleaseç‰ˆï¼Œå¤§å°çº¦ä¸º6.7MBã€‚å¯¹äºŽè¿™ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œæ ¸å¿ƒå¼•æ“Žå¤§çº¦3.3MBï¼Œæ¡†æž¶+åº”ç”¨ç¨‹åºä»£ç å¤§çº¦æ˜¯1.25MBï¼ŒLICENSEæ–‡ä»¶ï¼ˆåŒ…å«åœ¨app.flxä¸­ï¼‰æ˜¯55kï¼Œå¿…éœ€çš„Javaä»£ç .dexä¸º40kï¼Œå¹¶ä¸”çº¦æœ‰2.1MBçš„ICUæ•°æ®ã€‚ 3. ä¸Žå…¶å®ƒè·¨å¹³å°æ–¹æ¡ˆå¯¹æ¯” Flutterå°†UIç»„ä»¶å’Œæ¸²æŸ“å™¨ä»Žå¹³å°ç§»åŠ¨åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¯ä»¥è‡ªå®šä¹‰å’Œå¯æ‰©å±•ã€‚Flutterå”¯ä¸€è¦æ±‚ç³»ç»Ÿæä¾›çš„æ˜¯canvasï¼ˆç”»å¸ƒï¼ŒåƒiOSä¸­çš„CoreGraphï¼‰ï¼Œä»¥ä¾¿å®šåˆ¶çš„UIç»„ä»¶å¯ä»¥å‡ºçŽ°åœ¨è®¾å¤‡çš„å±å¹•ä¸Šã€‚Dartç¨‹åºå’Œæ‰§è¡Œæ•°æ®ç¼–ç å’Œè§£ç çš„åŽŸç”Ÿå¹³å°ä»£ç ï¼ˆè“è‰²ï¼Œé€‚ç”¨äºŽiOSæˆ–Androidï¼‰ä¹‹é—´ä»ç„¶æœ‰ä¸€ä¸ªæŽ¥å£ï¼Œä½†è¿™èƒ½æ¯”JavaScriptæ¡¥æŽ¥å™¨å¿«å‡ ä¸ªæ•°é‡çº§ã€‚ä¸‹å›¾æ˜¯Flutterä¸ŽReact Nativeçš„å®žçŽ°å¯¹æ¯” å®žçŽ°åŽŸç†æ¡†æž¶ Flutterçš„æž¶æž„ä¸»è¦åˆ†æˆä¸‰å±‚:Frameworkï¼ŒEngineå’ŒEmbedderã€‚Frameworkä½¿ç”¨dartå®žçŽ°ï¼ŒåŒ…æ‹¬Material Designé£Žæ ¼çš„Widgetï¼Œå’Œé’ˆå¯¹iOSçš„Cupertinoé£Žæ ¼çš„Widgetsï¼Œå…¶ä¸­åˆåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€æŒ‰é’®ç­‰åŸºç¡€Widgetsï¼Œç„¶åŽæ˜¯æ¸²æŸ“ï¼ŒåŠ¨ç”»ï¼Œæ‰‹åŠ¿ç­‰ç»„æˆã€‚ Engineä½¿ç”¨C++å®žçŽ°ï¼Œä¸»è¦åŒ…æ‹¬:Skiaï¼ŒDartå’ŒTextã€‚Skiaæ˜¯å¼€æºçš„äºŒç»´å›¾å½¢åº“ï¼Œæä¾›äº†é€‚ç”¨äºŽå¤šç§è½¯ç¡¬ä»¶å¹³å°çš„é€šç”¨APIã€‚å…¶å·²ä½œä¸ºGoogle Chromeï¼ŒChrome OSï¼ŒAndroid, Mozilla Firefox, Firefox OSç­‰å…¶ä»–ä¼—å¤šäº§å“çš„å›¾å½¢å¼•æ“Žï¼ŒTextæ–‡æœ¬æ¸²æŸ“ï¼ˆå…ˆç»è¿‡è¡ç”Ÿè‡ªminikinçš„libtxtåº“ï¼Œå†ç”±HartBuzzé€‰æ‹©å­—åž‹å’Œæˆåž‹ï¼‰ï¼Œåœ¨Androidå’ŒFuchsiaä¸Šä½¿ç”¨FreeTypeæ¸²æŸ“ï¼Œåœ¨iOSä¸Šä½¿ç”¨CoreGraphicsæ¥æ¸²æŸ“å­—ä½“ã€‚Dartéƒ¨åˆ†ä¸»è¦åŒ…æ‹¬:Dart Runtimeï¼ŒGarbage Collection(GC)ï¼Œå¦‚æžœæ˜¯Debugæ¨¡å¼çš„è¯ï¼Œè¿˜åŒ…æ‹¬JIT(Just In Time)æ”¯æŒã€‚ Embedderæ˜¯ä¸€ä¸ªåµŒå…¥å±‚ï¼Œå³æŠŠFlutteråµŒå…¥åˆ°å„ä¸ªå¹³å°ä¸ŠåŽ»ã€‚è¿™é‡Œåšçš„ä¸»è¦å·¥ä½œåŒ…æ‹¬æ¸²æŸ“Surfaceè®¾ç½®,çº¿ç¨‹è®¾ç½®ï¼Œä»¥åŠæ’ä»¶ç­‰ã€‚ä»Žè¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒFlutterçš„å¹³å°ç›¸å…³å±‚å¾ˆä½Žï¼Œå¹³å°(å¦‚iOS)åªæ˜¯æä¾›ä¸€ä¸ªç”»å¸ƒï¼Œå‰©ä½™çš„æ‰€æœ‰æ¸²æŸ“ç›¸å…³çš„é€»è¾‘éƒ½åœ¨Flutterå†…éƒ¨ï¼Œè¿™å°±ä½¿å¾—å®ƒå…·æœ‰äº†å¾ˆå¥½çš„è·¨ç«¯ä¸€è‡´æ€§ã€‚ ç¼–è¯‘ç¼–è¯‘å™¨Dart2jsï¼šå°†Dartè½¬æ¢ä¸ºjsåŽå†ç”±æµè§ˆå™¨ä¸Šjsçš„V8å¼•æ“Žè¿›è¡Œè¯æ³•å’Œè¯­æ³•åˆ†æžï¼Œå¾—åˆ°è¯­æ³•æ ‘åŽå†è§£é‡Šæ‰§è¡Œã€‚DartVMï¼Œå®ƒæ˜¯ä½¿ç”¨LLVMå®žçŽ°çš„ï¼Œå¯ä»¥å®žçŽ°JITå’ŒAOTä¸¤ç§ç¼–è¯‘æ–¹å¼ã€‚ ç¼–è¯‘æ–¹å¼ï¼šå¯ä»¥åˆ†ä¸ºJITå’ŒAOT JITï¼šScript Snapshot AOTï¼šMachine Code JITå…¨ç§°æ˜¯Just In Timeï¼Œä»£ç å¯ä»¥åœ¨ç¨‹åºæ‰§è¡Œæ—¶æœŸç¼–è¯‘ï¼Œå› ä¸ºè¦åœ¨ç¨‹åºæ‰§è¡Œå‰è¿›è¡Œåˆ†æžã€ç¼–è¯‘ï¼ŒJITç¼–è¯‘å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºæ‰§è¡Œæ—¶é—´è¾ƒæ…¢ï¼›è€ŒAOTç¼–è¯‘ï¼Œå…¨ç§°Ahead Of Timeï¼Œæ˜¯åœ¨ç¨‹åºè¿è¡Œå‰å°±å·²ç»ç¼–è¯‘ï¼Œä»Žå¼€å‘è€…ä¿®æ”¹ä»£ç ã€ç¼–è¯‘è¾ƒæ…¢ï¼Œä½†è¿è¡Œæ—¶ä¸éœ€è¦è¿›è¡Œåˆ†æžã€ç¼–è¯‘ï¼Œå› æ­¤æ‰§è¡Œé€Ÿåº¦æ›´å¿«ã€‚ åœ¨Releaseæ¨¡å¼ä¸‹ï¼š ä¸Šå›¾ä¸ºiOSçš„ç¼–è¯‘æµç¨‹ï¼Œgen_snapshotæ˜¯dartç¼–è¯‘å™¨ï¼Œé‡‡ç”¨äº†tree shaking(ç±»ä¼¼ä¾èµ–æ ‘é€»è¾‘ï¼Œå¯ç”Ÿæˆæœ€å°åŒ…ï¼Œä¹Ÿå› è€Œåœ¨Flutterä¸­ç¦æ­¢äº†dartæ”¯æŒçš„åå°„ç‰¹æ€§)ç­‰æŠ€æœ¯ï¼Œè´Ÿè´£ç”Ÿæˆæ±‡ç¼–å½¢å¼æœºå™¨ä»£ç ã€‚å†é€šè¿‡xcrunç­‰å·¥å…·é“¾ç”Ÿæˆæœ€ç»ˆçš„App.frameworkã€‚æ‰€æœ‰çš„dartä»£ç ï¼ŒåŒ…æ‹¬ä¸šåŠ¡ä»£ç ï¼Œä¸‰æ–¹packageä»£ç ï¼Œå®ƒä»¬æ‰€ä¾èµ–çš„flutteræ¡†æž¶ä»£ç ï¼Œæœ€ç»ˆå°†ä¼šç¼–è¯‘æˆApp.frameworkã€‚ ä¸Šå›¾ä¸ºAndroidç¼–è¯‘æµç¨‹ï¼Œvm/isolate_snapshot_data/instrå†…å®¹å‡ä¸ºarmæŒ‡ä»¤ï¼Œå…¶ä¸­vm_ä¸­æ¶‰åŠruntimeç­‰æœåŠ¡(å¦‚gc)ï¼Œç”¨äºŽåˆå§‹åŒ–DartVMã€‚isolate__åˆ™å¯¹åº”äº†æˆ‘ä»¬çš„åº”ç”¨dartä»£ç ï¼Œç”¨äºŽåˆ›å»ºä¸€ä¸ªæ–°çš„isolateï¼Œisolate/vm_snapshot_data/instrå‡æœ€åŽä½äºŽappçš„æœ¬åœ°dataç›®å½•ä¸‹ï¼Œè€Œæ­¤éƒ¨åˆ†åˆå±žäºŽå¯å†™å†…å®¹ï¼Œå¯é€šè¿‡ä¸‹è½½å¹¶æ›¿æ¢çš„æ–¹å¼ï¼Œå®ŒæˆAppçš„åŠ¨æ€æ›´æ–°ã€‚ è€ŒiOSçš„Flutter.frameworkå’ŒAndroidçš„flutter.jarå¯¹åº”äº†Flutteræž¶æž„ä¸­çš„engineéƒ¨åˆ†ï¼Œä»¥åŠEmbedderã€‚é»˜è®¤æ˜¯ä»Žgoogleä»“åº“æ‹‰å–ã€‚å½“éœ€è¦è‡ªå®šä¹‰ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯é€šè¿‡ä¸‹è½½engineæºç ï¼Œåˆ©ç”¨Ninjaæž„å»ºç³»ç»Ÿæ¥ç”Ÿæˆã€‚Flutterç›¸å…³ä»£ç çš„æœ€ç»ˆäº§ç‰©æ˜¯:App.framework(dartä»£ç ç”Ÿæˆ)å’ŒFlutter.framework(å¼•æ“Ž)ã€‚ åœ¨Debugæ¨¡å¼ä¸‹ï¼š iOSçš„Flutter.frameworkå’Œflutter.jarä¸­æ˜¯æœ‰JITæ”¯æŒçš„ï¼Œåœ¨Releaseæ¨¡å¼ä¸‹å¹¶æ²¡æœ‰JITéƒ¨åˆ†ã€‚è€ŒApp.frameworkåªæœ‰å‡ ä¸ªç®€å•çš„APIï¼Œå…¶Dartä»£ç å­˜åœ¨äºŽsnapshot_blob.binæ–‡ä»¶é‡Œï¼Œä½äºŽflutter_assetsä¸‹ã€‚è¿™éƒ¨åˆ†çš„snapshotæ˜¯è„šæœ¬å¿«ç…§ï¼Œé‡Œé¢æ˜¯ç®€å•çš„æ ‡è®°åŒ–çš„æºä»£ç ã€‚æ‰€æœ‰çš„æ³¨é‡Šï¼Œç©ºç™½å­—ç¬¦éƒ½è¢«ç§»é™¤ï¼Œå¸¸é‡ä¹Ÿè¢«è§„èŒƒåŒ–ï¼Œæ²¡æœ‰æœºå™¨ç ï¼Œtree shakingæˆ–æ··æ·†ã€‚ å°ç»“ä¸€ä¸‹ï¼Œdebugé˜¶æ®µä¸‹æ˜¯ä½¿ç”¨Kernel Snapshotæ¨¡å¼(å¯¹åº”JITç¼–è¯‘)ï¼Œå°†dartä»£ç ç”Ÿæˆæ ‡è®°åŒ–çš„æºä»£ç ï¼Œåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œè§£é‡Šæ‰§è¡Œï¼›releaseé˜¶æ®µä¸‹ï¼Œiosä½¿ç”¨AOTç¼–è¯‘ï¼Œç¼–è¯‘å™¨å°†dartä»£ç ç”Ÿæˆæ±‡ç¼–ä»£ç ï¼Œæœ€ç»ˆç”Ÿæˆapp.framworkï¼Œandroidä½¿ç”¨äº†Core JITç¼–è¯‘ï¼Œdartè½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ¨¡å¼ï¼Œåœ¨VMå¯åŠ¨å‰è½½å…¥ã€‚ æŽ§ä»¶ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨Flutterç•Œé¢æ¸²æŸ“è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šå¸ƒå±€ã€ç»˜åˆ¶ã€åˆæˆï¼Œå¸ƒå±€å’Œç»˜åˆ¶åœ¨Flutteræ¡†æž¶ä¸­å®Œæˆï¼Œåˆæˆåˆ™äº¤ç”±å¼•æ“Žè´Ÿè´£ã€‚ Flutterçš„æŽ§ä»¶æ ‘åœ¨å®žé™…æ˜¾ç¤ºæ—¶ä¼šè½¬æ¢æˆå¯¹åº”çš„æ¸²æŸ“å¯¹è±¡ï¼ˆRenderObjectï¼‰æ ‘æ¥å®žçŽ°å¸ƒå±€å’Œç»˜åˆ¶æ“ä½œã€‚ä¸­é—´çš„Elementæ˜¯Flutterç”¨æ¥åˆ†ç¦»æŽ§ä»¶æ ‘å’ŒçœŸæ­£çš„æ¸²æŸ“å¯¹è±¡çš„ä¸­é—´å±‚ï¼ŒæŽ§ä»¶ç”¨æ¥æè¿°å¯¹åº”çš„elementå±žæ€§ï¼ŒæŽ§ä»¶é‡å»ºåŽå¯èƒ½ä¼šå¤ç”¨åŒä¸€ä¸ªelementã€‚ åœ¨Flutteré‡Œé¢ï¼Œä¸€åˆ‡çš†æŽ§ä»¶ï¼Œå®ƒä»¬çš„åŸºç±»éƒ½æ˜¯Widgetï¼Œé€šè¿‡ç»„åˆã€åµŒå¥—ä¸åŒç±»åž‹çš„æŽ§ä»¶ï¼Œå°±å¯ä»¥æž„å»ºå‡ºä»»æ„åŠŸèƒ½ã€ä»»æ„å¤æ‚åº¦çš„ç•Œé¢ã€‚Widget æ˜¯æ¯ä¸ª Flutter åº”ç”¨çš„åŸºç¡€ã€‚æ¯ä¸ª Widget æ˜¯ä¸€éƒ¨åˆ†ç”¨æˆ·ç•Œé¢ä¸Šä¸å¯å˜çš„å®šä¹‰ã€‚å’Œå…¶ä»–æ¡†æž¶æŠŠ Viewã€controllerã€ Layout å’Œå…¶ä»–èµ„æºåˆ†å¼€å®šä¹‰ä¸ä¸€æ ·ï¼ŒFlutter å…·æœ‰ä¸€è‡´çš„ã€å”¯ä¸€çš„å¯¹è±¡æ¨¡åž‹Widgetã€‚ FlutteræŽ§ä»¶ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼ŒStatelessWidgetå’ŒStatefulWidgetï¼ŒStatelessWidgetç”¨æ¥å±•ç¤ºé™æ€çš„æ–‡æœ¬æˆ–è€…å›¾ç‰‡ï¼Œå¦‚æžœæŽ§ä»¶éœ€è¦æ ¹æ®å¤–éƒ¨æ•°æ®æˆ–è€…ç”¨æˆ·æ“ä½œæ¥æ”¹å˜çš„è¯ï¼Œå°±éœ€è¦ä½¿ç”¨StatefulWidgetã€‚StatelessWidgetå’ŒStatefulWidgetå¹¶ä¸ä¼šç›´æŽ¥å½±å“RenderObjectçš„åˆ›å»ºï¼Œå®ƒä»¬åªè´Ÿè´£åˆ›å»ºå¯¹åº”çš„RenderObjectWidgetï¼ŒStatelessElementå’ŒStatefulElementä¹Ÿæ˜¯ç±»ä¼¼çš„åŠŸèƒ½ã€‚ StatelessWidgetæ˜¯æ— ä¸­é—´çŠ¶æ€å˜åŒ–çš„widgetï¼Œéœ€è¦æ›´æ–°å±•ç¤ºå†…å®¹å°±å¾—é€šè¿‡é‡æ–°newï¼ŒflutteræŽ¨èå°½é‡ä½¿ç”¨StatelessWidgetã€‚ StatefullWidgetæ˜¯å­˜åœ¨ä¸­é—´çŠ¶æ€å˜åŒ–ï¼Œå®ƒé€šè¿‡å¼•å…¥stateç±»å­˜æ”¾ä¸­é—´æ€ï¼Œé€šè¿‡è°ƒç”¨state.setState()è¿›è¡Œæ­¤èŠ‚ç‚¹åŠä»¥ä¸‹çš„æ•´ä¸ªå­æ ‘æ›´æ–°ã€‚è¿™ä¹Ÿæ˜¯åæ˜ flutterç•Œé¢å¼€å‘æ˜¯ä¸€ç§å“åº”å¼ç¼–ç¨‹ï¼Œæ•°æ®å˜æ›´æ—¶å‘é€é€šçŸ¥åˆ°å¯¹åº”çš„å¯å˜æ›´èŠ‚ç‚¹ï¼Œç”±ä¸Šåˆ°ä¸‹é‡æ–°create widgetæ ‘è¿›è¡Œåˆ·æ–°ï¼Œè¿™ç§æ€è·¯æ¯”è¾ƒç®€å•ï¼Œä¸ç”¨å…³å¿ƒæ•°æ®å˜æ›´ä¼šå½±å“åˆ°å“ªäº›èŠ‚ç‚¹ã€‚ çƒ­é‡è½½Flutteré€šè¿‡å°†æ–°çš„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„DartVMä¸­ï¼Œæ¥å®žçŽ°Hot Reloadè¿™ç§ç¥žå¥‡çš„æ•ˆæžœï¼Œåœ¨DartVMå°†ç¨‹åºä¸­çš„ç±»ç»“æž„æ›´æ–°å®ŒæˆåŽï¼ŒFlutterä¼šç«‹å³é‡å»ºæ•´ä¸ªæŽ§ä»¶æ ‘ï¼Œä»Žè€Œæ›´æ–°ç•Œé¢ã€‚æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º åº”ç”¨åœºæ™¯Appç«¯1. Appå¼€å‘ 2. åŒ…å¼€å‘ åŒ…ï¼ˆPackageï¼‰ï¼Œå…¶å®žå°±æ˜¯ä¸ºFlutterçš„Appæˆ–è€…Moduleè€Œæä¾›çš„ï¼Œæ¢å…¶å®ƒçš„ä¸€äº›è¯´æ³•ä¹Ÿå¯ä»¥è¯´æ˜¯ç»„ä»¶ã€å·¥å…·åº“åŒ…ç­‰ã€‚è¦å’ŒåŽŸç”Ÿäº¤äº’çš„ï¼Œæ¯”å¦‚èŽ·å–è®¾å¤‡ä¿¡æ¯æˆ–è€…å¯åŠ¨è®¾å¤‡ç¡¬ä»¶ç­‰åŽŸç”Ÿæ“ä½œï¼Œåˆæˆ–è€…è¦å°è£…Flutteræ¡†æž¶ä¸­çš„åŠŸèƒ½ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªå½¢å¼å®žçŽ°åŽäº¤ä»˜ç»™Flutteré¡¹ç›®æˆ–æ¨¡å—é‡Œä½¿ç”¨ã€‚ä½†æ˜¯ç”±åŽŸç”Ÿè§¦å‘Flutterä¸­çš„å‡½æ•°æˆ–å‘Flutterç´¢å–ä¿¡æ¯çš„å°±æ²¡å¿…è¦ä½¿ç”¨Flutterçš„æ’ä»¶å®žçŽ°äº†ï¼Œä¹Ÿä¸åˆé€‚ï¼Œå› ä¸ºå®žçŽ°å‡ºæ¥çš„Packageå¹¶ä¸æ˜¯æä¾›ç»™Flutteré¡¹ç›®ä½¿ç”¨ï¼Œä¸è¿‡è¿™ç§æƒ…å†µç›¸å¯¹è¾ƒå°‘ã€‚åŽŸç”Ÿå’ŒFlutterçš„äº¤äº’ä¸»è¦æ˜¯é€šè¿‡ä¸¤ç«¯å‡æ³¨å†Œå¯¹åº”çš„channelï¼Œç„¶åŽåˆ©ç”¨å…¶è¿›è¡Œé€šä¿¡ã€‚ 3. æ··åˆå¼€å‘ æ··åˆå¼€å‘å°±æ˜¯åœ¨åŽŸæœ‰çš„åŽŸç”Ÿå·¥ç¨‹ä¸Šåˆ›å»ºFlutterçš„æ¨¡å—ï¼ˆModuleï¼‰ï¼Œä½¿åŽŸé¡¹ç›®å¯ä»¥é€æ¸è¿‡æ¸¡ï¼Œè€Œä¸ç”¨ä¸€æ¬¡æ€§å…¨éƒ¨è½¬ç§»åˆ°Flutterä¸Šå®žçŽ°ã€‚ Webç«¯Flutterå›¢é˜Ÿæ­£åœ¨å¼€å‘ä¸€ä¸ªWebçš„æž¶æž„ï¼Œå«ä½œHummingbirdã€‚ä¸Žåœ¨ç§»åŠ¨åº”ç”¨ä¸­æ¸²æŸ“å‡ºæŽ§ä»¶åŠç•Œé¢ä¸€æ ·ï¼ŒHummingbirdå…¶å®žæ˜¯åœ¨å¼•æ“Žå±‚é¢ä¸Šï¼Œå³dart:uiä»£æ›¿åŽŸæ¥çš„å¼•æ“Žï¼Œä»Žè€Œå®žçŽ°äº†åœ¨Webç«¯ä¸Šçš„æ¸²æŸ“ã€‚ Flutterçš„å›¢é˜Ÿä¹Ÿæ­£åœ¨é€‰æ‹©ä¸€ç»„WebæŠ€æœ¯æ¥å®Œæˆæž„å»ºçš„ä»»åŠ¡ã€‚Flutterä¸€æ¬¡æ¸²æŸ“ä¸€å¸§UIï¼Œåœ¨æ¯ä¸ªå¸§å†…Flutterä¼šæž„å»ºwidgetsï¼Œæ‰§è¡Œå¸ƒå±€ï¼Œæœ€åŽåœ¨å±å¹•ä¸Šç»˜åˆ¶ã€‚æž„å»ºæ˜¯é€šè¿‡dart2jsï¼Œå°†æ‰€æœ‰ widgetå’Œwidget frameéƒ½ç¼–è¯‘æˆäº†JavaScriptï¼Œç§»æ¤åˆ°Webä¸Šã€‚å¸ƒå±€åˆ™æ˜¯é™¤äº†æ–‡æœ¬å¤–å…¶å®ƒå†…å®¹éƒ½ç”±æ¡†æž¶è¿›è¡Œå¸ƒå±€å¹¶ç¼–è¯‘åˆ°Webã€‚è€Œæœ€éš¾çš„éƒ¨åˆ†åˆ™æ˜¯ç»˜åˆ¶ï¼Œç›®å‰åœ¨æŽ¢ç´¢çš„ç»˜åˆ¶æ–¹æ¡ˆä¸»è¦åŒ…æ‹¬ï¼šHTML+CSS+Canvaså’ŒCSS Paint APIä¸¤ç§ã€‚ CSS Paint APIï¼Œå®ƒä¸æ˜¯JavaScriptç‹¬ç«‹å®Œæˆçš„ï¼Œå®ƒæœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œå®ƒä¼šåœ¨ DOM æ›´æ”¹æäº¤ä¹‹åŽï¼Œåœ¨æµè§ˆå™¨çš„ç»˜åˆ¶é˜¶æ®µæ‰§è¡Œç»˜åˆ¶å·¥ä½œï¼Œç„¶åŽå®ƒæ˜¯ç”±æ˜¾ç¤ºåˆ—è¡¨æ‰€æ”¯æŒè€Œéžä½å›¾ï¼Œè¿™æ ·å®ƒå°±å…·æœ‰äº†2D canvasçš„ç»˜åˆ¶æ•ˆçŽ‡å’Œæ— åƒç´ åŒ–çš„ä¼˜ç‚¹ï¼Œä½†ä¸æ”¯æŒç»˜åˆ¶æ–‡æœ¬ã€‚ HTML + CSSçš„æ–¹å¼å¯ä»¥ç§°ä½œä¸ºä¸€ç§å«DomCanvasçš„ç”»å¸ƒï¼Œå®ƒè¢«æµè§ˆå™¨çš„æ˜¾ç¤ºåˆ—è¡¨æ”¯æŒï¼Œæµè§ˆå™¨çš„æ¸²æŸ“å¼•æ“Žå¯ä»¥å¸®æˆ‘ä»¬å®Œæˆä¸€äº›ä¼˜åŒ–ï¼Œè¿˜å¯ä»¥ä»»æ„åº”ç”¨å˜æ¢è€Œä¸å¿…æ‹…å¿ƒåƒç´ åŒ–ã€‚ä½†è‹¥æ— æ³•ä½¿ç”¨DomCanvasæ¥è¡¨çŽ°å›¾ç‰‡çš„è¯ï¼Œåˆ™è½¬ä¸ºä½¿ç”¨Canvasï¼Œå…¶æ€§èƒ½å’Œç»˜å›¾å…¼å®¹æ€§å¥½ï¼Œä½†å…¶è¡¨ç¤ºä¸ºä½å›¾å¯¼è‡´å­˜åœ¨åƒç´ åŒ–çš„é—®é¢˜ï¼ŒåŠå…¶æ“ä½œä»£ä»·è¾ƒå¤§ï¼Œè¿˜éœ€ç»§ç»­æŽ¢ç ”é«˜æ•ˆçš„æ–¹æ³•ã€‚ æ¡Œé¢æ“ä½œç³»ç»ŸFlutter çš„è®¾è®¡ç†å¿µå°±æ˜¯å¸Œæœ›å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªçµæ´»ä¸”ä¾¿æºçš„ UI å·¥å…·åŒ…ï¼Œä»¥é€‚åº”å„ç§éœ€è¦ç»˜åˆ¶å±å¹•å†…å®¹çš„å¹³å°ã€‚æ ¹æ®ä¸€äº›æ–°é—»æ¶ˆæ¯ï¼ŒåƒFlutter Desktop Embedding å°±æ˜¯ä¸€ä¸ªä½¿ Flutter è¿è¡ŒäºŽ macOSã€Linux å’Œ Windows ç­‰æ¡Œé¢æ“ä½œç³»ç»Ÿçš„é¡¹ç›®ã€‚ Ref:ä¸è¦ä¸€çŸ¥åŠè§£ï¼Œæ·±å…¥ç†è§£flutterçš„ç¼–è¯‘åŽŸç† æ·±å…¥äº†è§£Flutterç•Œé¢å¼€å‘ æ­ç§˜Flutter Hot Reload Dartè¯­æ³•å­¦ä¹  ä¸ºä»€ä¹ˆ Flutter ä¼šé€‰æ‹© Dart Hummingbird: åœ¨Webä¸Šè¿è¡ŒFlutteråº”ç”¨ FlutteråŽŸç†ä¸Žå®žè·µ Flutterä¸­æ–‡ç½‘]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Flutter</tag>
        <tag>iOS</tag>
        <tag>Dart</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSé€†å‘ï¼ˆäº”ï¼‰æ€»ç»“ç¯‡]]></title>
    <url>%2FiOS%2FiOS%E9%80%86%E5%90%91%EF%BC%88%E4%BA%94%EF%BC%89%E6%80%BB%E7%BB%93%E7%AF%87%2F</url>
    <content type="text"><![CDATA[æœ€åŽä¸€éï¼Œæ€»ç»“ä¸€ä¸‹å…³äºŽå®‰å…¨å¼€å‘çš„æ”»é˜²è¦ç‚¹ï¼Œå€Ÿé‰´ä¸€äº›ç»éªŒï¼Œè®°å½•ä¸€äº›å°è€Œé»‘çš„æŠ€å·§ï¼Œè¿˜æœ‰æˆ‘è¯»å°é»„ä¹¦åŽçš„çŸ¥è¯†ç‚¹æ¢³ç†ã€‚ iOSå®‰å…¨å¼€å‘é˜²æŠ¤æ‘˜è¦1ã€æœ¬åœ°æ•°æ®å¾ˆå¤šå¼€å‘è€…å–œæ¬¢ç”¨NSUserDefaultsæ¥å­˜å‚¨ä¸€äº›å…¨å±€æ•°æ®ï¼Œä½†æ˜¯è¿™äº›ä¿¡æ¯å¯ä»¥ç›´æŽ¥åœ¨appç›®å½•æ–‡ä»¶ä¸­è¯»åˆ°ï¼Œå¦‚æžœä½ ä¹ŸæŠŠusernameå’Œpasswordå­˜åœ¨é‡Œé¢ã€‚ã€‚ã€‚å½“ç„¶ï¼Œå¦‚æžœå®‰å…¨çº§åˆ«ä¸é«˜çš„ç¨‹åºï¼Œè¿™ä¹ˆå†™ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼›å¾ˆå¤šappä¹Ÿä¼šå­˜ä¸€äº›ç®€å•çš„æ•°æ®åˆ°æœ¬åœ°sqliteæ–‡ä»¶ä¸­ï¼Œä½†å®žé™…ä¸Šï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨åŠ å¯†sqliteçš„ï¼Œå½“ç„¶ï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼Œå®‰å…¨çº§åˆ«ä¸é«˜çš„ç¨‹åºï¼Œè¿™ä¹ˆå†™æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ 2ã€ç½‘ç»œæŽ¥å£ä¿æŠ¤çŽ°åœ¨ç»å¤§éƒ¨åˆ†çš„appéƒ½å·²ç»æ˜¯è”ç½‘ç¨‹åºäº†ï¼Œç»å…¸æ¨¡å¼å°±æ˜¯http+jsonï¼Œå®¢æˆ·ç«¯ä¸€è§£æžï¼Œå†åšçš„æ¼‚äº®ä¸€ç‚¹å°±é½æ´»ã€‚ç„¶è€Œåªè¦æž¶ä¸ŠCharlesæˆ–æ˜¯tcpdumpï¼Œå®Œæ•´çš„url request+responseå°±çœ‹çš„æ¸…æ¸…æ¥šæ¥šã€‚æœ‰äº†è¿™äº›urlï¼Œä½ çš„ç½‘ç»œæ•°æ®å°±æ— å¯†å¯ä¿ï¼Œå°¤å…¶æ˜¯ä¸€äº›èµ„æºåž‹çš„æœåŠ¡ï¼Œç›´æŽ¥é€šè¿‡getListçš„æ¨¡å¼å°±èƒ½æŠŠæ‰€æœ‰çš„æ•°æ®æŠ“å›žæ¥ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯httpsä¹Ÿæ²¡ç”¨ï¼ŒCharlesè½»æ¾å°±èƒ½æžå®šï¼Œå¯ä»¥çœ‹ç›¸å…³çš„æ–‡ç« ã€‚è€Œä¸”å³ä½¿ä¸ç”¨Charlesæˆ–tcpdumpï¼Œç›´æŽ¥ç”¨ä»£ç hookç½‘ç»œæŽ¥å£ï¼Œä¸€æ ·èƒ½æŠŠæ•°æ®æ‹¿åˆ°ã€‚ å¦å¤–æ’æ’­ä¸€å¥ï¼šjsonæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå®ƒçš„å±•çŽ°å°±æ˜¯ä¸€ä¸ªDictionaryï¼Œæ•°æ®å‘ˆçŽ°çš„éžå¸¸æ¸…æ™°ã€‚ä½†æ˜¯å®ƒä¹Ÿç»å¯¹æ˜¯æœ€å®¹æ˜“è¢«ç›¯ä¸Šçš„ç‚¹ã€‚è®¾æƒ³ä¸€ä¸‹ï¼Œæ”»å‡»è€…hookäº†æŽ¥å£æ•°æ®ï¼Œæ­¤æ—¶ç›´æŽ¥æŠŠjsonæˆ–Dictionaryæ‰“å°å‡ºæ¥ï¼Œä¿¡æ¯æ˜¯ä¸æ˜¯å°±ä¸€è§ˆæ— ä½™äº†ï¼Ÿåœ¨ç¬”è€…çš„æ¦‚å¿µé‡Œï¼ŒæŠŠDictionary/jsonè½¬æˆæ™®é€šçš„ä¸šåŠ¡å¯¹è±¡å†ä¼ é€’ï¼Œå³ä½¿è¢«æ‹¦æˆªï¼Œèµ·ç ä¸ä¼šé‚£ä¹ˆç›´è§‚åœ°è¢«çœ‹åˆ°ã€‚å½“ç„¶äº†ï¼Œè¿™åªèƒ½ç»™é€†å‘è€…å¢žåŠ ä¸€ç‚¹éº»çƒ¦ï¼Œçº¯å±žç»†æžæœ«èŠ‚ã€‚ç¬”è€…çœ‹è¿‡ä¸å°‘appï¼Œå¤§æ¦‚70%éƒ½æ˜¯è¿™ç§å…¨è£¸å¥”çš„ç½‘ç»œè¯·æ±‚ï¼Œæ¯”å¦‚â€œç½‘æ˜“æ–°é—»â€ï¼›å‰©ä¸‹çš„ä¼šå¯¹urlåšä¸€å®šçš„ä¿æŠ¤ï¼Œæ¯”å¦‚åŠ tokenå’Œtimestampï¼Œå¦‚â€œ36krâ€ï¼Œè¿™æ ·ç¡®å®žå°±æŠŠæŠ“æ•°æ®çš„éš¾åº¦é™¡ç„¶æå‡äº†ï¼›æœ€â€œå˜æ€â€çš„æ˜¯â€œæˆ‘æŸ¥æŸ¥â€ï¼Œä»–ä»¬ç›´æŽ¥æŠŠurlåšäº†åŠ å¯†/ç¼–ç ï¼Œè¿™ç§æƒ…å†µä¸‹æƒ³è¦å¤åˆ¶å‡ºæ¥å°±éœ€è¦å¤§è´¹å‘¨ç« ï¼Œè€Œä¸”å¦‚æžœè¿™ç§ç¼–ç æ–¹å¼ä¸æ˜¯é€šç”¨çš„ï¼Œå°±æ›´éš¾é€†å‘è§£æžäº†ã€‚ 3ã€æ··æ·†æ··æ·†æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§æ˜¯å¯¹å‡½æ•°ååšæ··æ·†ï¼Œå¦ä¸€ç§æ˜¯å¯¹ä»£ç åšæ··æ·†ï¼Œä¸¤ç§éƒ½ç›´æŽ¥å¢žåŠ é€†å‘çš„éš¾åº¦ï¼Œä½†æ˜¯æŒ¡æ˜¯æŒ¡ä¸ä½çš„ï¼Œå°¤å…¶æ˜¯é€†å‘è€…è¿˜æœ‰å¤§æŠŠçš„æ—¶é—´ã€‚ä½†ä½†æ˜¯ä»£ç æ··æ·†çš„æ€§ä»·æ¯”æ˜¯å¾ˆé«˜çš„ï¼Œå°±æ˜¯ä½ è¿™è¾¹ä»˜å‡ºäº†ä¸€ç‚¹æ—¶é—´ï¼Œè€Œé»‘å®¢å°±è¦å¤šä»˜å‡ºå‡ åå€çš„æ—¶é—´ã€‚ 4ã€ç¨‹åºç»“æž„åœ¨appè¿™ç§å°è€Œç¾Žçš„é¢†åŸŸä¸­ï¼Œå¦‚æžœä»£ç ç»“æž„ä¹Ÿè®¾è®¡çš„éžå¸¸ç®€æ´æ¼‚äº®ï¼Œå®žåœ¨æ˜¯ä¸€ä»¶ä»¤äººèµå¿ƒæ‚¦ç›®çš„äº‹æƒ…ã€‚ä¸è¿‡å¯¹äºŽé€†å‘å·¥ç¨‹ï¼Œè¶Šæ˜¯è¿™ç§è®¾è®¡ç»“æž„ï¼Œè¶Šå®¹æ˜“å®šä½ï¼Œæœ‰æ—¶ç”šè‡³ä¸ç”¨ä¸Šä»€ä¹ˆå¤§æ‹›ï¼Œç›´æŽ¥ä»Ž.hæ–‡ä»¶åå’Œå‡½æ•°åˆ—è¡¨å°±èƒ½åˆæ­¥å®šä½æƒ³è¦å…³å¿ƒçš„æ ¸å¿ƒä»£ç ï¼Œå¦‚WhatsAppã€‚è€Œä¸€ä¸ªåä¾‹æ˜¯å¾®ä¿¡ï¼Œå¾®ä¿¡çš„è´¨é‡æ°´å‡†æ˜¯æœ‰ç›®å…±ç¹çš„ï¼Œä¸è¿‡æƒ³è¦å¯¹å®ƒè¿›è¡Œé€†å‘å·¥ç¨‹å°±æ˜¯ä¸€ä»¶æ¯”è¾ƒç—›è‹¦çš„äº‹æƒ…ï¼Œå› ä¸ºæœ€æ–°çš„5.1æœ‰3000å¤šä¸ª.hæ–‡ä»¶ï¼Œå¦‚æ­¤åºžå¤§çš„ä»£ç é‡ç›´æŽ¥å°†é€†å‘å·¥ä½œé‡æå‡ä¸€ä¸ªæ•°é‡çº§ã€‚åœ¨ç¬”è€…çš„åˆ†æžè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šè¢«ä¸€å †çš„Mgrã€Eventã€Serviceç»™æ…çš„å¿ƒçƒ¦æ„ä¹±ã€‚è¿™2ä¸ªappåªæ˜¯ä¸¤ä¸ªæžç«¯çš„æ¯”è¾ƒï¼Œæ¯•ç«ŸWhatsAppå…¨å…¬å¸æ‰50äººï¼Œä¸€ä¸ªiPhoneç‰ˆçš„å¼€å‘è€…ä¸è¿‡æ•°äººï¼Œç»“æž„è‡ªç„¶æ¸…æ™°ï¼›è€Œå¾®ä¿¡æ—©å·²æ˜¯ä¸€ä¸ªåºžç„¶å¤§ç‰©ï¼Œå„éƒ¨é—¨ä¹‹é—´ç›¸äº’åˆä½œï¼Œä¸€å±‚å±‚çš„ä»£ç åº“æŠ½è±¡å°è£…å¥½ç»™å…¶å®ƒç»„è°ƒç”¨ï¼Œå³ä½¿æ˜¯å¾ˆç®€å•çš„è°ƒç”¨å¯èƒ½ä¹Ÿè¦ä¸²3ã€4ä¸ªåœºï¼Œä¸è¿‡è¿™æ ·ä¹Ÿé—´æŽ¥å¢žåŠ äº†é€†å‘çš„å¤æ‚åº¦ã€‚ 5ã€Cæˆ–blockå‡½æ•°çŽ°åœ¨iOSæ–¹é¢çš„é€†å‘å·¥å…·éƒ½æ˜¯é’ˆå¯¹OCæ¥çš„ï¼Œè€Œä¸€æ—¦ä»£ç ä»¥Cå‡½æ•°æˆ–blockå‡½æ•°æ¥å®žçŽ°ï¼Œç›¸å½“äºŽå°±é‡‡ç”¨äº†åŒ¿åå‡½æ•°ï¼Œæƒ³è¦å®šä½å®ƒå°±åªèƒ½ä½¿ç”¨IDAï¼Œå¹¶ä¸”è¿˜å¾ˆå®¹æ˜“å®šä½ä¸å‡†ã€‚ç¬”è€…æ›¾ç»åœ¨æŸ¥çœ‹çŸ¥ä¹Žæ—¥æŠ¥çš„ä¸€æ®µå¯¹tokenè¿›è¡Œç¼–ç çš„é—®é¢˜ä¸Šç»•äº†å¾ˆå¤§çš„åœˆå­ï¼Œä¾ç„¶æ²¡æœ‰å®šå‡†ä½ï¼Œæœ€åŽå¹²è„†æ”¾å¼ƒäº†ï¼Œé‚£æ®µä»£ç å°±æ˜¯æ‹¿blockæ¥å®Œæˆçš„ã€‚è€Œä¸”ï¼Œå¦‚æžœæ˜¯Cä»£ç ï¼Œåœ¨IDAä¸­çœ‹èµ·æ¥å°±ä¸æ˜¯æ˜“è¯»çš„OCé£Žæ ¼ä¼ªä»£ç äº†ï¼Œçœ‹èµ·æ¥ä¹Ÿä¼šæ¯”è¾ƒç´¯ã€‚ 6ã€ä»£ç ä¸­çš„å…³é”®æ•°æ®å…³é”®æ•°æ®å†™åœ¨ä»£ç é‡Œï¼Œå¯ä»¥ä¿å­˜çš„æ˜¯åŠ å¯†åŽçš„æ•°æ®ï¼Œä½¿ç”¨çš„æ—¶å€™æ‰è§£å¯†å¤„ç†ã€‚å¯†é’¥è¦å®šæœŸæ›´æ¢ã€‚æ¯”å¦‚3ä¸ªæœˆæˆ–åŠå¹´æ¢ä¸€æ¬¡ï¼Œå¦‚æžœå¯†é’¥æ˜¯ä»ŽæŽ¥å£é€šè¿‡éžå¯¹ç§°åŠ å¯†èŽ·å–çš„ï¼Œç›´æŽ¥ä¿®æ”¹æœåŠ¡ç«¯å°±å¯ä»¥äº†ã€‚å¦‚æžœå¯†é’¥æ˜¯å†™åœ¨ä»£ç é‡Œçš„ã€‚å°±ç­‰APPå‡çº§æ–°çš„ç‰ˆæœ¬çš„æ—¶å€™ï¼Œæ–°ç‰ˆæœ¬çš„APPå’Œå…¶å¯¹åº”çš„æŽ¥å£ç‰ˆæœ¬éƒ½ä¿®æ”¹ä¸ºæ–°çš„å¯†é’¥å°±å¯ä»¥äº†ã€‚æ—§çš„æŽ¥å£ç‰ˆæœ¬å’ŒAPPç‰ˆæœ¬è¿˜ç”¨ä»¥å‰çš„å¯†é’¥ï¼Œç­‰å¼ºåˆ¶æ›´æ–°çš„æ—¶å€™æ‰ä¼šå¤±æ•ˆã€‚å¦‚æžœä¸€ä¸ªAPP ä¸€ä¸ªå¯†é’¥ç”¨ä¸Šå‡ å¹´éƒ½ä¸å˜ ï¼Œæ˜¯å¾ˆå±é™©çš„ã€‚ç¦»èŒçš„äººå‘˜éƒ½å¯ä»¥ç›´æŽ¥ç”¨ä»¥å‰çš„ä»£ç æ¥èŽ·å–ç›¸å…³çš„æ•°æ®ã€‚ç‰¹åˆ«æ˜¯æ”¯ä»˜ç›¸å…³çš„ï¼Œæœ‰çš„æœåŠ¡ç«¯ç”šè‡³æ²¡æœ‰åŽ»æ ¡éªŒæ”¯ä»˜çš„é‡‘é¢æˆ–å…¶ä»–æ•°æ®ï¼Œå¯¼è‡´ç¦»èŒäººå‘˜ç”¨1åˆ†é’±å¯ä»¥ä¹°åˆ°ä»»ä½•ä»·æ ¼çš„çº¿ä¸Šäº§å“ã€‚ 7ã€ä»£ç æ–¹é¢åœ¨releaseçŽ¯å¢ƒä¸‹NSLogä¸è¦æ‰“å°æ—¥å¿—ï¼Œå¦åˆ™iOSç³»ç»Ÿæ—¥å¿—é‡Œéƒ½å¯ä»¥æŸ¥çœ‹åˆ°ï¼Œåœ¨.pchæ–‡ä»¶ä¸­åŠ ä¸‹é¢çš„å‡ è¡Œä»£ç å°±å¯ä»¥è§£å†³ #ifdef DEBUG #define NSLog(...) NSLog(__VA_ARGS__) #define debugMethod() NSLog(@&quot;%s&quot;, __func__) #else #define NSLog(...) #define debugMethod() #endif è€ŒSwiftä¸­æ‰“å°è¦ç”¨printã€‚AFNetworkingçš„allowInvalidCertificateså±žæ€§è¦è®¾ç½®æˆfalseï¼ŒvalidatesDomainNameå±žæ€§ è®¾ç½®æˆtrueã€‚å¦åˆ™HTTPSé€šä¿¡å°±å¯ä»¥è¢«è§£å¯†ã€‚ä¸€èˆ¬å¼€å‘çš„æµ‹è¯•çŽ¯å¢ƒçš„HTTPSä¸æ˜¯CAé¢å‘çš„ï¼Œè€Œæ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œè®¿é—®çš„ä¹Ÿä¸æ˜¯åŸŸåï¼Œè€Œæ˜¯IPã€‚æ‰€ä»¥å¯ä»¥åœ¨æµ‹è¯•çŽ¯å¢ƒå¿½ç•¥è¯ä¹¦å’ŒåŸŸå #ifdef DEBUG manager.securityPolicy.allowInvalidCertificates = YES; manager.securityPolicy.validatesDomainName = NO; #endif å¼€å‘è€…åœ¨æ„çš„å®‰å…¨é˜²æŠ¤1ã€æƒ³è¦ä¿è¯ç¨‹åºä¸­çš„ä¿¡æ¯ä¸è¢«æˆªå–å‡ ä¹Žæ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå³ä½¿å†åŠ å¯†ï¼Œå¯†æ–‡ä¹Ÿæ€»è¦å˜æˆæ˜Žæ–‡ä¾›ä¸šåŠ¡é€»è¾‘æ¥ä½¿ç”¨ï¼Œæ”»å‡»è€…åªè¦ç›¯ä½è¿™ä¸ªç‚¹å°±èƒ½è¾¾åˆ°ç›®æ ‡ï¼› 2ã€æƒ³ä¿æŠ¤æœåŠ¡å™¨çš„èµ„æºå®¢æˆ·ç«¯åœ¨ç›¸å½“ç¨‹åº¦ä¸Šåªæ˜¯ä¸€ä¸ªUIå±•çŽ°ï¼Œå³ä½¿è¢«ç ´è§£ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦çš„ï¼ŒçœŸæ­£é‡è¦çš„æ˜¯æœåŠ¡å™¨ç«¯çš„èµ„æºï¼Œé‚£ä¹ˆå°±è¦åœ¨ç½‘ç»œå±‚è¿›è¡Œé˜²æŠ¤äº†ã€‚çŽ°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ç”¨httpï¼Œè€Œä¸”éƒ½é›†ä¸­å–œæ¬¢ä½¿ç”¨AFã€ASIç­‰å‡ ä¸ªå¼€æºåº“ï¼Œé€†å‘è€…åªè¦ç›¯ä½è¿™å‡ ä¸ªå£ï¼Œå°±èƒ½æŠŠæ¥å¾€çš„request+responseå…¨éƒ¨èŽ·å–ï¼Œè¿›è€Œå¯ä»¥ä»¿åˆ¶ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡å™¨çš„èµ„æºä¹Ÿå°±å…¨é¢å¼€æ”¾äº†ã€‚åŒæ ·çš„ï¼Œä½¿ç”¨AsyncSocketä¹Ÿæ˜¯ä¸€å›žäº‹ã€‚æ­¤æ—¶æœ‰3ç§é˜²æŠ¤æŽªæ–½ï¼š1ï¼‰æœåŠ¡å™¨æŽ§åˆ¶ï¼Œä¸å…è®¸åŒä¸€IP/å®¢æˆ·ç«¯é¢‘ç¹æŠ“å–æ•°æ®ï¼›2ï¼‰å¯¹urlåŠ ä¸Štokenã€timestampï¼Œç”šè‡³urlç¼–ç ï¼Œè™½ç„¶ç¢°ä¸Šé«˜æ‰‹è¿˜æ˜¯ä¸èƒ½100%å®‰å…¨ï¼Œä½†æ˜¯ç ´è§£è€…æƒ³è¦è¾¾åˆ°ç›®çš„ï¼Œå°±éœ€è¦è€ƒè™‘ä»˜å‡ºçš„ç²¾åŠ›æ˜¯ä¸æ˜¯å€¼å¾—äº†ï¼›3ï¼‰ä¼ è¾“æ•°æ®åŠ å¯†ï¼Œå¹¶ä¸”å°†åŠ è§£å¯†çš„ä»£ç å±‚çº§åŠ æ·±ï¼Œå°¤å…¶æ˜¯æ”¾åˆ°Cæˆ–blockå‡½æ•°ä¸­ï¼Œè¿™æ ·åˆå°†å®‰å…¨ç­‰çº§æé«˜äº†ä¸€çº§ã€‚ 3ã€æƒ³ä¿æŠ¤ç¨‹åºä¸è¢«ä¼ªé€ æˆ–å…‹éš†å…‹éš†/ä¼ªé€ å…¶å®žæ˜¯ä»¶éžå¸¸å®¹æ˜“çš„äº‹ï¼Œç”šè‡³éƒ½ä¸éœ€è¦å¤ªå¤šé€†å‘å·¥ä½œï¼Œåªè¦èƒ½æŠŠç½‘ç»œè¯·æ±‚æžå®šï¼Œå‰©ä¸‹çš„å°±æ˜¯ä»£ç é‡ã€ä»¥åŠæ˜¯å¦æ¯”è¢«ä»¿è€…åšçš„æ›´å¥½çš„é—®é¢˜äº†ã€‚ æ€»çš„æ¥è¯´ï¼Œå®¢æˆ·ç«¯æ²¡å¤ªå¤šå¯ä¿æŠ¤çš„ç©ºé—´ï¼Œå®ƒåº”è¯¥å°±æ˜¯ä¸ªä¸šåŠ¡å±•çŽ°å’Œæ•°æ®è§£æžçš„å·¥å…·ï¼Œä¸Žå…¶èŠ±ç²¾åŠ›æƒ³é˜²è¿™ä¸ªé˜²é‚£ä¸ªï¼Œä¸å¦‚æŠŠç²¾åŠ›æ”¾åœ¨ç½‘ç»œæŽ¥å£çš„ä¿æŠ¤ä¸Šï¼Œå°¤å…¶æ˜¯åŠ è§£å¯†ä»£ç æå–åˆ°Cæˆ–blockä¸­ã€‚ å¾®ä¿¡çš„å®‰å…¨é˜²æŠ¤æŽªæ–½1ã€ä¸åœ¨ä¸šåŠ¡è¡¨çŽ°ä¸Šåšå¤ªå¤šæ— ç”¨åŠŸé™¤äº†ä»£ç ç»“æž„æ¯”è¾ƒåºžå¤§ä¹‹å¤–ï¼Œå¾®ä¿¡æ²¡æœ‰åšç‰¹åˆ«çš„åŠ¨ä½œï¼› 2ã€æœåŠ¡å™¨æŽ§åˆ¶æ‰€æœ‰çš„å†³æ–­æ€§çš„åŠ¨ä½œç”±æœåŠ¡å™¨æŽ§åˆ¶ï¼Œå‡ ä¹Žä¸å¯èƒ½é é€šè¿‡ç¯¡æ”¹å®¢æˆ·ç«¯çš„ä»£ç æ¥èŽ·å–æ›´å¤§çš„æƒé™ã€‚ç¬”è€…æ›¾ç»é’ˆå¯¹æ¯å¤©20ä¸ªæ¼‚æµç“¶çš„é™åˆ¶å°è¯•æ‰©å¤§æƒé™ï¼Œä½†æ˜¯å³ä½¿æŠŠæœ¬åœ°ä»£ç é€»è¾‘æ”¾å¼€ï¼Œåœ¨è¶…è¿‡20ä¸ªç“¶å­ä¹‹åŽï¼Œå†æžå›žæ¥çš„æ°¸è¿œæ˜¯æµ·æ˜Ÿï¼Œæ˜¾ç„¶æ˜¯æœåŠ¡å™¨æŽ§åˆ¶ä½äº†ã€‚å½“ç„¶ï¼Œæœ¬åœ°LBSåæ ‡æ˜¯æ— æ³•è¢«æœåŠ¡å™¨æŽ§åˆ¶çš„ï¼Œè¿™ä¹Ÿå°±æ˜¯åæ ‡ç©¿è¶Šæ’ä»¶èƒ½èµ·ä½œç”¨çš„æ ¹æœ¬åŽŸå› ã€‚ 3ã€ç½‘ç»œæ•°æ®åŠ å¯†é€šè¿‡å¯¹ç½‘ç»œæŽ¥å£çš„æ‹¦æˆªï¼Œè™½ç„¶èƒ½å¾—åˆ°socketæ”¶å–çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œé¦–å…ˆæ˜¯æ— æ³•ç›´æŽ¥è§£å¯†ï¼Œå…¶æ¬¡æ˜¯ä»Žé‚£è®¸å¤šä»£ç ä¸­æ‰¾è§£å¯†ä»£ç éžå¸¸è´¹åŠ²ï¼Œçºµç„¶åŠ è§£å¯†éƒ½èƒ½æžå®šï¼Œæƒ³ä¼ªé€ ä¹Ÿååˆ†éº»çƒ¦ï¼Œpacketä¸­åŒ…ç½—äº†ç›¸å½“å¤šçš„ä¿¡æ¯ï¼Œæˆ‘ä¼°è®¡å°±æ˜¯æŠŠä»–ä»¬çš„ä»£ç å¼€æ”¾ç»™å¼€å‘è€…ï¼Œæƒ³ç†æ¸…è¿™ä¸€éƒ¨åˆ†éƒ½ä¸æ˜¯ä¸€ä»¶è½»æ¾çš„äº‹æƒ…ã€‚ 4ã€ç™»å½•å”¯ä¸€æ€§å³ä½¿èƒ½å¤Ÿä¼ªé€ å¾®ä¿¡çš„è¯·æ±‚ï¼Œä¸€æ—¦ç™»å½•èŽ·å–æ•°æ®ï¼ŒåŽŸè´¦å·å°±ä¼šè¢«è¸¢ä¸‹çº¿å¹¶ä¸”å¾—åˆ°é€šçŸ¥ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¯´èµ·æ¥ä¹Ÿç®—æ˜¯æœåŠ¡å™¨æŽ§åˆ¶ã€‚ ä»¥ä¸Šå¼•è‡ªè¿™é‡Œã€‚ è¡Œä¸šçŠ¶å†µçˆ±åŠ å¯†ä»¥å®‰å…¨åŠ å›ºä½œä¸ºä¸šåŠ¡é”€å”®ï¼Œä¸ºå®¢æˆ·æå‡ºäº†å„ç§å®‰å…¨æ–¹æ¡ˆï¼Œè¿™é‡Œå¯ä»¥ä½œä¸ºä¸€ä¸ªæ–¹å‘äº†è§£ï¼Œåœ°å€ã€‚ æŠ€å·§ç»•è¿‡ptraceåè°ƒè¯•http://bbs.iosre.com/t/debugserver-ptrace/8037 åè°ƒè¯•http://iosre.com/t/topic/8179 è¯»ã€ŠiOSåº”ç”¨é€†å‘å·¥ç¨‹ã€‹æ¢³ç†]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>é€†å‘</tag>
        <tag>å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSé€†å‘ï¼ˆå››ï¼‰å®žæˆ˜ç¯‡]]></title>
    <url>%2FiOS%2FiOS%E9%80%86%E5%90%91%EF%BC%88%E5%9B%9B%EF%BC%89%E5%AE%9E%E6%88%98%E7%AF%87%2F</url>
    <content type="text"><![CDATA[è¿™ç¯‡ä¸»è¦æ˜¯æ›´è¯¦ç»†åœ°è®²è§£ä¸€æ­¥ä¸€æ­¥æ‰¾å‡ºç›®æ ‡çš„æ–¹æ³•ï¼Œä»Žå®šä½viewï¼Œåˆ°å®šä½å…¶Controllerï¼Œå†åˆ°å®šä½ç›®æ ‡å‡½æ•°ï¼Œä»¥åŠä¸€äº›å·¥å…·åœ¨å®žé™…åœºæ™¯ä¸‹çš„ä½¿ç”¨è¿‡ç¨‹ï¼Œæ¯”å¦‚IDAç­‰ã€‚çœ‹åˆ°æœ€åŽï¼Œæˆ‘å¯èƒ½ä¼šè¢«è¯»è€…å–·æ˜¯æ ‡é¢˜å…šï¼Œä½†æ˜¯æˆ‘ä¹Ÿå¾ˆæ— å¥ˆï¼Œç­‰ä¸‹æ¬¡å§ï¼Œä¼šå†åŠªåŠ›å°è¯•ä¸€ä¸‹ã€‚ é€†å‘åˆ†æžæŽ¢å¯»ä½œå¢™é¡µé¢çš„Cåœ¨Appæ‰“å¼€è¢«å¢™çš„é¡µé¢ï¼Œç„¶åŽä½¿ç”¨Revealæˆ–è€…cycriptæ¥åˆ†æžå½“å‰æ˜¾ç¤ºé¡µé¢Vï¼ˆViewï¼‰çš„Cï¼ˆViewControllerï¼‰ã€‚è¿™é‡Œæ‹¿å›žä¸Šä¸€ç¯‡æ–‡ç« æ‰€ç”¨çš„æ–¹å¼è¯´æ˜Žï¼Œåˆ©ç”¨cycriptæ¥å®šä½ cy# [[UIApp keyWindow] recursiveDescription].toString() cy# button=#0x10c22b490 cy# [button setHidden:YES] cy# [button nextResponder] åˆ—å‡ºkeyWindowä¸Šè§†å›¾çš„å±‚çº§ç»“æž„åŽï¼Œæ ¹æ®å†…å®¹ç‰¹å¾ï¼Œå¦‚labelçš„textå±žæ€§å€¼ä¸Žå½“å‰é¡µé¢ä¸Šçš„å†…å®¹å¯¹æ¯”ï¼Œæ‰¾å‡ºå»åˆçš„å†…å®¹è¿›è¡ŒéªŒè¯ï¼Œä¾‹å¦‚è®¾ç½®æŽ§åˆ¶çš„éšè—ã€‚ç¡®è®¤æ˜¯å½“å‰é¡µé¢çš„æŽ§ä»¶åŽåˆ™å¯ä»¥å¼€å§‹æ ¹æ®å“åº”é“¾çš„å…³ç³»ï¼Œå¦‚å­è§†å›¾çš„nextResponderæ˜¯çˆ¶è§†å›¾ï¼Œè‹¥è¯¥çˆ¶è§†å›¾æ²¡æœ‰å®ƒçš„çˆ¶è§†å›¾äº†ï¼Œåˆ™å…¶nextResponderå°±æ˜¯å¯¹åº”çš„Controllerï¼Œé€šè¿‡è¿™æ ·æ¥æ‰¾å‡ºå½“å‰é¡µé¢çš„Controllerã€‚ åœ¨è¢«å¢™çš„é¡µé¢ä¸Šï¼Œæ ¹æ®ç¡®è®¤æ”¯ä»˜æŒ‰é’®ï¼Œæ‰¾å‡ºäº†å½“å‰çš„Cä¸ºXDBigNameViewController æŽ¢å¯»éœ€è§£é”çš„æ•°æ®æºIDAåˆ†æž ç„¶åŽå¯ä»¥å…ˆç›´æŽ¥åœ¨IDAä¸Šå¼€å§‹å¯¹ä¸šåŠ¡é€»è¾‘è¿›è¡Œåˆæ­¥çš„äº†è§£ï¼Œå®šä½åˆ°å…³é”®çš„å‡½æ•°ã€‚ XDBigNameViewControlleråœ¨å…¶setUIæ–¹æ³•ä¸Šåˆ›å»ºäº†ä¸€ä¸ªXDBigNameToolï¼ˆä¸€ä¸ªViewï¼‰ï¼Œå…¶delegateè®¾ä¸ºå½“å‰çš„XDBigNameViewControllerå¯¹è±¡å¹¶å åŠ åˆ°åŽè€…è‡ªèº«çš„viewå±žæ€§ä¸Šï¼Œå¯ä»¥çŒœæµ‹è¿™ä¸ªXDBigNameToolå°±æ˜¯ç•Œé¢ä¸Šçš„å¢™ã€‚ XDBigNameViewControllerç¡®è®¤äº†åè®®XDBigNameToolDelegateï¼Œè¯¥åè®®åªæœ‰ä¸€ä¸ªå¿…é¡»å®žçŽ°çš„æ–¹æ³• - (void)clickunlock; ã€‚ è§¦å‘ clickunlock åŽä¼šåˆå§‹åŒ–è®¢å•IDå’Œä»·æ ¼ä¿¡æ¯å¹¶å­˜å…¥æ•°æ®åº“ï¼Œç„¶åŽpushå‡ºä¸€ä¸ªå«XDPayViewControllerçš„é¡µé¢ã€‚åœ¨è¿™ä¸ªXDPayViewControlleré‡Œï¼Œå®žçŽ°äº†StoreKitçš„ä¸€ä¸ªä»£ç†æ–¹æ³• paymentQueue:updatedTransactions: ï¼Œæ„å‘³ç€è‹¹æžœå†…è´­å®ŒæˆåŽçš„å›žè°ƒå¯èƒ½æ‰§è¡Œè¯¥æ–¹æ³•ã€‚ åœ¨è¿™ä¸ªpaymentQueue:updatedTransactions:æ–¹æ³•ä¸­ï¼Œå½“transactionStateè¿”å›žçš„ç»“æžœæ˜¯1uLLæ—¶ï¼Œæ‰§è¡ŒXDPayViewControllerçš„completeTransaction: ï¼Œå¹¶ä¸”è·³è½¬åˆ° LABEL_11 ç»§ç»­æ‰§è¡Œ switch ( (unsigned __int64)objc_msgSend(*(void **)(v21 + 8 * v7), &quot;transactionState&quot;) ) &#123; ... case 1uLL: objc_msgSend(v4, &quot;removeProgressingView&quot;); objc_msgSend(v4, &quot;addProgressingViewWithMessage:&quot;, CFSTR(&quot;äº¤æ˜“æˆåŠŸï¼Œæ ¡éªŒä¿¡æ¯&quot;)); -[XDPayViewController completeTransaction:](v4, &quot;completeTransaction:&quot;, v8); v12 = objc_msgSend(&amp;OBJC_CLASS___SKPaymentQueue, &quot;defaultQueue&quot;); goto LABEL_11; ... LABEL_11: v13 = (void *)objc_retainAutoreleasedReturnValue(v12); objc_msgSend(v13, &quot;finishTransaction:&quot;, v8); v11 = (__int64)v13; ... &#125; æŸ¥çœ‹ä¸€ä¸‹ StoreKité‡ŒSKPaymentTransactionStateå®šä¹‰ï¼Œå†ç»“åˆæ­¤å¤„çš„æç¤ºä¿¡æ¯ï¼Œå¯ä»¥è‚¯å®šcase 1uLLé‡Œæ‰§è¡Œçš„æ“ä½œæ˜¯å†…è´­æˆåŠŸåŽçš„ä¸šåŠ¡é€»è¾‘ï¼Œè°ƒç”¨äº†å†…éƒ¨æ–¹æ³•completeTransaction:ã€‚ XDPayViewControllerçš„completeTransaction:æ–¹æ³•çš„ï¼ˆPseudocodeåŽçš„ï¼‰åç¼–è¯‘ç»“æžœå¦‚ä¸‹ ä»Žä¸Šé¢çš„å®žçŽ°å¯ä»¥å¤§æ¦‚çœ‹å‡ºåšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ… èŽ·å–receipt-dataï¼› ç”Ÿæˆè¯·æ±‚éªŒè¯å‰æ‰€éœ€çš„å…¶å®ƒå‚æ•°ï¼ˆordercodeã€paytypeã€payfromã€productIdç­‰ï¼‰ï¼› ç¼“å­˜ordercodeä¿¡æ¯ï¼› å®šä¹‰è¯·æ±‚çš„æˆåŠŸå’Œå¤±è´¥å›žè°ƒblockï¼› å‘èµ·è¯·æ±‚ã€‚ è¿˜æ²¡ç ”ç©¶å‡ºæ€Žä¹ˆåœ¨blockä¸­æ‰“æ–­ç‚¹ï¼Œå‚è€ƒ å¯¹é€†å‘ä¸­çš„blockæ‰“æ–­ç‚¹ã€‚ åœ¨Main Windowçš„åç¼–è¯‘é‡Œ å¯ä»¥çœ‹åˆ°X20è¿™ä¸ªå¯„å­˜å™¨ä¸€ç›´ä¿å­˜ç€receipt-dataï¼Œå¹¶åœ¨éªŒè¯æˆåŠŸçš„å›žè°ƒblockä¸­è¢«å¼•ç”¨ã€‚ ä¸­é—´ä¸€æ®µå¯¹X8çš„æ“ä½œï¼Œæ˜¯åœ¨æ”¶é›†è¯·æ±‚å‰çš„å‚æ•°é›†åˆï¼ŒåŒ…æ‹¬è¿›è¡Œbase64ç¼–ç åŽçš„receipt-data å†ç»è¿‡åˆ†æžï¼ŒX29æ˜¯æ–¹æ³•é‡Œä»Žå¤´åˆ°å°¾æ²¡æœ‰è¢«é‡æ–°èµ‹å€¼è¿‡å¹¶ä¸€ç›´ä¿æŒæ¿€æ´»çš„ä¸€ä¸ªå˜é‡ï¼Œåœ¨blockä¸­ä¹Ÿè¢«å¼•ç”¨åˆ°ï¼Œç”±æ­¤å¯ä»¥çŒœæµ‹å®ƒæ˜¯æ–¹æ³•ä¼ å…¥çš„åž‹å‚transactionï¼Œå¹¶åœ¨æˆåŠŸå›žè°ƒçš„blockä¸­å¯¹è¿™ä¸ªtransactionè¿›è¡Œfinishæ“ä½œã€‚ è¿™é‡Œå°è¯•è¿‡ä½¿ç”¨cycriptåŠ¨æ€è°ƒç”¨è¯¥completeTransaction:ï¼ˆå…ˆåˆ©ç”¨nextResponderæ‰¾å‡ºå½“å‰XDPayViewControllerçš„åœ°å€ï¼Œå†è¿›è¡Œè°ƒç”¨ï¼‰ï¼Œæ¨¡æ‹Ÿä¼ å…¥nilä½œä¸ºtransactionå‚æ•°ï¼Œè¿™æ—¶ä¼šè§¦å‘å¦‚ä¸‹çš„ç½‘ç»œè¯·æ±‚ ä¼šè¿”å›žé”™è¯¯çš„ç»“æžœï¼Œæç¤ºéªŒè¯å¤±è´¥ã€‚ æ­¤å‰å·²ç»åœ¨åº”ç”¨çš„æ²™ç›’ã€UserDefaultã€æœ¬åœ°æ•°æ®åº“ç­‰åº”ç”¨å†…çš„åœ°æ–¹æœæŸ¥è¿‡ä¸€éï¼Œæ”¶è´¹çš„æ•°æ®å¹¶æ²¡æœ‰æ”¾åœ¨æœ¬åœ°ï¼ˆæŒ‰å¸¸ç†æ¥è¯´ä¹Ÿä¸å¤ªå¯èƒ½è¿™æ ·å­˜æ”¾ï¼‰ã€‚ åˆ¶ä½œTweak åˆ°è¿™é‡Œå·²ç»å¯ä»¥çŸ¥é“ï¼Œæ”¶è´¹å†…å®¹æ˜¯éœ€è¦åœ¨receipt-dataè¢«éªŒè¯æˆåŠŸäº†æ‰ä¼šè¿”å›žï¼Œåˆ°è¿™é‡Œæš‚æ—¶å°±æ²¡è¾™äº†ã€‚ ä½†è‹¥åœ¨çŸ¥é“ç ´ç»½æ—¶ï¼ŒåŽç»­è¿˜éœ€è¦åšTweakæ’ä»¶æ¥hookä¸€äº›æ–¹æ³•çš„å®žçŽ°ï¼Œå°±æ‹¿ä¸Šé¢è°ƒç”¨completeTransaction:å¹¶ä¼ å…¥nilçš„transactionä¸¾ä¾‹ï¼ŒåšæˆTweakã€‚ é¦–å…ˆï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œé‡æ–°å®šä¹‰éœ€è¦hookçš„ç±»å’Œæ–¹æ³•æˆ–å±žæ€§ï¼Œç›®çš„æ˜¯ä¸ºäº†æ¬ºéª—ç¼–è¯‘å™¨ä½¿å…¶èƒ½æ‰¾åˆ°æ–¹æ³•çš„å£°æ˜Ž //In iosrefuguiqiming.h @interface XDPayViewController : NSObject - (void)completeTransaction:(id)transaction; @end //In Tweak.xm #import &quot;iosrefuguiqiming.h&quot; %hook XDPayViewController - (void)paymentQueue:(id)queue updatedTransactions:(id)transactions &#123; %log; UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@&quot;iosre&quot; message:@&quot;processing&quot; delegate:self cancelButtonTitle:@&quot;OK&quot; otherButtonTitles:nil]; [alert show]; [alert release]; [self completeTransaction:nil]; //%orig(queue,transactions); &#125; %end ç„¶åŽmake packageã€make installæŠŠdebå®‰è£…åˆ°è®¾å¤‡ä¸Šï¼Œè‡ªåŠ¨é‡å¯springboardæˆ–è€…tweakæŒ‡å®šçš„è¿›ç¨‹åŽï¼Œdebå°±å·²ç»ç”Ÿæ•ˆäº†ã€‚æ­¤æ—¶æ‰“å¼€target appï¼Œç‚¹å‡»å†…è´­åŽå°±é©¬ä¸Šå¼¹å‡ºæ’å…¥çš„æç¤ºæ¡†å’Œå‘èµ·æ”¯ä»˜çš„éªŒè¯è¯·æ±‚ã€‚ ç»“è¯­è™½ç„¶ç»“æžœæœªèƒ½è¾¾åˆ°ç›®æ ‡ï¼Œä½†è¿‡ç¨‹è¶³ä»¥è®©æˆ‘ä»¬å­¦ä¼šäº†åŠ¨æ‰‹åŽ»åˆ†æžå’Œæ”¹é€ ä¸€ä¸ªappï¼Œåƒç ´å£³ã€é™æ€çš„åç¼–è¯‘åˆ†æžã€åŠ¨æ€çš„lldbè°ƒè¯•ã€è‡ªåˆ¶tweakç­‰ï¼Œè®©æˆ‘ä»¬æ‹¥æœ‰äº†å€Ÿé‰´åˆ«äººAppçš„é˜²å¾¡æœºåˆ¶çš„èƒ½åŠ›ï¼Œåƒè¿™æ¬¡çš„æŽ¢ç´¢å°±å†æ¬¡å°è¯äº†åšè‹¹æžœçš„å†…è´­ï¼Œå¿…é¡»åœ¨æœåŠ¡ç«¯å¯¹æ”¶æ®è¿›è¡ŒéªŒè¯ï¼Œå¹¶ä¸”è¦å»ºç«‹å®Œå–„çš„è®¢å•åŒ¹é…é€»è¾‘ï¼Œé˜²æ­¢è¢«æ”»å‡»è€…é‡æ”¾æˆ–è€…ç¯¡æ”¹è®¢å•æ¥èŽ·å–æ”¶è´¹èµ„æºã€‚å¾…ä¹‹åŽæœ‰æ–°æ€è·¯å†å›žæ¥å°è¯•é‡æ–°è¿›æ”»è¯¥æ¬¡å®žè·µAppçš„éªŒè¯é€»è¾‘ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>é€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSé€†å‘ï¼ˆä¸‰ï¼‰åˆ†æžç¯‡]]></title>
    <url>%2FiOS%2FiOS%E9%80%86%E5%90%91%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%86%E6%9E%90%E7%AF%87%2F</url>
    <content type="text"><![CDATA[åœ¨é€†å‘çŽ¯å¢ƒã€å·¥å…·å‡†å¤‡å¾—ä¸ƒä¸ƒå…«å…«åŽï¼Œå°±å¼€å§‹å­¦ä¹ ä¸€ä¸‹é€†å‘çš„å¥—è·¯ã€‚å…ˆè¦å®šä½ä¸€ä¸ªé€†å‘çš„ç›®æ ‡Appå’Œéœ€è¦Tweakå®ƒçš„åŠŸèƒ½ç‚¹ï¼Œç„¶åŽé€šè¿‡ç½‘ç»œåˆ†æžã€åŠ¨æ€åˆ†æžã€é™æ€åˆ†æžã€æ²™ç›’åˆ†æžç­‰æ–¹æ³•ï¼Œæ¥çœ‹çœ‹ä¸€èˆ¬æ˜¯å¦‚ä½•ç»™ä¸€ä¸ªAppåšé€†å‘çš„ï¼Œæ€Žä¹ˆæ‰¾å‡ºé¢˜ç›®çš„ä½ç½®ã€æœ‰ä»€ä¹ˆè§£æ³•ã€‚çŸ¥é“é¢˜è¯¥æ€Žä¹ˆè§£åŽï¼ŒæŽ¥ç€æ˜¯å­¦ä¹ æ€Žä¹ˆé€ Tweakï¼Œæ€Žä¹ˆæŠŠåˆ«äººAppçš„åŠŸèƒ½æ‰­æ›²æˆè‡ªå·±æƒ³è¦çš„æ•ˆæžœã€‚ éœ€æ±‚åˆ†æžç›®æ ‡åº”ç”¨æ˜¯ä¸€ä¸ªå…³äºŽååŠ©èµ·åå­—çš„Appï¼Œé€šè¿‡æä¾›æŒ‡å®šçš„èµ·åæ¡ä»¶ï¼Œä¾‹å¦‚åŒåè¿˜æ˜¯å•åï¼Œå§“ï¼Œå‡ºç”Ÿå¹´æœˆï¼Œæ€§åˆ«çš„ä¿¡æ¯ï¼Œæ¥èŽ·å–ï¼ˆç¬¦åˆé£Žæ°´å‘½ç†çš„ï¼‰å¯¹åº”çš„åå­—ç»„åˆã€‚ ç»“æžœä¸­ä¼šæœ‰å°å‰åï¼Œå¤§å‰åï¼Œå’Œå¤§å¸ˆæŽ¨èåçš„åˆ†ç±»ï¼Œå…¶ä¸­å¤§å‰åå’Œå¤§å¸ˆæŽ¨èåæ˜¯è¦åˆ†åˆ«ä»˜æ¬¾è§£é”æ‰èƒ½æŸ¥çœ‹çš„ã€‚ ä¸‹é¢å°±é’ˆå¯¹è¿™ä¸¤ä¸ªä»˜æ¬¾åŠŸèƒ½ï¼Œå°è¯•ç ´è§£ã€‚ ç½‘ç»œåˆ†æžæ— è®ºæ˜¯å¯åŠ¨åº”ç”¨çš„åˆå§‹åŒ–è¯·æ±‚ï¼Œè¿˜æ˜¯èµ·ååˆ†æžè¯·æ±‚ï¼ˆå·²ç»è¯·æ±‚è¿‡çš„èµ·åæ¡ä»¶åˆ™ä¸ä¼šé‡å¤å‘èµ·ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œéƒ½ä¼šå¸¦æœ‰ä¸‹é¢è¿™äº›å‚æ•° appname naming_fugui_iphone client iPhone device iPhone openudid FD7925AB-92C0-438C-B6E1-C58339553B57 idfa 332C7245-BCD7-458A-BB1F-BC25F6C2D541 sign 600D1E13A20AEADE3C5485E78418DC3E ver 1.2 appnameä»£è¡¨å½“å‰Appåç§°ï¼Œä¼°è®¡å…¶ä½œç”¨ä¸ºåŒºåˆ†ä¸åŒçš„é©¬ç”²åŒ…ï¼› clientå’Œdeviceä¼°è®¡æ˜¯åŒºåˆ†æ“ä½œç³»ç»Ÿã€æ“ä½œç»ˆç«¯ã€è®¾å¤‡ç±»åž‹ç­‰ï¼› openudidä¼°è®¡ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼› idfaåˆ™æ˜¯ç†ŸçŸ¥çš„å¹¿å‘ŠIDï¼› signä¼°è®¡å°±æ˜¯å¯¹éƒ¨åˆ†å‚æ•°å€¼æŒ‰ä¸€å®šé¡ºåºï¼ˆå¦‚appname+client+device+openudid+secretkeyï¼‰ï¼ŒåŠ å…¥å¯†é’¥keyè¿›è¡Œç­¾ååŽçš„åºåˆ—ï¼ˆå› ä¸ºå°è¯•ä¿®æ”¹äº†å®ƒï¼Œæˆ–è€…ä»¥ä¸Šå‚æ•°åŽå°±æ— æ³•èŽ·å–æ•°æ®äº†ï¼‰ åœ¨åˆå§‹åŒ–è¯·æ±‚ä¸­è¿”å›žçš„dataä¸»è¦æ˜¯ä¸€äº›åŠ¨æ€æŽ§åˆ¶çš„è®¾ç½®å†…å®¹ï¼Œå¦‚å¹¿å‘Šã€å¥½è¯„ã€å®šæ—¶æœ¬åœ°æŽ¨é€ã€è·‘é©¬ç¯ã€æ”¯ä»˜æ¸ é“ç­‰ç­‰ã€‚ å…¶æ¬¡ï¼Œèµ·ååˆ†æžè¯·æ±‚èŽ·å¾—çš„ç»“æžœå¦‚ä¸‹ï¼Œå…¶ä¸­tjmå­—æ®µå¯¹åº”æŽ¨èåæ¿å—ã€zxmå­—æ®µå¯¹åº”å°å‰åæ¿å—ã€infoå­—æ®µå¯¹åº”èµ„æ–™åˆ†æžæ¿å—ï¼Œå¯¹åº”å¤§å‰åæ¿å—çš„æ•°æ®å¹¶æ²¡æœ‰è¿”å›žã€‚ç„¶åŽè¿˜æœ‰ä¸€ä¸ªå«productçš„å­—æ®µï¼Œé‡Œé¢åŒ…å«äº†ä¸‰ä¸ªç±»ä¼¼å“é¡¹çš„å¯¹è±¡ï¼Œå…¶ä¸­ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ˜¯product_identifierä¸ºtestçš„å¯¹è±¡ï¼Œå®ƒçš„ä»·æ ¼åªéœ€0.01ï¼ŒèŒç”Ÿç¬¬ä¸€ä¸ªè¯•æƒ³ï¼šè´­ä¹°å¤§å‰åæ—¶æ¢æˆè¿™ä¸ªå•†å“IDæ˜¯å¦è¡Œå¾—é€šã€‚ &#123; &quot;code&quot;: &quot;E00000000&quot;, &quot;msg&quot;: &quot;\u64cd\u4f5c\u6210\u529f\u3002&quot;, &quot;data&quot;: &#123; &quot;tjm&quot;: [...], &quot;zxm&quot;: [...], &quot;info&quot;: &#123;...&#125;, &quot;product&quot;: &#123; &quot;jiMing&quot;: &#123; &quot;product_identifier&quot;: &quot;zhangjingfuguiqiming001&quot;, &quot;product_name&quot;: &quot;...&quot;, &quot;product_desc&quot;: &quot;...&quot;, &quot;product_price&quot;: 25 &#125;, &quot;tuiJian&quot;: &#123; &quot;product_identifier&quot;: &quot;zhangjingfuguiqiming002&quot;, &quot;product_name&quot;: &quot;...&quot;, &quot;product_desc&quot;: &quot;...&quot;, &quot;product_price&quot;: 40 &#125;, &quot;tianJiang&quot;: &#123; &quot;product_identifier&quot;: &quot;test&quot;, &quot;product_name&quot;: &quot;...&quot;, &quot;product_price&quot;: 0.01 &#125; &#125; &#125; &#125; ç ¸å£³å…ˆsshåˆ°æ‰‹æœºä¸Š $ iproxy 4567 22 $ ssh -p 4567 root@127.0.0.1 å…ˆå®šä½å‡ºå…¶å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è·¯å¾„ã€‚åœ¨æ‰‹æœºæ‰“å¼€Target Appï¼Œç„¶åŽé€šè¿‡å½“å‰è¿è¡Œçš„è¿›ç¨‹æŸ¥æ‰¾ iPhone:~ root# ps -e | grep /Applications PID TTY TIME CMD1234 ?? 0:08.97 /var/containers/Bundle/Application/XXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/Target.app/Target Appstore Appå¯æ‰§è¡Œæ–‡ä»¶æ˜¯åœ¨/var/containers/Bundle/Application/æ ·å¼çš„è·¯å¾„é‡Œé¢ï¼Œå†é€šè¿‡å¯¹æ¯”å…¶ç›¸å…³çš„.appæ–‡ä»¶åå«ä¹‰å°±ä¸éš¾æ‰¾åˆ°æ­£ç¡®çš„è·¯å¾„ã€‚ ç„¶åŽæ˜¯å®šä½Target Appçš„Documentsç›®å½•è·¯å¾„ã€‚åˆ©ç”¨cycriptè¿›å…¥Target Appçš„è¿›ç¨‹åŽï¼Œä½¿ç”¨cycriptçš„è¯­æ³•èŽ·å–å½“å‰æ²™ç›’ç›®å½•ä¸­Documentsçš„è·¯å¾„ iPhone:~ root# cycript -p targetAppPID cy# [[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask][0] æœ€åŽå°±æ˜¯å°†dumpdecrypted.dylibæ‹·è´åˆ°Target Appçš„Documentsç›®å½•ä¸‹(å¼€å¯iproxyä¸­) $ rsync -avz -e &quot;ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 4567&quot; --progress /Path/to/dumpdecrypted.dylib root@127.0.0.1:/var/mobile/Containers/Data/Application/YYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY/Documents/ å¼€å§‹ç ¸å£³ iPhone:~ root# cd iPhone:/path/to/Documents root# DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib /var/containers/Bundle/Application/XXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/Target.app/Target dyld: could not load inserted library â€˜dumpdecrypted.dylibâ€™ because no suitable image found. Did find: dumpdecrypted.dylib: required code signature missing for â€˜dumpdecrypted.dylibâ€™ /private/var/mobile/Containers/Data/Application/YYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY/Documents/dumpdecrypted.dylib: required code signature missing for â€˜/private/var/mobile/Containers/Data/Application/YYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY/Documents/dumpdecrypted.dylibâ€™Abort trap: 6 è‹¥æŠ¥ä»¥ä¸Šé”™è¯¯ï¼Œå¯å‚è€ƒè¿™é‡Œè§£å†³ï¼Œæ€è·¯å°±æ˜¯ä½¿ç”¨MacOSä¸Šä»»ä½•ä¸€ä¸ªæœ‰æ•ˆçš„è¯ä¹¦å¯¹dumpdecrypted.dylibå…ˆåšä¸€ä¸ªç­¾åå†æ‹·è´åˆ°Target Appçš„Documents ## åˆ—å‡ºå¯ç­¾åè¯ä¹¦ $ security find-identity -v -p codesigning ## ä¸ºdumpecrypted.dylibç­¾å $ codesign --force --verify --verbose --sign &quot;iPhone Developer: xxx xxxx (xxxxxxxxxx)&quot; dumpdecrypted.dylib å†æ¬¡ç ¸å£³ï¼Œå°±æˆåŠŸäº† mach-o decryption dumper DISCLAIMER: This tool is only meant for security research purposes, not for application crackers. [+] detected 64bit ARM binary in memory.[+] offset to cryptid found: @0x1000b0c08(from 0x1000b0000) = c08[+] Found encrypted data at address 00004000 of length 3801088 bytes - type 1.[+] Opening /private/var/containers/Bundle/Application/4E0F7779-AD12-4634-9758-BB398648BBA6/XDQiMing.app/XDQiMing for reading.[+] Reading header[+] Detecting header type[+] Executable is a plain MACH-O image[+] Opening XDQiMing.decrypted for writing.[+] Copying the not encrypted start of the file[+] Dumping the decrypted data into the file[+] Copying the not encrypted remainder of the file[+] Setting the LC_ENCRYPTION_INFO-&gt;cryptid to 0 at offset c08[+] Closing original file[+] Closing dump file æœ€åŽçš„æœ€åŽï¼Œå°±æ˜¯å°†ç ¸å£³åŽçš„æ–‡ä»¶ Target.decrypted æ‹·è´å›žMacOSä¸Šã€‚ åŠ¨æ€åˆ†æžå®šä½ç›®æ ‡å‡½æ•°çš„æ–¹æ³•ä¸»è¦æ˜¯åˆ©ç”¨cycriptå®žçŽ°ã€‚ 1.æ³¨å…¥è¿›ç¨‹ iPhone:~ root# ps -e | grep /Applications 5288 ?? 0:05.52 /var/containers/Bundle/Application/4E0F7779-AD12-4634-9758-BB398648BBA6/TargetApp.app/TargetApp 5296 ttys001 0:00.00 grep /var/containers/Bundle/Application/ iPhone:~ root# cycript -p 5288 2.åˆ†æžUIå±‚æ¬¡ç»“æž„ å…ˆæ‰“å¼€TargetAppåˆ°éœ€è¦å®šä½çš„åŠŸèƒ½é¡µé¢ ç„¶åŽä½¿ç”¨åŽ†éæ‰“å°æŽ’æŸ¥çš„æ–¹å¼ï¼Œå°†é€çº§ç•Œé¢ä¸Šçš„æŽ§ä»¶åˆ—è¡¨è¾“å‡ºåˆ†æž cy# [[UIApp keyWindow] recursiveDescription].toString() psï¼šåŠ .toString()æ˜¯ä¸ºäº†æ ¼å¼åŒ–æ¢è¡Œç¬¦ç­‰ç¬¦å·ï¼Œä½¿è¾“å‡ºæ›´æ˜“äºŽé˜…è¯»ï¼Œä»¥å¾€è®©cycriptå¼€å¯ç¿»è¯‘æ ¼å¼ç¬¦å·åŠŸèƒ½çš„?expandæŒ‡ä»¤å·²ç»å¤±æ•ˆäº†ã€‚ å¾—å‡ºçš„ç»“æžœæ˜¯è¿™ä¸ªæ ·å­çš„ å…¶ä¸­ï¼Œå‘çŽ°æœ‰ä¸€ä¸ªLCTableViewï¼Œå…¶åŒ…å«çš„XDPayCellé‡Œæœ‰æ˜¾ç¤ºå¾®ä¿¡å’ŒæŽ¨èå·²å®‰è£…å¾®ä¿¡çš„ç”¨æˆ·ä½¿ç”¨è¿™ä¸¤ä¸ªæ–‡æ¡ˆçš„Unicodeï¼Œæ‰€ä»¥å¯ä»¥åŸºæœ¬ç¡®å®šLCTableViewå°±æ˜¯é€‰æ‹©æ”¯ä»˜æ–¹å¼çš„åˆ—è¡¨ã€‚ &lt;LCTableView: 0x101a72600; baseClass = UITableView; frame = (0 192; 320 153.6); clipsToBounds = YES; gestureRecognizers = &lt;NSArray: 0x17045b0f0&gt;; layer = &lt;CALayer: 0x17043a820&gt;; contentOffset: &#123;0, 0&#125;; contentSize: &#123;320, 153.60000228881836&#125;&gt; &lt;UITableViewWrapperView: 0x1018fd400; frame = (0 0; 320 153.6); gestureRecognizers = &lt;NSArray: 0x17045b420&gt;; layer = &lt;CALayer: 0x17043a860&gt;; contentOffset: &#123;0, 0&#125;; contentSize: &#123;320, 153.59999999999999&#125;&gt; &lt;XDPayCell: 0x101a73000; baseClass = UITableViewCell; frame = (0 0; 320 51.2); autoresize = W; layer = &lt;CALayer: 0x17043b760&gt;&gt; &lt;UITableViewCellContentView: 0x10c22ced0; frame = (0 0; 320 51.2); gestureRecognizers = &lt;NSArray: 0x17045ce00&gt;; layer = &lt;CALayer: 0x17043bce0&gt;&gt; &lt;UIView: 0x10c22ccd0; frame = (0 0; 320 46.9333); layer = &lt;CALayer: 0x17043bb20&gt;&gt; &lt;UIImageView: 0x100779510; frame = (12.8 8.53333; 29.8667 29.8667); opaque = NO; userInteractionEnabled = NO; layer = &lt;CALayer: 0x17043bbc0&gt;&gt; &lt;UILabel: 0x10c22d1d0; frame = (55.4667 8.53333; 85.3333 12.8); text = &apos;\u5fae\u4fe1&apos;; userInteractionEnabled = NO; layer = &lt;_UILabelLayer: 0x170481ae0&gt;&gt; &lt;_UILabelContentLayer: 0x17442e6e0&gt; (layer) &lt;UILabel: 0x10c22d460; frame = (55.4667 27.3067; 320 11.0933); text = &apos;\u63a8\u8350\u5df2\u5b89\u88c5\u5fae\u4fe1\u7684\u7528\u6237\u4f7f\u7528&apos;; userInteractionEnabled = NO; layer = &lt;_UILabelLayer: 0x170480050&gt;&gt; &lt;_UILabelContentLayer: 0x17442e6c0&gt; (layer) &lt;UIImageView: 0x10c22d820; frame = (288 0; 19.2 46.9333); opaque = NO; userInteractionEnabled = NO; layer = &lt;CALayer: 0x17043bb00&gt;&gt; ... &lt;UIButton: 0x10c22b490; frame = (12.8 362.667; 294.4 38.4); opaque = NO; layer = &lt;CALayer: 0x17043acc0&gt;&gt; &lt;UIButtonLabel: 0x10c22ca20; frame = (110.5 8.5; 73.5 21.5); text = &apos;\u786e\u8ba4\u652f\u4ed8&apos;; opaque = NO; userInteractionEnabled = NO; layer = &lt;_UILabelLayer: 0x170480af0&gt;&gt; &lt;_UILabelContentLayer: 0x17043be80&gt; (layer) ç„¶åŽä¸ŽLCTableViewåŒçº§çš„è¿˜æœ‰ä¸€ä¸ªUIButtonï¼Œä¹ŸåŸºæœ¬å¯ä»¥çŒœæµ‹åˆ°å…¶å°±æ˜¯ç¡®è®¤æ”¯ä»˜æŒ‰é’®ï¼Œä¸‹é¢æ¥éªŒè¯ä¸€ä¸‹ cy# button=#0x10c22b490 cy# [button setHidden:YES] å‘çŽ°ç¡®è®¤æ”¯ä»˜æŒ‰é’®éšè—äº†ï¼Œè¯å®ž #0x10c22b490 å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å¯¹è±¡ã€‚ å¦‚æžœç•Œé¢å¸ƒå±€æ¯”è¾ƒå¤æ‚ï¼ŒæŽ§ä»¶ç¹å¤šåˆæ²¡æœ‰ä»€ä¹ˆæ ‡è¯†èƒ½è¯†åˆ«çš„æ—¶å€™ï¼Œå¯ä»¥æ¢ä¸ªè§’åº¦ï¼Œé€šè¿‡æ‰¾å…¶ç›¸å…³çš„æ›´æ˜“å®šä½çš„æŽ§ä»¶æˆ–å®¹å™¨æ¥é—´æŽ¥å¯»æ‰¾ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨setHiddenè¿™ç§æ–¹å¼ï¼Œé…åˆä¸Šsubviewså’ŒsuperViewæ–¹æ³•ã€‚ å¦‚æžœæ€€ç–‘æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„windowæ—¶ï¼Œå¯ä»¥ä½¿ç”¨[UIApp windows]æ¥èŽ·å–ã€‚ 3.å®šä½å‡½æ•° cy# [button allTargets] [NSSet setWithArray:@[#&quot;&lt;XDPayViewController: 0x101194000&gt;&quot;]]] cy# [button allControlEvents] 64 cy# [button actionsForTarget:#0x101194000 forControlEvent:64] @[&quot;clickDetermineBtn&quot;] è¿™æ ·å°±èƒ½å®šä½åˆ°å‡½æ•°çš„å®žçŽ°æ˜¯åœ¨ XDPayViewControllerç±» çš„ clickDetermineBtnæ–¹æ³•é‡Œã€‚ åˆ†æžå‡½æ•°åœ°å€çš„æ–¹æ³•** è®¡ç®—çœŸå®žåœ°å€ **çœŸå®žçš„åœ°å€å…¶å®žå°±æ˜¯åç§»åŽçš„åŸºåœ°å€ åç§»åŽçš„åŸºåœ°å€ = åç§»å‰çš„åŸºåœ°å€ + ASLRåç§» ASLRåç§»å¯ä»¥åœ¨lldbä¸‹ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤èŽ·å¾— (lldb) image list -o -f [ 0] 0x00000000000c8000 /var/containers/Bundle/Application/4E0F7779-AD12-4634-9758-BB398648BBA6/Target.app/TargetApp(0x00000001000c8000) [ 1] 0x00000001005d0000 /Users/nero/Library/Developer/Xcode/iOS DeviceSupport/10.3.3 (14G60)/Symbols/usr/lib/dyld ... åœ¨[åºå·]å·¦è¾¹ç´§æŒ¨çš„åœ°å€å°±æ˜¯ ASLRåç§» åç§»å‰çš„åŸºåœ°å€åˆ™éœ€è¦åœ¨IDA/Hopperé‡ŒæŸ¥çœ‹ å°±æ‹¿ä¸Šé¢XDPayViewControllerå®žçŽ°çš„paymentQueue:updatedTransactions:æ–¹æ³•ä¸ºä¾‹ï¼Œå…¶åç§»åŽçš„åœ°å€å°±æ˜¯ 0xC8000 + 0x10006D5F8ï¼Œå³0x1001355F8ã€‚ éœ€è¦æ³¨æ„ASLRåç§»çš„é€‰å–ï¼Œè¿™é‡Œå› ä¸ºXDPayViewControllerå±žäºŽTargetAppè¿™ä¸ªæ¨¡å—ï¼Œæ‰€ä»¥é€‰æ‹©TargetAppçš„ASLRåç§»ï¼Œå³æ˜¯ASLRåç§»è¦æ ¹ç›®æ ‡ç±»æ‰€åœ¨çš„æ¨¡å—æ¥å†³å®šã€‚ çœŸæ˜¯éœ€è¦åŠ¨é™ç»“åˆæ‰èƒ½èŽ·å¾—çœŸå®žçš„åœ°å€å•Šï¼Œè€Œæ‹¿çœŸå®žåœ°å€çš„ä¸»è¦ç›®çš„æ˜¯ä¸‹æ–­ç‚¹ (lldb) b 0x100079ba4 Breakpoint 1: where = XDQiMing`_mh_execute_header + 154532, address = 0x0000000100079060 è¿™é‡Œçš„whereæ˜¯ä¸ä¼šç›´æŽ¥æ˜¾ç¤ºç›¸åº”çš„ç¬¦å·ï¼Œè¿™æ˜¯å› ä¸ºOCæ–¹æ³•æ²¡æœ‰ç¬¦å·ï¼Œè€Œlldbåˆ™ç”¨ä¸Šäº†ä¸€ä¸ªæœ‰ç¬¦å·çš„å‡½æ•°+offsetæ¥è¡¨ç¤ºã€‚ ç„¶åŽæ¢å¤è¿›ç¨‹ç»§ç»­è¿è¡Œï¼Œæ“ä½œç•Œé¢ä½¿æ–­ç‚¹æ‰€åœ¨å‡½æ•°è§¦å‘ï¼Œå†ç»“åˆä½¿ç”¨lldbçš„è°ƒè¯•æŒ‡ä»¤å°±èƒ½èŽ·å–æˆ–æ›´æ”¹è¯¥å‡½æ•°è¿è¡Œæ—¶çš„å˜é‡æ•°æ® (lldb) c Process PID resuming Process 3255 stopped * thread #1, queue = &apos;com.apple.main-thread&apos;, stop reason = breakpoint 2.1 frame #0: 0x0000000100079ba4 XDQiMing`_mh_execute_header + 154532 XDQiMing`_mh_execute_header: -&gt; 0x100079ba4 &lt;+154532&gt;: sub sp, sp, #0xb0 ; =0xb0 0x100079ba8 &lt;+154536&gt;: stp d11, d10, [sp, #0x30] 0x100079bac &lt;+154540&gt;: stp d9, d8, [sp, #0x40] 0x100079bb0 &lt;+154544&gt;: stp x28, x27, [sp, #0x50] Target 0: (XDQiMing) stopped. (lldb) ni (lldb) si (lldb) p (char *)$r1 (lldb) register write $rn x è¿˜æœ‰ä¸€ç§å¯ä»¥ä¸ç”¨æ´¾ä¸ŠIDAå°±èƒ½çŸ¥é“çœŸå®žåœ°å€çš„æ–¹æ³• (lldb) po [XDBigNameViewController _shortMethodDescription] &lt;XDBigNameViewController: 0x1004e33e0&gt;: in XDBigNameViewController: Properties: @property (retain, nonatomic) LCCollectionView* collectionView; (@synthesize collectionView = _collectionView;) ... Instance Methods: - (void) initData; (0x100079a00) ... in LCViewController: Properties: @property (retain, nonatomic) UIImageView* imageView; (@synthesize imageView = _imageView;) ... Instance Methods: - (void) pushViewControllerClass:(Class)arg1 Param:(id)arg2 Animated:(BOOL)arg3; (0x100141efc) ... æ›´å¤šçš„é»‘ç§‘æŠ€è¯·å‚é˜…è¿™ä¸ªé“¾æŽ¥ã€‚ é™æ€åˆ†æžå¤´æ–‡ä»¶åˆ†æžåˆ©ç”¨class-dumpè¿™æ¬¾å·¥å…·å°±èƒ½å¤Ÿå°†ç ´å£³çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ‰€æœ‰å¤´æ–‡ä»¶å¯¼å‡ºï¼Œç„¶åŽå»ºç«‹ä¸€ä¸ªç©ºçš„Xcodeå·¥ç¨‹å¯¼å…¥è¿™äº›å¤´æ–‡ä»¶æ¥ç¿»çœ‹ï¼Œæ–¹ä¾¿é˜…è¯»å’ŒæŸ¥æ‰¾å†…å®¹ class-dump -H /Users/mac/Desktop/Payload/Kt.app -o /Users/mac/Desktop/Payload Mach-Oåˆ†æžMach-Oä¸ºMachine Objectæ–‡ä»¶ï¼Œæ˜¯ä¸€ç§å¯æ‰§è¡Œæ–‡ä»¶ã€ç›®æ ‡ä»£ç ã€åŠ¨æ€åº“ã€å†…æ ¸è½¬å‚¨çš„æ–‡ä»¶æ ¼å¼ï¼Œåˆ©ç”¨IDAæˆ–è€…Hopper Disassembelerç­‰äº¤äº’å¼åæ±‡ç¼–å·¥å…·èƒ½å®žçŽ°å¯¹äºŒè¿›åˆ¶ä»£ç çš„åæ±‡ç¼–ï¼Œä»–ä»¬èƒ½æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œå¤šç§CPUæŒ‡ä»¤é›†åç¼–è¯‘ã€‚ è¦æ³¨æ„åç¼–è¯‘çš„å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯fat binaryè¿˜æ˜¯thin binaryï¼Œè‹¥æ˜¯fat binaryåˆ™åº”å…ˆå‡è‚¥ï¼ŒæŒ‡å®šä¿ç•™ä¸€ä¸ªæž¶æž„ï¼ˆä¸ŽIDAä¸­é€‰æ‹©åç¼–è¯‘çš„æž¶æž„éœ€ä¸€è‡´ï¼Œä½†æœ€æ–°ç‰ˆæœ¬çš„IDAå¥½åƒå·²ç»æ”¯æŒå¯¼å…¥fat binaryï¼Œå¯ä»¥å…åŽ»å¯¹äºŒè¿›åˆ¶æ–‡ä»¶å‡è‚¥çš„æ­¥éª¤ï¼‰ $ lipo -info /path/to/execution Non-fat file: /path/to/execution is architecture: arm64 $ lipo -thin armv7 execution -output execution_armv7 IDAæ”¶è´¹ç‰ˆçš„IDAè¿˜æœ‰ä¸€ä¸ªå¾ˆå¥½ç”¨çš„åŠŸèƒ½ï¼Œå°±æ˜¯ä¼ è¯´ä¸­çš„F5ï¼ˆPseudocodeï¼‰ ä½œç”¨å°±æ˜¯å°†ä¸‹å›¾æ±‡ç¼–æ ·å¼çš„è¯­æ³•è½¬æ¢ä¸ºä¸‹ä¸‹å›¾ä¸­çš„cæ ·å¼è¯­æ³•è¡¨ç¤ºï¼Œé˜…è¯»ä»£ç æ—¶æ›´ç›´è§‚æ–¹ä¾¿ï¼Œä¸ç”¨å†åŽ»ARMå®˜ç½‘æŸ¥æŒ‡ä»¤ã€åˆ†æžå¯„å­˜å™¨çš„äº¤æ›¿ï¼ˆå…¶å®žè¿™æ˜¯åŸºæœ¬åŠŸï¼Œå…ˆäº†è§£å…¶åŽŸç†è¿˜æ˜¯æœ‰å¥½å¤„ï¼‰ã€‚ è¿™é‡Œæœ‰æ›´è¯¦ç»†çš„IDAä»‹ç»å’ŒIDAä½¿ç”¨è¯´æ˜Žå¯ä¾›å‚è€ƒã€‚ ARMæ±‡ç¼–åœ¨è°ƒç”¨æ–¹æ³•å‰ï¼Œå¸¸ç”¨R0R3ï¼ˆx0x3ï¼‰å¯„å­˜å™¨ä¿å­˜objc_msgSendä¸­çš„å„ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯è°ƒç”¨è€…ã€selectorã€å‚æ•°1ã€å‚æ•°2ï¼Œåœ¨è°ƒç”¨æ–¹æ³•åŽï¼Œè¿”å›žç»“æžœä¼šå­˜åˆ°R0ï¼Œè‹¥æœ‰è¶…è¿‡ä¸¤ä¸ªçš„å‚æ•°æ—¶ï¼Œå¤šå‡ºçš„å‚æ•°ä¼šå­˜åœ¨æ ˆä¸­ï¼Œåœ°å€æ˜¯*SPã€ *(SP+sizeOfLastArg)ã€â€¦ã€‚ æ›´å¤šçš„æ±‡ç¼–æŒ‡ä»¤å’Œè¯¦ç»†è¯´æ˜Žå¯ä»¥å‚è€ƒARMå®˜æ–¹æ–‡æ¡£ã€‚ Tweakå¼€å‘Tweakåˆ›å»ºé…ç½®çŽ¯å¢ƒå˜é‡ export THEOS=/opt/theos è‹¥ä¸å…ˆé…ç½®çŽ¯å¢ƒå˜é‡çš„è¯ï¼Œå½“makeçš„æ—¶å€™ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ Makefile:1: /makefiles/common.mk: No such file or directoryMakefile:6: /tweak.mk: No such file or directory åˆ›å»ºtheoså·¥ç¨‹ /opt/theos/bin/nic.pl 1.é€‰æ‹©æ¨¡æ¿=&gt;2.tweaké¡¹ç›®å=&gt;3.debåŒ…å=&gt;4.ä½œè€…å=&gt;5.tweakä½œç”¨å¯¹è±¡ï¼ˆbundleIDè¡¨ç¤ºï¼‰=&gt;6.å®‰è£…åŽéœ€é‡å¯çš„åº”ç”¨ï¼ˆè¿›ç¨‹åè¡¨ç¤ºï¼‰ Tweakç¼–å†™åˆ›å»ºTweaké¡¹ç›®åŽï¼Œtweak.xmé‡Œçš„è‡ªå¸¦æ¨¡æ¿å¦‚ä¸‹ /* How to Hook with Logos Hooks are written with syntax similar to that of an Objective-C @implementation. You don&apos;t need to #include &lt;substrate.h&gt;, it will be done automatically, as will the generation of a class list and an automatic constructor. %hook ClassName // Hooking a class method + (id)sharedInstance &#123; return %orig; &#125; // Hooking an instance method with an argument. - (void)messageName:(int)argument &#123; %log; // Write a message about this call, including its class, name and arguments, to the system log. %orig; // Call through to the original function with its original arguments. %orig(nil); // Call through to the original function with a custom argument. // If you use %orig(), you MUST supply all arguments (except for self and _cmd, the automatically generated ones.) &#125; // Hooking an instance method with no arguments. - (id)noArguments &#123; %log; id awesome = %orig; [awesome doSomethingElse]; return awesome; &#125; // Always make sure you clean up after yourself; Not doing so could have grave consequences! %end */ æ¶‰åŠåˆ°å‡½æ•°è¯­æ³•åŒ…æ‹¬ï¼š %hookï¼šæŒ‡å®šè¦hookçš„classï¼Œä»¥%endç»“å°¾ %logï¼šå°†å‡½æ•°çš„ç±»åã€å‚æ•°ç­‰å†™å…¥syslog %origï¼šè°ƒç”¨hookçš„åŽŸå‡½æ•° %groupï¼šå°†%hookåˆ†ç»„ %initï¼šåˆå§‹åŒ–æŸä¸ª%group %ctorï¼šæ˜¾å¼å®šä¹‰è°ƒç”¨%init %newï¼šæ·»åŠ æ–°å‡½æ•° %cï¼šä½œç”¨ç­‰åŒäºŽNSClassFromString Tweakç¼–è¯‘ç¼–è¯‘ make Making all for tweak Nero_first_iosreâ€¦make[2]: Nothing to be done for `internal-library-compileâ€™. è‹¥æ‰‹åŠ¨åˆ é™¤äº†objæ–‡ä»¶åŽå†makeå‡ºçŽ°ä»¥ä¸ŠæŠ¥é”™çš„è¯ï¼Œå°†å’ŒobjåŒä¸€ä¸ªç›®å½•çš„.theosé‡Œé¢çš„ä¸œè¥¿åˆ æŽ‰å°±èƒ½è§£å†³ã€‚ è‹¥å‘çŽ°makeåŽçš„objé‡Œæ²¡æœ‰.dylibæ–‡ä»¶ï¼Œé‚£æ˜¯å› ä¸ºæ–°ç‰ˆæœ¬çš„Theoså·²ç»å°†å®ƒæ”¾åˆ°äº†objåŒç›®å½•ä¸‹çš„.theo/obj/debug/http://bbs.iosre.com/t/obj/3197 clang: warning: libstdc++ is deprecated; move to libc++ with a minimum deployment target of iOS 7 å¦‚æžœæ˜¯å‡ºçŽ°ä»¥ä¸Šwarningçš„è¯ï¼Œç‹—ç¥žè¯´ä¸ç”¨ç®¡ã€‚ warning: no debug symbols in executable å‡ºçŽ°ä»¥ä¸Šwarningçš„è¯ï¼Œå¯å…ˆå°è¯•å®‰è£…ä¸€ä¸‹LZMA make[3]: * No rule to make target â€˜/path/to/project.dylibâ€™. Stop.make[2]: * [/path/to/project.dylib] Error 2make[1]: * [internal-library-all_] Error 2make: * [project.all.tweak.variables] Error 2 å‡ºçŽ°ä¸Šé¢errorçš„è¯ï¼Œæ£€æŸ¥é¡¹ç›®è·¯å¾„æ˜¯å¦å¸¦æœ‰ä¸­æ–‡ã€‚ sudo cpan IO::Compress::Lzma ä¸è¿‡æˆ‘å®‰è£…äº†ä»ç„¶å­˜åœ¨è¯¥è­¦å‘Šï¼Œä½†ä¸å½±å“æ‰“åŒ… - -ã€‚ æ‰“åŒ… make package dm.pl: building package com.nero.firstproject:iphoneos-arm&#39; in./packages/com.nero.firstproject_0.0.1-1+debug_iphoneos-arm.debâ€™ çœ‹åˆ°ä¸Šé¢çš„è¾“å‡ºï¼Œå³ä»£è¡¨å·²ç»ç”Ÿæˆäº†å¯å‘å¸ƒåŠå®‰è£…çš„debåŒ…äº†ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„packagesæ–‡ä»¶å¤¹ä¸­ã€‚ å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨dpkgæŸ¥çœ‹debåŒ…çš„ç»“æž„ cd packages dpkg -c com.nero.firstproject_0.0.1-1+debug_iphoneos-arm.deb drwxr-xr-x root/wheel 0 2018-07-20 12:40 .drwxr-xr-x root/wheel 0 2018-07-20 12:40 ./Librarydrwxr-xr-x root/wheel 0 2018-07-20 12:40 ./Library/MobileSubstratedrwxr-xr-x root/wheel 0 2018-07-20 12:40 ./Library/MobileSubstrate/DynamicLibraries-rwxr-xr-x root/wheel 98704 2018-07-20 12:40 ./Library/MobileSubstrate/DynamicLibraries/firstproject.dylib-rw-râ€“râ€“ root/wheel 57 2018-07-20 12:40 ./Library/MobileSubstrate/DynamicLibraries/firstproject.plist è‹¥è¦é‡æ–°ç¼–è¯‘ï¼Œå¯ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼Œå¹¶æ¸…é™¤.theosæ–‡ä»¶å¤¹é‡Œçš„æ‰€æœ‰å†…å®¹ make clean ç„¶åŽæ˜¯æŠŠdebå®‰è£…åˆ°æ‰‹æœºä¸Šã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç”¨scpæˆ–è€…iFunboxæ‹·è´debåˆ°æ‰‹æœºä¸Šå†é€šè¿‡iFileå®‰è£…ã€‚ make install THEOS_DEVICE_IP = 192.168.1.231ARCHS = arm64 armv7sTARGET = iphone:latest:8.0 æœ‰ç½‘å‹æåˆ°ä½¿ç”¨make installè¦æ³¨æ„çš„å‘æ˜¯å°†ä¸Šé¢ä¸‰è¡Œå†…å®¹å†™åœ¨Makefileï¼ˆç›¸å½“äºŽappé¡¹ç›®ä¸­çš„info.plistæ–‡ä»¶ï¼‰çš„æœ€å¼€å¤´ä½ç½®ï¼ŒåŽŸç†ä¹Ÿæ˜¯é€šè¿‡scpå®Œæˆã€‚ å®‰è£…debåŽå¯ä»¥åœ¨Cydiaçš„å·²å®‰è£…-&gt;ä¸“ä¸šäººå£«ä¸€æ é‡Œæ‰¾åˆ°è¯¥debï¼Œç‚¹å‡»è¿›åŽ»èƒ½æŸ¥çœ‹è¯¦ç»†çš„ä¿¡æ¯]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>é€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSé€†å‘ï¼ˆäºŒï¼‰å·¥å…·ç¯‡]]></title>
    <url>%2FiOS%2FiOS%E9%80%86%E5%90%91%EF%BC%88%E4%BA%8C%EF%BC%89%E5%B7%A5%E5%85%B7%E7%AF%87%2F</url>
    <content type="text"><![CDATA[å…³äºŽé€†å‘çš„ç¬¬äºŒç¯‡ï¼Œä¹Ÿè¿˜æ²¡æ˜¯æ­£é¢˜ï¼Œå…ˆæ¥ä»¥ä½¿ç”¨çš„ç›®çš„æ¥åˆ†ç±»ä¸€ä¸‹é€†å‘éœ€è¦å“ªäº›å·¥å…·ï¼Œåˆ†åˆ«åœ¨ä»€ä¹ˆå¹³å°ä¸Šä½¿ç”¨å’Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Œéƒ¨åˆ†è¿˜ç›´æŽ¥å¸¦ä¸Šä½¿ç”¨ç¤ºä¾‹ã€‚åœ¨ä¸€äº›ä½¿ç”¨æ–¹å¼æ¯”è¾ƒç»•çš„å·¥å…·ä¸Šï¼ŒåŒæ ·ä¹Ÿå‡†å¤‡äº†å‘ç‚¹çš„æè¿°ï¼Œè®°å½•ä¸€ä¸‹ç—›è‹¦çš„å¿ƒè·¯åŽ†ç¨‹ï¼Œä¸€ä¸ªé—®é¢˜å¯èƒ½å°±å¡äº†1ã€2å¤©ã€‚ ç ¸å£³å·¥å…·dumpdecryptedå¹³å°ï¼šMacOS &amp; iOSä½œç”¨ï¼šç ¸å£³çº¿ä¸ŠåŠ å¯†App å…ˆä»Žgithubä¸‹è½½dumpdecryptedçš„æºç ï¼Œç„¶åŽç¼–è¯‘æˆdylibå¤‡ç”¨ã€‚ $ cd dumpdecrypted-master/ $ make é™æ€åˆ†æžå·¥å…·class dumpå¹³å°ï¼šMacOSä½œç”¨ï¼šå¯¼å‡ºå¤´æ–‡ä»¶ ä¸‹è½½è¿žæŽ¥ $ open /usr/local/bin $ sudo chmod 777 /usr/local/bin/class-dump $ class-dump --help å°†ä¸‹è½½å¥½çš„class-dumpå¤åˆ¶åˆ°/usr/local/bin æ›´æ”¹å…¶æƒé™ IDAå¹³å°ï¼šMacOSä½œç”¨ï¼šåæ±‡ç¼–ã€‚ ä¸‹è½½åœ°å€ï¼Œç‚¹evaluation versionï¼Œé€‰æ‹©ä¸‹è½½IDA 7.0 Freewareã€‚ åŠ¨æ€åˆ†æžå·¥å…·Cycriptå¹³å°ï¼šiOSä½œç”¨ï¼šå‘½ä»¤è¡Œä¸Šç¼–å†™åŠè¿è¡Œä»£ç ï¼Œæˆ–æ³¨å…¥ä»£ç åˆ°è¿›ç¨‹å¹¶æ‰§è¡Œã€‚ ç›´æŽ¥åœ¨Cydiaå°±èƒ½æ‰¾åˆ°ä¸‹è½½ã€‚ debugserverå¹³å°ï¼šiOSä½œç”¨ï¼šdebug Appï¼Œä¾›LLDBçš„æŽ¥å…¥ã€‚ åœ¨ä½¿ç”¨debugserverä¹‹å‰ï¼Œé¦–å…ˆè¦å¸®å®ƒæ·»åŠ task_for_pidæƒé™ï¼Œæ‰èƒ½ä»¥è¿›ç¨‹ä¸ºå•ä½è°ƒè¯•åˆ°åˆ«äººçš„Appã€‚ å…ˆä»ŽiOSæ‹·è´å‡ºdebugserver $ rsync -avz -e &quot;ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 4567&quot; --progress root@127.0.0.1:/Developer/usr/bin/debugserver /Path/to/debugserver/ ç„¶åŽå¯¹debugserverç˜¦èº« $ lipo -info /Path/to/debugserver/ $ lipo -thin arm64 /Path/to/debugserver/ -output /Path/to/debugserver/ ä¸çŸ¥ldidä»Žå“ªä¸ªç‰ˆæœ¬å¼€å§‹æ”¯æŒå¯¹fat binaryçš„ç­¾åï¼Œåæ­£æœ€åŽçš„ä¸€ä¸ªç‰ˆæœ¬1.2.1æ˜¯æ”¯æŒçš„ï¼Œå¦‚æžœæ”¯æŒçš„å¯ä»¥å¿½ç•¥ä¸Šé¢çš„ç˜¦èº«æ­¥éª¤ å†å¯¹å¯¹debugserverè¿›è¡Œç­¾å ent.xmlä¸‹è½½åœ°å€ï¼Œä¸‹è½½åˆ°/Path/to/debugserver/åŽæ‰§è¡Œä¸‹é¢å‘½ä»¤ $ cd /Path/to/debugserver/ $ /opt/theos/bin/ldid -Sent.xml debugserver //æˆ–ç›´æŽ¥ç”¨brewçš„ldidæ‰§è¡Œ å¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ç¡®è®¤ä¸€ä¸‹debugserverçš„ç­¾åå±žæ€§æ˜¯å¦æ­£ç¡®ï¼Œè‹¥è¾“å‡ºent.xmlçš„å†…å®¹åˆ™è¯æ˜Žç­¾åæˆåŠŸ ldid -e debugserver ç„¶åŽå°†debugserveræ‹·è´å›žiOS $ rsync -avz -e &quot;ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 4567&quot; --progress /Path/to/debugserver/debugserver root@127.0.0.1:/usr/bin/debugserver æœ€åŽSSHåˆ°iOSä¸ºdebugserveræ·»åŠ æ‰§è¡Œæƒé™ iPhone:~ root# chmod +x /usr/bin/debugserver //æˆ– iPhone:~ root# chmod 777 /usr/bin/debugserver å½“ldidç­¾åæ— æ•ˆæ—¶ï¼Œå¯ä»¥å°è¯•ç”¨ä¸‹é¢çš„æ–¹æ³•é‡ç­¾debugserver codesign -s - --entitlements ent.plist -f debugserver è‹¥ä¸Šè¿°çš„ent.xmlã€ent.plistä¸‹è½½ä¸äº†ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å†…å®¹è‡ªå·±å»ºæ–‡ä»¶ ent.plist &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/ PropertyList-1.0.dtd&quot;&gt; &lt;plist version=&quot;1.0&quot;&gt; &lt;dict&gt; &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt; &lt;true/&gt; &lt;key&gt;run-unsigned-code&lt;/key&gt; &lt;true/&gt; &lt;key&gt;get-task-allow&lt;/key&gt; &lt;true/&gt; &lt;key&gt;task_for_pid-allow&lt;/key&gt; &lt;true/&gt; &lt;/dict&gt; &lt;/plist&gt; ent.xml &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt; &lt;plist version=&quot;1.0&quot;&gt; &lt;dict&gt; &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt; &lt;true/&gt; &lt;key&gt;get-task-allow&lt;/key&gt; &lt;true/&gt; &lt;key&gt;task_for_pid-allow&lt;/key&gt; &lt;true/&gt; &lt;key&gt;run-unsigned-code&lt;/key&gt; &lt;true/&gt; &lt;/dict&gt; &lt;/plist&gt; å¦å¤–ï¼Œè¿˜å¯ä»¥åœ¨iOSä¸Šåœ¨BigBossé‚£å®‰è£…ä¸ŠToolchainï¼Œåœ¨Mterminalä¸Šä½¿ç”¨ldidæ¥ç›´æŽ¥å¯¹iOSçš„debugserverè¿›è¡Œç­¾åï¼Œå…åŽ»äº†æ‹·è´æ¥æ‹·è´åŽ»çš„éº»çƒ¦ã€‚ ä½¿ç”¨ç¤ºä¾‹ //å¯åŠ¨è¿›ç¨‹å¹¶ç­‰å¾…LLDBæŽ¥å…¥ //*ä¸ºæ‰€æœ‰IPå¯æŽ¥å…¥ï¼ŒæŽ¥å…¥ç«¯å£ä¸º1234 debugserver -x posix *:1234 /Path/to/TargetApp.app/TargetApp //é™„åŠ è¿›ç¨‹ debugserver *:1234 -a /Path/to/TargetApp.app/TargetApp ç¬¬äºŒç‰ˆå°é»„ä¹¦æ•™çš„debugserver -x backboardæ— æ•ˆï¼Œæç¤º debugserver-@(#)PROGRAM:debugserver PROJECT:debugserver-360.0.26.3 for arm64.error: failed to launch process debugserver: failed to get the task for process -1 ç½‘ä¸Šè¯´çš„debugserver -x springæ— æ•ˆï¼Œä½†è¾“å‡ºçš„æç¤ºæœ‰æŒ‡å‡ºæœ‰æ•ˆçš„ç±»åž‹æœ‰å“ªäº›ï¼Œä¼°è®¡springå·²ç»è¢«æŠ›å¼ƒäº† error: invalid TYPE for the â€“launch=TYPE (-x TYPE) option: â€˜springâ€™Valid values TYPE are: auto Auto-detect the best launch method to use. posix Launch the executable using posix_spawn. fork Launch the executable using fork and exec. backboard Launch the executable through BackBoard Services. frontboard Launch the executable through FrontBoard Services. æœ€åŽè¿˜æ˜¯ç”¨posixè§£å†³äº†ã€‚ LLDBå¹³å°ï¼šMacOSä½œç”¨ï¼šè°ƒè¯•ç”¨çš„Debugger è¿è¡ŒLLDB $ /Applications/Xcode.app/Contents/Developer/usr/bin/lldb è¿žæŽ¥debugserver (lldb) process connect connect://IP:port Process 1281 stopped * thread #1, stop reason = signal SIGSTOP frame #0: 0x000000010061d000 dyld`_dyld_start dyld`_dyld_start: -&gt; 0x10061d000 &lt;+0&gt;: mov x28, sp 0x10061d004 &lt;+4&gt;: and sp, x28, #0xfffffffffffffff0 0x10061d008 &lt;+8&gt;: mov x0, #0x0 0x10061d00c &lt;+12&gt;: mov x1, #0x0 Target 0: (TargetApp) stopped. æš‚æ—¶è¿˜æ²¡äº†è§£å¦‚ä½•ç”¨iproxyçš„æœ¬åœ°IPè¿žæŽ¥lldbï¼Œä½†æˆ‘åœ¨iproxyå¼€å¯çš„æƒ…å†µä¸‹ä½¿ç”¨Macçƒ­ç‚¹åˆ†é…çš„IPæ¥è¿žæŽ¥ä¹Ÿå¾ˆå¿«ï¼Œå‡ ç§’è€Œå·²ã€‚ ä½¿ç”¨ç¤ºä¾‹ (lldb) b function //åœ¨å‡½æ•°èµ·å§‹ä½ç½®è®¾æ–­ç‚¹ (lldb) b l //æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹ (lldb) b s -a 0xAddress //è®¾ç½®æ–­ç‚¹ (lldb) b dis [breakPointNumber] //ç¦ç”¨æ‰€æœ‰æ–­ç‚¹ [æˆ–æŒ‡å®šç¦ç”¨çš„æ–­ç‚¹å·] (lldb) b en //å¯ç”¨æ‰€æœ‰æ–­ç‚¹ [æˆ–æŒ‡å®šå¯ç”¨çš„æ–­ç‚¹å·] (lldb) b del //åˆ é™¤æ‰€æœ‰æ–­ç‚¹ [æˆ–æŒ‡å®šåˆ é™¤çš„æ–­ç‚¹å·] (lldb) c //ç»§ç»­è¿è¡Œ //è®¾ç½®ä¸€ç»„æ–­ç‚¹ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤ (lldb) b com add 1 // æŒ‡å®šæŸä¸€æ–­ç‚¹ä¸‹æ‰§è¡Œçš„æŒ‡ä»¤é›†åˆ Enter your debugger command(s). Type &apos;DONE&apos; to end. (lldb) po [$r0 class] (lldb) p (char *)$r1 (lldb) DONE (lldb) ni //nexti è¿›å…¥å‡½æ•°ä½“çš„ä¸‹ä¸€æ­¥ (lldb) si //stepi ä¸è¿›å…¥å‡½æ•°ä½“çš„ä¸‹ä¸€æ­¥ (lldb) register write $rn x //ç»™æŒ‡å®šå¯„å­˜å™¨rnèµ‹å€¼x //lldbä¸‹control + cèƒ½å¼ºåˆ¶æ–­æŽ‰çŽ°åœ¨çš„è¿›ç¨‹ï¼Œç›¸å½“äºŽXcodeä¸­çš„æš‚åœ Theoså¹³å°ï¼šMacOSä½œç”¨ï¼šç¼–å†™å’Œç¼–è¯‘æ’ä»¶ç­‰ brew install dpkg brew install ldid å…ˆå®‰è£…ä¸¤ä¸ªTheosä¾èµ–çš„å·¥å…·dpkgå’Œldid $ export THEOS=/opt/theos $ sudo git clone --recursive git://github.com/DHowett/theos.git $THEOS $ sudo chown -R 777 $THEOS $ cp /usr/local/Cellar/ldid/xx_version/bin/ldid /opt/theos/bin/ldid /opt/theos/bin/ldid $ sudo chmod 777 /opt/theos/bin/ldid $ sudo chmod 777 /opt/theos/bin/ldid $ cp /usr/local/Cellar/dpkg/xx_version/bin/dpkg-deb /opt/theos/bin/ldid /opt/theos/bin/dpkg-deb $ sudo chmod 777 /opt/theos/bin/dpkg-deb ä¸‹è½½Theos å¤åˆ¶ldidåˆ°Theosä¸‹ï¼Œå¹¶æ›´æ”¹å…¶æƒé™ å¤åˆ¶dpkg-debåˆ°Theosä¸‹ï¼Œå¹¶æ›´æ”¹å…¶æƒé™ è¾…åŠ©å·¥å…·SSHå¹³å°ï¼šMacOS &amp; iOSä½œç”¨ï¼šè¿œç¨‹æ“ä½œ å¦‚æžœæ‰“ç®—å…ˆåœ¨iOSçš„Cydiaä¸Šä¸‹è½½ä¸€ä¸ªOpenSSHï¼Œç„¶åŽåœ¨MacOSä¸Šçš„ç»ˆç«¯é€šè¿‡sshè¿žæŽ¥ä¸ŠåŽ»iOSï¼Œè€Œåˆå½“ä½ çš„è®¾å¤‡æ˜¯10.3.xç‰ˆæœ¬çš„ç³»ç»Ÿï¼Œé‚£å°±æŽ‰å‘äº†ã€‚ SSHè¿žä¸ä¸Šï¼Ÿæˆ³è¿™é‡Œ ç®€å•æ¥è¯´ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯ å¸è½½å¹²å‡€iOSä¸Šçš„OpenSSHå’ŒOpenSSLï¼› æ·»åŠ æº http://cydia.ichitaso.com/test ï¼› åœ¨ä¸Šè¿°æºé‡Œä¸‹è½½ dropbear ï¼ˆOpenSSHçš„æ›¿ä»£å“ï¼‰ï¼› é‡æ–°å®‰è£…OpenSSL è¿™ä¸ªæ—¶å€™å†è¯•è¯• ssh root@deviceIP ï¼ˆç»§ç»­ç”¨22ç«¯å£å³å¯ï¼Œæœ‰äº›ç½‘å‹è¯´ç”¨2222çš„äº²æµ‹ä¸å¯¹ï¼‰ ä¸èƒ½ä½¿ç”¨OpenSSHçš„åŽŸå› æ˜¯ Yalu jailbreakCan I install OpenSSH?No, the jailbreak already comes with a working SSH daemon (dropbear). Installing OpenSSH can create issues on your jailbroken device. ä¸­é€”ç¡®è®¤dropbearè¿›ç¨‹æ˜¯å¦æœ‰åœ¨è¿è¡Œçš„å¯ç”¨ä»¥ä¸‹æŒ‡ä»¤ ps aux|grep dropbear ps -e | grep ssh æŽ¥ä¸‹æ¥æ‰è¿›å…¥æ­£é¢˜ï¼Œç›´æŽ¥åœ¨åŒWifiçŽ¯å¢ƒä¸‹sshï¼Œæ­¤é“¾æŽ¥è¿‡ç¨‹å¯èƒ½ä¼šååˆ†æ¼«é•¿ $ ssh root@172.16.xxx.xxx è‹¥å«ŒWifiè¿žæŽ¥å¤ªæ…¢ï¼Œå¯ä»¥ä½¿ç”¨usbmuxdå·¥å…·æ¥åˆ©ç”¨usbå®žçŽ°è¿žæŽ¥ï¼Œå®‰è£… $ brew install usbmuxd æŠŠiPhoneçš„é»˜è®¤ç«¯å£22æ˜ å°„åˆ°Macä¸Š $ iproxy 4567 22 waiting for connection ä¿æŒä¸Šé¢çš„ç»ˆç«¯ï¼Œæ–°å»ºä¸€ä¸ªç»ˆç«¯è¿›è¡Œè¿žæŽ¥ï¼ˆrootçš„é»˜è®¤å¯†ç æ˜¯alpineï¼Œæœ‰å¿…è¦çš„è¯é¦–æ¬¡ç™»é™†åŽæ³¨æ„ä¿®æ”¹å¯†ç ï¼‰ $ ssh -p 4567 root@127.0.0.1 root@127.0.0.1&apos;s password: å½“ä½ æƒ³ä½¿ç”¨scpçš„æ—¶å€™ç›´æŽ¥æ”¹ç”¨rsyncä»£æ›¿å§ï¼Œåœ¨ä½¿ç”¨ç€iproxyçš„æƒ…å†µç¤ºä¾‹ rsync -avz -e &quot;ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 4567&quot; --progress /path/to/source/file root@127.0.0.1:/path/to/destination/ è¿™æ˜¯å‚è€ƒè‡ªç‹—ç¥žåˆ†äº«çš„rsyncæ›¿ä»£scpå¸–å­ä¸­ï¼Œä¸€ä½é€†å‹åŽæ¥æ›´æ–°çš„æŒ‡ä»¤ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨rsyncæ›¿ä»£scpï¼ŸåŽŸå› æ˜¯yalu102è‡ªå¸¦çš„SSHç¼ºå°‘äº†scpï¼Œæ— æ³•ç”¨WINSCPä¼ è¾“æ–‡ä»¶ã€‚ è¯´ä¸€ä¸‹æˆ‘è¸©åˆ°çš„å‘ï¼Œåœ¨ä½¿ç”¨ç€iproxyçš„æƒ…å†µä¸‹æ‰§è¡Œscpæ¥copy fileç¤ºä¾‹å¦‚ä¸‹ï¼ˆæ³¨æ„-Pè¦å¤§å†™ï¼‰ $ scp -P 4567 /Users/xx/dumpdecrypted.dylib root@127.0.0.1:/var/xx/Documents/ sh: scp: command not found ä¼šå‘çŽ°å‡ºçŽ°ä»¥ä¸ŠæŠ¥é”™ï¼ŒåŽŸå› ä¸Šé¢å·²äº¤ä»£ã€‚ googleä¸€ä¸‹ï¼Œå‘çŽ°éƒ¨åˆ†å¤–å›½å¸–å­å’Œå¤§é‡å›½äººå·²ç»é’ˆå¯¹ä¸Šè¿°é—®é¢˜æ€»ç»“å‡ºä¸‹é¢è§£å†³æ–¹æ³•ï¼Œå…ˆåˆ°Cydiaä¸‹è½½wgetåˆ°iOSä¸Šï¼Œç„¶åŽåœ¨iOSçš„Terminalæ‰§è¡Œä¸‹é¢æŒ‡ä»¤ wget mila432.com/scp ldid -S scp chmod 777 scp mv scp /usr/bin/scp ä½†æ˜¯ï¼mila432.com/scp è¿™ä¸ªåœ°å€çš„å†…å®¹å·²ä¸å­˜åœ¨äº†..æœ€åŽï¼Œå°±æ˜¯ç”¨rsyncè§£å†³äº†ï¼ˆå…¶å®žä½Žç«¯ç‚¹ç”¨iFunBoxç­‰å·¥å…·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ï¼Œæ‹·è´æˆåŠŸåŽä¼šè¾“å‡º building file list â€¦1 file to considerdumpdecrypted.dylib 197528 100% 157.13MB/s 0:00:00 (xfer#1, to-check=0/1)sent 8418 bytes received 42 bytes 2417.14 bytes/sectotal size is 197528 speedup is 23.35 å¦‚æžœè®¾å¤‡é‡å¯äº†ï¼Œé‡æ–°è¶Šç‹±åŽå‘çŽ°sshè¿žä¸ä¸Šï¼Œæç¤ºä»¥ä¸‹é”™è¯¯çš„æ—¶å€™ï¼Œåˆ™éœ€è¦é‡è£…Dropbearå’ŒOpenSSL $ ssh -p 4568 root@127.0.0.1 ssh: connect to host 127.0.0.1 port 4568: Connection refused ssh: connect to host 127.0.0.1 port 4568: Connection refused ssh_exchange_identification: read: Connection reset by peer å¦‚æžœå‡ºçŽ°ä¸‹é¢çš„é”™è¯¯ï¼Œæ¸…ç©ºæ–‡ä»¶/Users/username/.ssh/known_hostsä¸­çš„å†…å®¹å°±èƒ½è§£å†³ã€‚æˆ–è€…åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°çš„æ˜ å°„ç«¯å£ä¸Šï¼Œå¦‚ iproxy 2222 22ï¼ŒåŒºåˆ«å¼€ä¹‹å‰ç»å¸¸ä½¿ç”¨çš„ç«¯å£ $ ssh -p 2222 root@127.0.0.1 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @ WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! @ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY! Someone could be eavesdropping on you right now (man-in-the-middle attack)! It is also possible that a host key has just been changed. The fingerprint for the ECDSA key sent by the remote host is SHA256:NhckXKSdwvSSLhago6bQb1/lIqRaLqAxHd6kHOPIYQs. Please contact your system administrator. Add correct host key in /Users/username/.ssh/known_hosts to get rid of this message. Offending ECDSA key in /Users/username/.ssh/known_hosts:3 ECDSA host key for [127.0.0.1]:2222 has changed and you have requested strict checking. Host key verification failed. dyld_decacheå¹³å°ï¼šMacOSä½œç”¨ï¼šæŠ½å–å‡ºiOSçš„ç³»ç»Ÿåº“æ–‡ä»¶ï¼ˆä»ŽiOSæ‹·è´åˆ°MacOSä¸Šï¼‰çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å½“è¦åˆ†æžç³»ç»Ÿæ¡†æž¶ä¸­çš„ç±»åŠå…¶æ–¹æ³•æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ°è¿™ä¸ªå·¥å…·ã€‚æŠ½å–iOSåº“çš„äºŒè¿›åˆ¶æ–‡ä»¶æ¥åˆ†æžï¼Œæ˜¯ä¸ºäº†é¿å…MacOSå’ŒiOSä¸Šåˆ†æžå‡ºçš„æŒ‡ä»¤å’Œåœ°å€æ•°æ®ä¸ä¸€è‡´ã€‚ æŠ½å–åŽçš„åº“æ”¾å…¥IDAåˆ†æžåº“æœ¬èº«å’Œå…¶å„ä¸ªæ–¹æ³•çš„åŸºåœ°å€ï¼Œç„¶åŽç»“åˆASLRåç§»è®¡ç®—å‡ºåç§»åŽçš„çœŸå®žåœ°å€ï¼Œæœ€åŽå°±å¯ä»¥æ ¹æ®çœŸå®žåœ°å€æ‰“æ–­ç‚¹ã€‚ ä¸‹è½½åœ°å€]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>é€†å‘</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSé€†å‘ï¼ˆä¸€ï¼‰è¶Šç‹±ç¯‡]]></title>
    <url>%2FiOS%2FiOS%E9%80%86%E5%90%91%EF%BC%88%E4%B8%80%EF%BC%89%E8%B6%8A%E7%8B%B1%E7%AF%87%2F</url>
    <content type="text"><![CDATA[å…³äºŽé€†å‘çš„ç¬¬ä¸€ç¯‡å…ˆæ¥è®²ä¸€ä¸‹ iOS 10.3.x çš„è¶Šç‹±ï¼Œå› ä¸ºä¹‹åŽçš„é€†å‘å·¥ç¨‹å‡åœ¨iOS 10.3.3ä¸Šè¿›è¡Œï¼Œè€Œä¸”çŽ°åœ¨çš„iOSè¶Šç‹±å·¥å…·æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œå“ªä¸ªæ‰é€‚åˆä½œä¸ºé€†å‘çš„åŸºç¡€çŽ¯å¢ƒï¼Œè¿™é‡Œä¹Ÿç¨ä½œä¸€ä¸‹åˆ†æžã€‚ç„¶åŽä»‹ç»æ€Žä¹ˆä½¿ç”¨å·¥å…·è¿›è¡Œè¶Šç‹±ï¼Œæœ‰ä»€ä¹ˆå‘éœ€è¦æ³¨æ„ã€‚ Meridianhttps://www.i4.cn/news_detail_18056.html æœ‰Cydia å·¥ä½œæ­£å¸¸ æ”¯æŒRootAppå®‰è£… (iFile Filza ç­‰ï¼‰ Substrateä¸ç”Ÿæ•ˆï¼ˆæš‚ä¸æ”¯æŒæ’ä»¶ï¼Œç­‰æ›´æ–°ï¼‰ é‡‡ç”¨å…¨æ–°çš„KpplessæŠ€æœ¯ï¼Œæ”¯æŒiPhone7ç³»+ ç­‰å¾…Substrateå…¼å®¹ è¶Šç‹±æ€§è´¨ï¼Œä¾ç„¶æ˜¯ Semi-Untethered JailBreak åŠå®Œç¾Žè¶Šç‹± ï¼ˆAppå¼•å¯¼è¶Šç‹±ï¼‰ è¶Šç‹±å®Œæ²¡æœ‰Cydiaçš„åŒå­¦ï¼Œæ‰§è¡Œå‘½ä»¤ uicache åˆ·æ–°ç¼“å­˜å³å¯ g0blinhttps://mrmad.com.tw/g0blin ç›®å‰è™•æ–¼RC2ï¼ˆå…¬é–‹æ¸¬è©¦ï¼‰ç‹€æ…‹ï¼Œé‚„ä¸æ˜¯å¾ˆç©©å®šï¼Œéœ€è¦ç­‰å¾ŒçºŒæ›´æ–°æ‰èƒ½è§£æ±ºä¸å°‘å•é¡Œã€‚ ç›®å‰é‚„æœƒå°Žè‡´ç¬¬ä¸‰æ–¹APPå…§ç„¡æ³•ä½¿ç”¨ Touch IDéŒ¯èª¤å•é¡Œã€‚ GPSæœ‰å¯èƒ½æœƒç„¡æ³•æ­£æˆå®šä½ï¼Œå¯é‡æ–°é–‹æ©ŸèˆŠå¯è§£æ±ºã€‚ å°‘æ•¸ç”¨æˆ¶ç™¼ç¾RC2ç‰ˆæœ¬æœƒå°Žè‡´è€—é›»å•é¡Œã€‚ å°‘æ•¸GUI Tweaksæœƒå°Žè‡´é–ƒé€€ç¾è±¡ï¼Œä¾‹å¦‚ BytaFonts 2ã€ Cydia Eraserç­‰ã€‚ G0blin æ˜¯é‡å° iOS 10.3.x è¶Šç„å·¥å…·ï¼Œ: æ˜¯å°‡ Yalu çš„ KPP Bypass æŠ€è¡“åŠ ä»¥æ‹“å±•æ²¿ç”¨è‡³å¾ŒçºŒç‰ˆæœ¬ã€‚: æ­£å› ç‚ºå¦‚æ­¤ï¼Œæ‰€ä»¥å…©è€…æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œ: åŒæ™‚ä¹Ÿåªæ”¯æ´æ­è¼‰ A7-A9 è™•ç†å™¨çš„è£ç½®ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„ iPhone 7 è·Ÿ iPad Pro 10.5 æ˜¯ä¸æ”¯æ´çš„ã€‚å¯¹æ¯”https://mrmad.com.tw/ios1033-cydia-tweak-list g0blinç”¨çš„v0rtex+yalu102kppbypassï¼Œæ”¯æŒ16å¹´å‰å‡ºçš„æ‰€æœ‰64ä½è®¾å¤‡ã€‚cydiaå’ŒsubstrateåŸºæœ¬ä¸Šèƒ½å·¥ä½œï¼Œç›®å‰g0blinå®˜æ–¹è¿˜æ²¡æœ‰æ”¾å‡ºipaï¼ŒçŽ°åœ¨çš„å¦–ç²¾v4æ˜¯jakejamesåˆ©ç”¨å¦–ç²¾æ”¾å‡ºçš„æºä»£ç æ‰€å¼€å‘çš„ä¸€ä¸ªåˆ†æ”¯ç‰ˆæœ¬ï¼Œç›®å‰å·²ç»åœæ­¢æ›´æ–°ï¼Œè½¯ä»¶åŸºæœ¬ä¸Šå¯ä»¥ä½¿ç”¨å¯èƒ½è¿˜æœ‰ä¸€äº›å°bugå’Œä¸ç¨³å®šçš„æƒ…å†µ meridianåˆ©ç”¨v0rtex+kpplessè¶Šç‹±ï¼Œæ”¯æŒæ‰€æœ‰64ä½è®¾å¤‡ï¼Œç›®å‰substrateä¸æ”¯æŒkpplessï¼Œcydiaéƒ¨åˆ†å·¥ä½œï¼Œsubstrateå®Œå…¨ä¸å·¥ä½œï¼Œéœ€è¦ç­‰å¾…saurikæ›´æ–° https://www.ptt.cc/bbs/iOS/M.1517425637.A.0A3.htmlç›®å‰ iOS 10.3 æœ‰3å€‹æ¯”è¼ƒæ­£å¼(çŸ¥å)çš„è¶Šç„å·¥å…·ï¼Œåˆ†åˆ¥æ˜¯64ä½å…ƒ G0blin 10.3.x KPPBypass èˆ‡ Meridian iOS 10.x KPPLessï¼Œé‚„æœ‰32ä½å…ƒçš„ h3lix iOS 10.xã€‚KPPLess ç”±æ–¼ä¸éœ€è¦è§¸ç™¼KPPï¼Œæ‰€ä»¥æœƒæ¯” G0blin &amp; Yalu é‚„ç©©å®šè¨±å¤šã€‚ä½†æ˜¯ç”±æ–¼è¶Šç„çš„æ–¹å¼æ¯”è¼ƒç‰¹æ®Šï¼Œå› æ­¤ç¾æœ‰çš„ Cydia è·Ÿ Substrate éƒ½ä¸ç›¸å®¹ã€‚ç›®å‰å¤šæ•¸äººçŸ¥é“çš„ Electra ä¹Ÿæ˜¯é€™ç¨® KPPLess çš„æ–¹å¼ã€‚ç”±æ–¼ G0blin çš„é‹ä½œæ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥ç›¸å®¹ç¾æœ‰çš„ Cydia ä¹Ÿå°±æ˜¯åŸºæœ¬ä¸Šæ˜¯ä¸€å€‹ã€Œå®Œæ•´ã€è¶Šç„å·¥å…·ï¼Œåªä¸éŽé‚„æœƒæœ‰èˆŠçš„ Yalu è€æ¯›ç—…ï¼šFailed,Retry çš„å°å›°æ“¾ã€‚ å·¥å…·é›†ç»¼ä¸Šæ‰€è¿°ï¼Œæ•…é€‰æ‹©g0blin Cydia Impactorhttp://www.cydiaimpactor.com/ g0blinhttps://g0blin.sticktron.net/G0BLINæ›´æ–°è‡³RC2ä¿®å¤æ— æ³•æ³¨é”€é—®é¢˜ä¿®å¤CYDIAå›¾æ ‡ä¸å‡ºçŽ°é—®é¢˜å¯å¸è½½dropbear,å®‰è£…OpenSSHä»£æ›¿ å®‰è£…å®‰è£…æµç¨‹https://bbs.feng.com/read-htm-tid-11596960.html æ‰“å¼€cydia impactorï¼Œæ‹–æ‹½ipaåˆ°çª—å£é‡Œ è¾“å…¥APPLE IDå›žè½¦ï¼Œè¾“å…¥å¯†ç å›žè½¦ã€‚ï¼ˆè‹¥æœ‰ä¸¤é‡éªŒè¯çš„å¯åœ¨apple idç®¡ç†https://appleid.apple.com/account/manageé‡Œç”Ÿæˆä¸€ä¸ªApp-Specific Passwordsæ¥æ›¿ä»£å¡«å…¥ï¼Œæˆ–è€…å…ˆå…³é—­åŒé‡éªŒè¯ï¼‰ å›žåˆ°æ‰‹æœºä¿¡ä»»è¶Šç‹±è½¯ä»¶å¹¶æ‰“å¼€ã€‚ ç‚¹å‡»jailbreakè¶Šç‹±æŒ‰é’®ç­‰å¾…è¶Šç‹±ï¼ˆå¦‚æžœå¤±è´¥é‡å¯éœ€é‡æ–°å°è¯•ï¼‰ï¼Œå®ŒæˆåŽç‚¹respringæ³¨é”€å³å¯ã€‚ï¼ˆå¦‚æžœå®‰è£…è¿‡å…¶ä»–è¶Šç‹±å·¥å…·çš„ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æœ¬å·¥å…·è¯·ç‚¹å‡»è½¯ä»¶ç•Œé¢å³ä¸Šè§’å¹å·ï¼Œå‹¾é€‰settingsçš„re-install boottstrapä¿å­˜åŽå†è¿›è¡Œè¶Šç‹±ï¼‰è¶Šç‹±æˆåŠŸåŽå³å¯ç›´æŽ¥æ‰“å¼€cydiaä½¿ç”¨ï¼Œå¯æ­£å¸¸å®‰è£…æ’ä»¶ã€‚é‡å¯åŽéœ€è¦é‡æ–°è¶Šç‹±ã€‚ ï¼ˆæ³¨æ„ï¼šå¦‚æžœé‡å¯äº†ï¼Œéœ€é‡æ–°å¼•å¯¼è¶Šç‹±ï¼Œæ‰“å¼€è½¯ä»¶ç›´æŽ¥ç‚¹jailbreakè¶Šç‹±å³å¯ã€‚ã€‚è¯·ä¸è¦å‹¾é€‰boottstrapé€‰é¡¹!!!ä¸è¦å‹¾é€‰ï¼ï¼ï¼ä¸è¦å‹¾é€‰ï¼ï¼ï¼ä¸è¦å‹¾é€‰ï¼ï¼ï¼ä¸ç„¶è¶Šç‹±çŽ¯å¢ƒä¼šè¢«é‡ç½®ï¼Œæ’ä»¶ä¼šè¢«åˆ é™¤ã€‚å¦‚æžœè¿žg0blinéƒ½é—ªé€€ï¼Œå°±éœ€è¦ç”¨Impactoré‡æ–°å®‰è£…g0blinçš„ipaï¼ŒåŒæ ·é‡æ–°è¶Šç‹±æ—¶ä¸è¦æ‰“å¼€boottstrapï¼Œç‚¹jailbreakå°±å¥½äº†ï¼‰æ³¨ï¼šcydiaæ— æ³•è”ç½‘çš„å¯ä»¥è¯•ä¸€ä¸‹åŽ»åŠ©æ‰‹ä¸‹è½½ä¹ç½‘APPï¼Œè¿žä¸ŠV/PNåŽå†æ‰“å¼€cydiaåº”è¯¥å°±å¯ä»¥è”ç½‘äº†ã€‚ç„¶åŽåœ¨cydiaå®‰è£…conditionalWIFI2ï¼Œé‡å¯åŽåŽ»è®¾ç½®-WIFIä¸‹æ‹‰çœ‹åˆ°cydiaçš„wifiæƒé™æ˜¯é»˜è®¤å…³é—­çš„ï¼Œæ‰“å¼€å®ƒå°±å¯ä»¥è”ç½‘äº†ï¼Œè¿™æ—¶å€™èœ‚çªæ•°æ®é‡Œé¢ä¹Ÿä¼šæœ‰cydiaçš„è”ç½‘é€‰é¡¹ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>è¶Šç‹±</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bootstrapæ‰‹å†Œ]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%2FBootstrap%E6%89%8B%E5%86%8C%2F</url>
    <content type="text"><![CDATA[ä»‹ç»Bootstrapæ˜¯TwitteræŽ¨å‡ºçš„ä¸€ä¸ªç”¨äºŽå‰ç«¯å¼€å‘çš„å¼€æºå·¥å…·åŒ…ã€‚å®ƒç”±Twitterçš„è®¾è®¡å¸ˆMark Ottoå’ŒJacob Thorntonåˆä½œå¼€å‘ï¼Œæ˜¯ä¸€ä¸ªCSS/HTML/JSæ¡†æž¶ï¼Œç”¨äºŽå¼€å‘å“åº”å¼å¸ƒå±€ã€ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„ WEB é¡¹ç›®ã€‚ æ”¯æŒé¢„å¤„ç†è„šæœ¬ï¼šå¯ä»¥ç›´æŽ¥ä½¿ç”¨ Bootstrap æä¾›çš„ CSS æ ·å¼è¡¨ï¼ŒåŒæ—¶ Bootstrap çš„æºç æ˜¯åŸºäºŽæœ€æµè¡Œçš„ CSS é¢„å¤„ç†è„šæœ¬ - Less å’Œ Sass å¼€å‘çš„ã€‚ä½ å¯ä»¥é‡‡ç”¨é¢„ç¼–è¯‘çš„ CSS æ–‡ä»¶å¿«é€Ÿå¼€å‘ï¼Œä¹Ÿå¯ä»¥ä»Žæºç å®šåˆ¶è‡ªå·±éœ€è¦çš„æ ·å¼ã€‚ ä¸€ä¸ªæ¡†æž¶ã€å¤šç§è®¾å¤‡ï¼šç½‘ç«™å’Œåº”ç”¨èƒ½åœ¨ Bootstrap çš„å¸®åŠ©ä¸‹é€šè¿‡åŒä¸€ä»½ä»£ç å¿«é€Ÿã€æœ‰æ•ˆé€‚é…æ‰‹æœºã€å¹³æ¿ã€PC è®¾å¤‡ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ CSS åª’ä½“æŸ¥è¯¢ï¼ˆMedia Queryï¼‰çš„åŠŸåŠ³ã€‚ Bootstrap3å®˜ç½‘ å¼€å‘çŽ¯å¢ƒ&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;!--Responsive--&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt; &lt;!--CSS--&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt; &lt;!--jQuery--&gt; &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;!--JavaScript--&gt; &lt;script src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; ... &lt;/body&gt; &lt;/html&gt; ç½‘æ ¼ç³»ç»Ÿ &lt;!-- 1.ç½‘æ ¼ç³»ç»Ÿ flexboxæ”¯æŒä¸€é¡µ12åˆ—ï¼›å¤§å±å¹•æ—¶æ¨ªæ”¾ï¼Œå°å±å¹•æ—¶ç«–æ”¾ï¼›è‹¥ä¸€è¡Œä¸­ä¸è¶³12åˆ—ï¼Œå…¶å®ƒåˆ—å¯ä»¥æ‰©å±•å®½åº¦ï¼› åŒ…å«å››ç§åˆ—å°ºå¯¸ï¼šxs=å±å®½å°äºŽ768px(phones)ã€sm=å±å®½å¤§äºŽç­‰äºŽ768px(tablets)ã€md=å±å®½å¤§äºŽç­‰äºŽ992px(small laptops)ã€lg=å±å®½å¤§äºŽç­‰äºŽ1200px(laptops/desktops) ä¸¤ç§å®¹å™¨ç±»ï¼šcontainer=å“åº”å¼å®¹å™¨ï¼Œåœ¨ä¸åŒçš„å±å¹•å®½åº¦ä¸‹ï¼Œå‡æœ‰å¯¹åº”çš„å›ºå®šå°ºå¯¸ï¼Œä¸€èˆ¬è‡³äºŽæœ€å¤–å±‚åšæ•´ä½“å¸ƒå±€ï¼Œæœ‰æ°´å¹³æ»šåŠ¨æ¡ï¼›container-fluid=ç”¨äºŽ100% å®½åº¦ï¼Œå æ®å…¨éƒ¨è§†å£ï¼ˆviewportï¼‰çš„å®¹å™¨ï¼Œæ²¡æœ‰æ°´å¹³æ»šåŠ¨æ¡ divç±»æ ¼å¼ï¼šcol-*-#ï¼Œ*=ç½‘æ ¼ç§ç±»(å°ºå¯¸)ï¼Œ#=æ‰€å åˆ—æ•° --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-xs-6&quot;&gt;6 cols&lt;/div&gt; &lt;div class=&quot;col-xs-1&quot;&gt;6 cols&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-xs-4&quot;&gt;4 cols&lt;/div&gt; &lt;div class=&quot;col-xs-8&quot;&gt;8 cols&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; å­—ä½“ &lt;!-- 2.å­—ä½“ é»˜è®¤å­—ä½“å¤§å°ï¼š14pxï¼›è¡Œé«˜ï¼š1.428(&lt;body&gt;æˆ–&lt;p&gt;)ï¼›åº•é—´è·ï¼šè¡Œé«˜çš„ä¸€åŠæˆ–æœ€å°10px(&lt;p&gt;) &lt;h1&gt;è‡³&lt;h6&gt;æ˜¯ä»Ž36pxè‡³12px &lt;small&gt;æ›´å°ã€æ›´æµ…çš„æ ‡é¢˜ &lt;mark&gt;æµ…è‰²çš„é«˜äº®æ ‡ç­¾ &lt;abbr&gt;CSSæç¤ºä¿¡æ¯ &lt;blockquote&gt;åŒ…å«&lt;footer&gt;ä»£è¡¨å¼•ç”¨ä¸­çš„é•¿ç ´æŠ˜å·ä»¥åŠæµ…è‰²æ–‡æ¡ˆï¼Œç”¨äºŽå¼•ç”¨ä¸­æœ€åŽè¯´æ˜Žå‡ºå¤„ï¼Œè‹¥class=&quot;blockquote-reverse&quot;åˆ™æ ‡ç­¾å³å¯¹é½ &lt;dl&gt; &lt;dt&gt; åˆ—å‡ºå¼ºè°ƒçš„å…ƒç´  &lt;code&gt; é«˜äº®ä»£ç  &lt;kbd&gt;é«˜äº®é”®ç›˜å­—ç¬¦(é»‘åº•æ¡†) &lt;p&gt;ä¸­å¯ä½¿ç”¨text-mutedã€text-primaryã€text-successã€text-infoã€text-warningã€text-dangerã€bg-primaryã€bg-successã€bg-infoã€bg-warningã€bg-dangerè®¾ç½®æ–‡å­—é¢œè‰²å’ŒèƒŒæ™¯é¢œè‰²ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨text-leftã€text-justifyã€text-centerã€ext-nowrapã€text-rightå¯¹é½æ–‡å­— --&gt; &lt;div class=&quot;container&quot;&gt; &lt;h3&gt;Miscellaneous&lt;small&gt;stuff&lt;/small&gt;&lt;/h3&gt; &lt;p class=&quot;bg-info&quot;&gt;The Gutenberg Press 1454&lt;/p&gt; &lt;p class=&quot;text-success&quot;&gt;revolutionized printing&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;The only source of knowledge is experience.&lt;/p&gt; &lt;footer&gt;Albert Einstein&lt;/footer&gt; &lt;/blockquote&gt; &lt;p&gt;&lt;kbd&gt;Enter&lt;/kbd&gt; is a &lt;code&gt;kbd&lt;/code&gt; element&lt;/p&gt; &lt;p class=&quot;bg-warning text-center&quot;&gt;Paragraph formats&lt;/p&gt; &lt;/div&gt; è¡¨æ ¼ &lt;!-- 3.è¡¨æ ¼ table-border=æ‰€æœ‰è¾¹æœ‰è¾¹æ¡† table-condensed=åŽ‹ç¼©åˆ—è¡¨ï¼Œç¼©å‡å•å…ƒæ ¼çš„å†…è¾¹è· table-striped=äº¤æ›¿çš„è¡Œé˜´å½±(åƒæ–‘é©¬æ¡çº¹) table-hover=åœ¨æ¯è¡Œçš„å‘¨è¾¹æ·»åŠ ç°è‰²èƒŒæ™¯ table-responsive=åˆ›å»ºå“åº”å¼è¡¨æ ¼ï¼Œå½“è®¾å¤‡å±å®½å°äºŽ768pxæ—¶è¡¨æ ¼ä¼šå˜ä¸ºæ¨ªå‘æ»‘åŠ¨ --&gt; &lt;div class=&quot;container table-responsive&quot;&gt; &lt;table class=&quot;table table-striped&quot;&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt;Column 1&lt;/th&gt; &lt;th&gt;Column 2&lt;/th&gt; &lt;th&gt;Column 3&lt;/th&gt; &lt;th&gt;Column 4&lt;/th&gt; &lt;th&gt;Column 5&lt;/th&gt; &lt;th&gt;Column 7&lt;/th&gt; &lt;th&gt;Column 8&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td&gt;1&lt;/td&gt; &lt;td&gt;2&lt;/td&gt; &lt;td&gt;3&lt;/td&gt; &lt;td&gt;4&lt;/td&gt; &lt;td&gt;5&lt;/td&gt; &lt;td&gt;6&lt;/td&gt; &lt;td&gt;7&lt;/td&gt; &lt;td&gt;8&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;1&lt;/td&gt; &lt;td&gt;2&lt;/td&gt; &lt;td&gt;3&lt;/td&gt; &lt;td&gt;4&lt;/td&gt; &lt;td&gt;5&lt;/td&gt; &lt;td&gt;6&lt;/td&gt; &lt;td&gt;7&lt;/td&gt; &lt;td&gt;8&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; å›¾ç‰‡ &lt;!-- 4.å›¾ç‰‡ img-rounded=åœ†è§’å›¾ img-circle=åœ†å½¢å›¾ img-thumbnail=æžå°å›¾(è‡ªå¸¦è‡ªé€‚åº”å±å®½ç‰¹æ€§) img-responsive=åˆ›å»ºå“åº”å¼è¡¨æ ¼ï¼Œå½“è®¾å¤‡å±å®½å°äºŽ768pxæ—¶å›¾ç‰‡è‡ªåŠ¨è°ƒæ•´å°ºå¯¸é€‚é…å±å¹•å¤§å° --&gt; &lt;div class=&quot;container&quot;&gt; &lt;img src=&quot;http://images.freeimages.com/images/large-previews/b3d/flowers-1375316.jpg&quot; width=&quot;200&quot; height=&quot;200&quot; class=&quot;img-rounded img-responsive&quot;/&gt;&lt;br&gt;&lt;br&gt; &lt;img src=&quot;http://images.freeimages.com/images/large-previews/b3d/flowers-1375316.jpg&quot; width=&quot;200&quot; height=&quot;200&quot; class=&quot;img-circle&quot;/&gt;&lt;br&gt;&lt;br&gt; &lt;img src=&quot;http://images.freeimages.com/images/large-previews/b3d/flowers-1375316.jpg&quot; width=&quot;200&quot; height=&quot;200&quot; class=&quot;img-thumbnail&quot;/&gt; &lt;/div&gt; æŒ‰é’® &lt;!-- 5.æŒ‰é’® buttonè¯¥classå¯ä»¥ç”¨åœ¨&lt;button&gt;ã€&lt;a&gt;ã€&lt;input&gt;å…ƒç´ ä¸Š å¯ç”¨ç§ç±»ï¼š btn-defaultã€btn-primaryã€btn-successã€btn-warningã€btn-dangerã€btn-infoã€btn-linkï¼ˆä»¥ä¸Šå…¶å®žä¸Žæ–‡å­—çš„ç§ç±»ç±»ä¼¼ï¼Œä¸»è¦è®¾ç½®é¢œè‰²ç‰¹æ€§ï¼‰ï¼› btn-xsã€btn-smã€btn-mdã€btn-lgï¼ˆä»¥ä¸Šä¸Žç½‘æ ¼åˆ—å®½ç‰¹æ€§ç±»ä¼¼ï¼Œè®¾ç½®æŒ‰é’®å¤§å°ç‰¹æ€§ï¼‰ï¼› active=å¯ç”¨ï¼ˆä¸Žå…¶å®ƒç§ç±»é…å¥—ä½¿ç”¨ï¼Œåƒ class=&quot;btn-default btn-xs active&quot;ï¼‰ disabled=ä¸å¯ç”¨ btn-block=ä¸Žçˆ¶å®¹å™¨å®½ä¸€è‡´ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;button type=&quot;button&quot; class=&quot;btn&quot;&gt;Basic&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot;&gt;Default&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;Primary&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-success&quot;&gt;Success&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-warning&quot;&gt;Warning&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-danger&quot;&gt;Danger&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-info&quot;&gt;Info&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-link&quot;&gt;Link&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-xs&quot;&gt;Extra Small&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-sm&quot;&gt;Small&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-md&quot;&gt;Medium&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-lg&quot;&gt;Large&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn active&quot;&gt;Active&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn disabled&quot;&gt;Disabled&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-block&quot;&gt;Block&lt;/button&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-success btn-xs active btn-block&quot;&gt;Combine&lt;/button&gt; &lt;/div&gt; è¡¨å• &lt;!-- 6.è¡¨å• * è¡¨å•ç”¨äºŽæŽ¥æ”¶è¾“å…¥ï¼Œå¯ä»¥åŒ…æ‹¬å¤šè¡Œæ–‡æœ¬è¾“å…¥ã€é€‰æ‹©æ€§åˆ—è¡¨ã€å•é€‰æŒ‰é’®ã€å¤šé€‰æ¡†ã€‚é»˜è®¤éƒ½æ˜¯åž‚ç›´å¸ƒå±€ã€‚ * ç”¨&lt;form&gt;åŒ…è£¹æ•´ä¸ªè¡¨å•ã€‚ * ç”¨form-groupç±»çš„&lt;div&gt;åŒ…è£¹æ™®é€šè¾“å…¥&lt;input&gt;ï¼Œæ–‡æœ¬è¾“å…¥&lt;textarea&gt;ï¼Œé€‰æ‹©åˆ—è¡¨&lt;radio&gt;æˆ–&lt;checkbox&gt;ã€‚ * æ–‡æœ¬ç±»è¾“å…¥éœ€ä½¿ç”¨form-controlç±»(&lt;textarea&gt;æ˜¯ç”¨å…¶ä½œä¸ºtype)ã€‚ * å¯ä»¥å°†&lt;input&gt;æ”¾å…¥&lt;label&gt;æ¥åˆ›å»ºä¸€ä¸ªå¤šé€‰æˆ–å•é€‰æŒ‰é’®ï¼Œå¯å„è‡ªæ”¾åˆ°checkboxç±»æˆ–radioç±»çš„&lt;div&gt;é‡Œï¼Œç»„æˆä¸€ä¸ªåˆ—è¡¨ã€‚ * è¦åœ¨å•è¡Œä¸­æ˜¾ç¤ºå¤šé€‰æˆ–å•é€‰æŒ‰é’®ç»„ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨&lt;div&gt;åŒ…æ‹¬é€‰é¡¹æŒ‰é’®ï¼Œå¹¶ä¸”è¦å¢žåŠ checkbox-inlineç±»æˆ–radio-inlineç±»åˆ°æ‰€æœ‰è¡Œå†…çš„labelå…ƒç´ ä¸Šã€‚ * Bootstrapæ”¯æŒHTML5çš„è¾“å…¥typeï¼ŒåŒ…æ‹¬ï¼šemailã€textã€passwordã€datetimeã€datetime-localã€dateã€monthã€timeã€weekã€numberã€urlã€searchã€telã€colorã€‚ * &lt;form&gt;å¯ä»¥ä½¿ç”¨form-lineç±»æ¥ä½¿æ‰€æœ‰formå†…çš„å…ƒç´ åœ¨å•è¡Œæ˜¾ç¤ºï¼Œå•è¡Œæ˜¾ç¤ºçš„formä¼šåœ¨å±å®½å°‘äºŽ768pxæ—¶è½¬æ¢ä¸ºç«–è¡¨å½¢å¼ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;form&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;email&quot;&gt;Email:&lt;/label&gt; &lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;email&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;info&quot;&gt;Info:&lt;/label&gt; &lt;textarea type=&quot;form-control&quot; rows=&quot;3&quot; id=&quot;info&quot;&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;sellist&quot;&gt;Select One&lt;/label&gt; &lt;select class=&quot;form-control&quot; id=&quot;sellist&quot;&gt; &lt;option&gt;A&lt;/option&gt; &lt;option&gt;B&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;label class=&quot;radio-inline&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;rb&quot;&gt;Radio 1&lt;/label&gt; &lt;label class=&quot;radio-inline&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;rb&quot;&gt;Radio 2&lt;/label&gt; &lt;div class=&quot;checkbox&quot;&gt; &lt;label&gt;&lt;input type=&quot;checkbox&quot;&gt;Checkbox 1&lt;/label&gt; &lt;label&gt;&lt;input type=&quot;checkbox&quot;&gt;Checkbox 2&lt;/label&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; ä¸‹æ‹‰è¡¨å• &lt;!-- 7.ä¸‹æ‹‰è¡¨å• * å°†ä¸€ä¸ªè§¦å‘æŒ‰é’®å’Œé€‰é¡¹åˆ—è¡¨åŒ…è£¹åœ¨dropdownç±»çš„&lt;div&gt;å†…ï¼› * è§¦å‘æŒ‰é’®è¦è®¾ç½®ä¸ºdropdown-toggleç±»ï¼ˆå¯æ­é…å…¶å®ƒç±»è®¾ç½®æ ·å¼ï¼‰ï¼Œä»¥åŠdata-toggleå±žæ€§ä¸ºdropdownï¼› * åœ¨è§¦å‘æŒ‰é’®é‡Œè¿˜éœ€åˆ›å»ºä¸€ä¸ª&lt;span&gt;å…ƒç´ ï¼Œè®¾å…¶ä¸ºcaretç±»ï¼Œè®©æŒ‰é’®å³ä¾§å¸¦æœ‰å¯¼ä¸‰è§’æŒ‡ç¤ºç¬¦ï¼› * åˆ›å»ºç±»å±žæ€§ä¸ºdropdown-menuçš„ulåˆ—è¡¨å…ƒç´ ï¼› * åœ¨ulåˆ—è¡¨ä¸­è¿˜æ˜¯å¯ä»¥é€šè¿‡dividerç±»å’Œdropdown-headerç±»çš„&lt;li&gt;åšåˆ—è¡¨ä¸­çš„åˆ†éš”çº¿å’Œåˆ†éš”æ ‡é¢˜ï¼Œè¿˜æœ‰activeå’Œdisabledç±»ï¼Œå¯å¯¹é€‰é¡¹è®¾ç½®å¯ç”¨æ€§ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;dropdown&quot;&gt; &lt;button class=&quot;btn btn-primary dropdown-toggle&quot; data-toggle=&quot;dropdown&quot;&gt; Languages &lt;span class=&quot;caret&quot;&gt;&lt;/span&gt; &lt;/button&gt; &lt;ul class=&quot;dropdown-menu&quot;&gt; &lt;li&gt;English&lt;/li&gt; &lt;li&gt;Spanish&lt;/li&gt; &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt; &lt;li class=&quot;dropdown-header&quot;&gt;Coding&lt;/li&gt; &lt;li&gt;C++&lt;/li&gt; &lt;li&gt;Java&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; è¿›åº¦æ¡ &lt;!-- 8.è¿›åº¦æ¡ * å°†progress-barç±»çš„&lt;div&gt;æ”¾åœ¨progressç±»çš„&lt;div&gt;é‡Œï¼Œprogressç±»çš„&lt;div&gt;ç›¸å½“äºŽè¿›åº¦æ¡çš„å¤–æ¡†ï¼Œé»˜è®¤æ€»é•¿æ˜¯100%ï¼Œprogress-barç±»çš„&lt;div&gt;ç›¸å½“äºŽè¿›åº¦æ¡å†…çš„ä¸€ä¸ªè¿›åº¦å¯¹è±¡ï¼Œå¯æ”¾å…¥å¤šä¸ªè¿›åº¦å¯¹è±¡ï¼Œä¼šåœ¨è¿›åº¦æ¡æ¡†ä¸­å †å ï¼› * progress-barç±»çš„&lt;div&gt;è¿˜éœ€è®¾ç½®roleå±žæ€§ä¸ºprogressbarï¼Œè®¾ç½®styleå±žæ€§çš„å®½åº¦ä¸ºå½“å‰è¿›åº¦çš„ç™¾åˆ†æ¯”ï¼› * progress-barç±»çš„&lt;div&gt;è¿˜å¯è®¾ç½®æ™®é€šçš„HTMLè¿›åº¦æ¡å±žæ€§valueã€minã€maxï¼Œåˆ†åˆ«å¯¹åº”aria-valuenowã€aria-valueminã€aria-valuemaxï¼Œå‡ä¸ºå¯é€‰çš„å±žæ€§; * é¢å¤–çš„æ ·å¼è¿˜åŒ…æ‹¬ï¼šprogress-bar-infoã€progress-bar-successã€progress-bar-warningã€progress-bar-dangerã€progress-bar-stripedï¼› --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;progress&quot;&gt; &lt;div class=&quot;progress-bar&quot; role=&quot;progressbar&quot; aria-valuenow=&quot;59&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot; style=&quot;width: 59%&quot;&gt; 59% Complete! &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;progress&quot;&gt; &lt;div class=&quot;progress-bar progress-bar-success&quot; role=&quot;progressbar&quot; style=&quot;width: 50%&quot;&gt;50&lt;/div&gt; &lt;div class=&quot;progress-bar progress-bar-warning&quot; role=&quot;progressbar&quot; style=&quot;width: 20%&quot;&gt;25&lt;/div&gt; &lt;div class=&quot;progress-bar progress-bar-danger&quot; role=&quot;progressbar&quot; style=&quot;width: 10%&quot;&gt;10&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; å·¨å¹• &lt;!-- 9.è¶…å¤§å± ä¸€ä¸ªåœ†è§’çš„ç°è‰²å¤§æ¡†ï¼›åŒºåˆ†å¼€å½“å‰é¡µé¢çš„å…¶å®ƒå…ƒç´ ï¼Œçªå‡ºæ˜¾ç¤ºï¼›æ¡†å†…çš„æ–‡æœ¬ä¹Ÿä¼šè¢«æ”¾å¤§ï¼›è‹¥æ”¾åˆ°containerä¹‹å¤–ï¼Œä¼šæ‰©å±•åˆ°å±å¹•çš„å„ä¸ªè¾¹ç•Œã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;jumbotron&quot;&gt; &lt;h1&gt;SoloLearn&lt;/h1&gt; &lt;p&gt;Learn to code for FREE!&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; è­¦å‘Šæ¡† &lt;!-- 10.è­¦å‘Šæ¡† * è­¦å‘Šæ¡†å¿…é¡»ä½¿ç”¨ä»¥ä¸‹æ ·å¼ä¸­çš„å…¶ä¸­ä¸€ä¸ªæŒ‡å®š:alert-infoã€alert-successã€alert-warningã€alert-danger; * è‹¥éœ€è¦alertæ˜¯å¯æ¶ˆå¤±çš„ï¼Œéœ€å¯¹ç±»åž‹å±žæ€§æ·»åŠ alert-dismissableç±»ï¼Œç„¶åŽåœ¨alertä¸­çš„&lt;link&gt;æˆ–&lt;button&gt;ä¸­æ·»åŠ class=&quot;close&quot;å’Œdata-dismiss=&quot;alert&quot;ï¼Œä½¿å…¶è§¦å‘èƒ½åŒæ—¶å…³é—­alertï¼› --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;alert alert-success&quot;&gt;Success Alert!&lt;/div&gt; &lt;div class=&quot;alert alert-warning&quot;&gt;Warning Alert!&lt;/div&gt; &lt;div class=&quot;alert alert-danger&quot;&gt;Danger Alert!&lt;/div&gt; &lt;div class=&quot;alert alert-info alert-dismissable&quot;&gt; &lt;a class=&quot;close&quot; data-dismiss=&quot;alert&quot; href=&quot;#&quot;&gt;Close&lt;/a&gt; Information Alert! &lt;/div&gt; &lt;/div&gt; åµŒäº• &lt;!-- 11.åµŒäº• ä¸€ä¸ªåœ†è§’çš„ç°è‰²æ¡†ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šç±»æŽ§åˆ¶å…¶æ˜¾ç¤ºå°ºå¯¸ï¼šwell-smã€well-lg; é€šå¸¸ç”¨äºŽç»™å…ƒç´ ä¸€ä¸ªåµŒå…¥çš„ç®€å•æ•ˆæžœã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;well well-sm&quot;&gt;Small well&lt;/div&gt; &lt;div class=&quot;well&quot;&gt;Normal well&lt;/div&gt; &lt;div class=&quot;well well-lg&quot;&gt;Large well&lt;/div&gt; &lt;/div&gt; æ ‡è®° æ ‡ç­¾ &lt;!-- 12.æ ‡è®° æ ‡ç­¾ * æ ‡è®°badgeç±»å¯ä»¥ç»™ä¸€ä¸ªå…ƒç´ é™„ä¸Šæ•°å€¼æ˜¾ç¤º; * æ ‡ç­¾labelç±»å¯ä»¥ç»™ä¸€ä¸ªå…ƒç´ é™„ä¸Šå…¶å®ƒä¿¡æ¯æ˜¾ç¤ºï¼Œä¸”å¿…é¡»æŒ‡å®šå…¶ä¸­ä¸€ä¸ªæ ·å¼ï¼šlabel-defaultã€label-primaryã€label-infoã€label-successã€label-warningã€label-dangerï¼› * ä»¥ä¸Šå‡ä½¿ç”¨spané™„åŠ ï¼ˆæ”¾å…¥ï¼‰åˆ°è¦é™„åŠ æ˜¾ç¤ºçš„å…ƒç´ ä¸Š --&gt; &lt;div class=&quot;container&quot;&gt; &lt;button class=&quot;btn&quot;&gt; Click&lt;span class=&quot;badge&quot;&gt;59&lt;/span&gt; &lt;/button&gt; &lt;p&gt; Paragraph &lt;span class=&quot;label label-primary&quot;&gt;Label&lt;/span&gt; &lt;/p&gt; &lt;p&gt; Paragraph &lt;span class=&quot;label label-info&quot;&gt;Label&lt;/span&gt; &lt;/p&gt; &lt;/div&gt; åª’ä½“å¯¹è±¡ &lt;!-- 13.åª’ä½“å¯¹è±¡ * ä¸ºä¾¿äºŽå¯¹é½åª’ä½“å¯¹è±¡ * ä½¿ç”¨mediaç±»çš„&lt;div&gt;åŒ…è£¹æ‰€æœ‰è¦å¯¹é½çš„æ‰€æœ‰å†…å®¹ï¼› * ä½¿ç”¨ç±»media-leftã€media-rightã€media-topã€media-middleã€media-bottom(åŽä¸‰è€…ä¸€èˆ¬ç”¨äºŽå½“å†…å®¹å¾ˆå¤§çš„æƒ…å†µ)çš„&lt;div&gt;æ¥åŒ…è£¹è¦å¯¹é½åª’ä½“æ ‡ç­¾ï¼Œåª’ä½“æ ‡ç­¾çš„ç±»ä¸”éœ€ä¸ºmedia-objectï¼› * å†…å®¹éœ€è¦ä½¿ç”¨media-bodyç±»çš„&lt;div&gt;åŒ…è£¹ï¼› * å†…å®¹ä¸­çš„æ ‡é¢˜å¯ä»¥ä½¿ç”¨media-headingç±»è®¾å®šï¼› * éœ€è¦æ³¨æ„åŒ…è£¹å†…å®¹å’Œåª’ä½“çš„&lt;div&gt;é¡ºåºï¼Œæ ¹æ®å…¶æ‰€è®¾å®šçš„ä½ç½®ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;media&quot;&gt; &lt;div class=&quot;media-left&quot;&gt; &lt;img src=&quot;http://www.sololearn.com/images/fb-story-icon.jpg&quot; width=&quot;40&quot; height=&quot;40&quot; class=&quot;media-object&quot;&gt; &lt;/div&gt; &lt;div class=&quot;media-body&quot;&gt; &lt;h4 class=&quot;media-heading&quot;&gt;SoloLearn&lt;/h4&gt; Let&apos;s Collaborate! &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;media&quot;&gt; &lt;div class=&quot;media-body&quot;&gt; &lt;h4 class=&quot;media-heading&quot;&gt;FreeCodeCamp&lt;/h4&gt; Let&apos;s Collaborate! &lt;/div&gt; &lt;div class=&quot;media-right&quot;&gt; &lt;img src=&quot;http://avatars3.githubusercontent.com/u/9892522&quot; width=&quot;40&quot; height=&quot;40&quot; class=&quot;media-object&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; è·‘é©¬ç¯ &lt;!-- 14.è·‘é©¬ç¯ * é»˜è®¤æ ·å¼ä¸­ï¼Œæœ‰å°åœ†å½¢çš„æŒ‡ç¤ºå™¨æ ‡å‡ºå„æ»‘å—çš„åºå·ã€å½“å‰æ¿€æ´»çš„æ»‘å—ï¼›å¯æ‰‹å·¥æ¥å›žåˆ‡æ¢å¹»ç¯ç‰‡ï¼› * ç”¨è‡ªå®šä¹‰idçš„&lt;div&gt;åŒ…è£¹æ‰€æœ‰è·‘é©¬ç¯å†…å®¹ï¼Œ&lt;div&gt;çš„ç±»å±žæ€§éœ€è¦æŒ‡å®šä¸ºcarousel(å¯é…åˆæŒ‡å®šä¸ºslideï¼Œä¼šå¸¦æœ‰è¿‡æ¸¡åŠ¨ç”»)ï¼Œç„¶åŽè¿˜è¦æŒ‡å®šdata-rideå±žæ€§æ ‡è®°è½®æ’­åœ¨é¡µé¢åŠ è½½æ—¶å°±å¼€å§‹åŠ¨ç”»æ’­æ”¾ï¼› * åœ¨ä¸Šè¿°divé‡Œçš„å¤–å±‚å†…å®¹ï¼Œä¼šåŒ…æ‹¬æŒ‡ç¤ºå™¨ã€åª’ä½“å†…å®¹ã€æŽ§åˆ¶å™¨ï¼› * æŒ‡ç¤ºå™¨ä½¿ç”¨ç±»carousel-indicatorsçš„&lt;ol&gt;å®žçŽ°ï¼Œé‡Œé¢çš„æ¯ä¸€é¡¹&lt;li&gt;éƒ½éœ€è¦æœ‰å±žæ€§data-targetæŒ‡å‘è·‘é©¬ç¯divçš„idï¼Œå’Œå±žæ€§data-slide-toæŒ‡å‡ºç‚¹å‡»æ—¶æ˜¾ç¤ºå“ªä¸ªå¯¹åº”çš„æ»‘å—ï¼› * åª’ä½“å†…å®¹ç”¨carousel-innerç±»çš„divåŒ…è£¹ï¼Œç„¶åŽå°†ä¸åŒçš„åª’ä½“ç”¨itemç±»çš„divåˆ†ç¦»ï¼ŒåŒæ—¶æŒ‡å®šactiveç±»è¡¨æ˜Žå½“å‰æ˜¾ç¤ºçš„åª’ä½“ï¼› * itemç±»divé‡Œé™¤äº†åŒ…è£¹åª’ä½“ï¼Œè¿˜åŒ…è£¹carousel-captionç±»çš„divï¼Œæ‰¿è½½å½“å‰åª’ä½“æ»‘å—å¤–çš„é¢å¤–å†…å®¹ï¼Œitemåœ¨carousel-innerç±»çš„divé‡Œæ˜¯ä½äºŽä¸­ä¸‹æ–¹ï¼› * åœ¨carousel-innerç±»divé‡Œï¼Œä¹Ÿå¯ä»¥æ·»åŠ å¦å¤–çš„&lt;a&gt;æŽ§ä»¶æ¥æŽ§åˆ¶åˆ‡æ¢ï¼Œç±»å±žæ€§è®¾ç½®ä¸ºcarousel-control(ä¸€èˆ¬é…åˆleftæˆ–rightç±»å®šæŽ§ä»¶åœ¨å½“å‰è·‘é©¬ç¯ä¸Šçš„ä½ç½®)ï¼Œhrefè¦æŒ‡å‘è·‘é©¬ç¯çš„idï¼ŒåŒæ—¶è¦è®¾ç½®ä¸€ä¸ªdata-slideå±žæ€§prevæˆ–nextæŒ‡å®šè§¦å‘åˆ‡æ¢çš„å‘å‰ä¸€é¡µè¿˜æ˜¯å‘åŽä¸€é¡µã€‚æŽ§ä»¶ä¸­å¯ä»¥æŒ‡å®šæŒ‡ç¤ºå›¾æ ‡&lt;span&gt;ï¼Œé»˜è®¤å¯ç›´æŽ¥ç‚¹å‡»æŽ§ä»¶çš„é˜´å½±èŒƒå›´è§¦å‘ï¼› * glyphiconæ¥è‡ªäºŽGlyphicon Halfingsï¼ŒCarouselæ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œåœ¨Bootstrapçš„JSæ–‡ä»¶ä¸­ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div id=&quot;logoCarousel&quot; class=&quot;carousel&quot; data-ride=&quot;carousel&quot;&gt; &lt;ol class=&quot;carousel-indicators black&quot;&gt; &lt;li data-target=&quot;#logoCarousel&quot; data-slide-to=&quot;0&quot; class=&quot;active&quot;&gt;&lt;/li&gt; &lt;li data-target=&quot;#logoCarousel&quot; data-slide-to=&quot;1&quot;&gt;&lt;/li&gt; &lt;/ol&gt; &lt;div class=&quot;carousel-inner&quot;&gt; &lt;div class=&quot;item active&quot;&gt; &lt;img src=&quot;https://images.freeimages.com/images/large-previews/9fc/yet-another-flower-1399208.jpg&quot; style=&quot;width: 100%&quot;&gt; &lt;div class=&quot;carousel-caption&quot;&gt; &lt;h3&gt;Caption 1&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;img src=&quot;https://images.freeimages.com/images/large-previews/b3d/flowers-1375316.jpg&quot; style=&quot;width: 100%&quot;&gt; &lt;div class=&quot;carousel-caption&quot;&gt; &lt;h3&gt;Caption 2&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt; &lt;a class=&quot;left carousel-control&quot; href=&quot;#logoCarousel&quot; data-slide=&quot;prev&quot;&gt; &lt;span class=&quot;glyphicon glyphicon-chevron-left&quot;&gt;&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;right carousel-control&quot; href=&quot;#logoCarousel&quot; data-slide=&quot;next&quot;&gt; &lt;span class=&quot;glyphicon glyphicon-chevron-right&quot;&gt;&lt;/span&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; æ¨¡æ€æ¡† &lt;!-- 15.æ¨¡æ€æ¡† å¼¹å‡ºä¸€ä¸ªæ˜¾ç¤ºåœ¨å½“å‰é¡µé¢é¡¶éƒ¨å¯¹è¯çª—/æ¡†ï¼Œæ˜¯ä¸€ä¸ªæ’ä»¶ã€‚ é€šè¿‡æŒ‡å®šæŒ‰é’®buttonçš„data-toogleå±žæ€§ä¸ºmodalï¼Œdata-targetå±žæ€§ä¸ºmodalç±»çš„divçš„idï¼Œé‚£ä¹ˆæŒ‰é’®ç‚¹å‡»æ—¶å°±èƒ½è§¦å‘å‡ºè¯¥modalç±»divçš„æ¨¡æ€å¯¹è±¡ï¼› * æ¨¡æ€å¯¹è±¡ä¸­åŒ…è£¹æ¨¡æ€å¯¹è¯æ¡†modal-dialogï¼› * æ¨¡æ€æ¡†ä¸­åŒ…è£¹æ¨¡æ€å†…å®¹modal-contentï¼› * æ¨¡æ€å†…å®¹å¯åŒ…æ‹¬ï¼šmodal-header(å¯åœ¨å…¶ä¸­åŒ…å«modal-title)ã€modal-boodyã€mode-footerï¼Œæ¥æŒ‡å®šæ¨¡æ€çª—ä¸­çš„ä¸åŒéƒ¨ä½å†…å®¹; * å¯ä»¥æŒ‡å®šå…³é—­æ¨¡æ€æ¡†çš„æŒ‰é’®ï¼ŒæŒ‰é’®éœ€è¦è®¾å®šå±žæ€§data-dismiss=&quot;modal&quot;æ‰èƒ½åœ¨è§¦å‘æŒ‰é’®æ—¶å…³é—­æ¨¡æ€æ¡†ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;button type=&quot;button&quot; data-toggle=&quot;modal&quot; data-target=&quot;#myModal&quot;&gt;Open Modal&lt;/button&gt; &lt;div id=&quot;myModal&quot; class=&quot;modal&quot;&gt; &lt;div class=&quot;modal-dialog&quot;&gt; &lt;div class=&quot;modal-content&quot;&gt; &lt;div class=&quot;modal-header&quot;&gt; &lt;h3 class=&quot;modal-title&quot;&gt;Header&lt;/h3&gt; &lt;button data-dismiss=&quot;modal&quot;&gt;X&lt;/button&gt; &lt;/div&gt; &lt;div class=&quot;modal-body&quot;&gt;Body&lt;/div&gt; &lt;div class=&quot;modal-footer&quot;&gt;Footer&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; æ‚¬æµ® &lt;!-- 16.æ‚¬æµ® å°†ä¸€ä¸ªå…ƒç´ è´´åœ¨é¡µé¢çš„ä¸€ä¸ªåŒºåŸŸä¸Šï¼Œæ»šåŠ¨é¡µé¢æ—¶è¯¥æ‚¬æµ®å…ƒç´ ä¿æŒå›ºå®šåœ¨è¿™ä¸ªæŒ‡å®šåŒºåŸŸä¸åŠ¨ã€‚ ï¼ˆæ”¾åœ¨è¯¥ä½ç½®ä¸Šå¯èƒ½å› è·‘é©¬ç¯çš„ç¼˜æ•…æ— æ³•æ˜¾ç¤ºï¼Œæ”¾ç½®åˆ°é¡µé¢åˆå§‹æ˜¾ç¤ºçš„ä½ç½®æ—¶èƒ½æ­£å¸¸æ‚¬æµ®æ˜¾ç¤ºï¼‰ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div id=&quot;affixed&quot; data-spy=&quot;affix&quot;&gt;Affix&lt;/div&gt; &lt;div class=&quot;jumbotron&quot;&gt;Content for Scrolling&lt;/div&gt; &lt;div class=&quot;jumbotron&quot;&gt;Content for Scrolling&lt;/div&gt; &lt;div class=&quot;jumbotron&quot;&gt;Content for Scrolling&lt;/div&gt; &lt;/div&gt; åˆ†ç»„æŒ‰é’® &lt;!-- 17.åˆ†ç»„æŒ‰é’® btn-groupç±»çš„divä¸ºé»˜è®¤æ¨ªæŽ’æŒ‰é’®ç»„ï¼Œbtn-group-verticalä¸ºç«–æŽ’ã€‚ æŒ‰é’®ç»„çš„å°ºå¯¸å¯ä»¥ä½¿ç”¨ç±»æŒ‡å®šåŒ…æ‹¬btn-group-xsã€btn-group-smã€btn-group-lgã€‚ btn-group-justifiedç±»å¯ä½¿æŒ‰é’®ç»„å®½åº¦æ ¹æ®å±å®½é€‚é…ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;btn-group btn-group-xs&quot;&gt; &lt;button class=&quot;btn btn-success&quot;&gt;h1&lt;/button&gt; &lt;button class=&quot;btn btn-warning&quot;&gt;h2&lt;/button&gt; &lt;button class=&quot;btn btn-danger&quot;&gt;h3&lt;/button&gt; &lt;/div&gt; &lt;br&gt;&lt;br&gt; &lt;div class=&quot;btn-group-vertical&quot;&gt; &lt;button class=&quot;btn btn-success&quot;&gt;v1&lt;/button&gt; &lt;button class=&quot;btn btn-warning&quot;&gt;v2&lt;/button&gt; &lt;button class=&quot;btn btn-danger&quot;&gt;v3&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; åˆ—è¡¨ç»„ &lt;!-- 18.åˆ—è¡¨ç»„ * å¯¹&lt;ul&gt;çš„ç±»å±žæ€§æŒ‡å®šä¸ºlist-groupï¼Œå¯¹&lt;li&gt;çš„ç±»å±žæ€§æŒ‡å®šä¸ºlist-group-itemï¼› * å¯ç»§ç»­å¯¹&lt;li&gt;æŒ‡å®šç±»å±žæ€§ä¸ºactiveæˆ–disabledï¼› * æ ·å¼å¯ä»¥ç»§ç»­ä½¿ç”¨ä»¥ä¸‹ç±»è®¾ç½®ï¼šlist-group-item-successã€list-group-item-infoã€list-group-item-warningã€list-group-item-danger; * ä¹Ÿå¯ä»¥ä½¿ç”¨divæˆ–aç»„æˆåˆ—è¡¨ç»„ï¼Œä¸å±€é™äºŽulå’Œliã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;list-group&quot;&gt; &lt;li class=&quot;list-group-item active&quot;&gt;HTML&lt;/li&gt; &lt;li class=&quot;list-group-item disabled&quot;&gt;CSS&lt;/li&gt; &lt;li class=&quot;list-group-item list-group-item-success&quot;&gt;JS&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; åµŒæ¿ &lt;!-- 19.åµŒæ¿ * é•¶è¾¹æ¡†ï¼Œå…ˆç”¨panelç±»çš„divåŒ…è£¹ä¸€å±‚ï¼ŒåŒæ—¶æœ‰ä»¥ä¸‹ç§ç±»å¯ä»¥è®¾æ ·å¼ï¼španel-defaultã€panel-primaryã€panel-successã€panel-infoã€panel-warningã€panel-dangerï¼› * ç„¶åŽç”¨ä»¥ä¸‹ç±»æ·»åŠ ç¬¬äºŒå±‚divï¼španel-headingã€panel-bodyã€panel-footerï¼› * å¯ä»¥ç”¨panel-groupç±»çš„divç»„ç»‡èµ·panelç±»çš„divã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;panel panel-success&quot;&gt; &lt;div class=&quot;panel-heading&quot;&gt;Head&lt;/div&gt; &lt;div class=&quot;panel-body&quot;&gt;Body&lt;/div&gt; &lt;div class=&quot;panel-footer&quot;&gt;Foot&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;panel panel-danger&quot;&gt; &lt;div class=&quot;panel-heading&quot;&gt;Head&lt;/div&gt; &lt;div class=&quot;panel-body&quot;&gt;Body&lt;/div&gt; &lt;div class=&quot;panel-footer&quot;&gt;Foot&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; æŠ˜å  &lt;!-- 20.æŠ˜å  æ”¶çº³æˆ–æ˜¾ç¤ºå¤§é‡çš„å†…å®¹ï¼Œé€šè¿‡æŒ‰é’®è§¦å‘ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;button data-toggle=&quot;collapse&quot; data-target=&quot;#myCollapsible&quot; class=&quot;btn btn-warning&quot;&gt;Show/Hide&lt;/button&gt; &lt;div id=&quot;myCollapsible&quot; class=&quot;collapse&quot;&gt;Bootstrap Collapsibel&lt;/div&gt; &lt;/div&gt; é¡µæ ‡ &lt;!-- 21.é¡µæ ‡ å°ºå¯¸å¤§å°å¯ä»¥ä½¿ç”¨è¿™äº›ç±»æŽ§åˆ¶ï¼špagination-smã€pagination-lg --&gt; &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;pagination&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;1&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;2&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;#&quot;&gt;3&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;4&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; è·¯å¾„å¯¼èˆª &lt;!-- 22.ç—•è¿¹å¯¼èˆª ä½œä¸ºåˆ†å±‚å¯¼èˆªè¡¨å•çš„ä¸€ç§é¡µæ ‡ï¼Œå³æ˜¯å¯¼èˆªçš„è·¯å¾„ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;breadcrumb&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Languages&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Programming&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;C&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Intro&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; ç¿»é¡µå™¨ &lt;!-- 23.ç¿»é¡µå™¨ * ä¸Šä¸€é¡µã€ä¸‹ä¸€é¡µï¼› * è‹¥è¦åˆ†åˆ«å°†ä¸Šä¸€é¡µå’Œä¸‹ä¸€é¡µæŒ‰é’®æ”¾åœ¨å±å¹•å·¦è¾¹å’Œå³è¾¹ï¼Œç»™liçš„ç±»å±žæ€§è®¾ä¸ºå¯¹åº”çš„previouså’Œnextã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;pager&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Previous&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Next&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;div class=&quot;container&quot;&gt; &lt;ul class=&quot;pager&quot;&gt; &lt;li class=&quot;previous&quot;&gt;&lt;a href=&quot;#&quot;&gt;Previous&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;#&quot;&gt;Next&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; å¯¼èˆªæ  &lt;!-- 24.å¯¼èˆªæ  * ä½¿ç”¨&lt;nav&gt;æ ‡ç­¾ï¼Œå¹¶è®¾ç½®ç±»å±žæ€§ä¸ºnavbarå’Œnavbar-default/navbar-inverseï¼ˆå³é»˜è®¤æˆ–å€’ç½®æ ·å¼ï¼‰ï¼› * åœ¨&lt;nav&gt;é‡Œåˆ›å»ºç±»å±žæ€§ä¸ºnavbar-headerçš„&lt;div&gt;ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºç±»å±žæ€§ä¸ºnavbar-brandçš„&lt;a&gt;å…ƒç´ ä½œä¸ºä¸»è¦çš„å¤´é¡¹ï¼› * åœ¨&lt;nav&gt;é‡Œç»§ç»­åˆ›ç±»å±žæ€§ä¸ºnavå’Œnavbar-navçš„&lt;ul&gt;ï¼Œä½œä¸ºæ¬¡è¦çš„å­é¡¹åˆ—è¡¨ï¼› * å¯ä»¥å¯¹é¡¹æŒ‡å®šç±»å±žæ€§activeæˆ–disabledè®¾å®šæ˜¯å¦å¯ç”¨ï¼› * å¯ä½¿ç”¨navbar-rightä½œä¸ºå­é¡¹åˆ—è¡¨çš„ç±»å±žæ€§ï¼Œæ¥è®¾ç½®å­é¡¹åˆ—è¡¨åœ¨å¯¼èˆªæ ä¸­çš„å¯¹é½æ–¹å‘ï¼› * ä½¿ç”¨navbar-fixed-topã€navbar-fixed-bottomä½œä¸º&lt;nav&gt;çš„ç±»å±žæ€§å¯ä»¥è®¾å®šå¯¼èˆªæ å›ºå®šåœ¨é¡µé¢çš„é¡¶éƒ¨æˆ–åº•éƒ¨ï¼Œä¸ä¼šåœ¨æ»šåŠ¨æ—¶ç§»å‡ºé¡µé¢ã€‚ --&gt; &lt;div class=&quot;container&quot;&gt; &lt;nav class=&quot;navbar navbar-default&quot;&gt; &lt;div class=&quot;navbar-header&quot;&gt; &lt;a href=&quot;#&quot; class=&quot;navbar-brand&quot;&gt;Home&lt;/a&gt; &lt;/div&gt; &lt;ul class=&quot;nav navbar-nav&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Page0&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Page1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Page2&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;#&quot;&gt;Page 4&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/nav&gt; &lt;/div&gt; æ»šåŠ¨&lt;!-- 25.æ»šåŠ¨ * ä¸ºè‡ªåŠ¨æ›´æ–°åœ¨åŸºäºŽæ»šåŠ¨ä½ç½®çš„å¯¼èˆªæ ä¸­çš„é“¾æŽ¥ï¼Œå¯ä»¥ä½¿ç”¨scrollspyï¼› * &lt;body&gt;çš„æ•°æ®ç›‘æµ‹å±žæ€§è®¾ä¸ºscrollï¼Œæ•°æ®åç§»å±žæ€§è®¾ä¸º20ï¼ˆé¢„ç•™å¯¼èˆªæ é«˜åº¦ï¼‰ï¼› * å¯æ»šåŠ¨åŒºåŸŸéœ€è¦CSSçš„ä½ç½®å±žæ€§æ˜¯ä¸Žscrollspyå…³è”æ‰æœ‰æ•ˆï¼› * æ˜¯ä¸€ä¸ªJSæ’ä»¶ã€‚ --&gt; &lt;body data-spy=&quot;scroll&quot; data-offset=&quot;20&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;nav class=&quot;navbar navbar-inverse navbar-fixed-top&quot;&gt; &lt;div class=&quot;navbar-header&quot;&gt; &lt;a href=&quot;#&quot; class=&quot;navbar-brand&quot;&gt;Home&lt;/a&gt; &lt;/div&gt; &lt;ul class=&quot;nav navbar-nav&quot;&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;#p0&quot;&gt;Part 0&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#p1&quot;&gt;Part 1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#p2&quot;&gt;Part 2&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/nav&gt; &lt;div id=&quot;p0&quot;&gt;0:Scroll and See the Navigation Bar&lt;/div&gt; &lt;div id=&quot;p1&quot;&gt;1:Scroll and See the Navigation Bar&lt;/div&gt; &lt;div id=&quot;p2&quot;&gt;2:Scroll and See the Navigation Bar&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; å…¶å®ƒ&lt;!-- 26.å…¶å®ƒ * é€‰é¡¹å¡ï¼štabbableã€nav-tabsã€tab-contentã€tab-pane * æ‰‹é£Žç´åˆ‡æ¢ï¼španel-collapse --&gt; ä»£ç å‚è€ƒè‡ªSoloLearn]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>bootstrap</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆä¸ƒï¼‰å·¥å…·ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E4%B8%83%EF%BC%89%E5%B7%A5%E5%85%B7%E7%AF%87%2F</url>
    <content type="text"><![CDATA[æ¬æœ€åŽä¸€ç¯‡å…³äºŽVaporçš„ç –ï¼Œä»‹ç»ä¸€ä¸‹Vaporä¸­å¯é€‰ç”¨çš„å·¥å…·ï¼ŒåŒ…æ‹¬Commandã€Consoleã€Cryptoã€‚ TerminalTerminalå’ŒConsoleäºŒé€‰ä¸€ä½¿ç”¨ï¼Œä¸¤è€…åªæ˜¯åˆ›å»ºæ–¹å¼ä¸ä¸€æ · import Vapor let terminal = Terminal() print(terminal is Console) // true terminal.print(&quot;Hello&quot;) let console = try req.make(Console.self) console.print(&quot;Hello&quot;) æ— è®ºæ˜¯ä½¿ç”¨ print(_ :) è¿˜æ˜¯ warning(_ :)ï¼Œå®žè´¨éƒ½æ˜¯è°ƒç”¨å¼ºå¤§çš„output(_:)å®žçŽ° /// Prints &quot;Hello, world&quot;, but the word &apos;world&apos; is blue. console.output(&quot;Hello, &quot; + &quot;world&quot;.consoleText(color: .blue)) ä¹Ÿå¯ä»¥ä½¿ç”¨Logï¼Œå®žçŽ°Loggeråè®®æ¥è‡ªå®šä¹‰è¾“å‡ºçš„ä¿¡æ¯ï¼Œé»˜è®¤æœ‰æ•ˆçš„æ˜¯PrintLogger let logger = try req.make(Logger.self) logger.info(&quot;Logger created!&quot;) è¾“å…¥ /// Accepts input from the terminal until the first newline. let input = console.input() console.print(&quot;You wrote: \(input)&quot;) /// Outputs the prompt then requests input. let name = console.ask(&quot;What is your name?&quot;) console.print(&quot;You said: \(name)&quot;) /// Prompts the user for yes / no input. if console.confirm(&quot;Are you sure?&quot;) &#123; // they are sure &#125; else &#123; // don&apos;t do it! &#125; SPM let package = Package( name: &quot;Project&quot;, dependencies: [ ... /// ðŸ’» APIs for creating interactive CLI tools. .package(url: &quot;https://github.com/vapor/console.git&quot;, from: &quot;3.0.0&quot;), ], targets: [ .target(name: &quot;Project&quot;, dependencies: [&quot;Console&quot;,&quot;Logging&quot;, ... ]) ] ) Commandå‘½ä»¤è¡Œå·¥å…· /// Generates ASCII picture of a cow with a message. struct CowsayCommand: Command &#123; var arguments: [CommandArgument] &#123; return [.argument(name: &quot;message&quot;)] &#125; var options: [CommandOption] &#123; return [ .value(name: &quot;eyes&quot;, short: &quot;e&quot;, default: &quot;oo&quot;, help: [&quot;Change cow&apos;s eyes&quot;]), .value(name: &quot;tongue&quot;, short: &quot;t&quot;, default: &quot; &quot;, help: [&quot;Change cow&apos;s tongue&quot;]), ] &#125; var help: [String] &#123; return [&quot;Generates ASCII picture of a cow with a message.&quot;] &#125; /// See `Command`. func run(using context: CommandContext) throws -&gt; Future&lt;Void&gt; &#123; let message = try context.argument(&quot;message&quot;) /// We can use requireOption here since both options have default values let eyes = try context.requireOption(&quot;eyes&quot;) let tongue = try context.requireOption(&quot;tongue&quot;) let padding = String(repeating: &quot;-&quot;, count: message.count) let text: String = &quot;&quot;&quot; \(padding) &lt; \(message) &gt; \(padding) \\ ^__^ \\ (\(eyes)\\_______ (__)\\ )\\/\\ \(tongue) ||----w | || || &quot;&quot;&quot; context.console.print(text) return .done(on: context.container) &#125; &#125; //in configure.swift /// Create a `CommandConfig` with default commands. var commandConfig = CommandConfig.default() /// Add the `CowsayCommand`. commandConfig.use(CowsayCommand(), as: &quot;cowsay&quot;) /// Register this `CommandConfig` to services. services.register(commandConfig) $ swift run Run xxx --help $ swift run Run cowsay &apos;Good job!&apos; -e ^^ -t U SPM let package = Package( name: &quot;Project&quot;, dependencies: [ ... /// ðŸ’» APIs for creating interactive CLI tools. .package(url: &quot;https://github.com/vapor/console.git&quot;, from: &quot;3.0.0&quot;), ], targets: [ .target(name: &quot;Project&quot;, dependencies: [&quot;Command&quot;, ... ]) ] ) Cryptoå¾…å®Œæˆã€‚]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>command</tag>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>crypto</tag>
        <tag>console</tag>
        <tag>terminal</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆå…­ï¼‰è§†å›¾ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E5%85%AD%EF%BC%89%E8%A7%86%E5%9B%BE%E7%AF%87%2F</url>
    <content type="text"><![CDATA[Vaporé‡Œçš„è§†å›¾ä¸»è¦æ˜¯é€šè¿‡Leafå®žçŽ°çš„ï¼ŒLeafæ˜¯ä¸€ç§ç®€å•çš„æ¨¡æ¿è¯­è¨€ï¼Œé€šè¿‡æ¨¡æ¿æ¥å®žçŽ°åœ¨HTMLä¸­çš„åŠ¨æ€Webï¼Œå°±æ˜¯åœ¨Leafæ¨¡æ¿ä¸­é€šè¿‡è§„å®šçš„è¯­æ³•æ¥æ¸²æŸ“å‡ºå¯¹åº”çš„å†…å®¹ã€‚Leafæœ‰ä»¥ä¸‹ç›®æ ‡ Small set of strictly enforced rules å°å¥—ä¸¥æ ¼æ‰§è¡Œè§„åˆ™ Consistency ä¸€è‡´æ€§ Parser first mentality è§£æžå™¨ç¬¬ä¸€å¿ƒæ€ Extensibility å¯æ‰©å±•æ€§ è€ŒåŠ¨æ€Webï¼Œåˆ™æ˜¯æŒ‡åœ¨é¡µé¢é‡ŒåµŒå¥—äº†ç¨‹åºï¼Œè¿™ç§ç½‘ç«™å¯¹ä¸€äº›æ¡†æž¶ç›¸åŒï¼Œæ›´æ–°è¾ƒå¿«çš„ä¿¡æ¯é¡µé¢è¿›è¡Œå†…å®¹ä¸Žå½¢å¼çš„åˆ†ç¦»ï¼Œå°†ä¿¡æ¯å†…å®¹ä»¥è®°å½•çš„å½¢å¼å­˜å…¥äº†ç½‘ç«™çš„æ•°æ®åº“ä¸­ï¼Œä»¥ä¾¿äºŽç½‘ç«™å„å¤„è°ƒç”¨ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„ä¸€ä¸ªé¡µé¢å¯èƒ½åœ¨æœåŠ¡å™¨ä¸Šå¹¶ä¸ä¸€ä¸€å¯¹åº”æŸä¸ª html çš„æ–‡ä»¶ï¼Œç½‘é¡µæ¡†æž¶é‡Œä¹Ÿå¥—äº†å¾ˆå¤šæ•°æ®åº“é‡Œè®°å½•çš„å†…å®¹ã€‚ TemplateKitTemplateKitæ˜¯ä¸ºäº†å®šä¹‰é€šç”¨çš„æ¨¡æ¿ç»“æž„å’Œåºåˆ—å¤„ç†çš„æ¨¡æ¿è¯­è¨€èƒ½æ›´å®¹æ˜“è¢«å®žçŽ°è€Œè®¾è®¡çš„ã€‚ Leafä½¿ç”¨TemplateKitæ¥æ¸²æŸ“è§†å›¾ï¼Œé€šè¿‡éµä»ŽTemplateParseråè®®çš„è§£æžå™¨LeafParserï¼Œå°†leafè§£æžåˆ°æŠ½è±¡çš„è¯­æ³•æ ‘ï¼ˆASTï¼‰ä¸Š //greeting.leaf -&gt; LeafParser -&gt; AST //leaf Hello, #capitalize(name)! //parser func parse(scanner: TemplateByteScanner) throws -&gt; [TemplateSyntax] //AST [ .raw(data: &quot;Hello. &quot;), .tag( name: &quot;capitalize&quot;, parameters: [.identifier(&quot;name&quot;)] ), .raw(data: &quot;!&quot;), ] ç„¶åŽé€šè¿‡éµä»ŽTemplateRendererçš„LeafRendererå¡«å……ASTä¸­çš„å˜é‡ï¼Œæœ€åŽæ¸²æŸ“å‡ºè§†å›¾View //AST + Data -&gt; TemplateSerializer -&gt; View //å¡«å……ASTä¸­çš„å˜é‡ let data = TemplateData.dictionary([&quot;name&quot;: &quot;vapor&quot;]) //render public func render(_ path: String, _ context: TemplateData) -&gt; Future&lt;View&gt; //View Hello, Vapor! å°ç»“æ•´ä¸ªæ¸²æŸ“çš„æµç¨‹å°±æ˜¯ LeafRenderer | |----------------------------------------------------------------| greeting.leaf -&gt; LeafParser -&gt; AST -&gt; TemplateSerializer -&gt; View ^ / TemplateData LeafLeafæ˜¯ä¸€ç§ä½¿ç”¨Swiftæ€ç»´è¯­æ³•çš„æ¨¡æ¿è¯­è¨€ã€‚ä½¿ç”¨å®ƒèƒ½å¤Ÿä¸ºå‰ç«¯äº§ç”ŸåŠ¨æ€çš„HTMLé¡µé¢ï¼Œæˆ–ç”Ÿäº§é€šè¿‡APIå‘é€çš„å¯Œé‚®ä»¶ã€‚ è®¾ç½®//In SPM let package = Package( name: &quot;MyApp&quot;, dependencies: [ .package(url: &quot;https://github.com/vapor/leaf.git&quot;, from: &quot;3.0.0&quot;), ], targets: [ .target(name: &quot;App&quot;, dependencies: [&quot;Leaf&quot;, ...]) ] ) //In configure.swift import Leaf try services.register(LeafProvider()) config.prefer(LeafRenderer.self, for: ViewRenderer.self) //è§£å†³æœ‰å¤šä¸ªè§†å›¾æ¸²æŸ“å™¨æ—¶çš„å†²çªï¼Œé€‰æ‹©ä¼˜å…ˆä½¿ç”¨è€…ã€‚ æ–‡ä»¶å¤¹ç»“æž„Leaf expects the views folder to be a ./Resources/Viewsrelative to your projectâ€™s root. Leaféœ€è¦æ”¾åœ¨ä¸‹é¢çš„ç»“æž„çš„Viewsæ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”è·¯å¾„ä¹Ÿéœ€æŒ‰æ­¤è§„åˆ’ã€‚ VaporApp â”œâ”€â”€ Package.swift â”œâ”€â”€ Resources â”‚ â”œâ”€â”€ Views â”‚ â”‚ â””â”€â”€ hello.leaf â”œâ”€â”€ Public â”‚ â”œâ”€â”€ images (images resources) â”‚ â”œâ”€â”€ styles (css resources) â””â”€â”€ Sources â””â”€â”€ ... æ¸²æŸ“//In leaf Hello, #(name)! //In routes.swift import Leaf router.get(&quot;hello&quot;) &#123; req -&gt; Future&lt;View&gt; in return try req.view().render(&quot;hello&quot;, [&quot;name&quot;: &quot;Leaf&quot;]) &#125; è¯­æ³•Leafå†…å»ºtagçš„ç”¨æ³• #(variable) #embed(&quot;template&quot;) #set(&quot;title&quot;) &#123; Welcome to Vapor &#125; #count(friends) #for(friend in friends) &#123; &lt;li&gt;#(friend.name)&lt;/li&gt; &#125; ä¸Šä¸‹æ–‡ åªè¦å®žçŽ°äº†Encodableï¼Œéƒ½å¯ä»¥ä¼ å€¼ç»™Leaf struct WelcomeContext: Encodable &#123; var title: String var number: Int &#125; return try req.view().make(&quot;home&quot;, WelcomeContext(title: &quot;Hello!&quot;, number: 42)) //In leaf &lt;h1&gt;#(title)&lt;/h1&gt; &lt;p&gt;#(number)&lt;/p&gt; æ¡ä»¶ //In leaf #if(title) &#123; The title is #(title) &#125; else &#123; No title was provided. &#125; #if(title == &quot;Welcome&quot;) &#123; This is a friendly web page. &#125; else &#123; No strangers allowed! &#125; #if(lowercase(title) == &quot;welcome&quot;) &#123; This is a friendly web page. &#125; else &#123; No strangers allowed! &#125; #if(title == &quot;Welcome&quot;) &#123; This is a friendly web page. &#125; else if (1 == 2) &#123; What? &#125; else &#123; No strangers allowed! &#125; å¾ªçŽ¯ struct SolarSystem: Codable &#123; let planets = [&quot;Venus&quot;, &quot;Earth&quot;, &quot;Mars&quot;] &#125; return try req.view().render(..., SolarSystem()) //In leaf Planets: &lt;ul&gt; #for(planet in planets) &#123; &lt;li&gt;#(planet)&lt;/li&gt; &#125; &lt;/ul&gt; #for(planet in planets) &#123; #if(isFirst) &#123; #(planet) is first! &#125; //isFirstã€isLastã€index &#125; åµŒå¥— //In child.leaf #set(&quot;body&quot;) &#123; &lt;p&gt;Welcome to Vapor!&lt;/p&gt; &#125; #embed(&quot;master&quot;) //åµŒå¥—äº† master.leaf çš„å†…å®¹åˆ°è¿™é‡Œ //In master.leaf &lt;html&gt; &lt;head&gt; &lt;title&gt;#(title)&lt;/title&gt; &lt;/head&gt; &lt;body&gt;#get(body)&lt;/body&gt; &lt;/html&gt; //In context [&quot;title&quot;: &quot;Hi there!&quot;] //In View &lt;html&gt; &lt;head&gt; &lt;title&gt;Hi there!&lt;/title&gt; &lt;/head&gt; &lt;body&gt;&lt;p&gt;Welcome to Vapor!&lt;/p&gt;&lt;/body&gt; &lt;/html&gt; æ³¨é‡Š #// Say hello to the user Hello, #(name)! #/* Say hello to the user */ Hello, #(name)! æ—¥æœŸ render(..., [&quot;now&quot;: Date()]) //In leaf The time is #date(now) The date is #date(now, &quot;yyyy-MM-dd&quot;) å¤§å°å†™ #capitalize(name) //é¦–å­—æ¯å¤§å†™ #uppercase(name) #lowercase(name) åŒ…å« //#contains #if(contains(planets, &quot;Earth&quot;)) &#123; Earth is here! &#125; else &#123; Earth is not in this array. &#125; è®¡æ•° Your search matched #count(matches) pages. //è¿”å›žæ•°ç»„çš„å…ƒç´ ä¸ªæ•° è‡ªå®šä¹‰æ ‡ç­¾ å®žçŽ°TagRenderer final class NowTag: TagRenderer &#123; init() &#123; &#125; func render(tag: TagContext) throws -&gt; EventLoopFuture&lt;TemplateData&gt; &#123; let formatter = DateFormatter() switch tag.parameters.count &#123; case 0: formatter.dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot; case 1: guard let string = tag.parameters[0].string else &#123; throw ... &#125; formatter.dateFormat = string default: throw ... &#125; let string = formatter.string(from: .init()) return tag.container.future(.string(string)) &#125; &#125; é…ç½®æ ‡ç­¾ services.register &#123; container -&gt; LeafTagConfig in var config = LeafTagConfig.default() config.use(NowTag(), as: &quot;now&quot;) return config &#125; ä½¿ç”¨æ•ˆæžœ The time is #now()]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>leaf</tag>
        <tag>view</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆäº”ï¼‰ç½‘ç»œç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E4%BA%94%EF%BC%89%E7%BD%91%E7%BB%9C%E7%AF%87%2F</url>
    <content type="text"><![CDATA[è¿™ç¯‡ä¸»è¦å†…å®¹æ˜¯å†ä»‹ç»ä¸€ä¸‹Routeçš„é€šç”¨æ–¹æ³•ï¼Œç½‘ç»œä¼ è¾“æ•°æ®çš„ç¼–ç æ ¼å¼ï¼ŒVaporä¸­HTTPæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜Žï¼Œä»¥åŠWebSocketã€‚ RouteRouting (vapor/routing)æ˜¯åƒHTTPè¯·æ±‚ä¸€æ ·å¯»æ‰¾æŸäº›ä¸œè¥¿è·¯å¾„çš„ä¸€ä¸ªåº“ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨åµŒå¥—ã€åŠ¨æ€è·¯å¾„ç»„ä»¶çš„è·¯ç”±å™¨æ³¨å†Œæˆ–æŸ¥æ‰¾è·¯ç”±ã€‚ æ”¶é›†åŠ¨æ€ç»„ä»¶å€¼çš„è·¯ç”±è¯·æ±‚å¦‚ä¸‹ï¼ˆç»„ä»¶ä¹‹é—´æ˜¯ç‹¬ç«‹çš„å…³ç³»ï¼Œä»£è¡¨æœ‰userså’Œcommentsä¸¤ä¸ªç»„ä»¶ï¼Œä¹Ÿå¯ä»¥åˆ†åˆ«å•ç‹¬è¯·æ±‚ï¼‰ /users/:user_id/comments/:comment_id é€šå¸¸ä¼šä½¿ç”¨åƒHTTPå“åº”è¿™ç±»åž‹ä½œä¸ºTriRouterçš„æ³›åž‹ï¼Œè¿™é‡Œä¸ºç®€å•æ¼”ç¤ºä½¿ç”¨äº†Doubleã€‚ // Create a router that stores Doubles let router = TrieRouter(Double.self) // Register some routes and values to the router router.register(route: Route(path: [&quot;funny&quot;, &quot;meaning_of_universe&quot;], output: 42)) router.register(route: Route(path: [&quot;funny&quot;, &quot;leet&quot;], output: 1337)) router.register(route: Route(path: [&quot;math&quot;, &quot;pi&quot;], output: 3.14)) // Create empty Parameters to hold dynamic params (none yet) var params = Parameters() // Test fetching some routes print(router.route(path: [&quot;fun&quot;, &quot;meaning_of_universe&quot;], parameters: &amp;params)) // 42 print(router.route(path: [&quot;foo&quot;], parameters: &amp;params)) // nil ä½¿ç”¨register(â€¦)ç»™è·¯ç”±å™¨æ³¨å†Œè·¯ç”±ï¼Œä½¿ç”¨route(â€¦)æŠ“å–å›žè¯¥è·¯ç”±æ³¨å†Œæ—¶è®¾å®šè¿”å›žçš„å†…å®¹ã€‚ TrieRouter ä½¿ç”¨äº†äºŒå‰æ ‘æŸ¥æ‰¾æ³•å®šä½è·¯ç”±çš„è·¯å¾„ã€‚ æ³¨å†Œä¸€ä¸ªåŠ¨æ€çš„è·¯å¾„ç»„ä»¶ï¼Œä¸‹é¢å±•ç¤ºä¼šå˜åŒ–è·¯å¾„çš„å…¶ä¸­ä¸€éƒ¨åˆ†çš„è¯·æ±‚ /users/:user_id è·¯ç”±è®¾ç½® // Create a route for /users/:user_id let user = Route(path: [.constant(&quot;users&quot;), .parameter(&quot;user_id&quot;)], output: ...) // Create a router and register our route let router = TrieRouter(...) router.register(route: user) // Create empty Parameters to hold dynamic values var params = Parameters() // Route the path /users/42 _ = router.route(path: [&quot;users&quot;, &quot;42&quot;], parameters: &amp;params) // The params contains our dynamic value! print(params) // [&quot;user_id&quot;: &quot;42&quot;] .parameter(â€¦) è®¾å®šçš„å­—ç¬¦ä¸²å°±æ˜¯ç”¨æ¥ä»ŽParametersä¸­æŠ“å–å€¼çš„é”®ã€‚ æ³¨æ„è¿™é‡Œæ¼”ç¤ºæ‰€ç”¨çš„è·¯ç”±å™¨æ˜¯è‡ªå®šä¹‰çš„ï¼Œåº”ä¸Žåº”ç”¨Appä¸­é»˜è®¤çš„EngineRouter.default()åŒºåˆ†å¼€æ¥ã€‚ URL-EncodedURL-Encodedæ˜¯Webé‡Œé¢çš„ä¸€ç§å¹¿æ³›çš„ç¼–ç æ–¹å¼ï¼Œèƒ½åºå°†Webè¡¨å•åºåˆ—åŒ–åŽé€šè¿‡POSTè¯·æ±‚å‘é€å‡ºåŽ»ï¼Œä¹Ÿèƒ½ç”¨äºŽå‘é€ç»“æž„æ•°æ®æˆ–URLçš„æŸ¥è¯¢ï¼Œä½†åªå¯¹å‘é€å°é‡çš„æ•°æ®æ—¶æœ‰æ•ˆï¼Œæ•°æ®ä¹Ÿéœ€è¦æ»¡è¶³percent-encodedï¼Œè€Œä¸Šä¼ æ–‡ä»¶åˆ™å‚ç…§ä¸‹ä¸€ç‚¹çš„Multipartã€‚ è§£ç Body è§£ç  application/x-www-form-urlencoded çš„è¯·æ±‚ form-urlencodedçš„è¯·æ±‚æ ¼å¼ POST /users HTTP/1.1 Content-Type: application/x-www-form-urlencoded name=Vapor&amp;age=3&amp;luckyNumbers[]=5&amp;luckyNumbers[]=7 []æ˜¯ç”¨æ¥ç¼–ç æ•°ç»„çš„ã€‚ å¯¹åº”çš„è¡¨å•æ ¼å¼ &lt;form method=&quot;POST&quot; action=&quot;/users&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;age&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;luckyNumbers[]&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;luckyNumbers[]&quot;&gt; &lt;/form&gt; å¯¹åº”æ¨¡åž‹ import Vapor struct User: Content &#123; var name: String var age: Int var luckyNumbers: [Int] &#125; èŽ·å–æ•°æ® router.post(&quot;users&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in return try req.content.decode(User.self).map(to: HTTPStatus.self) &#123; user in print(user.name) // &quot;Vapor&quot; print(user.age) // 3 print(user.luckyNumbers) // [5, 7] return .ok &#125; &#125; ç¼–ç Body router.get(&quot;multipart&quot;) &#123; req -&gt; User in let res = req.makeResponse() let user = User(name: &quot;Vapor&quot;, age: 3, luckyNumbers: [5, 7]) res.content.encode(user, as: .urlEncodedForm) return user &#125; Multipartå°†è¡¨å•è®¾ä¸ºmultipart/form-dataï¼ŒåŒæ—¶åŠ å…¥æ–‡ä»¶åŸŸï¼Œè€ŒåŽé€šè¿‡HTTPåè®®å°†æ–‡ä»¶å†…å®¹å‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç«¯è¯»å–è¿™ä¸ªåˆ†æ®µ(multipart)çš„æ•°æ®ä¿¡æ¯ï¼Œå°±èƒ½å°†å…¶ä¸­çš„æ–‡ä»¶å†…å®¹æå–å‡ºæ¥ã€‚ POST /users HTTP/1.1 Content-Type: multipart/form-data; boundary=123 --123 Content-Disposition: form-data; name=&quot;name&quot; Vapor --123 Content-Disposition: form-data; name=&quot;age&quot; 3 --123 Content-Disposition: form-data; name=&quot;image&quot;; filename=&quot;droplet.png&quot; &lt;contents of image&gt; --123-- è¿™é‡Œä½¿ç”¨æ ‡è¯†123ä½œä¸ºè¾¹ç•Œ ä¸Šé¢çš„multipartè¯·æ±‚æ ¼å¼å¯¹åº”çš„è¡¨å•æ ¼å¼ä¸º &lt;form method=&quot;POST&quot; action=&quot;/users&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;age&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;image&quot;&gt; &lt;/form&gt; å¯¹åº”çš„æ¨¡åž‹æ ¼å¼ä¸º import Vapor struct User: Content &#123; var name: String var age: Int var image: Data &#125; èŽ·å–æ•°æ® router.post(&quot;users&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in return try req.content.decode(User.self).map(to: HTTPStatus.self) &#123; user in print(user.name) // &quot;Vapor&quot; print(user.age) // 3 print(user.image) // Raw image data return .ok &#125; &#125; è¿™æ ·ï¼ŒPOSTè¿™ä¸ªè¡¨å•åˆ°/usersæ—¶ï¼Œå°±ä¼šæŽ¥æ”¶åˆ°å¯¹åº”çš„æ•°æ®ã€‚ è‹¥éœ€è¦ç”¨åˆ°ç¼–ç æ—¶ï¼Œå¯ä»¥è¿™æ · router.get(&quot;multipart&quot;) &#123; req -&gt; User in let res = req.makeResponse() let user = User(name: &quot;Vapor&quot;, age: 3, image: Data(...)) res.content.encode(user, as: .formData) return user &#125; HTTPClient æŠ“å–Vaporçš„ä¸»é¡µ // Connect a new client to the supplied hostname. let client = try HTTPClient.connect(hostname: &quot;vapor.codes&quot;, on: ...).wait() print(client) // HTTPClient // Create an HTTP request: GET / let httpReq = HTTPRequest(method: .GET, url: &quot;/&quot;) // Send the HTTP request, fetching a response let httpRes = try client.send(httpReq).wait() print(httpRes) // HTTPResponse å¯ä»¥çœ‹åˆ°é¦–å…ˆéœ€è¦è¿žæŽ¥åˆ°ä¸»åŸŸåæ¥åˆ›å»ºclientï¼Œç„¶åŽå†æŒ‡å®šè¯·æ±‚çš„æ–¹å¼å’Œè·¯å¾„ï¼Œæœ€åŽé€šè¿‡clientå‘å‡ºè¯¥è¯·æ±‚ä»Žè€Œå¾—åˆ°å“åº”ã€‚å‘é€è¯·æ±‚å‰Vaporä¼šè‡ªåŠ¨è§£æžåŸŸåä¸Žè·¯å¾„çš„å…³ç³»ã€‚ Server åˆ›å»ºå“åº”è€…HTTPServerResponderï¼Œå®ƒèƒ½ç›´æŽ¥å“åº”è¿žå…¥çš„è¯·æ±‚ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªEchoç¤ºä¾‹ï¼Œç›´æŽ¥å°†è¯·æ±‚çš„å†…å®¹ä½œä¸ºå“åº”å›žç»™å®¢æˆ·ç«¯ï¼Œå®žé™…ä¼šæ ¹æ®å…·ä½“æƒ…å†µå“åº”å…·ä½“å†…å®¹ /// Echoes the request as a response. struct EchoResponder: HTTPServerResponder &#123; /// See `HTTPServerResponder`. func respond(to req: HTTPRequest, on worker: Worker) -&gt; Future&lt;HTTPResponse&gt; &#123; // Create an HTTPResponse with the same body as the HTTPRequest let res = HTTPResponse(body: req.body) // We don&apos;t need to do any async work here, we can just // se the Worker&apos;s event-loop to create a succeeded future. return worker.eventLoop.newSucceededFuture(result: res) &#125; &#125; åˆ›å»ºæœåŠ¡å™¨HTTPServerï¼Œç»‘å®šä¸»åŸŸåã€ç«¯å£ã€å“åº”è€… // Create an EventLoopGroup with an appropriate number // of threads for the system we are running on. let group = MultiThreadedEventLoopGroup(numThreads: System.coreCount) // Make sure to shutdown the group when the application exits. defer &#123; try! group.syncShutdownGracefully() &#125; // Start an HTTPServer using our EchoResponder // We are fine to use `wait()` here since we are on the main thread. let server = try HTTPServer.start( hostname: &quot;localhost&quot;, port: 8123, responder: EchoResponder(), on: group ).wait() // Wait for the server to close (indefinitely). try server.onClose.wait() start(â€¦) æ–¹æ³•ä¼šå¼‚æ­¥è¿”å›žä¸€ä¸ªHTTPServerçš„futureå¯¹è±¡ï¼Œå½“æœåŠ¡å™¨å®Œæˆå¯åŠ¨èµ·æ¥åŽfutureå°±ä¼šå®Œæˆï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ åœ¨ç­‰å¾…æœåŠ¡å™¨å…³é—­çš„futureå®Œæˆæ—¶ï¼Œåº”ç”¨èƒ½ä¸€ç›´åœ¨æ¿€æ´»çŠ¶æ€ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æœåŠ¡å™¨ä¸ä¼šè‡ªå·±å…³é—­ã€‚ message è¯·æ±‚æ¶ˆæ¯ï¼Œä¸»è¦çš„å‚æ•°æ˜¯methodå’Œurl let httpReq = HTTPRequest(method: .GET, url: &quot;/hello&quot;) var httpReq: HTTPRequest = ... httpReq.method = .POST httpReq.url = URL(...) //output GET /hello HTTP/1.1 Content-Length: 0 å“åº”æ¶ˆæ¯ï¼Œä¸»è¦å‚æ•°æ—¶status let httpRes = HTTPResponse(status: .ok, body: &quot;hello&quot;) var httpRes: HTTPResponse = ... httpRes.status = .notFound HTTP/1.1 200 OK Content-Length: 5 Content-Type: text/plain hello statusçš„ç±»åž‹å¯ä»¥å‚è€ƒhttpstatuses.com æ¶ˆæ¯å¤´ï¼Œè‡³å°‘éœ€è¦æœ‰Content-Length æˆ–è€… Transfer-Encoding æ¥å®šä¹‰æ¶ˆæ¯ä½“æœ‰å¤šé•¿ï¼ŒContent-Typeæ¥è§£é‡Šæ¶ˆæ¯ä½“çš„æ•°æ®ç±»åž‹ Content-Length: 5 Content-Type: text/plain var message: HTTPMessage ... message.headers.firstValue(for: .contentLength) // 5 æ¶ˆæ¯ä½“ï¼Œè®¾ç½®æ¶ˆæ¯ä½“ä¼šè‡ªåŠ¨æ›´æ–°Content-Length æˆ–è€… Transfer-Encodingçš„å†…å®¹ var message: HTTPMessage = ... message.body = HTTPBody(string: &quot;Hello, world!&quot;) message.contentType = .plainText var message: HTTPMessage = ... message.body = HTTPBody(string: &quot;&quot;&quot; &#123;&quot;message&quot;: &quot;Hello, world!&quot;&#125; &quot;&quot;&quot;) message.contentType = .json å¯ç¼–ç ï¼ˆCodableï¼‰ HTTPå®šä¹‰ä¸¤ä¸ªä¾¿åˆ©çš„åè®®HTTPMessageEncoderå’ŒHTTPMessageDecoderåŽ»ä½¿ç”¨Codableï¼Œè¿™ä¸¤ä¸ªç¼–è§£ç åè®®å¯ä»¥ç¼–è§£ç è‡ªå®šä¹‰çš„Codableç±»åž‹çš„æ•°æ®åˆ°HTTPçš„æ¶ˆæ¯ä½“ä¸­ï¼Œå¹¶è®¾ç½®é€‚åˆçš„Content Typeåˆ°æ¶ˆæ¯å¤´ã€‚ HTTPé»˜è®¤æ˜¯æä¾›äº†JSONEncoderå’ŒJSONDecoderçš„å®žçŽ°ï¼Œä½†Vaporä¹ŸåŒ…å«äº†å¾ˆå¤šç±»åž‹çš„ç¼–ç æ–¹å¼ struct Greeting: Codable &#123; var message: String &#125; // Create an instance of Greeting let greeting = Greeting(message: &quot;Hello, world!&quot;) // Create a 200 OK response var httpRes = HTTPResponse(status: .ok) // Encode the greeting to the response try JSONEncoder().encode(greeting, to: &amp;httpRes, on: ...) WebSocketä¸ŽHTTPä¸åŒï¼ŒWebSocketså¯ä»¥ä¸€ä¸ªå¼€æ”¾ã€å¯äº¤äº’çš„æ–¹å¼é€šè®¯ï¼Œèƒ½å‘é€æ–‡æœ¬æˆ–äºŒè¿›åˆ¶æ ¼å¼çš„æ¶ˆæ¯ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥åœ¨åŒä¸€æ—¶é—´å‘é€å¤šæ¡æ¶ˆæ¯è€Œæ— éœ€ç­‰å¾…å“åº”ã€‚ä½†å®ƒè¿˜æ˜¯åŸºäºŽHTTPå‘èµ·è®¾ç½®çš„ï¼ˆåœ¨å“åº”å¤´ä¸­å¸¦æœ‰çŠ¶æ€101çš„äº¤æ¢åè®®ï¼‰ã€‚ WebSocketæœåŠ¡å™¨å¯èƒ½åŒæ—¶è¿žæŽ¥ç€ä¸€ä¸ªæˆ–å¤šä¸ªWebSocketå®¢æˆ·ç«¯ï¼ŒWebSocketæœåŠ¡å™¨å»ºç«‹åœ¨HTTPæœåŠ¡å™¨ä¹‹ä¸Šï¼Œå¹¶ä½¿ç”¨HTTPçš„upgradeæœºåˆ¶ã€‚WebSocket servers are built on top of HTTP servers using the HTTP upgrade mechanism. // First, create an HTTPProtocolUpgrader let ws = HTTPServer.webSocketUpgrader(shouldUpgrade: &#123; req in // Returning nil in this closure will reject upgrade if req.url.path == &quot;/deny&quot; &#123; return nil &#125; // Return any additional headers you like, or just empty return [:] &#125;, onUpgrade: &#123; ws, req in // This closure will be called with each new WebSocket client ws.send(&quot;Connected&quot;) ws.onText &#123; ws, string in ws.send(string.reversed()) &#125; &#125;) // Next, create your server, adding the WebSocket upgrader let server = try HTTPServer.start( ... upgraders: [ws], ... ).wait() // Run the server. try server.onClose.wait() shouldUpgradeåœ¨æ”¶åˆ°HTTPçš„å‡çº§è¯·æ±‚åŽå›žè°ƒï¼Œå®ƒå†³å®šäº†upgradeæ˜¯å¦èƒ½å®Œæˆï¼Œè¿”å›žnilåˆ™ä»£è¡¨æ‹’ç»upgradeã€‚onUpgradeåœ¨æ¯ä¸€ä¸ªWebSocketå®¢æˆ·ç«¯è¿žæŽ¥åˆ›å»ºæ—¶å›žè°ƒã€‚ æ³¨æ„ï¼Œupgradeçš„é—­åŒ…å¯èƒ½ä¼šè¢«å¤šä¸ªäº‹ä»¶å¾ªçŽ¯è°ƒç”¨ï¼Œå¦‚æžœå¿…é¡»è®¿é—®å¤–éƒ¨å˜é‡æ—¶åˆ™éœ€è¦é¿å…èµ„æºç«žäº‰ã€‚ å®¢æˆ·ç«¯è¿žæŽ¥åˆ°WebSocketæœåŠ¡ç«¯ï¼Œå°±åƒWebSocketæœåŠ¡ç«¯ä½¿ç”¨HTTPæœåŠ¡ç«¯ä¸€æ ·ï¼ŒWebSocketå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä½¿ç”¨HTTPå®¢æˆ·ç«¯ã€‚ // Create a new WebSocket connected to echo.websocket.org let ws = try HTTPClient.webSocket(hostname: &quot;echo.websocket.org&quot;, on: ...).wait() // Set a new callback for receiving text formatted data. ws.onText &#123; ws, text in print(&quot;Server echo: \(text)&quot;) &#125; // Send a message. ws.send(&quot;Hello, world!&quot;) // Wait for the Websocket to closre. try ws.onClose.wait() Vaporçš„ä¾¿åˆ©WebSocketæ–¹æ³• Vaporçš„WebSocketæœåŠ¡ç«¯å…·æœ‰è·¯ç”±è¯·æ±‚çš„èƒ½åŠ› // Create a new NIO websocket server let wss = NIOWebSocketServer.default() // Add WebSocket upgrade support to GET /echo wss.get(&quot;echo&quot;) &#123; ws, req in // Add a new on text callback ws.onText &#123; ws, text in // Simply echo any received text ws.send(text) &#125; &#125; // Register our server services.register(wss, as: WebSocketServer.self) å¯åŠ¨æœåŠ¡å™¨åŽï¼Œå°±èƒ½å¤Ÿè¿è¡Œä¸€ä¸ªWebSocketçš„upgradeï¼Œé€šè¿‡GET /echoï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå·¥å…·wstaæ¥æµ‹è¯• $ wsta ws://localhost:8080/echo Connected to ws://localhost:8080/echo hello, world! hello, world! èŽ·å–å‚æ•° // Add WebSocket upgrade support to GET /chat/:name wss.get(&quot;chat&quot;, String.parameter) &#123; ws, req in let name = try req.parameters.next(String.self) ws.send(&quot;Welcome, \(name)!&quot;) // ... &#125; $ wsta ws://localhost:8080/chat/Vapor Connected to ws://localhost:8080/chat/Vapor Welcome, Vapor! VaporåŒæ ·æ”¯æŒä½œä¸ºå®¢æˆ·ç«¯åŽ»è¿žæŽ¥WebSocketæœåŠ¡å™¨ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨å®¢æˆ·ç«¯çš„webSocket(...) // connect to echo.websocket.org let done = try app.client().webSocket(&quot;ws://echo.websocket.org&quot;).flatMap &#123; ws -&gt; Future&lt;Void&gt; in // setup an on text callback that will print the echo ws.onText &#123; ws, text in print(&quot;rec: \(text)&quot;) // close the websocket connection after we recv the echo ws.close() &#125; // when the websocket first connects, send message ws.send(&quot;hello, world!&quot;) // return a future that will complete when the websocket closes return ws.onClose &#125; print(done) // Future&lt;Void&gt; // wait for the websocket to close try done.wait()]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>network</tag>
        <tag>http</tag>
        <tag>webSocket</tag>
        <tag>encoded</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆå››ï¼‰éªŒè¯ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E5%9B%9B%EF%BC%89%E9%AA%8C%E8%AF%81%E7%AF%87%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨çš„æœåŠ¡ç«¯çš„éªŒè¯æ–¹å¼æœ‰Cookie-Sessionã€JWTï¼Œä¸‹é¢ä¸»è¦å›´ç»•è¿™ä¸¤ç§éªŒè¯æ–¹å¼è¯´æ˜Žï¼Œé¡ºå¸¦ä¹Ÿä»‹ç»äº†Cookieçš„å¯†ç å’ŒOauth Tokenä¸¤ç§éªŒè¯æ–¹å¼ã€‚ JWTJSON WEB Tokenï¼ˆJWTï¼‰ï¼Œæ˜¯ä¸€ç§åŸºäºŽJSONçš„ã€ç”¨äºŽåœ¨ç½‘ç»œä¸Šå£°æ˜ŽæŸç§ä¸»å¼ çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚JWTé€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆ: å¤´ä¿¡æ¯ï¼ˆheaderï¼‰, æ¶ˆæ¯ä½“ï¼ˆpayloadï¼‰å’Œç­¾åï¼ˆsignatureï¼‰ã€‚ å¤´ä¿¡æ¯: header = &apos;{&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;}&apos;æ¶ˆæ¯ä½“: payload = &apos;{&quot;id&quot;: 42,&quot;name&quot;: &quot;Vapor Developer&quot;}&apos;æœªç­¾åçš„ä»¤ç‰Œç”±base64urlç¼–ç çš„å¤´ä¿¡æ¯å’Œæ¶ˆæ¯ä½“æ‹¼æŽ¥è€Œæˆï¼ˆä½¿ç”¨â€.â€åˆ†éš”ï¼‰ï¼Œç­¾ååˆ™é€šè¿‡ç§æœ‰çš„keyè®¡ç®—è€Œæˆ: key = &apos;secretkey&apos; unsignedToken = encodeBase64(header) + &apos;.&apos; + encodeBase64(payload) signature = HMAC-SHA256(key, unsignedToken) åŽåœ¨æœªç­¾åçš„ä»¤ç‰Œå°¾éƒ¨æ‹¼æŽ¥ä¸Šbase64urlç¼–ç çš„ç­¾åï¼ˆåŒæ ·ä½¿ç”¨â€.â€åˆ†éš”ï¼‰å°±æ˜¯JWTäº†: token = encodeBase64(header) + &apos;.&apos; + encodeBase64(payload) + &apos;.&apos; + encodeBase64(signature) //&lt;header&gt;.&lt;payload&gt;.&lt;signature&gt;å®žçŽ°çš„æ­¥éª¤ä¸€èˆ¬æ˜¯ å®¢æˆ·ç«¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•æœåŠ¡å™¨ï¼› æœåŠ¡ç«¯å¯¹å®¢æˆ·ç«¯èº«ä»½è¿›è¡ŒéªŒè¯ï¼› æœåŠ¡ç«¯å¯¹è¯¥ç”¨æˆ·ç”ŸæˆTokenï¼Œè¿”å›žç»™å®¢æˆ·ç«¯ï¼› å®¢æˆ·ç«¯å°†Tokenä¿å­˜åˆ°æœ¬åœ°æµè§ˆå™¨ï¼Œä¸€èˆ¬ä¿å­˜åˆ°cookieä¸­ï¼› å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œéœ€è¦æºå¸¦è¯¥Tokenï¼› æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åŽï¼Œé¦–å…ˆéªŒè¯Tokenï¼Œä¹‹åŽè¿”å›žæ•°æ®ã€‚ä¼˜ç‚¹æ˜¯æœåŠ¡ç«¯ä¸éœ€è¦ä¿å­˜Tokenï¼Œåªéœ€è¦å¯¹Tokenä¸­æºå¸¦çš„ä¿¡æ¯è¿›è¡ŒéªŒè¯å³å¯ï¼›æ— è®ºå®¢æˆ·ç«¯è®¿é—®åŽå°(é›†ç¾¤ä¸­çš„)çš„å“ªå°æœåŠ¡å™¨ï¼Œåªè¦å¯ä»¥é€šè¿‡ç”¨æˆ·ä¿¡æ¯çš„éªŒè¯å³å¯ã€‚ åˆ›å»ºCodableç±»åž‹çš„æ¨¡åž‹æ¥æ‰¿è½½JWTé‡Œçš„Payload struct User: JWTPayload &#123; var id: Int var name: String func verify(using signer: JWTSigner) throws &#123; // nothing to verify &#125; &#125; JWTçš„è§£æžå’ŒéªŒè¯ import JWT import Vapor router.get(&quot;hello&quot;) &#123; req -&gt; String in // fetches the token from `Authorization: Bearer &lt;token&gt;` header guard let bearer = req.http.headers.bearerAuthorization else &#123; throw Abort(.unauthorized) &#125; // parse JWT from token string, using HS-256 signer let jwt = try JWT&lt;User&gt;(from: bearer.token, verifiedUsing: .hs256(key: &quot;secret&quot;)) return &quot;Hello, \(jwt.payload.name)!&quot; &#125; åˆ›å»ºä¸€ä¸ªJWTç»™å®¢æˆ·ç«¯ä¿å­˜ router.post(&quot;login&quot;) &#123; req -&gt; String in // create payload let user = User(id: 42, name: &quot;Vapor Developer&quot;) // create JWT and sign let data = try JWT(payload: user).sign(using: .hs256(key: &quot;secret&quot;)) return String(data: data, encoding: .utf8) ?? &quot;&quot; &#125; SessionsSessionçš„ä¸­æ–‡ç¿»è¯‘æ˜¯â€œä¼šè¯â€ï¼Œå½“ç”¨æˆ·æ‰“å¼€æŸä¸ªwebåº”ç”¨æ—¶ï¼Œä¾¿ä¸ŽWebæœåŠ¡å™¨äº§ç”Ÿä¸€æ¬¡Sessionã€‚æœåŠ¡å™¨ä½¿ç”¨SessionæŠŠç”¨æˆ·çš„ä¿¡æ¯ï¼ˆTokenã€è´¦å¯†ï¼‰ä¸´æ—¶ä¿å­˜åœ¨äº†æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·ç¦»å¼€ç½‘ç«™åŽSessionä¼šè¢«é”€æ¯ã€‚è¿™ç§ç”¨æˆ·ä¿¡æ¯å­˜å‚¨æ–¹å¼ç›¸å¯¹ç›´æŽ¥å°†ç”¨æˆ·ä¿¡æ¯å­˜åœ¨Cookieæ¥è¯´æ›´å®‰å…¨ã€‚å¯æ˜¯Sessionæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå¦‚æžœwebæœåŠ¡å™¨åšäº†è´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ“ä½œè¯·æ±‚åˆ°äº†å¦ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™Sessionä¼šä¸¢å¤±ã€‚ æˆ–è€…è¯´å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ç™»é™†æˆåŠŸä¹‹åŽï¼ŒæœåŠ¡ç«¯ä¼šç”Ÿæˆä¸€ä¸ªsessionIDè¿”å›žç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°†sessionIDä¿å­˜åˆ°Cookieä¸­ï¼Œå†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶å€™æºå¸¦Cookieä¸­çš„sessionIDåˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šç¼“å­˜è¯¥Sessionï¼ˆä¼šè¯ï¼‰ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶å°†å¤„ç†(sessionIDæ˜ å°„å‡ºç”¨æˆ·ä¿¡æ¯è¿›è¡ŒéªŒè¯)çš„ç»“æžœè¿”å›žç»™å®¢æˆ·ç«¯ï¼Œå®Œæˆé€šä¿¡ã€‚ç¼ºç‚¹æ˜¯è®¿å®¢é‡å¤§æ—¶æœåŠ¡ç«¯éœ€è¦æ¶ˆè€—è¾ƒå¤§ç©ºé—´ä¿å­˜Sessionï¼Œå…¶æ¬¡æ˜¯é›†ç¾¤æœåŠ¡ç«¯ä¸‹éœ€é‡‡ç”¨ç¼“å­˜ä¸€è‡´æ€§æŠ€æœ¯ä¿å­˜Sessionã€‚ ä¸€èˆ¬é€šè¿‡ä¸­é—´ä»¶å®žçŽ°é€»è¾‘åŽæ·»åŠ åœ¨è·¯ç”±ä¸Šã€‚éªŒè¯æ˜¯æ£€éªŒç”¨æˆ·çš„èº«ä»½ï¼Œä¸è¦å’ŒèŽ·å–èµ„æºæƒé™çš„æŽˆæƒæ··æ·†ã€‚ æ·»åŠ é‰´å®šçš„ä¸­é—´ä»¶æœåŠ¡ config.prefer(MemoryKeyedCache.self, for: KeyedCache.self) //ä¼˜å…ˆä½¿ç”¨å†…å­˜ç¼“å­˜ var middlewares = MiddlewareConfig() middlewares.use(SessionsMiddleware.self) // ... services.register(middlewares) æ¨¡åž‹éµå®ˆé‰´å®šåè®® extension User: SessionAuthenticatable &#123; &#125; å…·é‰´å®šèƒ½åŠ›çš„è·¯ç”±å™¨ä»Žè¯·æ±‚å¤´ä¸­å–å‡ºsessionIdï¼Œé‰´å®šè¯·æ±‚çš„ç”¨æˆ· // åˆ›å»ºUserçš„éªŒè¯sessionä¸­é—´ä»¶ let session = User.authSessionsMiddleware() // åˆ›å»ºè¢«ä¸­é—´ä»¶åŒ…è£¹çš„è·¯ç”±å™¨ let auth = router.grouped(session) // åœ¨é—´æŽ¥è·¯ç”±å™¨authä¸­å®žçŽ°è·¯ç”±ï¼Œå¹¶èŽ·å–ä¾›é‰´å®šçš„ä¿¡æ¯è½¬ä¸ºå¯¹åº”çš„æ¨¡åž‹ auth.get(&quot;hello&quot;) &#123; req -&gt; String in let user = try req.requireAuthenticated(User.self) //requireå‰ç¼€ä»£è¡¨åœ¨éªŒè¯å¤±è´¥æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ return &quot;Hello, \(user.name)!&quot; &#125; ç™»å½•çš„è·¯ç”±ï¼Œä¹Ÿå¿…é¡»ä½¿ç”¨é‰´å®šä¸­é—´ä»¶æ‰€æ†ç»‘çš„è·¯ç”±å™¨ä¸­å®žçŽ°ï¼Œå¹¶åœ¨å“åº”å‰å°†ç”¨æˆ·modelä½¿ç”¨.authenticateç¼“å­˜åˆ°æœåŠ¡ç«¯ï¼Œå¦åˆ™åŽé¢(åŒä¸€ä¸ªç”¨æˆ·)é€šè¿‡è¯¥è·¯ç”±å™¨çš„å…¶å®ƒè¯·æ±‚é‡Œçš„éªŒè¯ä¼šæ— æ•ˆ auth.get(&quot;login&quot;) &#123; req -&gt; Future&lt;String&gt; in return User.find(1, on: req).map &#123; user in guard let user = user else &#123; throw Abort(.badRequest) &#125; try req.authenticate(user) return &quot;Logged in&quot; &#125; &#125; ç™»å½•æˆåŠŸåŽï¼Œä¼šå‘çŽ°ä¸€ä¸ªå« â€œvapor-sessionâ€ çš„ Cookie å·²ç»å­˜åœ¨äºŽæµè§ˆå™¨ä¸Šã€‚è€Œåƒ/login/helloè¿™æ ·çš„è®¿é—®è·¯å¾„ï¼Œä¼šå…ˆç™»å½•å†è®¿é—®helloã€‚ Statelessè¿™æ˜¯ä¸€ä¸ªæœ€åˆçº§çš„éªŒè¯æ–¹å¼ã€‚ä¸ºä¿æŠ¤æŽ¥å£ç«¯ç‚¹ï¼Œå¼•å…¥äº†ä¸€ç§æ— çŠ¶æ€éªŒè¯æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸€ç§éªŒè¯ç”¨æˆ·èº«ä»½çš„æ–¹æ³•ï¼Œè€ŒéžèŽ·å–èµ„æºæƒé™çš„æŽˆæƒã€‚ Cookie å¯†ç éªŒè¯ï¼ˆBasicï¼‰ å®žè´¨å°±æ˜¯åˆ©ç”¨Cookieä¿å­˜ç”¨æˆ·åå’Œå¯†ç åœ¨å®¢æˆ·ç«¯ï¼Œåœ¨æ¯æ¬¡è¯·æ±‚æ—¶å¸¦ä¸Šè¿™ä¸ªCookieä½œä¸ºè¯·æ±‚çš„éªŒè¯å¤´ã€‚ åŒ…å«çš„è´¦å·åå’Œå¯†ç ï¼Œæ ¼å¼ä¸º Authorization: Basic base64(username:password)åŒæ—¶éœ€è¦å¯éªŒè¯çš„ç›®æ ‡æ¨¡åž‹éµä»ŽPasswordAuthenticatableï¼Œç»™ä¸­é—´ä»¶æŽ¥å…¥ï¼ˆéœ€è¦æ³¨æ„å¯†ç åº”è¯¥ä½¿ç”¨hashå€¼ï¼‰ extension User: PasswordAuthenticatable &#123; /// See `PasswordAuthenticatable`. static var usernameKey: WritableKeyPath&lt;User, String&gt; &#123; return \.email &#125; /// See `PasswordAuthenticatable`. static var passwordKey: WritableKeyPath&lt;User, String&gt; &#123; return \.passwordHash &#125; &#125; åˆ›å»ºå¯éªŒè¯çš„æ¨¡åž‹åŽï¼Œå°±ä¸ºè¦ä¿æŠ¤çš„è·¯ç”±æ·»åŠ ä¸­é—´ä»¶ï¼ˆåœ¨å®žè·µä¸­è¦ç”¨basicAuthMiddlewareåŽ»åŒ…è£¹authSessionsMiddlewareåŒ…è£¹çš„è·¯ç”±å™¨æ‰èƒ½éªŒè¯æˆåŠŸï¼‰ // Use user model to create an authentication middleware let password = User.basicAuthMiddleware(using: BCryptDigest()) //ä½¿ç”¨ BCryptDigest æ¥éªŒè¯å­˜å‚¨ä¸º BCrypt hashçš„å¯†ç ã€‚ // Create a route closure wrapped by this middleware router.grouped(password).get(&quot;hello&quot;) &#123; req in /// &#125; Oauth TokenéªŒè¯ï¼ˆBearerï¼‰ Tokençš„æ„æ€æ˜¯â€œä»¤ç‰Œâ€ï¼Œæ˜¯ç”¨æˆ·èº«ä»½çš„éªŒè¯æ–¹å¼ï¼Œæœ€ç®€å•çš„Tokenç»„æˆ:uid(ç”¨æˆ·å”¯ä¸€çš„èº«ä»½æ ‡è¯†)ã€time(å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³)ã€sign(ç­¾åï¼Œç”±Tokençš„å‰å‡ ä½+ç›ä»¥å“ˆå¸Œç®—æ³•åŽ‹ç¼©æˆä¸€å®šé•¿çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¯ä»¥é˜²æ­¢æ¶æ„ç¬¬ä¸‰æ–¹æ‹¼æŽ¥Tokenè¯·æ±‚æœåŠ¡å™¨)ã€‚è¿˜å¯ä»¥æŠŠä¸å˜çš„å‚æ•°ä¹Ÿæ”¾è¿›Tokenï¼Œé¿å…å¤šæ¬¡æŸ¥åº“ã€‚ åœ¨æ¯ä¸€ä¸ªè¯·æ±‚APIçš„éªŒè¯å¤´ä¸Šæ·»åŠ ä¸€ä¸ªæš‚æ—¶çš„tokenï¼Œä¸€èˆ¬æ˜¯ Authorization: Bearer hash(uid+timestamp+sign)é¦–å…ˆä½¿å¯éªŒè¯æ¨¡åž‹éµä»ŽAuthenticatableåè®® struct User: Model &#123; var id: Int? var name: String var email: String var passwordHash: String var tokens: Children&lt;User, UserToken&gt; &#123; return children(\.userID) &#125; &#125; extension User: TokenAuthenticatable &#123; /// See `TokenAuthenticatable`. typealias TokenType = UserToken &#125; ç„¶åŽéœ€è¦é¢å¤–å®šä¹‰ä¸€ä¸ªTokenç±» struct UserToken: Model &#123; var id: Int? var string: String var userID: User.ID var user: Parent&lt;UserToken, User&gt; &#123; return parent(\.userID) &#125; &#125; extension UserToken: Token &#123; /// See `Token`. typealias UserType = User /// See `Token`. static var tokenKey: WritableKeyPath&lt;UserToken, String&gt; &#123; return \.string &#125; /// See `Token`. static var userIDKey: WritableKeyPath&lt;UserToken, User.ID&gt; &#123; return \.userID &#125; &#125; æœ€åŽä¸ºè¦ä¿æŠ¤çš„è·¯ç”±æ·»åŠ ä¸­é—´ä»¶ // Use user model to create an authentication middleware let token = User.tokenAuthMiddleware() // Create a route closure wrapped by this middleware router.grouped(token).get(&quot;hello&quot;) &#123; req in let user = try req.requireAuthenticated(User.self) return &quot;Hello, \(user.name).&quot; &#125; Cookie ä¸Ž Session Cookieæ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼ŒSessionæ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚ Cookieä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æžå­˜æ”¾åœ¨æœ¬åœ°çš„Cookieå¹¶è¿›è¡ŒCookieæ¬ºéª—ï¼Œè€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨Sessionã€‚ Sessionä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“è®¿é—®å¢žå¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½ã€‚è€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢çš„è¯ï¼Œåº”å½“ä½¿ç”¨Cookieã€‚ å•ä¸ªCookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4Kï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜20ä¸ªCookieã€‚ ä¸€èˆ¬æƒ…å†µï¼Œå°†ç™»é™†ä¿¡æ¯ç­‰é‡è¦ä¿¡æ¯å­˜æ”¾ä¸ºSessionï¼Œå…¶ä»–ä¿¡æ¯å¦‚æžœéœ€è¦ä¿ç•™ï¼Œå¯ä»¥æ”¾åœ¨Cookieä¸­ã€‚ Token ä¸Ž SessionSession å’Œ Oauth Tokenå¹¶ä¸çŸ›ç›¾ï¼Œä½œä¸ºèº«ä»½è®¤è¯ Tokenå®‰å…¨æ€§æ¯”Sessionå¥½ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½æœ‰ç­¾åè¿˜èƒ½é˜²æ­¢ç›‘å¬ä»¥åŠé‡æ”¾æ”»å‡»ï¼Œè€ŒSessionå°±å¿…é¡»é é“¾è·¯å±‚æ¥ä¿éšœé€šè®¯å®‰å…¨äº†ã€‚å¦‚ä¸Šæ‰€è¯´ï¼Œå¦‚æžœä½ éœ€è¦å®žçŽ°æœ‰çŠ¶æ€çš„ä¼šè¯ï¼Œä»ç„¶å¯ä»¥å¢žåŠ Sessionæ¥åœ¨æœåŠ¡å™¨ç«¯ä¿å­˜ä¸€äº›çŠ¶æ€ã€‚ Appé€šå¸¸ç”¨restful apiè·Ÿserveræ‰“äº¤é“ã€‚Restæ˜¯statelessçš„ï¼Œä¹Ÿå°±æ˜¯Appä¸éœ€è¦åƒbrowseré‚£æ ·ç”¨Cookieæ¥ä¿å­˜Session,å› æ­¤ç”¨session tokenæ¥æ ‡ç¤ºè‡ªå·±å°±å¤Ÿäº†ï¼Œsession/stateç”±api serverçš„é€»è¾‘å¤„ç†ã€‚ å¦‚æžœä½ çš„åŽç«¯ä¸æ˜¯statelessçš„rest api, é‚£ä¹ˆä½ å¯èƒ½éœ€è¦åœ¨Appé‡Œä¿å­˜Sessionã€‚å¯ä»¥åœ¨appé‡ŒåµŒå…¥webkit,ç”¨ä¸€ä¸ªéšè—çš„browseræ¥ç®¡ç†cookie sessionã€‚]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>session</tag>
        <tag>token</tag>
        <tag>verification</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆä¸‰ï¼‰æ•°æ®åº“ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E4%B8%89%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AF%87%2F</url>
    <content type="text"><![CDATA[ä½œä¸ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ²¡æœ‰æ¯”æ•°æ®åº“æ›´é‡è¦çš„ä¸œè¥¿ï¼Œåœ¨Vaporä¸Šæœ‰å¤šç§æ•°æ®åº“æä¾›é€‰æ‹©ï¼Œè€Œä¸”å·²ç»æœ‰è‰¯å¥½çš„å°è£…å’Œä¸­é—´ä»¶ï¼Œç®€å•çš„è°ƒç”¨å°±èƒ½è®¿é—®åˆ°æ•°æ®åº“ï¼ŒåŒæ—¶æ¨ªå‘å…¼å®¹ã€‚ è¿™ç¯‡æ–‡ç« è®²è§£äº†Vaporä¸­å’Œæ•°æ®åº“ç›¸å…³çš„ä¸€äº›é…ç½®ã€æ“ä½œã€åŽŸç†ç­‰çš„å†…å®¹ã€‚ æ•°æ®åº“é€‰åž‹MySQL å’Œ PostgreSQL çš„å¯¹æ¯”ï¼Œç½‘ä¸Šå·²ç»å¾ˆå¤šåˆ†æžï¼Œä¾‹å¦‚è¿™ç¯‡PostgreSQL ä¸Ž MySQL ç›¸æ¯”ï¼Œä¼˜åŠ¿ä½•åœ¨ï¼Ÿã€‚ä¸ºäº†æ„Ÿå—ä¸€ä¸‹æ½®æµï¼Œæˆ‘é€‰æ‹©äº†PostgreSQLæ¥å­¦ä¹ å’Œç»ƒä¹ ã€‚ DatabaseKitConnectionDatabaseKitä¸»è¦è´Ÿè´£åˆ›å»ºã€ç®¡ç†å’Œåˆå¹¶è¿žæŽ¥ã€‚åˆäº†è¿žæŽ¥æˆ‘ä»¬æ‰èƒ½è®¿é—®æ•°æ®åº“ï¼Œè€Œåˆ›å»ºè¿žæŽ¥å¯¹åº”ç”¨æ¥è¯´æ˜¯ä¸€ä»¶éžå¸¸è€—æ—¶çš„ä»»åŠ¡ï¼Œä»¥è‡³äºŽå¾ˆå¤šäº‘æœåŠ¡éƒ½ä¼šé™åˆ¶ä¸€ä¸ªæœåŠ¡èƒ½æ‰“å¼€çš„è¿žæŽ¥æ•°ï¼Œå…³äºŽæ€§èƒ½æ–¹é¢çš„çŸ¥è¯†å¯ä»¥è‡ªè¡ŒåŽ»äº†è§£ã€‚å‚è€ƒ1 å‚è€ƒ2 ç”±è·¯ç”±ä¼ å…¥requestæ¥è¯·æ±‚è¿žæŽ¥æ—¶ï¼Œå¦‚æžœè¿žæŽ¥æ± ä¸­æ²¡æœ‰å¯ç”¨çš„è¿žæŽ¥åˆ™åˆ›å»ºä¸€æ¡æ–°è¿žæŽ¥ï¼Œè‹¥è¿žæŽ¥æ•°è¾¾åˆ°äº†ä¸Šé™åˆ™ç­‰å¾…è¢«é‡Šæ”¾æ”¾å›žçš„è¿žæŽ¥ã€‚ å†è§‚å¯Ÿä¸€ä¸‹Requestå®žçŽ°çš„åè®® public final class Request: ContainerAlias, DatabaseConnectable, HTTPMessageContainer, RequestCodable, CustomStringConvertible, CustomDebugStringConvertible å…¶ä¸­å°±æ˜¯DatabaseConnectableå†³å®šRequestæ‹¥æœ‰è¿žæŽ¥æ•°æ®åº“çš„èƒ½åŠ› // è¯·æ±‚ä¸€æ¡è¿žæŽ¥æ± ä¸­çš„è¿žæŽ¥ï¼Œè¿žåˆ° `.psql` db req.withPooledConnection(to: .psql) &#123; conn in return conn.query(...) // do some db query &#125; ä¸Šé¢æ–¹æ³•ä¸­çš„é—­åŒ…ä¼šåœ¨reqè¯·æ±‚åˆ°æœ‰æ•ˆè¿žæŽ¥æ—¶å›žè°ƒï¼Œè€Œå½“é—­åŒ…è¿”å›žçš„Futureå®Œæˆæ—¶ï¼Œæ­¤è¿žæŽ¥åˆ™ä¼šè‡ªåŠ¨é‡Šæ”¾å›žè¿žæŽ¥æ± ã€‚ å¦‚æžœä½ æƒ³æ‰‹åŠ¨è¯·æ±‚ä¸€æ¡è¿žæŽ¥ï¼Œå°±è¦å¯¹åº”åœ°æ‰‹åŠ¨é‡Šæ”¾æ­¤æ¡è¿žæŽ¥ // Request a connection from the pool and wait for it to be ready. let conn = try app.requestPooledConnection(to: .psql).wait() // Ensure the connection is released when we exit this scope. defer &#123; app.releasePooledConnection(conn, to: .psql) &#125; å¯ä»¥é…ç½®è¿žæŽ¥æ•°æ®åº“çš„è¿žæŽ¥æ±  // Create a new, empty pool config. var poolConfig = DatabaseConnectionPoolConfig() // Set max connections per pool to 8. poolConfig.maxConnections = 8 // Register the pool config. services.register(poolConfig) ä¸ºäº†é¿å…ç«žäº‰çš„çŠ¶å†µå‡ºçŽ°ï¼Œè¿žæŽ¥æ± ç»å¯¹ä¸èƒ½åœ¨äº‹ä»¶å¾ªçŽ¯ä¹‹é—´å…±äº«ä½¿ç”¨ã€‚é€šå¸¸ä¸€ä¸ªè¿žæŽ¥æ± å¯¹åº”ä¸€ä¸ªæ•°æ®åº“å’Œä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ã€‚æ„å‘³ç€åº”ç”¨æ‰“å¼€æŒ‡å®šæ•°æ®åº“çš„è¿žæŽ¥æ•°ä¸º çº¿ç¨‹æ•° * æ± ä¸­çš„æœ€å¤§è¿žæŽ¥æ•°ã€‚ è¿˜å¯ä»¥å•ç‹¬åœ°åˆ›å»ºè¿žæŽ¥ï¼Œä½†å¿…é¡»æ³¨æ„çš„æ˜¯ï¼Œä¸è¦åœ¨è·¯ç”±çš„å›žè°ƒé—­åŒ…ä¸­è¿™æ ·ä½¿ç”¨ï¼Œå› ä¸ºé¢‘ç¹çš„è®¿é—®ä¼šå¯¼è‡´åˆ›å»ºå‡ºå¾ˆå¤šè¿žæŽ¥ï¼Œè€Œç”±è·¯ç”±å›žè°ƒé—­åŒ…è¿”å›žçš„è¿žæŽ¥åˆ™æ˜¯ä»Žè¿žæŽ¥æ± ä¸­èŽ·å–çš„ã€‚ // Creates a new connection to `.sqlite` db ã€‚åŒæ ·ï¼Œä½¿ç”¨é—­åŒ…è¿”å›žè¿žæŽ¥çš„å½¢å¼èƒ½å¤Ÿåœ¨å›žè°ƒæ—¶è‡ªåŠ¨é‡Šæ”¾è¿žæŽ¥ï¼Œåªæ˜¯è¿™é‡Œä¸æ˜¯é‡Šæ”¾åˆ°æ± ä¸­è€Œå·²ã€‚ app.withNewConnection(to: .sqlite) &#123; conn in return conn.query(...) // do some db query &#125; // Creates a new connection to `.sqlite` db ã€‚ éœ€æ‰‹åŠ¨é‡Šæ”¾è¿žæŽ¥ã€‚ let conn = try app.newConnection(to: .sqlite).wait() // Ensure the connection is closed when we exit this scope. defer &#123; conn.close() &#125; Loggingé…ç½®æ•°æ®åº“æ—¥å¿—åŠŸèƒ½ // Enable logging on the SQLite database dbsConfig.enableLogging(for: .sqlite) //æˆ– // Create a custom log handler. let myLogger: DatabaseLogHandler = ... // Enable logging on SQLite w/ custom logger. dbsConfig.enableLogging(for: .sqlite, logger: myLogger) Keyed Cacheé”®ç¼“å­˜ï¼Œæ˜¯å¯é€šè¿‡é”®æ¥èŽ·å–ã€è®¾ç½®å’Œç§»é™¤Codableå€¼çš„æ“ä½œæ–¹å¼ï¼Œæœ‰æ—¶ä¼šç§°ä½œé”®å€¼å‚¨å­˜ã€‚ è¦åˆ›å»ºä¸€ä¸ªé”®ç¼“å­˜ï¼Œéœ€è¦ç”¨åˆ°Containeråè®®ä¸­çš„æ–¹æ³•.keyedCache(for:) // Creates a DatabaseKeyedCache with .redis connection pool let cache = try app.keyedCache(for: .redis) // Sets &quot;hello&quot; = &quot;world&quot; try cache.set(&quot;hello&quot;, to: &quot;world&quot;).wait() // Gets &quot;hello&quot; let world = try cache.get(&quot;hello&quot;, as: String.self).wait() print(world) // &quot;world&quot; // Removes &quot;hello&quot; try cache.remove(&quot;hello&quot;).wait() RedisRedisæ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ã€æ— é˜»å¡žã€å»ºç«‹äºŽSwiftNIOçš„åº“ã€‚å¯ä»¥é€šè¿‡å‘é€Redisçš„å‘½ä»¤ä¸ŽæœåŠ¡ç«¯ç›´æŽ¥äº¤äº’ï¼Œåˆæˆ–è€…é€šè¿‡Vaporçš„KeyedCacheæŽ¥å£æ¥å½“ä½œç¼“å­˜ä½¿ç”¨ã€‚ é…ç½®Redis //SPM let package = Package( name: &quot;MyApp&quot;, dependencies: [ // âš¡ï¸Non-blocking, event-driven Redis client. .package(url: &quot;https://github.com/vapor/redis.git&quot;, from: &quot;3.0.0&quot;), ], targets: [ .target(name: &quot;App&quot;, dependencies: [&quot;Redis&quot;, ...]) ] ) //configure.swift import Redis // register Redis provider try services.register(RedisProvider()) é¦–å…ˆåˆ›å»ºè¿žåˆ°Redisæ•°æ®åº“çš„æ–°è¿žæŽ¥ï¼Œ router.get(&quot;redis&quot;) &#123; req -&gt; Future&lt;String&gt; in return req.withNewConnection(to: .redis) &#123; redis in // send INFO command to redis and map the resulting RedisData to a String return redis.command(&quot;INFO&quot;).map &#123; $0.string ?? &quot;&quot; &#125;//å•è¡Œçš„ç•¥ç®€è¯­æ³• &#125; &#125; Rediså‘½ä»¤é›† Get/Set/Deleteå‘½ä»¤ï¼Œé€šè¿‡è¿™å¯¹å‘½ä»¤å¯ä»¥åœ¨æœåŠ¡ç«¯ï¼ˆä½¿ç”¨key:valueçš„å½¢å¼ï¼‰å­˜å‚¨ã€æå–å’Œåˆ é™¤å¯¹åº”çš„æ•°æ®ï¼Œå¯ä»¥ä¼ å…¥ä»»ä½•Codableç±»åž‹çš„æ•°å€¼ã€‚ router.get(&quot;set&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in // create a new redis connection return req.withNewConnection(to: .redis) &#123; redis in // save a new key/value pair to the cache return redis.set(&quot;hello&quot;, to: &quot;world&quot;) // convert void future to HTTPStatus.ok .transform(to: .ok) &#125; &#125; router.get(&quot;get&quot;) &#123; req -&gt; Future&lt;String&gt; in // create a new redis connection return req.withNewConnection(to: .redis) &#123; redis in // fetch the key/value pair from the cache, decoding a String return redis.get(&quot;hello&quot;, as: String.self) // handle nil case .map &#123; $0 ?? &quot;&quot; &#125; &#125; &#125; router.get(&quot;del&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in // create a new redis connection return req.withNewConnection(to: .redis) &#123; redis in // fetch the key/value pair from the cache, decoding a String return redis.delete(&quot;hello&quot;) // convert void future to HTTPStatus.ok .transform(to: .ok) &#125; &#125; ä¹Ÿå¯å°†Redisä½œä¸ºVapor KeyedCacheåè®®çš„åŽç«¯ router.get(&quot;set&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in let string = try req.query.get(String.self, at: &quot;string&quot;) return try req.keyedCache(for: .redis).set(&quot;string&quot;, to: string) .transform(to: .ok) &#125; router.get(&quot;get&quot;) &#123; req -&gt; Future&lt;String&gt; in return try req.keyedCache(for: .redis).get(&quot;string&quot;, as: String.self) .unwrap(or: Abort(.badRequest, reason: &quot;No string set yet.&quot;)) &#125; FluentFluent æ˜¯ä¸€ä¸ªæž„å»ºORMsï¼ˆObject Relational Mapping å¯¹è±¡å…³ç³»æ˜ å°„ï¼‰çš„æ¡†æž¶ï¼Œé€šè¿‡Fluentèƒ½å¤Ÿæ•´åˆå¤šç§æ•°æ®åº“ï¼Œä½†å®ƒæœ¬èº«å¹¶ä¸æ˜¯ORMï¼Œå®ƒéœ€è¦æ•°æ®åº“æ¥é©±åŠ¨æ‰èƒ½è¿ä½œï¼Œæœ€åˆçš„Fluentä¹Ÿæ˜¯ä¸ºäº†æ•´åˆæž„å»ºNoSQLå’ŒSQLä¸¤ç§æ•°æ®åº“åšè€Œè¯žç”Ÿã€‚ æ•°æ®åº“é©±åŠ¨ï¼ˆDatabase Driverï¼‰å¯ä»¥æœ‰å¤šä¸ªé€‰æ‹©ï¼Œæ¯”å¦‚ MySQLã€SQLiteã€MongoDBã€PostgreSQLã€‚ Vapor 2.0å¯¹åº”çš„ç‰ˆæœ¬åœ¨Vapor2.0çš„æ—¶å€™ï¼ŒDriveræ˜¯é€šè¿‡Provideræ¥å°è£…çš„ï¼Œç„¶åŽVaporç›´æŽ¥ä½¿ç”¨Provideræ¥æ“ä½œæ•°æ®åº“ï¼Œä¾‹å¦‚PostgreSQLProvider import PackageDescription let package = Package( name: &quot;OneVideo-Vapor&quot;, dependencies: [ .Package(url: &quot;https://github.com/vapor/vapor.git&quot;, majorVersion: 2), .Package(url: &quot;https://github.com/vapor/fluent-provider.git&quot;, majorVersion: 1), //å¯ç‹¬ç«‹äºŽVaporä½¿ç”¨ //.Package(url: &quot;https://github.com/vapor/fluent.git&quot;, majorVersion: 2), .Package(url: &quot;https://github.com/vapor/postgresql-provider.git&quot;, majorVersion: 2, minor: 0) ], exclude: [ ... ] ) FluentProviderï¼ˆfluent-provider/fluentï¼‰ç›¸å½“äºŽä¸€å¥—æ ‡å‡†æŽ¥å£ï¼Œæä¾›ç»™Vaporä½¿ç”¨ï¼Œä½œç”¨å°±æ˜¯ä¸Šé¢äº¤ä»£çš„æ•´åˆæ•°æ®åº“ã€æž„å»ºæ•°æ®åº“ã€‚PostgreSQLProviderï¼ˆpostgresql-providerï¼Œå®ƒä¼šå†ä¾èµ–postgresqlï¼‰åˆ™æ˜¯FluentæŽ¥å£ä¸Žé©±åŠ¨postgresqlçš„é€‚é…å™¨ã€ä¸­é—´ä»¶ï¼Œå³æŒ‰Fluentçš„æ ‡å‡†æä¾›ç”±postgresqlæ“ä½œæ•°æ®åº“çš„æŽ¥å£ï¼Œè€ŒVaporæ— æ„ŸçŸ¥ã€‚ è‹¥æƒ³ç›´æŽ¥ä½¿ç”¨PostgreSQLï¼Œä¸ä½¿ç”¨Fluentçš„æƒ…å†µä¸‹åˆ™ import PackageDescription let package = Package( name: &quot;Project&quot;, dependencies: [ ... .Package(url: &quot;https://github.com/vapor/postgresql.git&quot;, majorVersion: 2) ], exclude: [ ... ] ) Vapor 3.0å¯¹åº”çš„ç‰ˆæœ¬å¤§è‡´ä¸Šä¸Ž2.0çš„æ“ä½œå¥—è·¯ä¸€æ ·ï¼Œåªæ˜¯åº“åŒ…çš„åç§°æœ‰æ‰€å˜åŒ–ï¼ŒåŒæ ·æ‹¿PostgreSQLä¸¾ä¾‹ // swift-tools-version:4.0 import PackageDescription let package = Package( name: &quot;MyApp&quot;, dependencies: [ /// Any other dependencies ... .package(url: &quot;https://github.com/vapor/fluent-postgresql.git&quot;, from: &quot;1.0.0&quot;), ], targets: [ .target(name: &quot;App&quot;, dependencies: [&quot;FluentPostgreSQL&quot;, ...]), .target(name: &quot;Run&quot;, dependencies: [&quot;App&quot;]), .testTarget(name: &quot;AppTests&quot;, dependencies: [&quot;App&quot;]), ] ) ä»¥å‰çš„Provider/Driverå«åšäº†FluentPostgreSQL(ä»ç„¶ä¼šä¾èµ–postgresql)ï¼Œè¿™æ ·å‘½åæ›´æ¸…æ™°ç›´è§‚ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯éµå¾ªFluentçš„é©±åŠ¨ï¼ŒåŽåŠéƒ¨åˆ†çš„å‘½ååˆ™æ˜¯å…·ä½“é©±åŠ¨çš„æ•°æ®åº“ç±»åž‹ã€‚ ä½†ä¸ä¸€å®šæ¯ä¸ªDriveréƒ½æœ‰Providerï¼Œä¹Ÿä¸ä¸€å®šæ¯ä¸ªDriverçš„Provideréƒ½æ»¡è¶³æœ€æ–°ç‰ˆæœ¬çš„Vaporï¼Œå…·ä½“è¦çœ‹ç¤¾åŒºåœ¨Vaporä½¿ç”¨æŸç§æ•°æ®åº“çš„è´¡çŒ®ç¨‹åº¦ã€‚ å¦‚æžœåªæƒ³å¼•ç”¨PostgreSQLè€Œä¸ç”¨Fluentçš„è¯ï¼Œåˆ™ let package = Package( name: &quot;MyApp&quot;, dependencies: [ // ðŸ˜ Non-blocking, event-driven Swift client for PostgreSQL. .package(url: &quot;https://github.com/vapor/postgresql.git&quot;, from: &quot;1.0.0&quot;), ], targets: [ .target(name: &quot;App&quot;, dependencies: [&quot;PostgreSQL&quot;, ...]), ... ] ) Modelä½¿ç”¨æ¨¡åž‹åŽ»æŸ¥è¯¢æ•°æ®åº“ï¼Œè¿”å›žçš„ç»“æžœæ˜¯ç¡®å®šç±»åž‹çš„é›†åˆï¼Œè€Œä¸åƒå…¶å®ƒORMè¯­è¨€è¿”å›žçš„æ˜¯ä¸ç¡®å®šç±»åž‹çš„é›†åˆã€‚ä¸åŒçš„æ•°æ®åº“é©±åŠ¨æä¾›äº†å…¶å¯¹åº”çš„ä¾¿åˆ©æ¨¡åž‹ï¼Œä¾‹å¦‚PostgreSQLModelã€‚ 1.å®šä¹‰ä¸€ä¸ªæ¨¡åž‹ //å¿…é¡»ä½¿ç”¨finalä¿®é¥°ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¾—æ›´é€šé… final class User&lt;D&gt;: Model where D: Database final class User: Model &#123; /// See `Model.Database`ã€‚æŒ‡å®šæ•°æ®åº“ï¼Œä½¿Fluentå¯ä»¥åŠ¨æ€åœ°æ·»åŠ åˆé€‚çš„æ–¹æ³•å’Œæ•°æ®ç±»åž‹åˆ°`QueryBuilder`ï¼Œè‹¥ä½¿ç”¨é€šé…çš„æ–¹å¼å®šä¹‰æ¨¡åž‹æ—¶åº”å†™æˆ typealias Database = D typealias Database = FooDatabase /// See `Model.ID`ã€‚æŒ‡å®šIDçš„ç±»åž‹ typealias ID = Int /// See `Model.idKey`ã€‚æŒ‡å®šIDå±žæ€§çš„KeyPathï¼Œä¸”å¿…é¡»æŒ‡å‘ä¸€ä¸ªOptionalç±»åž‹çš„å±žæ€§ã€‚ static let idKey: IDKey = \.id /// The unique identifier for this user. æ¨¡åž‹çš„å”¯ä¸€æ ‡è¯†ï¼Œå³IDå±žæ€§ var id: Int? var name: String var age: Int /// Creates a new user. å¿…é¡»å®žçŽ°çš„åˆå§‹åŒ–æ–¹æ³• init(id: Int? = nil, name: String, age: Int) &#123; self.id = id self.name = name self.age = age &#125; &#125; Fluent 3 å°±æ˜¯è¿™æ ·è®¾è®¡æˆè®©æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡åž‹å’Œé©±åŠ¨çš„è”ç³»æ¥é©¾é©­æ•°æ®åº“çš„åŠ›é‡ã€‚ 2.æ¨¡åž‹çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• willCreate didCreate willUpdate didUpdate willRead willDelete final class User: Model &#123; /// ... /// See `Model.willUpdate(on:)` func willUpdate(on connection: Database.Connection) throws -&gt; Future&lt;Self&gt; &#123; /// Throws an error if the username is invalid try validateUsername() /// Return the user. No async work is being done, so we must create a future manually. return Future.map(on: connection) &#123; self &#125; &#125; &#125; 3.å¢žåˆ æ”¹æŸ¥(CRUD)CRUD (create, read, update, delete) //åœ¨æ¨¡åž‹çš„æ•°æ®åº“ä¸­å¢žåŠ ä¸€æ¡è®°å½•ï¼Œå½“æ¨¡åž‹æ²¡æœ‰IDæ—¶è°ƒç”¨.save(on:)ä¼šè½¬ä¸ºè°ƒç”¨è¯¥æ–¹æ³• //è‹¥æ¨¡åž‹ä¸ºå€¼ç±»åž‹(struct)çš„æ—¶å€™ï¼Œ.create(on:)è¿”å›žçš„æ¨¡åž‹ä¼šå¸¦ä¸Šæ–°çš„ID let didCreate = user.create(on: req) print(didCreate) /// Future&lt;User&gt; ///æ‰¾å‡ºID == 1çš„é‚£ä¸ªæ¨¡åž‹ let user = User.find(1, on: req) print(user) /// Future&lt;User?&gt; ///æ‰¾å‡ºæ‰€æœ‰nameä¸º&quot;Vapor&quot;çš„æ¨¡åž‹ let users = User.query(on: req).filter(\.name == &quot;Vapor&quot;).all() print(users) /// Future&lt;[User]&gt; ///æ›´æ–°æ¨¡åž‹ï¼Œå¦‚æžœå·²ç»æœ‰IDåˆ™åœ¨è°ƒç”¨.save(on:)æ—¶ä¼šè½¬ä¸ºè°ƒç”¨è¯¥æ–¹æ³• let didUpdate = user.update(on: req) print(didUpdate) /// Future&lt;User&gt; ///åˆ é™¤æ¨¡åž‹ let didDelete = user.delete(on: req) print(didDelete) /// Future&lt;Void&gt; ///èŽ·å–å”¯ä¸€çš„IDæˆ–æŠ›å‡ºå¼‚å¸¸ let id = try user.requireID() è¦æŸ¥è¯¢æ•°æ®ï¼Œé¦–å…ˆè¦è¿žæŽ¥æ•°æ®åº“ï¼Œæœ€ç®€å•çš„è¿žæŽ¥æ–¹å¼å°±æ˜¯ä½¿ç”¨è·¯ç”±è¿”å›žçš„Requestï¼Œå®ƒä¼šä½¿ç”¨æ¨¡åž‹çš„defaultDatabaseå±žæ€§ä½œä¸ºè¿žæŽ¥ç›®æ ‡ï¼Œç„¶åŽè‡ªåŠ¨æŠ“å–ä¸€ä¸ªåˆå¹¶äº†è¯¥æ•°æ®åº“çš„è¿žæŽ¥ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨Containerå®¹å™¨ä¸Šä½¿ç”¨ä¾¿åˆ©æ–¹æ³•æ¥æ‰‹åŠ¨åˆ›å»ºè¿žæŽ¥ã€‚è¯¦ç»†çš„æŸ¥è¯¢æ–¹æ³•åœ¨ä¸‹é¢çš„ PostgreqSQLä¸€èŠ‚å†ä½œä»‹ç»ã€‚ä½†æ˜¯æš‚æ—¶è¿˜ä¸æ”¯æŒUnionæŸ¥è¯¢ã€‚ Migrationç„¶åŽåœ¨Vapor3.0çš„Fluenté‡Œè¿˜å¢žåŠ äº†ä¸€ä¸ªå«Migrationçš„æ¦‚å¿µï¼Œå…¶å®žå°±æ˜¯ä¸€ä¸ªå¯ä½¿æ¨¡åž‹çš„å±žæ€§è¢«åŠ¨æ€è¯†åˆ«çš„åè®®ï¼ˆå»ºç«‹å±žæ€§ä¸Žæ•°æ®è¡¨å„å­—æ®µçš„å…³è”ï¼‰ï¼Œä¸ä¸€å®šå¿…é¡»æ‰©å±•Modelç±»åž‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåªè¦ä¹Ÿéµå¾ªModelåè®®Fluentå°±èƒ½è‡ªåŠ¨æŽ¨æ–­å‡ºæ¨¡åž‹å„å±žæ€§åŠå…¶ç±»åž‹å¹¶å®žçŽ°äº†prepareå’Œrevertæ–¹æ³• //User.swift import FluentPostgreSQL import Vapor final class User: PostgreSQLModel &#123; typealias Database = PostgreSQLDatabase typealias ID = Int var id: ID? var name: String init(id: ID? = nil, name: String) &#123; self.id = id self.name = name &#125; &#125; extension User: PostgreSQLMigration &#123; &#125; //configure.swift var migrations = MigrationConfig() migrations.add(model: User.self, database: .psql) services.register(migrations) å…¶å®ƒæƒ…å†µä¸‹å¯ä»¥é‡å†™prepareæ–¹æ³•åœ¨å‡†å¤‡åˆ›å»ºæ•°æ®è¡¨å‰é€šè¿‡builderå£°æ˜ŽåŠåˆ›å»ºè‡ªå®šä¹‰éœ€è¦çš„å­—æ®µï¼Œæˆ–åœ¨revertæ–¹æ³•ä¸­åˆ é™¤åºŸå¼ƒçš„å­—æ®µæˆ–æ•°æ®è¡¨ã€‚ //User.swift extension User: PostgreSQLMigration &#123; //è®¿é—®æ•°æ®è¡¨å‰æ‰§è¡Œ static func prepare(on conn: PostgreSQLConnection) -&gt; Future&lt;Void&gt; &#123; //åˆ›å»ºæ•°æ®è¡¨ return PostgreSQLDatabase.create(User.self, on: conn) &#123; builder in builder.field(for: \.id, isIdentifier: true) builder.field(for: \.name) //try builder.field(for: \.name, type: &lt;#DataType#&gt;) //æŒ‡å®šå­—æ®µçš„ç±»åž‹ &#125; //ç»“åˆåˆ¤æ–­å‘å¸ƒçš„ç‰ˆæœ¬çš„é€»è¾‘ï¼Œæ›´æ–°å·²æœ‰æ•°æ®è¡¨çš„å­—æ®µ return PostgreSQLDatabase.update(User.self, on: conn) &#123; builder in builder.field(for: \.mass) //å½“ç„¶æ¨¡åž‹éœ€è¦æ–°å¢žä¸Šè¿™ä¸ªå±žæ€§ builder.deleteField(for: \.name) &#125; //æ ¹æ®æ¡ä»¶ä¿®æ”¹æ“ä½œ return Galaxy.query(on: conn).filter(\.mass == 0).delete() &#125; //å¯åŠ¨åº”ç”¨æ—¶æ‰§è¡Œ static func revert(on connection: PostgreSQLConnection) -&gt; Future&lt;Void&gt; &#123; return PostgreSQLDatabase.delete(User.self, on: connection) //ç›´æŽ¥è¿”å›žä¸€ä¸ªé¢„å…ˆå®Œæˆçš„future return conn.future(()) &#125; &#125; //configure.swift var migrations = MigrationConfig() migrations.add(migration: CreateGalaxy.self, database: .psql) services.register(migrations) PostgreSQLçš„å­—æ®µç±»åž‹(DataType) æ³¨æ„ï¼Œè®¾ç½®è‡ªå®šä¹‰çš„Migrationéœ€è¦ä½¿ç”¨add(migration:database:)è¿™ä¸ªæ–¹æ³•ã€‚ RelationFluentæ”¯æŒä¸¤ç§å…³ç³»æ¨¡åž‹ï¼Œåˆ†åˆ«æ˜¯å•å¯¹å¤šï¼ˆçˆ¶-å­ parent-childï¼‰å’Œå¤šå¯¹å¤šï¼ˆåŒè¾ˆ siblingsï¼‰ã€‚ å•å¯¹å¤šç¤ºä¾‹ //çˆ¶æ¨¡åž‹ extension Galaxy &#123; // this galaxy&apos;s related planets var planets: Children&lt;Galaxy, Planet&gt; &#123; return children(\.galaxyID) &#125; &#125; //å­æ¨¡åž‹ extension Planet &#123; // this planet&apos;s related galaxy var galaxy: Parent&lt;Planet, Galaxy&gt; &#123; return parent(\.galaxyID) &#125; &#125; let galaxy: Galaxy = ... let planets = galaxy.planets.query(on: ...).all()//å³æ˜¯åœ¨Planetä¸­æŸ¥å‡ºå«è¯¥galaxyçš„IDçš„æ¨¡åž‹ let planet: Planet = ... let galaxy = planet.galaxy.get(on: ...)//ç›´æŽ¥æŸ¥å‡ºplanetå¯¹åº”çš„galaxyï¼ˆæ ¹æ®planetä¸­çš„galaxyçš„IDï¼‰ å¤šå¯¹å¤šç¤ºä¾‹ struct PlanetTag: Pivot &#123; // ... typealias Left = Planet typealias Right = Tag //åˆ©ç”¨å¯¹åº”çš„keyPathï¼ŒæŒ‡å®šå…³ç³»çš„ä¾æ® static var leftIDKey: LeftIDKey = \.planetID static var rightIDKey: RightIDKey = \.tagID var id: Int? var planetID: Int var tagID: Int &#125; extension Planet &#123; // this planet&apos;s related tags ï¼Œ&lt;From, To, Through&gt; var tags: Siblings&lt;Planet, Tag, PlanetTag&gt; &#123; return siblings() &#125; &#125; extension Tag &#123; // all planets that have this tag ï¼Œ&lt;From, To, Through&gt; var planets: Siblings&lt;Tag, Planet, PlanetTag&gt; &#123; return siblings() &#125; &#125; let planet: Planet = ... planet.tags.query(on: ...).all() //æä¾›ä¸­é€”æ’å…¥å…³ç³»çš„æ–¹æ³• extension PlanetTag: ModifiablePivot &#123; init(_ planet: Planet, _ tag: Tag) throws &#123; planetID = try planet.requireID() tagID = try tag.requireID() &#125; &#125; let planet: Planet = ... let tag: Tag = ... planet.tags.attach(tag, on: ...) å®˜æ–¹è¯´æ˜Žéœ€æ±‚æ¡ˆä¾‹ Transactionäº‹åŠ¡ï¼Œåœ¨å…¶æœªå®Œæˆå‰ï¼Œæ•°æ®ä¸ä¼šè¢«ä¿å­˜åˆ°æ•°æ®åº“ã€‚ var userA: User = ... var userB: User = ... return req.transaction(on: .&lt;#dbid#&gt;) &#123; conn in return userA.save(on: conn).flatMap &#123; _ in return userB.save(on: conn) &#125;.transform(to: HTTPStatus.ok) &#125; ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºï¼Œåªè¦userAæˆ–userBæœ‰ä¸€ä¸ªsaveå¤±è´¥ï¼Œåˆ™å‡ä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“ã€‚äº‹åŠ¡ä¸€å®Œæˆï¼Œç»“æžœå°±ä¼šè½¬æ¢æˆHTTPçš„çŠ¶æ€å“åº”ã€‚ PostgreSQLPostgreSQL æ˜¯å»ºç«‹åœ¨ SwiftNIO åº“ä¹‹ä¸Šçš„ä¸€ä¸ªçº¯Swiftåº“ã€‚å®ƒæ¯” Fluent ORM ä½Žä¸€çº§ï¼Œæ˜¯Providerå’ŒDriverçš„ä¸»è¦åŠŸèƒ½å®žçŽ°è€…ï¼Œä½†ç‹¬ç«‹äºŽå°è£…å®ƒçš„Fluent Provider/Driverã€‚å³ä½¿æ˜¯è¿™æ ·ï¼ŒPostgreSQL è¿˜æ‰©å±•äº†DatabaseKitçš„è¿žæŽ¥æ± å’Œäº¤äº’æŽ¥å£ã€Vaporçš„æœåŠ¡æž¶æž„ã€‚ å½“ä½ æœ‰ä»¥ä¸‹æ¡ä»¶æˆ–éœ€æ±‚æ—¶ï¼Œå¯ä»¥è·¨è¿‡Provider/Driverç›´æŽ¥ä½¿ç”¨å®ƒ æ‹¥æœ‰éžæ ‡å‡†ç»“æž„çš„æ•°æ®åº“ ä¾èµ–äºŽå¤æ‚æˆ–é‡åº¦è‡ªå®šä¹‰çš„SQLè¯­å¥æŸ¥è¯¢ ä¸å–œæ¬¢ORM ä½†è¿™é‡Œä»¥FluentPostgreSQLä»‹ç»PostgreSQLçš„åº”ç”¨ã€‚ å…ˆå°†çŽ¯å¢ƒæ­å»ºç„¶åŽåœ¨é¡¹ç›®ä¸­å¼•ç”¨ä¹‹ã€‚ å®‰è£…ä¸Žå¯åŠ¨//å®‰è£…postgresql brew install postgresql //å¼€å¯postgresqlæ–¹å¼ä¸€ brew services start postgresql //å¼€å¯postgresqlæ–¹å¼äºŒ pg_ctl -D /usr/local/var/postgres start //å¼€å¯postgresqlæ–¹å¼ä¸‰ postgres -D /usr/local/var/postgres/ //å…³é—­postgresql pg_ctl -D /usr/local/var/postgres stop -s -m fast é…ç½®//é…ç½®æ•°æ®å­˜æ”¾ç›®å½• initdb /usr/local/var/postgres -E utf8 //é…ç½®å¼€æœºå¯åŠ¨postgresql ln -sfv /usr/local/opt/postgresql/*.plist ~/Library/LaunchAgents launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist createuser username -P #Enter password for new role: #Enter it again: ä½¿ç”¨//åˆ›å»ºæ•°æ®åº“ createdb [-U username] dbname //åˆ é™¤æ•°æ®åº“ dropdb [-U username] dbname //åˆ›å»ºæ•°æ®åº“å¹¶æŒ‡å®šæ‹¥æœ‰è€…å’Œç¼–ç æ ¼å¼ï¼ˆåŠæ˜¾ç¤ºæ“ä½œæŒ‡ä»¤ï¼‰ createdb dbname -O username -E UTF8 -e //æŸ¥çœ‹å·²åˆ›å»ºçš„æ•°æ®åº“ psql -l //è¿žæŽ¥æ•°æ®åº“ psql dbname //ä½¿ç”¨é»˜è®¤ç”¨æˆ·è¿žæŽ¥(å½“å‰Macè´¦å·ç™»å…¥) psql -U username -d dbname -h 127.0.0.1 psql (9.6.2) Type &quot;help&quot; for help. //æ˜¾ç¤ºå·²åˆ›å»ºçš„æ•°æ®åº“ dbname=# \l //è¿žæŽ¥æ•°æ®åº“ dbname=# \c dbname //æ˜¾ç¤ºæ•°æ®åº“è¡¨ dbname=# \d //é€€å‡ºå½“å‰çš„æ•°æ®åº“è¿žæŽ¥ dbname=# \q //åˆ›å»ºè¡¨ï¼ˆå¹¶æŒ‡å®šæ‹¥æœ‰è€…ï¼‰ dbname=# CREATE TABLE test(id int, text VARCHAR(50)) [ OWNER [ = ] user_name ]; //æ’å…¥è®°å½• dbname=# INSERT INTO test(id, text) VALUES(1, &apos;sdfsfsfsdfsdfdf&apos;); //æŸ¥è¯¢è®°å½• dbname=# SELECT * FROM test WHERE id = 1; //æ›´æ–°è®°å½• dbname=# UPDATE test SET text = &apos;xx&apos; WHERE id = 1; //åˆ é™¤è®°å½• dbname=# DELETE FROM test WHERE id = 1; //åˆ é™¤è¡¨ dbname=# DROP TABLE test; //åˆ é™¤æ•°æ®åº“ dbname=# DROP DATABASE dbname; è¯¦ç»†å¯å‚è€ƒPostgreSQLæ–°æ‰‹å…¥é—¨PostgreSQL ç»“æž„åŠæƒé™ ç®¡ç†ä¸‹è½½pgAdmin4ï¼Œæ·»åŠ æ•°æ®åº“åˆ°pgAdmin4å‰åº”å…ˆç¡®è®¤è´¦å·å’Œæ•°æ®åº“å‡å·²åˆ›å»ºå¥½ã€‚ æ·»åŠ Server æŒ‡å®šServerçš„æ•°æ®åº“ æŸ¥çœ‹æ•°æ®è¡¨ å®‰è£…åŽä¼šåœ¨è¿™ä¸ªåœ°å€ä¸­ http://127.0.0.1:49707/browser/ å¯åŠ¨ pgAdmin4ã€‚ åº”ç”¨ä¸Šè¿°çš„æ­¥éª¤å®ŒæˆåŽï¼Œæ„å‘³ç€æˆ‘ä»¬æ­å»ºå¥½äº†ä½¿ç”¨PostgreSQLçš„çŽ¯å¢ƒã€‚è€Œè¦ä½¿ç”¨å®ƒè¿˜éœ€è¦åœ¨é¡¹ç›®ä¸­è¿›è¡Œé…ç½®ï¼Œ æ³¨å†ŒæœåŠ¡ //in configure.swift. import FluentPostgreSQL import Vapor // Register providers first try services.register(FluentPostgreSQLProvider()) // è‹¥ä¸ä½¿ç”¨Fluentçš„æ³¨å†Œå¦‚ä¸‹ try services.register(PostgreSQLProvider()) æ·»åŠ æ•°æ®åº“é…ç½® // Configure a PostgreSQL database. è¿™é‡Œæ— è®ºæ˜¯ç›´æŽ¥ä½¿ç”¨PostgreSQLè¿˜æ˜¯Fluentï¼Œéƒ½æ˜¯ä¸€æ ·çš„é…ç½®æ–¹å¼ let postgreSql = PostgreSQLDatabase(config: PostgreSQLDatabaseConfig(hostname: &quot;localhost&quot;, username: &quot;xx&quot;)) /// Register the configured PostgreSQL database to the database config. var databases = DatabasesConfig() databases.add(database: postgresql, as: .psql) services.register(databases) æ•°æ®åº“æ“ä½œ //ä¿å­˜ä¸€ä¸ªæ¨¡åž‹å¯¹è±¡ï¼Œè¿”å›žå¸¦IDã€é»˜è®¤å€¼å­—æ®µçš„æ¨¡åž‹å¯¹è±¡ router.post(&quot;galaxies&quot;) &#123; req in let galaxy: Galaxy = ... //æ³¨æ„ï¼Œreqæ˜¯å®žçŽ°äº†DatabaseConnectableåè®®çš„å¯¹è±¡ï¼Œåœ¨è¯¥å‚æ•°ä¸­æ‰®æ¼”çš„è§’è‰²å®žè´¨æ˜¯connectioné“¾æŽ¥ï¼Œè¿™ä¸€å¥çš„ä»£ç æè¿°åº”è¯¥æ˜¯ï¼šâ€œå°†æ¨¡åž‹é€šè¿‡è¿žæŽ¥åˆ›å»ºåˆ°æ•°æ®åº“ä¸­åŽ»â€ return galaxy.create(on: req) &#125; //æŸ¥æ‰¾ Galaxy.find(42, on: conn) Galaxy.find(42, on: conn).unwrap(or: Abort(...)) Galaxy.query(on: conn).filter(\.name == &quot;Milky Way&quot;) Galaxy.query(on: conn).filter(\.mass &gt;= 500).filter(\.type == .spiral)//å‰åŽçš„filteré“¾å½¢æˆä¸Žçš„å…³ç³» Galaxy.query(on: conn).group(.or) &#123; $0.filter(\.mass &lt;= 250).filter(\.mass &gt;= 500) &#125;.filter(\.type == .spiral)//é€‰æ‹©filteré“¾çš„å…³ç³» Galaxy.query(on: conn).range(..&lt;50) Galaxy.query(on: conn).sort(\.name, .descending) Galaxy.query(on: conn).join(\Planet.galaxyID, to: \Galaxy.id) .filter(\Planet.name == &quot;Earth&quot;) //åˆå¹¶è¡¨æŸ¥æ‰¾ï¼Œæ‰¾å‡ºæ‰€æœ‰planet nameä¸ºEarthçš„galaxyï¼ˆPlanetçš„è¡¨åˆå¹¶åˆ°GalaxyåŽï¼Œåœ¨Galaxyæ–°å¢žçš„Planetå±žæ€§ä¸­è¿‡æ»¤ï¼‰ (join and filter).alsoDecode(Planet.self).all()//å¯¹ç­›é€‰çš„ç»“æžœè½¬æ¢å›žåˆå¹¶å‰çš„æ¨¡åž‹ç¼–ç ï¼Œä½¿ç”¨(Galaxy, Planet)å…ƒç¥–ç±»åž‹è¿”å›žã€‚ Galaxy.query(on: conn).all() Galaxy.query(on: conn).range(..&lt;50).all() Galaxy.query(on: conn).chunk(max: 32) &#123; galaxies in print(galaxies) // Array of 32 or less galaxies &#125; Galaxy.query(on: conn).filter(\.name == &quot;Milky Way&quot;).first() //æ›´æ–° var planet: Planet ... // fetched from database planet.name = &quot;Earth&quot; planet.update(on: conn) //åˆ é™¤ var planet: Planet ... // fetched from database planet.delete(on: conn) è‹¥ä¸ä½¿ç”¨ Fluent çš„æƒ…å†µï¼ˆæ˜¯çš„ï¼Œä¼šéº»çƒ¦ç‚¹ï¼‰ï¼Œåˆ™ struct PostgreSQLVersion: Codable &#123; let version: String &#125; router.get(&quot;sql&quot;) &#123; req in return req.withPooledConnection(to: .psql) &#123; conn in return conn.raw(&quot;SELECT version()&quot;) .all(decoding: PostgreSQLVersion.self) &#125;.map &#123; rows in return rows[0].version &#125; &#125; SQLæœ€åŽï¼Œçœ‹çœ‹SQLçš„åº”ç”¨ï¼Œå®ƒåœ¨Vaporé‡Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº“ï¼ˆvapor/sqlï¼‰ï¼Œæä¾›äº†åœ¨Swiftä¸­çš„åºåˆ—åŒ–SQLæŸ¥è¯¢åŠŸèƒ½ï¼Œå®žçŽ°çš„ä¸»è¦åè®®åŒ…æ‹¬DQLã€DMLã€DDLï¼Œä¸Šé¢ä»‹ç»çš„ç»„ä»¶å‡åŸºäºŽå®ƒæ¥å®žçŽ°æŸ¥è¯¢ã€‚ æ”¯æŒçš„æŸ¥è¯¢æœ‰ SELECT, INSERT, UPDATE, DELETE CREATE TABLE, ALTER TABLE, DROP TABLE CREATE INDEX, DROP INDEX ä¾‹å¦‚SELECTè¿™ä¸ªæ–¹æ³•ï¼Œå®ƒæ”¯æŒ , columns, and expressions like functions FROM JOIN GROUP BY ORDER BY SELECT * FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;name&quot; = ? å¯¹åº”çš„vapor/sqlå®žçŽ°å°±æ˜¯ struct User: SQLTable, Codable &#123; static let sqlTableIdentifierString = &quot;users&quot; let id: Int? let name: String &#125; router.get(&quot;sql&quot;) &#123; req in return req.withPooledConnection(to: .psql) &#123; conn in let users = conn.select() .all().from(User.self) .where(\User.name == &quot;Vapor&quot;) .all(decoding: User.self) print(users) // Future&lt;[User]&gt; return users// use conn to perform a query &#125; &#125;]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>database</tag>
        <tag>postgreSQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆäºŒï¼‰è¿›é˜¶ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E4%BA%8C%EF%BC%89%E8%BF%9B%E9%98%B6%E7%AF%87%2F</url>
    <content type="text"><![CDATA[ç»è¿‡äº†è§£åŸºç¡€çš„æ¦‚å¿µåŽï¼Œå¯ä»¥å†æ·±ä¸€æ­¥æ¥äº†è§£è¿™äº›æ¦‚å¿µå­˜åœ¨çš„æ„ä¹‰å’Œæ‰©å±•çš„ä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬Serviceã€Clientã€Contentã€Sessionã€‚ ServiceServiceæ˜¯ä¸€ä¸ªä¾èµ–æ³¨å…¥çš„æ¡†æž¶ï¼Œä»¥å¯ç»´æŠ¤çš„æ–¹å¼æ¥è¿›è¡Œæ³¨å†Œã€é…ç½®å’Œåˆ›å»ºåº”ç”¨ä¾èµ–ã€‚å…¶å®žVaporé‡Œçš„è¿™ä¸ªServiceçš„æ¦‚å¿µæœ‰ç‚¹åƒiOSé‡Œé¢ç»„ä»¶åŒ–çš„è§£è€¦æ–¹æ¡ˆï¼Œä½¿ç”¨è·¯ç”±æˆ–è€…åè®®å»ºç«‹èµ·ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒï¼ŒåŽ»ç»™æœ‰åŠŸèƒ½è°ƒç”¨éœ€æ±‚çš„åœ°æ–¹åˆ†å‘æœåŠ¡ã€‚é‚£åº”ç”¨åˆ°çš„ç»„ä»¶å°±ä¸ä¼šæ•£è½åœ¨é¡¹ç›®çš„å„å¤„ï¼ŒåŒæ—¶å¯ä»¥é’ˆå¯¹è‡ªå·±éœ€è¦çš„æƒ…æ™¯ã€åŠŸèƒ½æ¥é…ç½®ã€é€‰æ‹©å¯¹åº”çš„æœåŠ¡ã€‚ æ³¨å†ŒæœåŠ¡ é¦–å…ˆéµä»Žä¸€ä¸ªç©ºçš„åè®®Serviceï¼ˆæ‹¿PrintLoggeræ¥ä¸¾ä¾‹ï¼‰ extension PrintLogger: Service &#123; &#125; ç„¶åŽåœ¨configure.swiftå°†å®žçŽ°æœåŠ¡çš„ç±»æ³¨å†Œåˆ°Servicesç»“æž„ä½“ä¸­ï¼Œä½¿ç”¨å·¥åŽ‚æ–¹æ³•åŠ¨æ€åœ°åˆ›å»ºæœåŠ¡ services.register(Logger.self) &#123; container in return PrintLogger() &#125; å¦å¤–ï¼Œéµä»Žå¹¶å®žçŽ°ServiceTypeåè®®åŽå¯ä»¥æ›´ç®€å•åœ°æ³¨å†ŒæœåŠ¡ extension PrintLogger: ServiceType &#123; /// See `ServiceType`. static var serviceSupports: [Any.Type] &#123; return [Logger.self] &#125; /// See `ServiceType`. static func makeService(for worker: Container) throws -&gt; PrintLogger &#123; return PrintLogger() &#125; &#125; //In configure.swift services.register(PrintLogger.self) ç”šè‡³å¯ä»¥æŒ‡å®šæ³¨å†Œçš„å®žä¾‹å¯¹è±¡ services.register(PrintLogger(), as: Logger.self) æ³¨æ„ï¼Œå¦‚æžœä½¿ç”¨å¼•ç”¨ç±»åž‹ï¼ˆclassï¼‰æ¥æ³¨å†ŒæœåŠ¡çš„è¯ï¼Œé‚£ä¹ˆæ‰€æœ‰å®¹å™¨Containerå’Œå­å®¹å™¨SubContaineréƒ½ä¼šå…±äº«è¿™ä¸€ä¸ªç±»åž‹çš„è¿™ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶è¦å°å¿ƒèµ„æºç«žäº‰çš„é—®é¢˜ã€‚ é…ç½®æœåŠ¡ å¦‚æžœåŒä¸€ä¸ªæŽ¥å£æ³¨å†Œäº†å¤šä¸ªæœåŠ¡ï¼Œåˆ™éœ€è¦æŒ‡å®šä¼˜å…ˆçš„é€‰æ‹© services.register(PrintLogger.self) services.register(FileLogger.self) switch env &#123; case .production: config.prefer(FileLogger.self, for: Logger.self) default: config.prefer(PrintLogger.self, for: Logger.self) &#125; å½“ç„¶ï¼Œé€šè¿‡çŽ¯å¢ƒå˜é‡å°±èƒ½åŠ¨æ€åœ°å†³å®šæ³¨å†Œçš„æœåŠ¡ï¼Œè€Œæ— éœ€ä½¿ç”¨åˆ°é…ç½®ï¼ˆconfigï¼‰ã€‚ åˆ›å»ºæœåŠ¡ å½“ä½ æ³¨å†Œè¿‡æœåŠ¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨å®¹å™¨Containeræ¥åˆ›å»ºæœåŠ¡ let logger = try someContainer.make(Logger.self) logger.log(&quot;Hello, world!&quot;) // PrintLogger or FileLogger depending on the container&apos;s environment print(type(of: logger)) Provider é€šè¿‡Provideråè®®å¯ä»¥æ›´ç®€å•åœ°æ•´åˆå¤–éƒ¨æœåŠ¡åˆ°å½“å‰åº”ç”¨ã€‚åƒæ‰€æœ‰çš„Vaporå®˜æ–¹åŒ…éƒ½ä½¿ç”¨å®ƒæ¥å±•ç¤ºå®ƒä»¬çš„æœåŠ¡ã€‚Providerå¯ä»¥ç”¨æ¥æ³¨å†Œåˆ°Servicesç»“æž„ä½“ä¸­ï¼Œå¯ä»¥å‹¾è¿›å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚ import Foo try services.register(FooProvider()) Vaporçš„ç¬¬ä¸‰æ–¹åº“ä¸€èˆ¬éƒ½ä¼šé€‰æ‹©å®žçŽ°å®ƒæ¥ç»„ç»‡ä»£ç  public final class LoggerProvider: Provider &#123; /// See `Provider`. public func register(_ services: inout Services) throws &#123; services.register(PrintLogger.self) services.register(FileLogger.self) &#125; /// See `Provider`. public func didBoot(_ container: Container) throws -&gt; Future&lt;Void&gt; &#123; let logger = try container.make(Logger.self) logger.log(&quot;Hello from LoggerProvider!&quot;) return .done(on: container) &#125; &#125; å®žçŽ°Provideråè®®åŽï¼Œå½“æ³¨å†ŒLoggerProvideråˆ°åº”ç”¨çš„Servicesç»“æž„ä½“ä¸­ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨æ³¨å†Œä¸Šé¢çš„ä¸¤ä¸ªæœåŠ¡ã€‚åŒæ—¶å½“å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥éªŒè¯provideræ˜¯å¦å·²ç»æ·»åŠ ï¼ˆæ³¨å†ŒæœåŠ¡ï¼‰äº†ã€‚ Clientä½œä¸ºå®¢æˆ·ç«¯ä½¿ç”¨æ—¶ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªæœåŠ¡å®¹å™¨ï¼ˆContainerï¼‰æ¥åˆ›å»ºå®¢æˆ·ç«¯ã€‚é€šå¸¸å¦‚æžœåƒè¿›å…¥ä½ æœåŠ¡å™¨çš„è¯·æ±‚ç»“æžœä¸€æ ·è¯·æ±‚å¤–éƒ¨APIï¼Œä½ å°±åº”è¯¥ä½¿ç”¨è¯·æ±‚å®¹å™¨æ¥åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ let res = try req.client().get(&quot;http://vapor.codes&quot;) print(res) // Future&lt;Response&gt; åªè¦å®¹å™¨ï¼ˆappã€reqï¼‰å°±èƒ½åˆ›å»ºå®¢æˆ·ç«¯ // Creates a generic Client let client = try container.client() å‘é€è¯·æ±‚ let req: Request ... let res = try client.send(req) print(res) // Future&lt;Response&gt; let user: User ... let res = try client.post(&quot;http://api.vapor.codes/users&quot;) &#123; post in try post.content.encode(user) &#125; print(res) // Future&lt;Response&gt; Contentæœ‰å¯¹åº”çš„ç¼–ç å™¨æˆ–è§£ç å™¨æŒ‡å®šï¼Œæ¨¡åž‹æ‰ä¼šæŒ‰ç‰¹å®šçš„åºåˆ—å½¢å¼åœ¨HTTPä¸Šè¿›è¡Œé€šè®¯ã€‚ å› ä¸ºæ‰€æœ‰çš„HTTPè¯·æ±‚éƒ½å¿…é¡»åŒ…å«content typeï¼Œæ‰€ä»¥Vaporèƒ½æ ¹æ®è¿™è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ç¼–ç å™¨æˆ–è€…æŠ¥é”™ã€‚åŒæ—¶ä¹Ÿå¯ä»¥åœ¨åº”ç”¨çš„é…ç½®è®¾å®šVaporé»˜è®¤çš„ç¼–ç å™¨å’Œè§£ç å™¨ /// Create default content config var contentConfig = ContentConfig.default() /// Create custom JSON encoder var jsonEncoder = JSONEncoder() jsonEncoder.dateEncodingStrategy = .millisecondsSince1970 /// Register JSON encoder and content config contentConfig.use(encoder: jsonEncoder, for: .json) services.register(contentConfig) ä¾¿åˆ©è§£ç ä¸ºäº†æ›´æ–¹ä¾¿è§£ç HTTPè¯·æ±‚ï¼ŒVaporæä¾›äº†æ‰©å±•çš„Routeræ–¹æ³• //åŽŸå§‹æ–¹æ³• router.post(&quot;login&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in return req.content.decode(LoginRequest.self).map(to: HTTPStatus.self) &#123; loginRequest in print(loginRequest.email) // user@vapor.codes print(loginRequest.password) // don&apos;t look! return .ok &#125; &#125; //æ•ˆæžœåŒä¸Šçš„ä¾¿åˆ©æ–¹æ³• router.post(LoginRequest.self, at: &quot;login&quot;) &#123; req, loginRequest in print(loginRequest.email) // user@vapor.codes print(loginRequest.password) // don&apos;t look! return HTTPStatus.ok &#125; ç±»åž‹æ£€æµ‹ è‡ªå®šä¹‰è§£ç å™¨å’Œç¼–ç å™¨ï¼ˆé»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯ä¼šä½¿ç”¨JSONè§£ç å™¨æˆ–è€…ç¼–ç å™¨ï¼‰ let user = try req.content.decode(User.self, using: JSONDecoder()) print(user) // Future&lt;User&gt; try res.content.encode(user, as: .urlEncodedForm) å“åº”é»˜è®¤è¿”å›žçš„æ˜¯200 OKçš„çŠ¶æ€ç ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œè‡ªå®šä¹‰ //é»˜è®¤ router.get(&quot;user&quot;) &#123; req -&gt; User in return User(name: &quot;Vapor User&quot;, email: &quot;user@vapor.codes&quot;) &#125; //è‡ªå®šä¹‰ router.get(&quot;user&quot;) &#123; req -&gt; Future&lt;Response&gt; in return User(name: &quot;Vapor User&quot;, email: &quot;user@vapor.codes&quot;).encode(status: .created) &#125; //æˆ–è€…è‡ªå®šä¹‰ struct User: Content &#123; /// See `Content`. static let defaultContentType: MediaType = .urlEncodedForm ... &#125; å®¢æˆ·ç«¯ å®¢æˆ·ç«¯çš„HTTPç¼–ç å°±åƒæœåŠ¡ç«¯è¿”å›žçš„HTTPå“åº”ç¼–ç ä¸€æ ·ã€‚ //ç¼–ç åŽçš„è¯·æ±‚ POST /login HTTP/1.1 Host: api.vapor.codes Content-Type: application/json &#123; &quot;email&quot;: &quot;user@vapor.codes&quot;, &quot;password&quot;: &quot;don&apos;t look!&quot; &#125; //å‘èµ·ç¼–ç çš„æ¨¡åž‹ import Vapor struct LoginRequest: Content &#123; var email: String var password: String &#125; //ç¼–ç HTTPè¯·æ±‚ let loginRequest = LoginRequest(email: &quot;user@vapor.codes&quot;, password: &quot;don&apos;t look!&quot;) let res = try req.client().post(&quot;https://api.vapor.codes/login&quot;) &#123; loginReq in // encode the loginRequest before sending try loginReq.content.encode(loginRequest) &#125; print(res) // Future&lt;Response&gt; //è§£ç å‰çš„å“åº” HTTP/1.1 200 OK Content-Type: application/json &#123; &quot;name&quot;: &quot;Vapor User&quot;, &quot;email&quot;: &quot;user@vapor.codes&quot; &#125; //æŽ¥æ”¶è§£ç çš„æ¨¡åž‹ import Vapor struct User: Content &#123; var name: String var email: String &#125; //è§£ç HTTPå“åº” let res: Future&lt;Response&gt; // from the Client let user = res.flatMap &#123; try $0.content.decode(User.self) &#125; print(user) // Future&lt;User&gt; æ•´ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚å’ŒæŽ¥æ”¶å“åº”çš„ç¤ºä¾‹ // Create the LoginRequest data let loginRequest = LoginRequest(email: &quot;user@vapor.codes&quot;, password: &quot;don&apos;t look!&quot;) // POST /login let user = try req.client().post(&quot;https://api.vapor.codes/login&quot;) &#123; loginReq in // Encode Content before Request is sent return try loginReq.content.encode(loginRequest) &#125;.flatMap &#123; loginRes in // Decode Content after Response is received return try loginRes.content.decode(User.self) &#125; print(user) // Future&lt;User&gt; Query Stringå½“æ˜Žç¡®è¯·æ±‚ä½¿ç”¨çš„ç¼–ç æ˜¯URL-Encoded Formæ—¶ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨æ‰€æœ‰Requestéƒ½åŒ…å«æœ‰çš„QueryContaineræ¥è§£ç Query Stringï¼Œå¯¹ç¼–ç ä¹Ÿä¸€æ · struct Flags: Content &#123; var search: String? var isAdmin: Bool? &#125; let flags = try req.query.decode(Flags.self) print(flags) // Flags let flags: Flags ... try req.query.encode(flags) ä¾¿åˆ©JSONç”±äºŽæœ‰éƒ¨åˆ†æ•°æ®çš„ç¼–ç æ²¡æœ‰è§„èŒƒæ ‡å‡†ï¼Œæ‰€ä»¥Vaporè®©è‡ªå®šä¹‰çš„JSONè§£ç å™¨æ›´æ–¹ä¾¿åœ°å¤„ç†è¿™äº›æ•°æ® // Conforms to Encodable let user: User ... // Encode JSON using custom date encoding strategy try req.content.encode(json: user, using: .custom(dates: .millisecondsSince1970)) // Decode JSON using custom date encoding strategy let user = try req.content.decode(json: User.self, using: .custom(dates: .millisecondsSince1970)) åŠ¨æ€å±žæ€§ä¸ºå“åº”æ·»åŠ å±žæ€§è¿™æ ·çš„å¤„ç†ï¼Œå³æ˜¯å¤„ç†Contentï¼Œæ˜¯å®Œå…¨åŸºäºŽCodableçš„ã€‚ Sessionsession ä¸»è¦æ˜¯ç»´æŠ¤å®¢æˆ·ç«¯çš„è¿žæŽ¥çŠ¶æ€ï¼Œå…¶é€šè¿‡ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºå”¯ä¸€æ ‡è¯†ï¼Œå¹¶è¦æ±‚å®¢æˆ·ç«¯åœ¨æ¯ä¸€æ¬¡è¯·æ±‚ä¸­æä¾›è¿™ä¸ªæ ‡è¯†ã€‚è¿™ä¸ªæ ‡è¯†å¯ä»¥åˆ©ç”¨ä»»ä½•çš„æ ¼å¼ä¼ é€’ï¼Œä½†åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨cookiesæ¥å®Œæˆã€‚ å½“ä¸€ä¸ªæ–°å®¢æˆ·ç«¯çš„è¿žæŽ¥å’Œsessionæ•°æ®è®¾ç½®åŽï¼ŒVaporè¿”å›žä¸€ä¸ªç”¨äºŽè®¾ç½®Cookieheaderçš„å€¼ï¼Œç„¶åŽå®¢æˆ·ç«¯å°±ä¼šè¢«è¦æ±‚åœ¨æ¯æ¬¡è¯·æ±‚çš„Cookieheaderä¸Šé‡å¤è¿”å›žè¯¥å€¼ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½ä¼šè‡ªåŠ¨å®Œæˆè¿™ä¸ªæµç¨‹ã€‚å¦‚æžœä½ æƒ³è®©sessionå¤±æ•ˆï¼ŒVaporå°±ä¼šåˆ é™¤ç›¸å…³çš„æ‰€æœ‰æ•°æ®å¹¶é€šçŸ¥å®¢æˆ·ç«¯å®ƒä»¬çš„cookieå·²ç»ä¸å†æœ‰æ•ˆã€‚ è¦å®žçŽ°sessionçš„åŠŸèƒ½ï¼Œé¦–å…ˆè¦å°†ä¸­é—´ä»¶MiddlewareConfigé…ç½®åˆ°å…¨å±€ //In configure.swift. var middlewares = MiddlewareConfig.default() middlewares.use(SessionsMiddleware.self) services.register(middlewares) ç„¶åŽåœ¨æ¯ä¸ªè·¯ç”±ä¸­ä½¿ç”¨grouped(...)æ–¹æ³• // create a grouped router at /sessions w/ sessions enabled let sessions = router.grouped(&quot;sessions&quot;).grouped(SessionsMiddleware.self) // create a route at GET /sessions/foo sessions.get(&quot;foo&quot;) &#123; req in // use sessions &#125; Vapor é»˜è®¤ä¸‹ä¼šå°†sessionsä¿æŒåœ¨å†…å­˜ï¼Œä¹Ÿå¯ä»¥åœ¨é…ç½®ä¸­é‡å†™è¿™ä¸ªå½¢å¼ã€‚è¿˜èƒ½ä½¿ç”¨Fluentçš„æ•°æ®åº“æˆ–ç¼“å­˜æ¥æŒä¹…åŒ–sessionsã€‚ å½“ä¸­é—´ä»¶ç”Ÿæ•ˆåŽï¼Œå°±å¯ä»¥ä½¿ç”¨req.session()åŽ»è®¿é—® // create a route at GET /sessions/get sessions.get(&quot;get&quot;) &#123; req -&gt; String in // access &quot;name&quot; from session or return n/a return try req.session()[&quot;name&quot;] ?? &quot;n/a&quot; &#125; // create a route at GET /sessions/set/:name sessions.get(&quot;set&quot;, String.parameter) &#123; req -&gt; String in // get router param let name = try req.parameters.next(String.self) // set name to session at key &quot;name&quot; try req.session()[&quot;name&quot;] = name // return the newly set name return name &#125; // create a route at GET /sessions/del sessions.get(&quot;del&quot;) &#123; req -&gt; String in // destroy the session try req.destroySession() // signal success return &quot;done&quot; &#125;]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporçš„éƒ¨ç½²]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%E7%9A%84%E9%83%A8%E7%BD%B2%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘è®¡åˆ’æ­ä¸ªåŽç«¯ï¼Œå¼€å§‹å®žè·µSwiftçš„åŽå°å¼€å‘ï¼Œå€Ÿæ­¤äº†è§£åŽå°æ•°æ®åº“çš„æ“ä½œï¼Œä¸ºä¹‹åŽå­¦ä¹ å‰ç«¯å’Œåœ¨å®¢æˆ·ç«¯æžç‚¹äº‹æƒ…æ—¶åšä¸€äº›æŽ¥å£çš„å‡†å¤‡ã€‚ æ‰è¿‡åŽ»äº†å‡ ä¸ªæœˆï¼ŒVaporå°±å‡çº§åˆ°3.0ç‰ˆæœ¬ï¼Œè¿˜æä¾›äº†ä»–ä»¬è‡ªå®¶çš„äº‘ç«¯ Vapor Cloudï¼Œé€šè¿‡ Vapor tool å°±å¯ç®€å•åœ°å°†å·¥ç¨‹éƒ¨ç½²ä¸ŠåŽ»ã€‚ åŒæ—¶ï¼Œåœ¨Swift4.0ä¸Šï¼Œéƒ¨ç½²åˆ°Herokuçš„ä¸€äº›æ“ä½œç»†èŠ‚ä¹Ÿä¸ä¸€æ ·äº†ï¼Œä¸‹é¢å°±æ¥è®²è¿°ä¸€ä¸‹éƒ¨ç½²åˆ°è¿™ä¸¤ä¸ªå¹³å°çš„æ­¥éª¤ Vapor Cloudå®˜æ–¹æ–‡æ¡£åœ¨æ­¤ 1.å…ˆ build å¥½å·¥ç¨‹ï¼Œç„¶åŽè¿è¡Œçœ‹çœ‹æ˜¯å¦æ­£å¸¸ï¼ˆvapor run serverè¯¥æ–¹æ³•å·²ç»è¢«æŠ›å¼ƒï¼Œä½¿ç”¨vapor xcode -yï¼Œåœ¨Xcodeä¸Šè¿è¡Œä»£æ›¿ï¼‰ç¼–è¯‘æ—¶è‹¥æç¤º â€“enable-prefetching option is unavailable in swift 4.1 åˆ™éœ€æ£€æŸ¥Package.swiftä¸­æŒ‡å®šçš„Vaporç‰ˆæœ¬æ˜¯å¦å¯¹åº”å½“å‰çš„Swiftç‰ˆæœ¬ï¼Œå³ä½¿ç”¨æœ€æ–°çš„Vapor toolåˆ›å»ºçš„å·¥ç¨‹ï¼Œé»˜è®¤é…ç½®çš„éƒ½å¯èƒ½å¯¹åº”ä¸ä¸Šï¼Œè¿™é‡Œå°†3.0.0æ”¹ä¸º3.0.6å°±è§£å†³äº† let package = Package( name: &quot;SavingThePlanet&quot;, dependencies: [ .package(url: &quot;https://github.com/vapor/vapor.git&quot;, from: &quot;3.0.6&quot;), .package(url: &quot;https://github.com/vapor/fluent-sqlite.git&quot;, from: &quot;3.0.0&quot;) ], targets: [ .target(name: &quot;App&quot;, dependencies: [&quot;FluentSQLite&quot;, &quot;Vapor&quot;]), .target(name: &quot;Run&quot;, dependencies: [&quot;App&quot;]), .testTarget(name: &quot;AppTests&quot;, dependencies: [&quot;App&quot;]) ] ) 2.æŒ‰ç€æ–‡æ¡£ä¸­çš„æ­¥éª¤ä¸€æ­¥æ­¥é…ç½® å…ˆåœ¨ä»–ä»¬å®¶çš„åŽå°(https://dashboard.vapor.cloud/)æ³¨å†Œè´¦å·ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œåº”ç”¨è¦ä¸Žæœ¬åœ°é¡¹ç›®ç›®å½•åä¸€è‡´ï¼Œ ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°é€šè¿‡æŒ‡ä»¤åˆ›å»ºï¼Œåˆ›å»ºå‰å…ˆç™»å½• vapor cloud login vapor cloud create projéƒ¨ç½²å‰å…ˆä¸ºé¡¹ç›®æ·»åŠ Git ç„¶åŽå¼€å§‹éƒ¨ç½² vapor cloud deployä¸­é€”ä¼šæœ‰å„ç§è¯¢é—® æŒ‡å®šåˆ›å»ºçš„åº”ç”¨å æŒ‡å®šæ¨¡å—å æŒ‡å®šä¸»åŸŸå åˆ›å»ºé¡¹ç›®çŽ¯å¢ƒ æŒ‡å®šéƒ¨ç½²çš„åˆ†æ”¯ æŒ‡å®šå¤åˆ¶å®¹é‡ å¢žåŠ æ•°æ®åº“ï¼ˆå¯é€‰ï¼Œä½¿ç”¨åˆ›å»ºæŒ‡ä»¤æå‰åˆ›å»º vapor cloud create dbï¼‰ æŒ‡å®šæž„å»ºç±»åž‹ å°±è¿™æ ·ï¼Œè½»æ¾éƒ¨ç½²å®Œæ¯•ã€‚ é¡¹ç›®å…¶ä¸­çš„æ–‡ä»¶ cloud.yml æ˜¯ä¸€ä¸ªè®¾ç½®å¯é€‰é¡¹çš„æ‰©å±•é…ç½®æ–‡ä»¶ï¼Œéœ€è¦å¢žåŠ è‡ªå®šä¹‰çš„è®¾ç½®å¯åœ¨ä¸Šé¢æ·»åŠ ã€‚ HerokuçŽ°åœ¨HerokuåŽå°(https://dashboard.heroku.com)æ³¨å†Œè´¦å·ï¼Œç„¶åŽåˆ›å»ºä¸€æ¡pipelineï¼Œå†åœ¨æ­¤piplineä¸Šåˆ›å»ºåº”ç”¨ã€‚ åœ¨åº”ç”¨çš„Settingsåšä¸€äº›çŽ¯å¢ƒé…ç½®ï¼ˆè¿™é‡Œæˆ‘ä½¿ç”¨Githubåšä»“åº“ç®¡ç†ï¼Œæ²¡ç”¨Herokuçš„Gitï¼‰ï¼š æŒ‡å®šGitHub Repo æŒ‡å®šBuildpacksï¼Œäº¤ä»£åº”ç”¨çš„ä¾èµ–åº“å’Œé…ç½®çŽ¯å¢ƒï¼ˆä¸€èˆ¬ä½¿ç”¨ https://github.com/kylef/heroku-buildpack-swift.gitï¼‰ æŒ‡å®šåŸŸåå’ŒSSLï¼ˆå¯é€‰ï¼‰ ç„¶åŽåœ¨åº”ç”¨çš„Deployåšä¸€äº›å‘å¸ƒé…ç½® å‘å¸ƒæ–¹å¼æŒ‡å®šï¼ˆè¿™é‡Œé€‰æ‹©GitHubï¼‰ è‡ªåŠ¨å‘å¸ƒæŒ‡å®šï¼ˆæ ¹æ®Gitçš„pushåŠ¨ä½œè‡ªåŠ¨é‡ç¼–è¯‘å’Œå‘å¸ƒï¼‰ å‘å¸ƒçš„åˆ†æ”¯æŒ‡å®š æœ€åŽï¼Œå°†èƒ½åœ¨æœ¬åœ°é€šè¿‡buildå’Œrunçš„é¡¹ç›®pushåˆ°GitHubï¼ŒActivityé‡Œå°±æœ‰å½“å‰buildçš„è¿›åº¦å’Œæ—¥å¿—æ˜¾ç¤ºï¼Œè®¿é—®Herokuæä¾›çš„é»˜è®¤åŸŸååœ°å€åŽï¼Œåœ¨Moreçš„View logsé‡Œèƒ½çœ‹åˆ°è®¿é—®çš„æƒ…å†µã€‚ ** ç‰¹åˆ«æç¤ºï¼š ** ä¸åŒVaporç‰ˆæœ¬ï¼Œä¸åŒçš„Procfileåœ¨ä½¿ç”¨ Vapor 2 çš„æ—¶å€™ï¼Œé¡¹ç›®æ ¹ç›®å½•ä¸­çš„Procfileæ–‡ä»¶éœ€è¦å¡«å…¥ä»¥ä¸‹å†…å®¹ web: Run â€“env=production â€“port=$PORT åœ¨ä½¿ç”¨ Vapor 3 çš„æ—¶å€™ï¼ŒProcfileåˆ™éœ€è¦å¡«å…¥ä»¥ä¸‹å†…å®¹ web: Run serve --env production --hostname 0.0.0.0 --port $PORTä½¿ç”¨Procfileå¯ä»¥ä¸ºwebæœåŠ¡å™¨è®¾ç½®è¿è¡Œè¿›ç¨‹ã€‚å› ä¸ºä¸€å¼€å§‹ä¸çŸ¥é“Vapor 3ä¸‹çš„é…ç½®æ ¼å¼è€Œä½¿ç”¨äº†Vapor 2çš„æ—§æ ¼å¼é…ç½®ï¼Œå¯¼è‡´å¡äº†å¾ˆä¹…éƒ½æ²¡èƒ½åœ¨äº‘ç«¯è®¿é—®æˆåŠŸï¼ˆå‘å¸ƒæ˜¾ç¤ºæˆåŠŸäº†ï¼‰ï¼Œè®¿é—®æ—¶ä¸€ç›´æç¤ºApplication Errorï¼Œæ—¥å¿—ä¸­æ‰“å°status=503 code=H10/H14 app crashã€‚ è‡ªå®šä¹‰swiftç‰ˆæœ¬åŒæ—¶è¿˜è¦æŒ‡å®šä¸€ä¸ª.swift-versionæ–‡ä»¶ï¼Œé‡Œé¢å¡«å…¥éœ€è¦ä¾èµ–çš„Swiftç‰ˆæœ¬å·ï¼ˆè¿™é‡Œå¡«å…¥4.1.2ï¼‰ï¼ŒåŒæ ·æ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ è¿ç§»é¡¹ç›®ç›®å½•éœ€è¦å…ˆæ¸…æŽ‰åŽ†å²çš„buildï¼Œå†é‡æ–°buildï¼Œå¦åˆ™runä¼šå¤±è´¥ï¼ˆä¸€äº›æ–‡ä»¶ä¸­çš„è·¯å¾„æ²¡æ›´æ–°ï¼‰ vapor build â€“clean æžå®šåŽå†æŽ¨åˆ°GitHubä¸Šï¼Œç­‰å¾…Herokuç¼–è¯‘å’Œå‘å¸ƒï¼Œè®¿é—®æˆåŠŸã€‚éœ€è¦å¤šè°¢è¿™ç¯‡æ–‡ç« çš„æŒ‡å¼•ã€‚]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>heroku</tag>
        <tag>cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vaporï¼ˆä¸€ï¼‰åŸºç¡€ç¯‡]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E7%A1%80%E7%AF%87%2F</url>
    <content type="text"><![CDATA[å…¶å®žè¿™ä¸ªVaporç³»åˆ—çš„æ–‡ç« å’Œå®˜ç½‘ä»‹ç»çš„å·®ä¸å¤šï¼Œä½†ä¸ºäº†åŠ æ·±ä¸ªäººç†è§£å’Œæ–¹ä¾¿æ—¥åŽæŸ¥é˜…ï¼Œè¿˜æ˜¯é€ç‚¹å†æ’¸ä¸€éï¼Œå¹¶ä¸”å°†çŸ¥è¯†ç‚¹åšäº†ä¸€ä¸‹å½’ç±»ã€‚è¿‡ç¨‹ä¸­ä¼šæœ‰ç±»æ¯”åˆ°å…¶å®ƒç³»ç»Ÿã€è¯­è¨€ï¼Œåˆæˆ–è€…æ˜¯æ—§ç‰ˆæœ¬çš„Vaporï¼Œåˆ†æžå®ƒä»¬çš„ç‰¹æ€§ã€è®¾è®¡æ¨¡å¼ç­‰ï¼Œä½¿å­¦ä¹ èµ·æ¥æ›´åŠ èžä¼šè´¯é€šã€‚ ç¬¬ä¸€ç¯‡ï¼Œå…ˆä»‹ç»ä¸€ä¸‹Vaporçš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œåƒæ–‡ä»¶ç»“æž„ã€æœåŠ¡ã€è·¯ç”±ã€å¼‚æ­¥ç­‰ç­‰ã€‚ æ–‡ä»¶ç»“æž„â”œâ”€â”€ Public â”œâ”€â”€ Sources â”‚ â”œâ”€â”€ App â”‚ â”‚ â”œâ”€â”€ Controllers â”‚ â”‚ â”œâ”€â”€ Models â”‚ â”‚ â”œâ”€â”€ boot.swift â”‚ â”‚ â”œâ”€â”€ configure.swift â”‚ â”‚ â””â”€â”€ routes.swift â”‚ â””â”€â”€ Run â”‚ â””â”€â”€ main.swift â”œâ”€â”€ Tests â”‚ â””â”€â”€ AppTests â””â”€â”€ Package.swift PublicPublicæ–‡ä»¶å¤¹ç”¨äºŽå­˜æ”¾æ ·å¼è¡¨ã€å›¾ç‰‡å’Œè„šæœ¬ã€‚å½“Vaporå“åº”ä¸€ä¸ªè¯·æ±‚æ—¶ä¼šä¼˜å…ˆæ£€æŸ¥è¯¥æ–‡ä»¶å¤¹é‡Œæ˜¯å¦æœ‰è¦è¯·æ±‚çš„å†…å®¹ï¼Œæœ‰åˆ™è·³è¿‡åŽå°åº”ç”¨çš„é€»è¾‘å¹¶ç›´æŽ¥ä½¿ç”¨è¯¥æ–‡ä»¶è¿”å›žã€‚ä¾‹å¦‚è¯·æ±‚localhost:8080/favicon.icoï¼Œä¼šæ£€æŸ¥Public/favicon.icoï¼Œæœ‰åˆ™ç›´æŽ¥è¿”å›žã€‚ Appä¸¤ä¸ªå­˜æ”¾æºç çš„åœ°æ–¹ä¹‹ä¸€ï¼Œè¿™æ˜¯æœ€é‡è¦çš„æ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰åŽå°åº”ç”¨çš„é€»è¾‘å‡åœ¨æ­¤å¤„ Controllersï¼šç»„ç»‡åº”ç”¨é€»è¾‘çš„åœ°æ–¹ï¼Œæœ‰å¤§é‡çš„å‡½æ•°æ¥æŽ¥æ”¶è¯·æ±‚å’Œå›žé¦ˆå“åº”ã€‚ Modelsï¼šå­˜æ”¾æ”¯æŒContentç±»åž‹çš„æ¨¡åž‹å’ŒFluentæ¨¡åž‹çš„åœ°æ–¹ã€‚ boot.swiftï¼šåŽå°åº”ç”¨å¯åŠ¨åŽï¼Œä½†åœ¨çœŸæ­£è¿è¡Œå‰ï¼Œä¼šæ‰§è¡Œå…¶ä¸­çš„å‡½æ•°ã€‚é€‚åˆå°†éœ€è¦åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–çš„å·¥ä½œæ”¾åœ¨æ­¤å¤„ã€‚ï¼ˆå¯ä»¥çœ‹ä½œæ˜¯iOS AppDelegateä¸­çš„didFinishLaunchingæ–¹æ³•ï¼‰ configure.swiftï¼šæ­¤å¤„åŒ…å«ä¸€ä¸ªå‡½æ•°ç”¨äºŽæŽ¥æ”¶é…ç½®ã€çŽ¯å¢ƒå’ŒæœåŠ¡ï¼Œç»™åŽå°åº”ç”¨ä½œä¸ºè¾“å…¥ã€‚é€‚åˆå°†æ³¨å†ŒæœåŠ¡æˆ–æ›´æ”¹é…ç½®æ”¾åˆ°æ­¤å¤„æ‰§è¡Œã€‚ routes.swiftï¼šé…ç½®è·¯ç”±çš„åœ°æ–¹ã€‚ AppTestså­˜æ”¾å•å…ƒæµ‹è¯•æ–‡ä»¶çš„åœ°æ–¹ Package.swiftä¾èµ–åŒ…æ¸…å•ã€‚ æœåŠ¡ï¼ˆServicesï¼‰Vaporä½¿ç”¨ä¸ª Services æ˜¯ä¸€ä¸ªä¾èµ–æ³¨å…¥å¼çš„æ¡†æž¶ï¼Œåœ¨åº”ç”¨é‡Œå¯ä»¥é€šè¿‡å®ƒæ¥æ³¨å†Œã€é…ç½®ã€åˆå§‹åŒ–ä»»ä½•éœ€è¦çš„å†…å®¹ã€‚ Vaporä¸æ”¯æŒé™æ€è®¿é—®ï¼Œè‹¥è¦è®¿é—®ä¸€ä¸ªç±»æˆ–ç»“æž„ä½“ï¼Œåˆ™è¦é€šè¿‡æ–¹æ³•æˆ–åˆå§‹åŒ–ã€‚å› ä¸ºé¿å…é™æ€è®¿é—®å˜é‡æœ‰åŠ©äºŽä½¿Vaporé€šè¿‡åœæ­¢ä½¿ç”¨çº¿ç¨‹å®‰å…¨é”æˆ–ä¿¡å·é‡çš„æ¥æå‡æ€§èƒ½ã€‚ ä½¿ç”¨æœåŠ¡å¥½å¤„æ˜¯èƒ½å¤Ÿè§£è€¦è°ƒç”¨è€…ä¸Žå®žçŽ°è€…çš„å…³ç³»ï¼Œè€Œä¸”Servicesç›¸å½“äºŽä¸€ä¸ªå¤§åž‹çš„è°ƒæŽ§ä¸­å¿ƒï¼Œå°†å„ç§æœåŠ¡ä¿å­˜èµ·æ¥ï¼Œä¾›éœ€è¦æ—¶ä»Žè¿™ç»Ÿä¸€è°ƒç”¨ï¼Œæ³¨å†ŒæœåŠ¡æ—¶ä¹Ÿç»Ÿä¸€é€šè¿‡å®ƒæ¥è¿›è¡Œã€‚ åœ¨æ³¨å†ŒæœåŠ¡çš„æ—¶å€™å¯ä»¥æŒ‡å®šä¸€è‡´çš„åè®® /// Register routes to the router let router = EngineRouter.default() try routes(router) services.register(router, as: Router.self) // services belongs to app let router = app.make(Router.self) let engineRouter = app.make(EngineRouter.self) print(router) // Router (actually EngineRouter) print(engineRouter) // EngineRouter print(router === engineRouter) // true å®¹å™¨ï¼ˆContainerï¼‰å®¹å™¨ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆ Services Config Environment Worker Vaporé‡Œå¸¸ç”¨çš„å®¹å™¨æœ‰ Applicationã€Requestã€Response é€šè¿‡å®¹å™¨èƒ½å¤Ÿåˆ›å»ºå‡ºæœåŠ¡ï¼ˆéµæŒ‡å®šç‰¹å®šåè®®æˆ–ç±»æ¥èŽ·å¾—ä¸€ä¸ªå¯¹è±¡ï¼Œå‰ææ˜¯å®¹å™¨è¦é¢„å…ˆæ³¨å†Œå¥½è¯¥æœåŠ¡ï¼‰ï¼Œå› ä¸ºå®¹å™¨é‡Œé¢æœ‰å±žäºŽå®ƒè‡ªå·±çš„ä¸€ä¸ªServiceså±žæ€§ï¼ˆå½“ç„¶ä½¿ç”¨Servicesçš„å•ä¾‹é™¤å¤–ï¼‰ /// Register to sevices. let sqlite = SQLiteDatabase(storage: .memory) services.register(sqlite) // services belongs to app let db = app.make(SQLiteDatabase.self) print(db) // SQLiteDatabase (the one we registered earlier) let leaf = try req.make(LeafRenderer.self) print(leaf) /// Definitely a LeafRenderer let view = try req.make(ViewRenderer.self) print(view) /// ViewRenderer, might be a LeafRenderer è·¯ç”±ï¼ˆRouteï¼‰åœ¨Vaporé‡Œé»˜è®¤çš„è·¯ç”±ç±»æ˜¯EngineRouterï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰è·¯ç”±ç±»ï¼Œä½†éœ€è¦éµä»ŽRouteråè®®ã€‚ è‹¥è‡ªå®šä¹‰äº†è·¯ç”±ç±»çš„è¯ï¼Œåœ¨configure.swiftä¸­åº”ä½¿ç”¨è‡ªå®šä¹‰è·¯ç”±ç±»åˆ›å»ºå¯¹è±¡æ¥æ³¨å†ŒæœåŠ¡ã€‚ åœ¨routes.swiftçš„é…ç½®è·¯ç”±çš„å‡½æ•°routesä¸­ä½¿ç”¨å…¥å‚routeré…ç½®è·¯ç”±æ—¶ï¼Œæ”¯æŒç”¨è‹±æ–‡é€—å·åˆ†éš”å¼€è·¯å¾„ï¼Œæˆ–ç›´æŽ¥ä½¿ç”¨åæ–œæ è¿žæŽ¥æ˜¾ç¤º router.get(&quot;path&quot;, &quot;to&quot;, &quot;something&quot;) &#123;...&#125; router.get(&quot;path/to/something&quot;) &#123;...&#125; å¯ä»¥å°†è·¯ç”±çš„å®žçŽ°äº¤ç”±controllerçš„æ–¹æ³•å®Œæˆ let helloController = HelloController() router.get(&quot;greet&quot;, use: helloController.greet) final class HelloController &#123; func greet(_ req: Request) throws -&gt; String &#123; return try req.make(BCryptHasher.self).hash(&quot;hello&quot;) &#125; &#125; èŽ·å–å‚æ•° router.get(&quot;users&quot;, Int.parameter) &#123; req -&gt; String in let id = try req.parameters.next(Int.self) return &quot;requested id #\(id)&quot; &#125; GET /users/:id çŽ¯å¢ƒï¼ˆEnvironmentï¼‰é€šè¿‡çŽ¯å¢ƒçš„è®¾ç½®ï¼Œèƒ½èµ‹äºˆåº”ç”¨æ–¹ä¾¿åœ°åŠ¨æ€åˆ‡æ¢æƒ…æ™¯ï¼Œæ‰§è¡Œä¸ä¸€æ ·çš„ï¼ˆé…ç½®ã€æœåŠ¡ã€åˆå§‹åŒ–ï¼‰ç‰ˆæœ¬ï¼Œåœ¨å¯åŠ¨Appæ—¶æŒ‡å®š swift run Run --env prod å®¹å™¨åœ¨é»˜è®¤çŽ¯å¢ƒä¸‹æ˜¯.developmentï¼Œå¯ä»¥é€šè¿‡.environmentå±žæ€§èŽ·å–ï¼Œä¸€èˆ¬ç”¨åœ¨configure.swiftä¸­ä½¿ç”¨ services.register &#123; container -&gt; BCryptConfig in let cost: Int switch container.environment &#123; case .production: cost = 12 default: cost = 4 &#125; return BCryptConfig(cost: cost) &#125; let sqlite: SQLiteDatabase if env.isRelease &#123; /// Create file-based SQLite db using $SQLITE_PATH from process env sqlite = try SQLiteDatabase(storage: .file(path: Environment.get(&quot;SQLITE_PATH&quot;)!)) &#125; else &#123; /// Create an in-memory SQLite database sqlite = try SQLiteDatabase(storage: .memory) &#125; services.register(sqlite) é…ç½®ï¼ˆConfigï¼‰å½“æœ‰å¤šä¸ªæœåŠ¡éµä»ŽåŒä¸€ä¸ªåè®®æ—¶ï¼Œéœ€è¦ä½¿ç”¨Configç»“æž„ä½“æ¥å£°æ˜Žè¯¥åè®®ä¼˜å…ˆå¯¹åº”çš„æœåŠ¡ /// Declare preference for MemoryKeyedCache anytime a container is asked to create a KeyedCache config.prefer(MemoryKeyedCache.self, for: KeyedCache.self) /// ... /// Create a KeyedCache using the Request container let cache = req.make(KeyedCache.self) print(cache is MemoryKeyedCache) // true å†…å®¹ï¼ˆContentï¼‰åœ¨Vapor 3ä¸­ï¼ŒJSON, protobuf, URLEncodedForm, Multipartç­‰ï¼Œæ‰€æœ‰çš„Contentç±»åž‹éƒ½ä¸€æ ·ï¼Œéœ€è¦åºåˆ—åŒ–å’Œè§£æžçš„Contentéƒ½è¦æ˜¯ä¸€ä¸ªCodableçš„ç±»æˆ–ç»“æž„ä½“ï¼ˆå³æ˜¯è¦éµä»ŽContentåè®®ï¼‰ã€‚ åƒä¸‹é¢è¿”å›žResponseçš„ä¾‹å­ä¸­ï¼Œå› ä¸ºUseréµä»Žäº†Contentåè®®ï¼Œæ‰€ä»¥åœ¨ä¸‹é¢æ³¨å†Œè·¯ç”±é‡Œçš„å®žçŽ°èƒ½ç›´æŽ¥è¿”å›žUserå¯¹è±¡ä½œä¸ºResponseï¼Œå›žè°ƒå¾—åˆ°çš„Userå¯¹è±¡ä¼šè¢«è°ƒç”¨å…¶Contentåè®®ä¸­çš„æ–¹æ³•è¿›è¡Œç¼–ç æˆJSONè¿”å›ž //HTTPå“åº” HTTP/1.1 200 OK Content-Type: application/json &#123; &quot;name&quot;: &quot;Vapor User&quot;, &quot;email&quot;: &quot;user@vapor.codes&quot; &#125; //é¢„æœŸçš„ç»“æž„ä½“æˆ–ç±» struct User: Content &#123; var name: String var email: String &#125; //ç¼–ç HTTPå“åº” router.get(&quot;user&quot;) &#123; req -&gt; User in return User( name: &quot;Vapor User&quot;, email: &quot;user@vapor.codes&quot; ) &#125; Requestçš„ç”¨æ³•ä¹Ÿå·®ä¸å¤šï¼ŒæŒ‡å®šéœ€è¦è§£ç å‡ºçš„å¯¹è±¡ç±»åž‹ï¼Œå°±èƒ½ä»ŽJSONè½¬æ¢æˆå¯¹åº”çš„æ¨¡åž‹å¯¹è±¡ //HTTPè¯·æ±‚ POST /login HTTP/1.1 Content-Type: application/json &#123; &quot;email&quot;: &quot;user@vapor.codes&quot;, &quot;password&quot;: &quot;don&apos;t look!&quot; &#125; //é¢„æœŸçš„ç»“æž„ä½“æˆ–ç±» struct LoginRequest: Content &#123; var email: String var password: String &#125; //è§£ç HTTPè¯·æ±‚ router.post(&quot;login&quot;) &#123; req -&gt; Future&lt;HTTPStatus&gt; in return req.content.decode(LoginRequest.self).map(to: HTTPStatus.self) &#123; loginRequest in print(loginRequest.email) // user@vapor.codes print(loginRequest.password) // don&apos;t look! return .ok &#125; &#125; å¼‚æ­¥ï¼ˆAsyncï¼‰å½“åº”ç”¨å¯åŠ¨æ—¶é€šå¸¸ä¼šåˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ç»™è¿è¡Œå®ƒçš„æ¯ä¸ªCPUæ ¸å¿ƒã€‚æ¯ä¸ªäº‹ä»¶å¾ªçŽ¯æœ‰ä¸€æ¡çº¿ç¨‹ã€‚ä½†å’ŒNode.jsä¸­çš„åªèƒ½è¿è¡Œä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ä¸åŒï¼ŒVaporåŸºäºŽSwiftæ”¯æŒå¤šçº¿ç¨‹çš„ç‰¹æ€§ï¼Œå…¶èƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œå¤šä¸ªäº‹ä»¶å¾ªçŽ¯ï¼Œè€Œå…¶å®ƒæ–¹é¢åˆ™éƒ½éžå¸¸åœ°ç›¸ä¼¼ã€‚ æ¯ä¸€æ¬¡æœ‰å®¢æˆ·ç«¯è¿žæŽ¥æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å°±èƒ½å¤ŸæŒ‡æ´¾ä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ç»™å®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ï¼Œå¹¶ä¸”å‡åœ¨æ­¤åŒä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ä¸Šè¿›è¡Œã€‚ äº‹ä»¶å¾ªçŽ¯è´Ÿè´£è·Ÿè¸ªæ¯ä¸€ä¸ªè¿žæŽ¥äº†çš„å®¢æˆ·çŠ¶æ€ã€‚å¦‚æžœæœ‰ä¸€ä¸ªç­‰å¾…æœåŠ¡ç«¯æŽ¥æ”¶çš„è¯·æ±‚ï¼Œäº‹ä»¶å¾ªçŽ¯ä¼šè§¦å‘æŽ¥æ”¶é€šçŸ¥æ¥ä¿ƒä½¿æ•°æ®è¢«æŽ¥æ”¶ã€‚å½“æ•´ä¸ªè¯·æ±‚è¢«æŽ¥æ”¶å®Œæ¯•åŽï¼ŒæŸä¸ªç­‰å¾…è¿”å›žè¯·æ±‚æ•°æ®futureå°±ä¼šè¢«è§¦å‘å®Œæˆã€‚ æ ¸å¿ƒå°±æ˜¯åˆ©ç”¨Future&lt;T&gt;è¿™æ ·ä¸€ä¸ªç±»åž‹ åŽ»æŽ¥æ”¶å¼‚æ­¥ä»»åŠ¡çš„è¿”å›žï¼› æ‰§è¡ŒæŒ‡å®šçš„å›žè°ƒä»»åŠ¡ï¼› å®žçŽ°é“¾å¼å“åº”ã€‚ ç¬¬ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼ŒfutureStringèŽ·å¾—ç­‰å¾…å¼‚æ­¥ä»»åŠ¡è¿”å›žçš„ä»»å‘½åŽï¼Œåœ¨å®ƒèº«ä¸Šè®¾ç½®ä¸Šå¼‚æ­¥ä»»åŠ¡è¿”å›žåŽéœ€è¦æ‰§è¡Œçš„å›žè°ƒä»»åŠ¡ï¼ŒæŒ‡å®šçš„æ–¹æ³•å°±æ˜¯.map(to:)ï¼Œå‚æ•°æ˜¯è¯´æ˜Žå›žè°ƒæ‰§è¡ŒåŽçš„è¿”å›žå€¼ï¼Œé—­åŒ…ä¸­çš„stringå…¶å®žå°±æ˜¯futureStringæ”¶åˆ°å¼‚æ­¥è¿”å›žåŽçš„çœŸæ­£ç»“æžœã€‚ ä½†å¤§å®¶å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œè‹¥å°±åœ¨è¿™ä¹ˆä¸€è¡Œä»£ç ä¹‹é—´ï¼Œè®¾ç½®å›žè°ƒå‰å¼‚æ­¥çš„ä»»åŠ¡å°±å·²ç»è¿”å›žäº†çš„è¯ï¼ŒåŽé¢çš„è®¾çš„å›žè°ƒä¼šä¸ä¼šæ²¡æœ‰æœºä¼šæ‰§è¡Œäº†ï¼Œä¸ç”¨æ…Œï¼Œ.map(to:)æ–¹æ³•é‡Œæœ‰çŠ¶æ€åˆ¤æ–­åˆ°åº•futureStringç­‰å¾…çš„å¼‚æ­¥ä»»åŠ¡æ˜¯å¦è¿”å›žäº†ï¼Œè‹¥å·²ç»è¿”å›žäº†çš„è¯å½“ç„¶è®¾ç½®å®Œå›žè°ƒå°±ç«‹é©¬æ‰§è¡Œäº†ã€‚ è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹ï¼Œ.map(to:)è¿”å›žçš„ç»“æžœä¹Ÿæ˜¯Future&lt;T&gt;ï¼Œå…¶ä¸­çš„Tå°±æ˜¯toå‚æ•°ä¸­çš„ç±»åž‹äº†ï¼Œç»§ç»­è¿”å›žFutureçš„ç±»åž‹æ˜¯ä¸ºäº†ä¸‹é¢ä¼šè¯´åˆ°é“¾å¼å“åº”è€Œè®¾è®¡çš„ã€‚å½“ä½ è¿˜è¦ç”¨è¿™ä¸ªæœ€åŽçš„futureç»“æžœå¤„ç†å…¶å®ƒé€»è¾‘æ—¶ï¼Œå¯ç»§ç»­ç»™å®ƒæŒ‡å®šå›žè°ƒä»»åŠ¡ï¼Œå¦‚æ­¤ç±»æŽ¨åœ°è®¾ç½®ä½ éœ€è¦åœ¨ç¬¬ä¸€çº§å¼‚æ­¥ä»»åŠ¡æ‰§è¡ŒåŽçš„ä¸€ç³»åˆ—ä»»åŠ¡ã€‚ /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... /// Map the future string to an integer let futureInt = futureString.map(to: Int.self) &#123; string in print(string) // The actual String return Int(string) ?? 0 &#125; /// We now have a future integer print(futureInt) // Future&lt;Int&gt; ç¬¬äºŒä¸ªä¾‹å­ï¼Œå½“å›žè°ƒé‡Œçš„ä»»åŠ¡ä¹Ÿæ˜¯å¼‚æ­¥çš„æ€Žä¹ˆåŠžï¼Ÿæœ€åŽå¾—åˆ°çš„ç»“æžœå²‚ä¸æ˜¯å˜æˆFuture&lt;Future&gt;ï¼Ÿ ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼ŒVaporå®šä¹‰äº† .flatMap(to:) è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œç›´è¯‘å°±æ˜¯â€œå¹³é¢æ˜ å°„â€ã€‚åŽŸç†åº”è¯¥æ˜¯å½“å‰futureåœ¨æ‰§è¡Œå…¶å›žè°ƒé—­åŒ…åŽï¼ŒèŽ·å¾—è¿”å›žç»“æžœä¹Ÿæ˜¯futureå¯¹è±¡æ—¶ï¼Œä¼šç­‰å¾…è¯¥è¿”å›žçš„futureç­‰å¾…çš„å¼‚æ­¥ä»»åŠ¡å®ŒæˆåŽï¼Œå†å°†å…¶tå¯¹è±¡æ‹¿å‡ºä¼ å…¥ä¸‹ä¸€ä¸ªfutureçš„å›žè°ƒé—­åŒ…ä¸­åŽ»ã€‚ åæ­£å°±æ˜¯è‹¥å›žè°ƒé—­åŒ…ä¸­è¿”å›žFutureç±»åž‹çš„ç»“æžœï¼Œåˆ™éœ€è¦ä½¿ç”¨.flatMap(to:)æ–¹æ³•è®¾ç½®å›žè°ƒã€‚ /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... /// Assume we have created an HTTP client let client: Client = ... /// Flat-map the future string to a future response let futureResponse = futureString.flatMap(to: Response.self) &#123; string in return client.get(string) // Future&lt;Response&gt; &#125; /// We now have a future response print(futureResponse) // Future&lt;Response&gt; Futureçš„é“¾å¼å“åº” /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... /// Assume we have created an HTTP client let client: Client = ... /// Transform the string to a url, then to a response let futureResponse = futureString.map(to: URL.self) &#123; string in guard let url = URL(string: string) else &#123; throw Abort(.badRequest, reason: &quot;Invalid URL string: \(string)&quot;) &#125; return url &#125;.flatMap(to: Response.self) &#123; url in return client.get(url) &#125; print(futureResponse) // Future&lt;Response&gt; å˜æ¢ï¼Œç”¨æ¥ä¿®æ”¹futureå¯¹è±¡çš„å€¼ï¼Œä¸€èˆ¬ç”¨äºŽä¿®æ”¹Futureè¿™ç§ç±»åž‹ï¼Œå› ä¸ºè¿™ç±»åž‹ç»å¸¸ä¼šä½œä¸ºä¸€ç§å›žè°ƒä¿¡å·ï¼Œå•å•åªæ˜¯éœ€è¦çŸ¥é“å®Œæˆäº†å°±å¯ä»¥çš„æƒ…å†µï¼Œä¿®æ”¹å®ƒå€¼ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé‡è¦çš„å½±å“ã€‚ /// Assume we get a void future back from some API let userDidSave: Future&lt;Void&gt; = ... /// Transform the void future to an HTTP status let futureStatus = userDidSave.transform(to: HTTPStatus.ok) print(futureStatus) // Future&lt;HTTPStatus&gt; Futureå¯¹è±¡ä¸€èˆ¬æ˜¯é€šè¿‡Promisesç±»æ¥åˆ›å»ºï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒPromisesä¸éœ€æˆ‘ä»¬ç®¡ç†ï¼Œè€Œåœ¨Vaporçš„APIé‡Œå®Œæˆåˆ›å»ºFutureå¯¹è±¡å¹¶è¿”å›ž Applicationã€Requestã€Responseè¿™ä¸‰ä¸ªç±»åŒæ—¶ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„Workerï¼Œæ‰€è°“Workerå°±æ˜¯æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡æˆ–è€…è®¿é—®äº‹ä»¶å¾ªçŽ¯ã€‚ /// Assume we have a Request and some ViewRenderer let req: Request = ... let view: ViewRenderer = ... /// Render the view, using the Request as a worker. /// This ensures the async work happens on the correct event loop. /// /// This assumes the signature is: /// func render(_: String, on: Worker) view.render(&quot;home.html&quot;, on: req) è‹¥æ²¡æœ‰å¤šé‡çš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨Futureç®€å•çš„do/catchæ–¹æ³•æ¥ç­‰å¾…å¼‚æ­¥çš„è¿”å›žå³å¯ /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... futureString.do &#123; string in print(string) // The actual String &#125;.catch &#123; error in print(error) // A Swift Error &#125; ä¹Ÿå¯ä»¥ä½¿ç”¨alwaysæ–¹æ³•æ¥æ‰§è¡Œå¼‚æ­¥è¿”å›žåŽçš„å›žè°ƒï¼Œæ— è®ºæˆåŠŸä¸Žå¦ /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... futureString.always &#123; print(&quot;The future is complete!&quot;) &#125; åŒæ­¥ç­‰å¾…ï¼Œæ³¨æ„åƒä¸‡ä¸è¦ç”¨åœ¨è·¯ç”±çš„é—­åŒ…é‡Œï¼Œå› ä¸ºåœ¨äº‹ä»¶å¾ªçŽ¯ä¸­é˜»å¡žäº†çº¿ç¨‹ï¼Œä¼šä½¿æ‰€æœ‰ç”¨æˆ·éƒ½æ— æ³•è®¿é—®ï¼Œç›´åˆ°é˜»å¡žç»“æŸã€‚ /// Assume we get a future string back from some API let futureString: Future&lt;String&gt; = ... /// Block until the string is ready let string = try futureString.wait() print(string) /// String]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonçš„ä½¿ç”¨çŽ¯å¢ƒé…ç½®]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FPython%E7%9A%84%E4%BD%BF%E7%94%A8%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[å…¬å¸æ›´æ¢æ–°Macï¼Œi7çš„cpuè·‘èµ·æ¥è¿˜æ˜¯æŒºçˆ½çš„ï¼Œç”µè„‘è¿˜æ˜¯ä¹°é¡¶é…çš„åˆ’ç®—ï¼Œæ— è®ºä»Žä½¿ç”¨æ—¶é—´ã€ä½¿ç”¨æœŸé™å’Œä½¿ç”¨ä½“éªŒä¸Šï¼Œéƒ½æ˜¯ç‰©æœ‰æ‰€å€¼ã€‚ ä¸ºäº†ç»´æŠ¤æˆ‘ä»¬å®¢æˆ·ç«¯è‡ªå·±çš„Webç‰ˆå·¥å…·ï¼Œæ–°ç”µè„‘ä¸Šå¾—é‡æ–°é…ç½®ä¸€æ¬¡å¼€å‘çŽ¯å¢ƒï¼Œä½†æ— å¥ˆä»¥å‰é…ç½®çŽ¯å¢ƒæ—¶æ²¡æœ‰æ€»ç»“ï¼Œå¯¼è‡´åˆå¤šè¸©ä¸€éå‘ã€‚è¿™æ¬¡æ€»ç»“ä¼šåŒ…æ‹¬ å®‰è£…Python3.x é…ç½®é¡¹ç›®çš„Pythonè™šæ‹ŸçŽ¯å¢ƒ é…ç½®PyCharmçš„ç¼–è¯‘çŽ¯å¢ƒ æ›´æ–°Djangoç‰ˆæœ¬ é¡ºå¸¦è®°å½•ä¸€ä¸‹å…¶å®ƒä½¿ç”¨Pythonçš„å·¥å…·æˆ–è€…ç®¡ç†å™¨çš„é—®é¢˜ï¼ŒåƒQgisã€Anacondaã€‚ å®‰è£…Pythonæœ€ç®€å•ä¸è¿‡çš„å°±æ˜¯é€šè¿‡Homebrewå®‰è£…äº† $ brew search python ä¹Ÿå¯ä»¥ä¸‹è½½å®‰è£…åŒ…æ‰‹åŠ¨å®‰è£…ã€‚ æ›´æ–°python brew upgrade python æ›´æ–°pip python -m pip install --upgrade pip å‡çº§pythonåŽæç¤ºæ‰¾ä¸åˆ°python3ï¼Œè¿™æ—¶éœ€è½¯è¿žæŽ¥åˆ° /usr/local/bin ç›®å½•å°±èƒ½è§£å†³ ln -s /usr/local/Cellar/python/3.6.5_1/bin/python3 /usr/local/bin/python3 pip3 çš„è½¯è¿žæŽ¥ ln -s /usr/local/Cellar/python/3.6.5_1/bin/pip3.6 /usr/local/bin/pip3 é…ç½®PyCharmçš„ç¼–è¯‘çŽ¯å¢ƒå­—ç¬¦ç¼–ç é—®é¢˜å®‰è£…python3åŽï¼Œåœ¨pycharmçš„preferenceé‡Œè®¾ç½®è§£æžå™¨ï¼Œè‹¥è¦æ–°å»ºçŽ¯å¢ƒè€Œåˆæç¤ºvenvçŽ¯å¢ƒå·²å­˜åœ¨åˆ™è¦å…ˆç§»é™¤venvæ–‡ä»¶å¤¹ã€‚é€‰æ‹©è¦ä½¿ç”¨çš„pythonç‰ˆæœ¬ï¼Œpython3.xçš„ç‰ˆæœ¬ä½äºŽ/usr/local/bin/python3.x(ç³»ç»Ÿé»˜è®¤çš„ä½äºŽ/usr/bin/python2.7)ã€‚ å½“ç‚¹å‡»OKä¿å­˜æ—¶æç¤ºäº†ä»¥ä¸‹é”™è¯¯ UnicodeEncodeError: â€˜asciiâ€™ codec canâ€™t encode characters in position XX è¿™æ˜¯å­—ç¬¦ç¼–ç çš„é—®é¢˜ï¼Œå¯å°è¯•åœ¨/usr/local/lib/python3.x/site-packages/sitecustomize.pyä¸­åŠ å…¥ä»¥ä¸‹ä»£ç  import sys sys.setdefaultencoding(&apos;UTF-8&apos;) å¦‚æžœè¿˜æ˜¯ä¸è¡Œï¼Œé‚£è¦è€ƒè™‘å°†çŽ¯å¢ƒåˆ›å»ºåœ¨æ²¡æœ‰ä¸­æ–‡çš„è·¯å¾„ä¸‹ã€‚ æ‰¾ä¸åˆ°Djangoæ¨¡å—é—®é¢˜ä¸Šé¢çš„é—®é¢˜æžå®šåŽï¼Œåˆå‡ºçŽ°æ–°çš„æŠ¥é”™ï¼Œæç¤º no module named django.core.management å…ˆæŸ¥è¯¢Djangoç‰ˆæœ¬ $ django-admin --version æŸ¥è¯¢æ— æžœåˆ™åº”å…ˆå®‰è£…Djangoï¼Œè‹¥æœ‰ç‰ˆæœ¬ä¿¡æ¯åˆ™å¯èƒ½æ˜¯venvä½¿ç”¨çš„Pythonç‰ˆæœ¬ä¸å¯¹ï¼Œè¿™é‡Œæ‰¾ä¸åˆ°æ˜¯å› ä¸ºDjango(ä»Ž1.9)æ›´æ–°åˆ°æœ€æ–°çš„2.xäº† $ pip3 install django ç„¶åŽï¼Œå†é‡æ–°è®¾ç½®interpreterï¼Œvenvå¿…é¡»é€‰ç”¨site-packagesåŒ…å«Djangoçš„Pythonç‰ˆæœ¬ï¼Œå¦åˆ™ä»ç„¶æ— æ³•import django ä¸€å¼€å§‹é€‰æ‹©äº†é”™è¯¯çš„ç‰ˆæœ¬è·¯å¾„ /usr/local/lib/python3.6 åŽæ¥é€‰æ‹©æ­£ç¡®çš„ç‰ˆæœ¬è·¯å¾„ä¸º /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6 ç„¶åŽè¿è¡Œèµ·é¡¹ç›® python manage.py runserver åœ¨é¡¹ç›®è®¾ç½®ä¸­ï¼ŒParameterså¡«çš„å°±æ˜¯æ­¤å‘½ä»¤ä¸­çš„runserverï¼ŒScript pathå¡«çš„æ˜¯manager.pyçš„æ–‡ä»¶è·¯å¾„ï¼ŒWorking directoryæ˜¯manager.pyæ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼ŒPython interpreteré€‰æ‹©åˆšåˆ›å»ºå¥½çš„venvçš„pythonç‰ˆæœ¬ Djangoç‰ˆæœ¬å…¼å®¹é—®é¢˜1.CASCADE è‹¥è¿è¡Œå¤±è´¥ï¼Œå‡ºçŽ°æŠ¥é”™ TypeError: init() missing 1 required positional argument: â€˜on_deleteâ€™ æ˜¯å› ä¸ºdjangoå‡çº§åˆ°2.xåŽçš„ä¸€ä¸ªå˜åŠ¨å¯¼è‡´çš„ï¼Œå®˜æ–¹è¯´æ˜Žå¦‚ä¸‹ Deprecated since version 1.9:on_delete will become a required argument in Django 2.0. In older versions it defaults to CASCADE å³æ˜¯ä»¥å‰ä¸ç”¨æŒ‡å®šé»˜è®¤çš„on_deleteå‚æ•°ï¼ŒçŽ°åœ¨éœ€è¦æ˜¾å¼æŒ‡å®šï¼Œå¦‚ä»¥å¾€æ²¡æœ‰æŒ‡å®šon_deleteï¼Œåˆ™ä»£ç å¯ä»¥æ›´æ–°ä¸ºä»¥ä¸‹æ ·å­ categorie = models.ForeignKey( &apos;Categorie&apos;, on_delete=models.CASCADE, ) CASCADE ä»£è¡¨ä¸²è”åˆ é™¤ï¼Œå®˜æ–¹æ›´æ–°è¯´æ˜Žåœ°å€ã€‚ 2.reverse å…¶æ¬¡2.xçš„djangoè¿˜å°†reverseå­˜æ”¾çš„åŒ…å˜æ›´äº†ï¼Œå¯ä»¥ç”¨ä¸‹é¢æ–¹å¼å‘ä¸‹å…¼å®¹ try: from django.core.urlresolvers import reverse except BaseException: from django.urls import reverse 3.urllib ç„¶åŽpython3.6ä¹Ÿæœ‰ä¸€ä¸ªæ›´æ–°ï¼Œä½¿ç”¨urllibåº“è®¿é—®httpsè¿žæŽ¥ï¼Œä¼šè¿”å›žé”™è¯¯ ssl.SSLError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:645) è§£å†³æ–¹æ³•æ˜¯åœ¨ç»ˆç«¯ç›´æŽ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…certifiæ¨¡å— /Applications/Python\ 3.6/Install\ Certificates.command ç„¶åŽåœ¨ç”¨åˆ°sslçš„åœ°æ–¹import sslã€‚å‚è€ƒåœ°å€ã€‚ 4.MIDDLEWARE_CLASSESæ™®é€šä¸šåŠ¡æ¨¡å—æ­£å¸¸è¿ä½œï¼Œä½†ä½¿ç”¨host:8000/adminåŽ»è®¿é—®ä¸­é—´ä»¶Djangoç®¡ç†æ—¶ï¼Œé¡µé¢æ˜¾ç¤º404ï¼Œæç¤ºæ‰¾ä¸åˆ°è¯¥urlè·¯å¾„ã€‚â€œThe current path, admin, didnâ€™t match any of the URLconf defined in web_server.urlsâ€è¿™ç¯‡stackoverflowæœ‰æå‡ºç›¸å…³çš„è§£å†³åŠžæ³•ï¼Œä½†æ£€æŸ¥åŽæ²¡å‘çŽ°é”™è¯¯ã€‚ æœ‰è¯´åœ¨python3.6ä¸‹è¦å°†settings.pyä¸­çš„è€å¼MIDDLEWARE_CLASSESæ›¿æ¢ä¸ºæ–°å¼çš„MIDDLEWAREï¼Œæœ‰è¯´å°†æ–°å¼æ›¿æ¢ä¸ºè€å¼çš„ï¼Œä½†è¯•è¿‡å‡æ— æ³•è§£å†³ã€‚åœ¨python3ä¸‹æ›¿æ¢ä¸ºæ–°å¼çš„ä¼šæç¤ºï¼š ImportError: Module â€œdjango.contrib.auth.middlewareâ€ does not define a â€œSessionAuthenticationMiddlewareâ€ attribute/class django.core.exceptions.ImproperlyConfigured: WSGI application â€˜web_server.wsgi.applicationâ€™ could not be loaded; Error importing module. è‹¥æ˜¯æç¤ºWSGIRequestç±»çš„userå±žæ€§æ‰¾ä¸åˆ°å¯ä»¥å‚è€ƒè¿™ç¯‡ï¼Œâ€˜WSGIRequestâ€™ object has no attribute â€˜userâ€™ Django adminã€‚ æœ€åŽè¿˜æ˜¯è¿˜åŽŸå›žä»£ç æœ€åˆä½¿ç”¨çš„çŽ¯å¢ƒï¼Œå°†djangoè¿˜åŽŸå›ž1.10.3çš„ç‰ˆæœ¬å¦‚æžœæ˜¯ä½¿ç”¨2.7çš„pythonï¼Œå…ˆä½¿ç”¨easy_installå®‰è£…pip $ sudo easy_install pip ç„¶åŽä½¿ç”¨2.7çš„pipå®‰è£…1.10.3çš„django $ pip2.7 install django==1.10.3 5.è™šæ‹ŸçŽ¯å¢ƒä¹Ÿé¡ºå¸¦äº†è§£ä¸€ä¸‹Pythonçš„è™šæ‹ŸçŽ¯å¢ƒã€‚ æˆ‘ä»¬å¯ä»¥åŒæ—¶å®‰è£…å¤šä¸ªPythonç‰ˆæœ¬åœ¨ç³»ç»Ÿä¸Šï¼Œé€šè¿‡åœ¨pythonæŒ‡ä»¤åŽåŠ ç‰ˆæœ¬æ•°å­—æ¥åŒºåˆ†ä½¿ç”¨çš„pythonç‰ˆæœ¬ã€‚ä½†åœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œä¹Ÿå¯èƒ½ä¼šå­˜åœ¨ä¸åŒåº”ç”¨éœ€è¦ä¸åŒçš„pythonç‰ˆæœ¬ï¼Œç”šè‡³ä¸åŒçš„pythonå·¥å…·åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨åˆ°venvè¿™ä¸ªåŸºäºŽä¸€ä¸ªæˆ–å¤šä¸ªé¡¹ç›®â€œç‹¬ç«‹â€çš„Pythonè¿è¡ŒçŽ¯å¢ƒï¼Œæ¥è§£å†³ä¸åŒåº”ç”¨é—´å¤šç‰ˆæœ¬çš„å†²çªé—®é¢˜ã€‚ æœ‰ä¸€ä¸ªå«virtualenvçš„å·¥å…·ï¼Œå¯é€šè¿‡pipï¼ˆç®¡ç†Pythonåº“çš„å·¥å…·ï¼‰å®‰è£…å¾—åˆ° $ pip3 install virtualenv é€šè¿‡è¿™ä¸ªå·¥å…·ï¼Œä½¿ç”¨å‘½ä»¤virtualenvå¯ä»¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„Pythonè¿è¡ŒçŽ¯å¢ƒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŠ ä¸Šå‚æ•°--no-site-packagesä½¿ç³»ç»ŸPythonçŽ¯å¢ƒä¸­çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹åŒ…éƒ½ä¸ä¼šå¤åˆ¶è¿‡æ¥ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªä¸å¸¦ä»»ä½•ç¬¬ä¸‰æ–¹åŒ…çš„â€œå¹²å‡€â€çš„Pythonè¿è¡ŒçŽ¯å¢ƒã€‚æ–°å»ºçš„PythonçŽ¯å¢ƒè¢«æ”¾åˆ°å½“å‰ç›®å½•ä¸‹çš„venvç›®å½•ã€‚å¯ä»¥ç”¨sourceå‘½ä»¤è¿›å…¥è¯¥çŽ¯å¢ƒï¼š $ source venv/bin/activate é€€å‡ºå½“å‰çš„venvçŽ¯å¢ƒï¼Œä½¿ç”¨deactivateå‘½ä»¤ï¼š $ deactivate å…¶ä¸Žå…¶å®ƒenvå·¥å…·çš„åŒºåˆ«å¯ä»¥å‚è€ƒè¿™é‡Œ Qgisçš„çŽ¯å¢ƒé—®é¢˜å®‰è£…QgisåŽæç¤ºæ‰¾ä¸åˆ°python3.6ï¼Œè½¯è¿žæŽ¥åˆ°è¿™é‡Œå³å¯è§£å†³ sudo ln -s /usr/local/Cellar/python/3.6.5_1/Frameworks/Python.framework /Library/Frameworks/Python.framework Qgiséœ€è¦çš„åº“ pip3 install owslib PyYaml psycopg2 jinja2 pygments plotly å…¶ä¸­osgeoéœ€è¦å®‰è£…gdal sudo python3 -m pip install gdal å¦‚æžœæŠ¥é”™æç¤º Command â€œpython setup.py egg_infoâ€ failed with error code 1 in /private/var/folders/xxx/ å¯ä»¥æ¢ç”¨brewå®‰è£… brew install gdal å¦‚æžœè¿˜æŠ¥é”™æç¤º Error: gdal contains conflicting version recursive dependencies: python@2, pythonView these with brew deps --tree gdal. æœ€åŽåœ¨è¿™é‡Œæ‰¾åˆ°è§£å†³æ–¹æ³•ï¼Œè¦ä½¿ç”¨qgis3.0ç‰ˆæœ¬ï¼Œå°±éœ€è¦å®‰è£…gdal2.0ç‰ˆæœ¬ $ brew unlink gdal $ brew tap osgeo/osgeo4mac &amp;&amp; brew tap --repair $ brew install jasper netcdf $ brew install gdal2 --with-armadillo --with-complete --with-libkml --with-unsupported $ brew link --force gdal2 å®‰è£…å®Œæ¯•åŽåˆ°.bash_profileæ·»åŠ ä¸‹é¢çš„ä¸€å¥åŽä¿å­˜åŠæ¿€æ´» $ vi ~/.bash_profile export PATH=&quot;/usr/local/opt/gdal2/bin:$PATH&quot; $ source ~/.bash_profile Anaconda1.Anacondaå®‰è£…çš„Pythonåº“ç›®å½•rootçŽ¯å¢ƒä¸‹å®‰è£…çš„Pythonåº“æ–‡ä»¶ç›®å½•ä¸º: /Users/userName/anaconda/lib/python2.7/site-packages python27çŽ¯å¢ƒä¸‹å®‰è£…çš„Pythonåº“æ–‡ä»¶ç›®å½•ä¸º: /Users/userName/anaconda/envs/python27/lib/python2.7/site-packages python3çŽ¯å¢ƒä¸‹å®‰è£…çš„Pythonåº“æ–‡ä»¶ç›®å½•ä¸º: /Users/zj_macbook/anaconda/envs/python3/lib/python3.6/site-packages 2.pipå®‰è£…çš„Pythonåº“ç›®å½•pipå®‰è£…çš„Pythonåº“æ–‡ä»¶ç›®å½•: /usr/local/lib/python2.7/site-packages pip3å®‰è£…çš„Pythonåº“æ–‡ä»¶ç›®å½•: /usr/local/lib/python3.6/site-packages 3.å¦å¤–å½“Anacondaå›¾å½¢äº¤æ¢ç•Œé¢ä¸Šé€‰æ‹©çš„ç¬¬ä¸‰æ–¹åº“ä¸‹è½½å¾ˆæ…¢çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æŽ¥æ‰¾å‡ºAnacondaä¸‹çš„pipåŽ»ç»ˆç«¯æ‰§è¡Œå‘½ä»¤è¡Œæ¥ä¸‹è½½ï¼Œé€Ÿåº¦ä¼šæœ‰æ˜¾è‘—çš„æå‡ã€‚ brewä¼šä¸ºå¯æ‰§è¡Œç¨‹åºåˆ›å»ºé“¾æŽ¥ï¼Œä½äºŽ: /usr/local/bin å®žé™…å®‰è£…çš„ä½ç½®åœ¨ /usr/local/Cellar]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>PyCharm</tag>
        <tag>Django</tag>
        <tag>Python</tag>
        <tag>Anaconda</tag>
        <tag>Qgis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Macå‘½ä»¤è¡Œå·¥å…·åŠå…¶é—®é¢˜æ”¶å½•]]></title>
    <url>%2F%E5%B7%A5%E5%85%B7%2FMac%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E5%8F%8A%E5%85%B6%E9%97%AE%E9%A2%98%E6%94%B6%E5%BD%95%2F</url>
    <content type="text"><![CDATA[é—®é¢˜é›†OSXä½¿ç”¨oh-my-zshåŽ.bash_profileè‡ªå®šä¹‰å¤±æ•ˆåŽŸå› ï¼šoh-my-zshçš„é…ç½®æ–‡ä»¶ä¸º.zshrcï¼Œè€Œé»˜è®¤shellï¼ˆbashï¼‰çš„é…ç½®æ–‡ä»¶ä¸º.bash_profileè§£å†³ï¼šå°†.bash_profileçš„é…ç½®ç§»åˆ°.zshrcä¸­åŽ»ã€‚åœ¨.zshrcæ·»åŠ source ~/.bash_profileä¼šäº§ç”Ÿæ‰“å¼€ç»ˆç«¯åˆå§‹åŒ–è¿‡ä¹…çš„é—®é¢˜ã€‚ ä½¿ç”¨brewå®‰è£…å‘½ä»¤è¡Œå·¥å…·æ—¶ï¼Œæç¤ºâ€Error: undefined method `sdk_path_if_neededâ€™ for OS::Mac:Moduleâ€åŽŸå› ï¼šbrewç‰ˆæœ¬è¿‡è€è§£å†³ï¼šè¿è¡Œ brew update-reset åŽ»æ›´æ–°brew æ›´æ–°CocoapodsæŠ¥é”™â€Operation not permittedâ€æ›´æ–°gemï¼Œsudo gem update â€“systemsudo gem install cocoapodsæŠ¥é”™ï¼šOperation not permitted - /usr/bin/xcodeprojè§£å†³ï¼šsudo gem install -n /usr/local/bin cocoapods åŠŸèƒ½é›†vimåˆ†å±vim -on file1_path file2_path .sqlite3æ–‡ä»¶æŸ¥çœ‹$ sqlite xx.sqlite3 //æ‰“å¼€æ•°æ®åº“æ–‡ä»¶ sqlite&gt;.help //å¸®åŠ© sqlite&gt;.quit //é€€å‡º sqlite&gt;.tables //æŸ¥æ‰€æœ‰è¡¨ sqlite&gt;.show //æŸ¥é…ç½® sqlite&gt;.mode list/line/column //è®¾ç½®æŸ¥è¯¢ç»“æžœæŽ’åˆ—æ ¼å¼ sqlite&gt;.headers on //æ˜¯å¦æ˜¾ç¤ºå¤´ sqlite&gt;select * from xx_table //æŸ¥è¡¨è¯­å¥æ‰§è¡Œ å½“ç„¶å¯ä»¥ä¸‹è½½ä»¥ä¸‹å·¥å…·åº”ç”¨ä½¿ç”¨ä»£æ›¿ Sqlite Database brower Datum Sqlite Professional mac åŒ¹é…å­—ç¬¦å½“å‰ç›®å½•ä¸‹ æŸ¥æ‰¾â€hello,world!â€å­—ç¬¦ä¸²grep -rn â€œhello,world!â€ * *: è¡¨ç¤ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæ–‡ä»¶å-r æ˜¯é€’å½’æŸ¥æ‰¾-n æ˜¯æ˜¾ç¤ºè¡Œå·-R æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶åŒ…å«å­ç›®å½•-i å¿½ç•¥å¤§å°å†™ å…¶å®ƒå‘½ä»¤è¡Œå‚æ•°ï¼šgrep -i pattern files ï¼šä¸åŒºåˆ†å¤§å°å†™åœ°æœç´¢ã€‚é»˜è®¤æƒ…å†µåŒºåˆ†å¤§å°å†™ï¼Œgrep -l pattern files ï¼šåªåˆ—å‡ºåŒ¹é…çš„æ–‡ä»¶åï¼Œgrep -L pattern files ï¼šåˆ—å‡ºä¸åŒ¹é…çš„æ–‡ä»¶åï¼Œgrep -w pattern files ï¼šåªåŒ¹é…æ•´ä¸ªå•è¯ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚åŒ¹é…â€˜magicâ€™ï¼Œè€Œä¸æ˜¯â€˜magicalâ€™ï¼‰ï¼Œgrep -C number pattern files ï¼šåŒ¹é…çš„ä¸Šä¸‹æ–‡åˆ†åˆ«æ˜¾ç¤º[number]è¡Œï¼Œgrep pattern1 | pattern2 files ï¼šæ˜¾ç¤ºåŒ¹é… pattern1 æˆ– pattern2 çš„è¡Œï¼Œgrep pattern1 files | grep pattern2 ï¼šæ˜¾ç¤ºæ—¢åŒ¹é… pattern1 åˆåŒ¹é… pattern2 çš„è¡Œã€‚ &lt; å’Œ &gt; åˆ†åˆ«æ ‡æ³¨å•è¯çš„å¼€å§‹ä¸Žç»“å°¾:grep man * ä¼šåŒ¹é… â€˜Batmanâ€™ã€â€˜manicâ€™ã€â€˜manâ€™ç­‰ï¼Œgrep â€˜&lt;manâ€™ * åŒ¹é…â€˜manicâ€™å’Œâ€˜manâ€™ï¼Œä½†ä¸æ˜¯â€˜Batmanâ€™ï¼Œgrep â€˜&lt;man&gt;â€˜ åªåŒ¹é…â€˜manâ€™ï¼Œè€Œä¸æ˜¯â€˜Batmanâ€™æˆ–â€˜manicâ€™ç­‰å…¶ä»–çš„å­—ç¬¦ä¸²ã€‚â€˜^â€™ï¼šæŒ‡åŒ¹é…çš„å­—ç¬¦ä¸²åœ¨è¡Œé¦–ï¼Œâ€˜$â€™ï¼šæŒ‡åŒ¹é…çš„å­—ç¬¦ä¸²åœ¨è¡Œå°¾ï¼Œ æ–‡ä»¶å­—ç¬¦è½¬ç iconv -f UTF8 -t GB18030 a.csv &gt;b.csv æŸ¥æ‰¾æ–‡ä»¶find /Applications/Xcode.app -name stdio.h æŸ¥çœ‹æ–‡ä»¶å¤§å°åˆ†å¸ƒdu -sh *du -d 1 h(Xcodeçš„ç¼“å­˜å’Œå„ç‰ˆæœ¬çš„iOS SDKå ç”¨é‡æžå¤§ï¼Œä¼šé€ æˆç³»ç»Ÿå ç”¨ç£ç›˜æ¯”ä¾‹æžé«˜) æ ¹æ®å ç”¨ç«¯å£æ€è¿›ç¨‹lsof -i:ç«¯å£å·kill -9 PID æ‰§è¡ŒXcodeåŠŸèƒ½ï¼ˆxcrunï¼‰# æˆªå›¾ xcrun simctl io booted screenshot /pictures/test.png # å½•å± xcrun simctl io booted recordVideo /videos/test.mp4 # æŸ¥çœ‹å·²å®‰è£…è®¾å¤‡ xcrun simctl list xcrun instruments -s # å¯åŠ¨æ¨¡æ‹Ÿå™¨ ï¼ˆXcode9ä»¥ä¸‹ï¼‰ xcrun simctl boot $UUID xcrun instruments -w &quot;iPhone 8(11.2)&quot; xcrun simctl boot &quot;iPhone 8(11.2)&quot; ï¼ˆXcode9æˆ–ä»¥ä¸Šï¼‰ open -a &apos;Simulator&apos; --args -CurrentDeviceUDID &lt;device_udid_here&gt; # å…³é—­æ¨¡æ‹Ÿå™¨ xcrun simctl shutdown $UUID # é‡ç½®æ¨¡æ‹Ÿå™¨ xcrun simctl erase $UUID # å®‰è£…æŒ‡å®šapp xcrun simctl install booted &lt;appè·¯å¾„&gt; xcrun simctl install &lt;device&gt; &lt;appè·¯å¾„&gt; # è¿è¡ŒæŒ‡å®šapp xcrun simctl launch booted &lt;bundle identifier&gt; xcrun simctl launch &lt;device&gt; &lt;bundle identifier&gt; # å…³é—­app xcrun simctl terminate booted &lt;bundle identifer&gt; xcrun simctl terminate &lt;device&gt; &lt;bundle identifier&gt; # å¸è½½app xcrun simctl uninstall booted &lt;bundle identifer&gt; xcrun simctl uninstall &lt;device&gt; &lt;bundle identifier&gt; # æ¨¡æ‹Ÿå™¨ä¸ŽMacä¹‹é—´å¤åˆ¶ç²˜è´´ pbcopy pbpaste xcrun simctl pbcopy booted xcrun simctl pbpaste booted xcrun simctl pbsync sourceDevice destDevice # å¸®åŠ© xcrun simctl -h]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>command</tag>
        <tag>Mac</tag>
        <tag>question</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ©ç”¨Firebaseå®žçŽ°çš„æŽ¨é€åŠŸèƒ½ç³»ç»Ÿ]]></title>
    <url>%2Funcategorized%2F%E5%88%A9%E7%94%A8Firebase%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%8E%A8%E9%80%81%E5%8A%9F%E8%83%BD%E7%B3%BB%E7%BB%9F%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸æ˜¯ä¸€ç¯‡ä»‹ç»å¦‚ä½•æŽ¥å…¥Notificationçš„æ•™ç¨‹ï¼Œè€Œä¸»è¦æ˜¯å…³è”èµ·åº”ç”¨ä¸šåŠ¡æ¥è®²è¿°å…³äºŽåˆ°ç‚¹çš„æŽ¨é€æ¨¡å¼çš„å®žçŽ°è¿‡ç¨‹ï¼Œä»¥åŠè¡¥å……ä¸€äº›æŽ¨é€æŽ¥å…¥æ—¶çš„æ³¨æ„ç‚¹ã€‚æŽ¥å…¥æ•™ç¨‹çš„è¯ï¼Œå–µç¥žçš„è¿™ç¯‡ã€Šæ´»ä¹…è§çš„é‡æž„ - iOS 10 UserNotifications æ¡†æž¶è§£æžã€‹å·²ç»ååˆ†æœ‰æ¡ç†åœ°æŠŠUserNotificationçš„ç»†èŠ‚è¯´å¾—éžå¸¸æ¸…æ™°ã€‚ ä¸šåŠ¡èƒŒæ™¯ä¸šåŠ¡éœ€æ±‚æ˜¯ï¼Œåˆ©ç”¨Firebase Cloud Messageï¼ˆä¸‹æ–‡ç®€ç§°FCMï¼‰è¿™ä¸ªäº‘æ¶ˆæ¯ç³»ç»Ÿä½œä¸ºä¸­é—´å·¥å…·ï¼Œå®žçŽ°åˆ°ç‚¹çš„æŽ¨é€ï¼Œè¿™é‡Œè¯´çš„ç‚¹å¹¶ä¸æ˜¯ä¼ ç»Ÿçš„æŒ‡ä¸€å°è®¾å¤‡ï¼Œè€Œæ˜¯æŒ‡ä¸€ä¸ªè´¦å·æˆ–è€…ä¸€ä¸ªè§’è‰²ï¼Œä¾‹å¦‚æŽ¨é€ç»™è¾¾åˆ°æŒ‡å®šç­‰çº§ï¼Œæˆ–è€…æ»¡è¶³äº†ç‰¹å®šæ¡ä»¶çš„ç”¨æˆ·ç¾¤ï¼Œåˆä¾‹å¦‚æŽ¨é€ç»™åŠ å…¥äº†å…¬ä¼šçš„æˆå‘˜ï¼Œæˆ–è€…ä¼šé•¿å‘é€å¹¿æ’­é€šçŸ¥æŽ¨é€ã€‚ åŸºäºŽFCMçš„å®žçŽ°ï¼Œä¼šç®€åŒ–äº†å¾ˆå¤§ä¸€éƒ¨åˆ†çš„å·¥ä½œï¼ŒåŒ…æ‹¬ï¼š iOS DeviceTokençš„ç®¡ç†ï¼šFCMä¼šç”Ÿæˆä¸€ä¸ªInstance Tokenæ¥è¿›è¡Œå…³è”ï¼Œå®ƒçš„åŽå°ä½¿ç”¨è¿™ä¸ªæ˜ å°„å…³ç³»æ‰¾å‡ºDeviceTokenç„¶åŽå‘æŽ¨é€APNSã€‚ æœåŠ¡ç«¯è·¨å¹³å°çš„å¯¹æŽ¥ï¼šæœåŠ¡ç«¯æä¾›ç»™å®¢æˆ·ç«¯æŽ¥å…¥çš„ä¸šåŠ¡é€»è¾‘æŽ¥å£æ˜¯ç»Ÿä¸€çš„ï¼Œè€Œå‘FCMå‘æ¶ˆæ¯çš„æŽ¥å£æ˜¯å•ä¸€çš„ï¼Œç»™ä¸åŒå¹³å°å‘é€æ¶ˆæ¯çš„éƒ¨åˆ†å°è£…åœ¨FCMçš„æŽ¥å£å†…éƒ¨ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘åŒºåˆ†iOSå’ŒAndroidçš„å·®å¼‚å³èƒ½å®Œæˆè·¨å¹³å°çš„å¯¹æŽ¥ã€‚ åˆ†ç±»æŽ¨é€åŠŸèƒ½ï¼šFCMä¼šå»ºç«‹å¤šä¸ªè®¾å¤‡Instance Tokenå¯¹åº”Topicesï¼ˆä¸»é¢˜ï¼‰ã€Eventï¼ˆè¡Œä¸ºï¼‰çš„å…³ç³»è¡¨ï¼Œåœ¨å‘æ¶ˆæ¯æ—¶å¯ä»¥é€‰æ‹©é’ˆå¯¹æŸä¸€Topicæˆ–è€…Eventï¼Œå®žçŽ°ç‰¹å®šç”¨æˆ·ç¾¤çš„æŽ¨é€ã€‚è€Œè¡¨ä¸­çš„å…³ç³»æœ‰å®¢æˆ·ç«¯è§¦å‘å¢žåŠ æˆ–åˆ é™¤ï¼Œè€ŒæŽ§åˆ¶å®¢æˆ·ç«¯è¿™ä¸ªæ“ä½œçš„åˆ™æ˜¯ä¸šåŠ¡éœ€æ±‚è€Œå®šäº†ï¼Œä¸‹é¢å°†ä¼šè®²è¿°ã€‚ è®¾å¤‡ç»„æŽ¨é€åŠŸèƒ½ï¼šèƒ½è‡ªå®šä¹‰æ†ç»‘å™¨ä¸€å †Instance Tokenï¼Œåˆ©ç”¨è¿™ä¸ªTokençš„æ†ç»‘åŒ…ä¸ºå•ä½ä½œä¸ºä¸€ä¸ªæŽ¨é€ç‚¹ã€‚ æ­¤å¤„çš„ä¸šåŠ¡åº”ç”¨æ˜¯åŸºäºŽæ‰‹æ¸¸Appä¸Šé¢å±•å¼€çš„ã€‚ ä¸šåŠ¡å®žçŽ°æ³¨å†ŒæŽ¨é€åœ¨åˆé€‚çš„ä½ç½®è°ƒç”¨ä»¥ä¸‹æ–¹æ³•ï¼Œæ¥èŽ·å–æŽ¨é€æŽˆæƒï¼Œæ³¨å†ŒæŽ¨é€ã€‚ç”±äºŽè¢«æ‹’ç»æŽˆæƒåŽï¼Œé‡æ–°èŽ·å–æŽˆæƒä¼šååˆ†éº»çƒ¦ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥å°½é‡è€ƒè™‘æ”¾åœ¨èƒ½æ¿€èµ·ç”¨æˆ·æŽ¥æ”¶æŽ¨é€çš„ä½ç½®æˆ–è€…æ—¶æœºå†è§¦å‘ã€‚ #ifdef __IPHONE_8_0 if ([application respondsToSelector:@selector(registerForRemoteNotifications)]) &#123; [application registerForRemoteNotifications]; [application registerUserNotificationSettings:[UIUserNotificationSettings settingsForTypes: UIUserNotificationTypeNone| UIUserNotificationTypeBadge| UIUserNotificationTypeSound categories:nil]]; &#125; else &#123; [application registerForRemoteNotificationTypes:UIRemoteNotificationTypeAlert|UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeSound]; &#125; #else [application registerForRemoteNotificationTypes:UIRemoteNotificationTypeAlert|UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeSound]; #endif å¤„ç†é€šçŸ¥é€šçŸ¥çš„æŽ¥æ”¶åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µ çŠ¶æ€ ç±»åž‹ å¤„ç†ä½ç½®(UIApplicationDelegate/UNUserNotificationCenterDelegate) Appåœ¨å‰å° è¿œç¨‹é€šçŸ¥ Appåœ¨å‰å° æœ¬åœ°é€šçŸ¥ Appåœ¨åŽå° è¿œç¨‹é€šçŸ¥ Appåœ¨åŽå° æœ¬åœ°é€šçŸ¥ ç„¶åŽåœ¨æŽ¨é€æ¶ˆæ¯ä¸­è®¾è®¡äº†ä¸€äº›é™„åŠ å­—æ®µæŽ§åˆ¶æ¶ˆæ¯çš„ç±»åž‹ã€å†…å®¹ã€æ˜¾ç¤ºæ–¹å¼ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªå­—æ®µ FirebaseContentTypeï¼šæ¶ˆæ¯çš„ç±»åž‹ï¼Œä¾‹å¦‚urlã€dialog FirebaseContentï¼šæ¶ˆæ¯çš„å†…å®¹ï¼Œä¾‹å¦‚å¯¹åº”urlçš„ä¸€ä¸ªåœ°å€ã€æˆ–è€…å¯¹åº”dialogçš„ä¸€æ®µæ–‡æœ¬ FirebaseShowModeï¼šæ¶ˆæ¯å±•ç¤ºæ–¹å¼ï¼Œä¾‹å¦‚è€ƒè™‘æ¸¸æˆç”¨æˆ·å¯èƒ½ä¸æƒ³è¢«æ‰“æ–­æ“ä½œï¼Œåˆ™åº”ä½¿ç”¨æ¨ªå¹…æç¤ºçš„å½¢å¼ï¼Œå…¶å®ƒæƒ…å†µå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼¹æç¤ºæ¡†è¯¢é—®ã€æˆ–è€…ç›´æŽ¥æ˜¾ç¤ºã€ç”šè‡³è‡ªå®šä¹‰æ˜¾ç¤ºå½¢å¼ã€‚ æœ¬åœ°é€šçŸ¥å¤„ç†æœªå¯åŠ¨Appçš„æŽ¥æ”¶iOS10ä»¥å‰ï¼Œåœ¨application:didFinishLaunchingWithOptions:é‡Œåˆ©ç”¨launchOptionsæºå¸¦çš„ä¿¡æ¯å¤„ç†æœ¬åœ°æŽ¨é€å¯åŠ¨Appçš„äº‹ä»¶ï¼Œä½†ä¸åšè¿œç¨‹æŽ¨é€çš„å¤„ç†ï¼Œå› ä¸ºapplication:didReceiveRemoteNotification:fetchCompletionHandler:ä¼šåœ¨å½“å‰å›žè°ƒæ–¹æ³•æ‰§è¡Œå®Œä¹‹åŽæŽ¥ç€è¢«è°ƒç”¨ï¼Œè¿™ä¹Ÿæ˜¯å®žçŽ°é™é»˜æŽ¨é€çš„æ–¹æ³•ï¼Œè€Œapplication:didReceiveLocalNotification:ä¸ä¼šè¢«è°ƒç”¨ã€‚ iOS10åŠä»¥ä¸Šï¼Œåº”åœ¨æ­¤å›žè°ƒä¸­åˆå§‹åŒ–UserNotificationCenterçš„delegateï¼Œå¹¶å®žçŽ°å¯¹åº”çš„UNUserNotificationCenterDelegateæ–¹æ³•ã€‚ - (void)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; Â·Â·Â· #ifdef __IPHONE_10_0 if ([[UIDevice currentDevice] systemVersion].floatValue &gt;= 10.0) &#123; EFNFirebaseNontificationController *notificationController = [[[self class] alloc] init]; [UNUserNotificationCenter currentNotificationCenter].delegate = notificationController; return; &#125; #endif UILocalNotification *localNotification = launchOptions[UIApplicationLaunchOptionsLocalNotificationKey]; if (localNotification) &#123; NSString *contentType = localNotification.userInfo[EFNFirebaseNotificationUserInfoContentTypeKey]; NSString *content = localNotification.userInfo[EFNFirebaseNotificationUserInfoContentKey]; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; //ä¸šåŠ¡å¤„ç† [self private_handleNotificationWithContentType:contentType content:content]; &#125;); &#125; &#125; è¿™é‡Œæœ‰ä¸‰ä¸ªæ³¨æ„ç‚¹ ç”±äºŽæ¸¸æˆçš„ä¸»Windowåˆå§‹åŒ–å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œé¿å…åŽé¢çš„ä¸€äº›åœ¨Windowæˆ–è€…RootViewControllerçš„viewä¸Šäº¤äº’çš„UIå‡ºçŽ°æ˜¾ç¤ºå¼‚å¸¸ï¼Œè¿™é‡Œåšäº†ä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„å¤„ç†ã€‚ UIApplicationLaunchOptionsLocalNotificationKeyå·²ç»è¢«æŠ›å¼ƒäº†ï¼Œæ‰€ä»¥å®ƒåº”è¯¥åªä½œä¸ºå…¼å®¹å¤„ç†ï¼Œå°½é‡ä½¿ç”¨UserNotificationï¼Œè®¾ç½®[UNUserNotificationCenter currentNotificationCenter].delegateæˆä¸ºå¿…é¡»è¦å®žçŽ°çš„éƒ¨åˆ†ã€‚ è‹¥é€šè¿‡ç‚¹å‡»æœ¬åœ°æŽ¨é€æ¶ˆæ¯å¯åŠ¨Appçš„è¯ï¼ŒlaunchOptionsçš„ç»“æž„åˆ™æ˜¯è¿™æ ·çš„ //launchOptions &#123; UIApplicationLaunchOptionsLocalNotificationKey = &quot;&lt;UIConcreteLocalNotification: 0x17018cd90&gt;&#123;fire date = 2018\134U5e741\134U670815\134U65e5 \134U661f\134U671f\134U4e00 \134U4e2d\134U56fd\134U6807\134U51c6\134U65f6\134U95f4 \134U4e0b\134U53487:25:56, time zone = (null), repeat interval = 0, repeat count = UILocalNotificationInfiniteRepeatCount, next fire date = (null), user info = &#123;\134n FirebaseMsg = https://www.google.com;\134n FirebaseType = url;\134n&#125;&#125;&quot;; &#125; //localNotification.userInfo &#123; FirebaseContent = &quot;https://www.google.com&quot;; FirebaseContentType = url; &#125; è€Œé€šè¿‡ç‚¹å‡»è¿œç¨‹æŽ¨é€æ¶ˆæ¯å¯åŠ¨Appçš„è¯ï¼Œåœ¨application:didFinishLaunchingWithOptions:çš„launchOptionsç»“æž„æ˜¯è¿™æ ·çš„ &#123; UIApplicationLaunchOptionsRemoteNotificationKey = &#123; FirebaseContent = &quot;https://www.google.com&quot;; FirebaseShowMode = none; FirebaseContentType = url; aps = &#123; alert = push6; &#125;; &quot;gcm.message_id&quot; = &quot;0:1516016736340703%99c10dc399c10dc3&quot;; &quot;gcm.n.e&quot; = 1; &quot;google.c.a.c_id&quot; = 7885967838754698804; &quot;google.c.a.e&quot; = 1; &quot;google.c.a.ts&quot; = 1516016735; &quot;google.c.a.udt&quot; = 0; &#125;; &#125; //FirebaseMsgã€FirebaseShowã€FirebaseTypeè¿™ä¸‰ä¸ªé™„åŠ å­—æ®µæ˜¯è‡ªå®šä¹‰çš„ï¼Œç”¨æ¥æŽ§åˆ¶ä¸šåŠ¡é€»è¾‘ï¼Œå…¶å®ƒgcmã€googleçš„æ˜¯Firebaseå®šä¹‰çš„ã€‚è€Œapsåˆ™æ˜¯ç³»ç»Ÿå®šä¹‰çš„ï¼Œåœ¨åªè®¾ç½®æŽ¨é€æ¶ˆæ¯çš„bodyæ—¶ï¼Œé‡Œé¢çš„alertçš„å€¼åˆ™ä¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€ŒæŠŠæ¶ˆæ¯çš„titleã€subtitleç­‰éƒ½è®¾ç½®ä¸Šçš„è¯ï¼Œalertçš„å€¼åˆ™ä¼šæ˜¯ä¸€ä¸ªå­—æ®µï¼Œé‡Œé¢æ‰åŒºåˆ†bodyã€titleã€subtitleã€‚ æ›´å¤šçš„Payloadæ ¼å¼å‚è€ƒã€‚ iOS10åŠä»¥ä¸Šæ—¶ï¼Œé‡‡ç”¨UNUserNotificationCenterDelegateå¤„ç†æŽ¨é€çš„è¯ï¼Œé€šè¿‡ç‚¹å‡»æŽ¨é€ï¼ˆä¸åˆ†æœ¬åœ°æˆ–æ˜¯è¿œç¨‹ï¼‰å¯åŠ¨Appå°±ä¼šå›žè°ƒä»¥ä¸‹ä»£ç†æ–¹æ³• #ifdef __IPHONE_10_0 - (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void(^)(void))completionHandler &#123; NSDictionary *userInfo = response.notification.request.content.userInfo; NSString *contentType = userInfo[EFNFirebaseNotificationUserInfoContentTypeKey]; NSString *content = userInfo[EFNFirebaseNotificationUserInfoContentKey]; [self private_handleNotificationWithContentType:contentType content:content]; !completionHandler?:completionHandler(); &#125; #endif è‹¥è¦çŸ¥é“æŽ¨é€çš„æ¥æºï¼Œåˆ™å¯é€šè¿‡åˆ¤æ–­response.notification.request.triggerçš„ç±»åž‹æ¥åŒºåˆ†ï¼Œåœ¨UNNotificationTriggerçš„å­ç±»é‡Œé¢ï¼Œé™¤äº†UNPushNotificationTriggeræ˜¯ä»£è¡¨è¿œç¨‹æŽ¨é€çš„triggerå¤–ï¼Œå…¶å®ƒå­ç±»å‡ä»£è¡¨æœ¬åœ°æŽ¨é€ã€‚ å‰åŽå°æŽ¥æ”¶iOS10ä»¥ä¸‹ï¼ˆUIApplicationDelegateï¼‰ - (void)application:(UIApplication *)application didReceiveLocalNotification:(nonnull UILocalNotification *)notification &#123; NSString *contentType = notification.userInfo[EFNFirebaseNotificationUserInfoContentTypeKey]; NSString *content = notification.userInfo[EFNFirebaseNotificationUserInfoContentKey]; [[self class] private_handleNotificationWithContentType:contentType content:content]; &#125; iOS10åŠä»¥ä¸Šï¼ˆUNUserNotificationCenterDelegateï¼‰ - (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions options))completionHandler &#123; NSDictionary *userInfo = notification.request.content.userInfo; NSDictionary *apsInfo = userInfo[@&quot;aps&quot;]; id alertInfo = apsInfo[@&quot;alert&quot;]; NSString *contentType = userInfo[EFNFirebaseNotificationUserInfoContentTypeKey]; NSString *content = userInfo[EFNFirebaseNotificationUserInfoContentKey]; NSString *showMode = userInfo[EFNFirebaseNotificationUserInfoPresentModeKey]; if (apsInfo) &#123; [[self class] private_handleRemoteNotificationWithContentType:contentType content:content showMode:showMode alertInfo:alertInfo]; &#125; else &#123; !completionHandler?:completionHandler(UNNotificationPresentationOptionAlert|UNNotificationPresentationOptionSound|UNNotificationPresentationOptionBadge); &#125; &#125; è¿™é‡Œé‡‡ç”¨åˆ¤æ–­notification.request.content.userInfoæ˜¯å¦å«æœ‰apsInfoæ¥å†³å®šæ˜¯å¦æœ¬åœ°æŽ¨é€ï¼Œè‹¥ä¸ºæœ¬åœ°æŽ¨é€çš„æ—¶å€™å°±ä¸å†é‡‡ç”¨ç³»ç»Ÿçš„æ¨ªå¹…å†æ¬¡æç¤ºã€‚ è¿œç¨‹é€šçŸ¥å¤„ç†iOS10ä»¥ä¸‹ï¼ˆUIApplicationDelegateï¼‰ - (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler &#123; NSDictionary *apsInfo = userInfo[@&quot;aps&quot;]; id alertInfo = apsInfo[@&quot;alert&quot;]; NSString *contentType = userInfo[EFNFirebaseNotificationUserInfoContentTypeKey]; NSString *content = userInfo[EFNFirebaseNotificationUserInfoContentKey]; NSString *showMode = userInfo[EFNFirebaseNotificationUserInfoPresentModeKey]; [[self class] private_handleRemoteNotificationWithContentType:contentType content:content showMode:showMode alertInfo:alertInfo]; &#125; æ³¨æ„ å½“æŽ¨é€æ¶ˆæ¯ä½“ä¸­çš„apsçš„content-availableä¸º1æ—¶ï¼ŒAppåœ¨åŽå°æŒ‚èµ·æ—¶æ–¹æ³•ä¹Ÿä¼šè¢«æ‰§è¡Œï¼Œå³æ˜¯é™é»˜æŽ¨é€(Silent-Push)ã€‚ åœ¨iOS7ä»¥ä¸Šï¼Œå®žçŽ°äº†application:didReceiveRemoteNotification:fetchCompletionHandler:æ­¤ä»£ç†æ–¹æ³•çš„è¯application:didReceiveRemoteNotification:å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚ å‰å°æˆ–åŽå°çš„æŽ¥æ”¶ä»¥åŠAppé€šè¿‡æŽ¨é€è§¦å‘å¯åŠ¨å‡é€šè¿‡æ­¤æ–¹æ³•å¤„ç†ã€‚ iOS10åŠä»¥ä¸Šï¼Œä¸Žæœ¬åœ°æŽ¨é€å…±ç”¨UNUserNotificationCenterDelegateçš„ä»£ç†æ–¹æ³•ï¼Œå‰å°æŽ¥æ”¶é€šè¿‡userNotificationCenter:willPresentNotification:withCompletionHandler:çš„å›žè°ƒå¤„ç†ï¼ŒåŽå°æŽ¥æ”¶æˆ–Appé€šè¿‡æŽ¨é€è§¦å‘å¯åŠ¨é€šè¿‡userNotificationCenter:didReceiveNotificationResponse:withCompletionHandler:çš„å›žè°ƒå¤„ç†ã€‚ å•ç”¨æˆ·æŽ¨é€ç”±æˆ‘ä»¬çš„æœåŠ¡ç«¯å»ºç«‹ç”¨æˆ·ä¸Žå…¶è®¾å¤‡çš„å…³ç³»è¡¨ï¼Œå³é€šè¿‡å®¢æˆ·ç«¯æŠŠç”¨æˆ·æ¯æ¬¡ç™»é™†çš„user IDä¸Žå½“å‰è®¾å¤‡çš„FCM Tokenä¸Šä¼ ç»™æœåŠ¡ç«¯æ’å…¥è¡¨ï¼Œè¿™æ ·æ¯ä¸ªç”¨æˆ·å°±ä¼šæœ‰ä¸€ä¸ªè®¾å¤‡ç»„å¯¹åº”ï¼Œåˆ©ç”¨FCMçš„è®¾å¤‡ç»„æŽ¨é€åŠŸèƒ½ï¼Œå°±èƒ½é’ˆå¯¹æŸä¸€ä¸ªæˆ–ä¸€ç¾¤æŒ‡å®šuser IDçš„ç”¨æˆ·çš„æ‰€æœ‰ç™»å½•ä¸­çš„è®¾å¤‡å®žæ–½æŽ¨é€ï¼Œä¾‹å¦‚è¡¥å¿å¥–åŠ±ç»™ç‰¹å®šçŽ©å®¶ä¹‹åŽï¼Œå¯¹ç‰¹å®šå¤§Rçš„é€šçŸ¥ç­‰ç­‰ã€‚ å½“ç”¨æˆ·ç™»å‡ºï¼Œæˆ–ä½¿ç”¨æ–°è´¦å·ç™»å½•ï¼Œåˆ™ä¸ŠæŠ¥æ–°ç™»å½•çš„user IDä¸Žå½“å‰è®¾å¤‡çš„FCM Tokenåˆ°æœåŠ¡ç«¯ï¼Œå½“æ²¡æœ‰è¯¥user IDçš„è®°å½•ï¼Œåˆ™å»ºç«‹åˆå§‹å¯¹åº”å…³ç³»ï¼Œè‹¥å·²æœ‰è®°å½•åˆ™å‘å…¶å·²å¯¹åº”çš„è®¾å¤‡ç»„æŽ¨é€æ–°è®¾å¤‡çš„ç™»å½•é€šçŸ¥ã€‚FCMä¼šè¿”å›žæŽ¨é€å¤±è´¥çš„è®¾å¤‡ï¼Œè¿™äº›è®¾å¤‡å¯èƒ½æ˜¯æ›´æ–°äº†FCM Tokenï¼Œæ—§Tokenå¤±æ•ˆæ‰€è‡´ã€‚ç„¶åŽæœåŠ¡ç«¯å°±å¯ä»¥å‘FCMç”³è¯·åˆ é™¤å¤±æ•ˆçš„Tokenå’Œæ·»åŠ æ–°å…³è”çš„Tokenåˆ°å½“å‰user IDçš„è®¾å¤‡ç»„é‡Œé¢ã€‚æ­¤æ—¶è®¾å¤‡ç»„å…³ç³»æ›´æ–°å®Œæ¯•ï¼Œè¿™å°±æ˜¯å¹³æ—¶æˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„å®‰å…¨ç™»å½•é€šçŸ¥åŠŸèƒ½ã€‚ ç¾¤æŽ¨é€æ ¹æ®è´¦å·çš„æ“ä½œï¼Œå†³å®šç”¨æˆ·æ‰€å±žçš„æŽ¨é€ç¾¤ã€‚ä¾‹å¦‚å°ç™½ç”¨æˆ·ä¸€ç›´å‡çº§ï¼Œåˆ°äº†5çº§å°±æ˜¯è§¦å‘è¿›å…¥5çº§æŽ¨é€ç¾¤ç»„é‡Œé¢ï¼Œå³å½“å‰è®¾å¤‡ä¼šè®¢é˜…åœ¨FCMé¢„å®šä¹‰çš„5çº§ä¸»é¢˜ï¼ˆlevel5 Topicï¼‰ï¼Œè¿™ä¹Ÿä¼šå½“ä½œå½“å‰ç”¨æˆ·çš„ä¸€é¡¹å±žæ€§å­˜åœ¨æœåŠ¡ç«¯ï¼Œå½“ç”¨æˆ·åœ¨å…¶å®ƒè®¾å¤‡æˆ–è€…é‡è£…åº”ç”¨åŽèƒ½è¢«æ¢å¤ã€‚è¿™æ ·åŽå°æŽ¨é€ç»™level5 Topicæ—¶ï¼Œæ‰€æœ‰è¾¾åˆ°æ­¤æ¡ä»¶ï¼Œå³æ˜¯è®¢é˜…äº†æ­¤ä¸»é¢˜çš„ç”¨æˆ·éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ï¼Œå…¶ä»–ç”¨æˆ·åˆ™ä¸ä¼šæ”¶åˆ°ã€‚ ä½†åªä½¿ç”¨å•ä¸€ä¸»é¢˜æŽ§åˆ¶ç¾¤æŽ¨é€ä»æœªèƒ½æ»¡è¶³éœ€æ±‚ï¼Œç”±äºŽæ¸¸æˆå¯èƒ½æ˜¯å¤šè¯­è¨€çš„ï¼Œä¸åŒç”¨æˆ·å¯èƒ½ä¼šåˆ‡æ¢åˆ°ä¸åŒçš„è¯­è¨€ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹æŽ¨é€æ‰€ç”¨çš„è¯­è¨€ä¹Ÿåº”è¯¥ä¸€è‡´ã€‚ä½†åŸºäºŽä¸åŒç¾¤ä¸»é¢˜å†é’ˆå¯¹ä¸åŒè¯­è¨€ç”Ÿæˆä¸åŒçš„Topicæ˜¯ä¸çŽ°å®žçš„ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´äº§ç”Ÿå¤§é‡çš„Topicï¼Œè€ŒGoogleå¯¹Topicçš„æ•°é‡æŽ§åˆ¶åˆæ˜¯æœªçŸ¥çš„ã€‚ æˆ‘ä»¬åˆ©ç”¨äº†FCM Topicçš„é€»è¾‘å…³ç³»æŽ§åˆ¶æŽ¨é€æŽ¥æ”¶çš„åŠŸèƒ½ï¼Œè§£å†³ä¸Šé¢è¿™ä¸ªé—®é¢˜ã€‚ç”¨æˆ·è¿›å…¥æ¸¸æˆéƒ½ä¼šå…ˆè®¢é˜…ä¸€ä¸ªæ¸¸æˆæ ‡è¯†+è¯­è¨€æ ‡è¯†å‘½åçš„Topicï¼Œå½“ç”¨æˆ·åˆ‡æ¢è¯­è¨€æ—¶å°±ä¼šå–æ¶ˆä¹‹å‰è¯­è¨€çš„Topicè®¢é˜…ï¼Œé‡æ–°è®¢é˜…æ¸¸æˆæ ‡è¯†+æ–°è¯­è¨€æ ‡è¯†çš„Topicã€‚æœåŠ¡ç«¯è¦æŽ¨é€æ¶ˆæ¯æ—¶ï¼Œå…ˆèŽ·å–ä¸åŒè¯­è¨€ç‰ˆæœ¬çš„æ¶ˆæ¯ä½“ï¼Œç„¶åŽå°†ä¸åŒè¯­è¨€çš„æ¶ˆæ¯ä½“é€šè¿‡ç¾¤Topic &amp;&amp; è¯­è¨€Topicçš„æ–¹å¼å¯¹åº”æŽ¨é€ï¼Œè¿™æ ·æ²¡æœ‰è®¢é˜…å…¶å®ƒè¯­è¨€Topicçš„ï¼Œä¸”æ²¡ç¬¦åˆç¾¤æ¡ä»¶çš„ç”¨æˆ·å°±ä¸ä¼šæ”¶åˆ°å…¶å®ƒè¯­è¨€çš„æŽ¨é€äº†ã€‚ åŒæ—¶è¿™ä¸ªæ¸¸æˆè¯­è¨€Topicå¯ä½œä¸ºæ­¤æ¸¸æˆçš„æ€»æŽ¨é€å¼€å…³ï¼Œå–æ¶ˆè®¢é˜…çš„è¯åˆ™æ‰€æœ‰æŽ¨é€éƒ½ä¸å†æ”¶åˆ°ï¼Œå› ä¸ºå…¶å®ƒTopicéƒ½éœ€è¦&amp;&amp;è¿™ä¸ªæ¸¸æˆè¯­è¨€Topicæ¥å‘é€ï¼Œä¸è®¢é˜…å®ƒå°±æ— æ³•æŽ¥æ”¶ã€‚ å½“ç”¨æˆ·ç™»å‡ºæ—¶ï¼Œåˆ™æŠŠå½“å‰è®¾å¤‡è®¢é˜…è¿‡çš„Topicå…¨å–æ¶ˆè®¢é˜…ï¼Œé¿å…ä¸Žæ–°ç”¨æˆ·çš„è®¢é˜…æ··æ·†ã€‚ç„¶åŽç­‰æ–°ç”¨æˆ·ç™»å½•åŽé‡æ–°åˆå§‹åŒ–ç”¨æˆ·æŽ¨é€ç¾¤çš„è®¢é˜…ã€‚ å…¬ä¼šæŽ¨é€å…¬ä¼šçš„æŽ¨é€æ˜¯é’ˆå¯¹è§’è‰²è€Œä¸æ˜¯ç”¨æˆ·çš„ï¼Œæ‰€ä»¥è¿™ç±»æŽ¨é€æ˜¯ç‹¬ç«‹çš„ï¼ˆå½“ç„¶å¯ä»¥åšæˆå—æ€»æŽ¨é€å¼€å…³æŽ§åˆ¶ï¼‰ã€‚ å½“è§’è‰²è¿›å…¥æ¸¸æˆåŽï¼Œé¦–å…ˆä¼šæ ¹æ®æ¸¸æˆå½“å‰è¯­è¨€è®¢é˜…ä¸€ä¸ªå…¬ä¼šè¯­è¨€Topicï¼ˆåˆ‡æ¢è¯­è¨€æ—¶è¿™ä¸ªè®¢é˜…ä¹Ÿè¦è·Ÿç€åˆ‡æ¢ï¼‰ã€‚ ç„¶åŽå½“è§’è‰²åŠ å…¥æŸä¸€å…¬ä¼šæ—¶ï¼Œåˆ™è®¢é˜…æ¸¸æˆæ ‡è¯†+å…¬ä¼šæ ‡è¯†çš„Topicã€‚è€Œå½“è§’è‰²åœ¨å…¬ä¼šé‡Œå…³é—­å…¬ä¼šæŽ¨é€åŠŸèƒ½ï¼Œæˆ–è€…é€€å‡ºå…¬ä¼šï¼Œåˆ™éœ€è¦å–æ¶ˆè®¢é˜…æ¸¸æˆæ ‡è¯†+å…¬ä¼šæ ‡è¯†çš„Topicã€‚ ç™»å‡ºè§’è‰²æˆ–è€…ç™»å‡ºè´¦å·æ—¶ï¼Œä¹Ÿéœ€è¦å–æ¶ˆè®¢é˜…æ¸¸æˆæ ‡è¯†+å…¬ä¼šæ ‡è¯†çš„Topicï¼Œè€Œå…¬ä¼šè¯­è¨€Topicåˆ™ä¸ç”¨å˜åŠ¨ï¼Œå› ä¸ºå®ƒæ ¹æ®æ¸¸æˆè¯­è¨€è€Œå®šçš„ï¼Œä¸å—è§’è‰²æˆ–è€…è´¦å·çš„å˜åŠ¨å½±å“ã€‚ å‘é€å®˜æ–¹çš„å…¬ä¼šæ¶ˆæ¯æ—¶å°†ä¸åŒè¯­è¨€çš„æ¶ˆæ¯ä½“é€šè¿‡æ¸¸æˆå…¬ä¼šTopic &amp;&amp; å…¬ä¼šè¯­è¨€Topicçš„æ–¹å¼å¯¹åº”æŽ¨é€ã€‚ä½†å…¬ä¼šé•¿çš„æ¶ˆæ¯åˆ™ç›´æŽ¥ä½¿ç”¨æ¸¸æˆå…¬ä¼šTopicå‘é€ï¼Œå› ä¸ºæ˜¯ä»¥ä¼šé•¿çš„è¯­è¨€ä¸ºå‡†ï¼Œè¿™æ ·åªéœ€è¦ä¿æŒä¼šé•¿çš„åŽŸæ–‡è¿›è¡ŒæŽ¨é€å³å¯ï¼Œä¸éœ€æ¸¸æˆå…¬ä¼šTopicè¾…åŠ©é€»è¾‘ã€‚ æž¶æž„å®žçŽ°ç±»çš„ç»“æž„å¦‚ä¸‹ â”œâ”€â”€ EFNFirebaseNontificationController â”œâ”€â”€ EFNFirebaseNotification â”œâ”€â”€ EFNFirebaseGroupNotification â”œâ”€â”€ EFNFirebaseGuildNotification â””â”€â”€ EFNFirebaseSingleNotification EFNFirebaseNontificationControllerï¼šè´Ÿè´£: æœ¬åœ°å’Œè¿œç¨‹ã€å‰å°å’ŒåŽå°çš„æŽ¨é€æŽ¥æ”¶ï¼› æŽ¥æ”¶æŽ¨é€åŽçš„æŽ¨é€å±•ç¤ºé€»è¾‘åŠå±•ç¤ºå®žçŽ°ï¼› ä½œä¸ºä¸€ä¸ªçŽ¯å¢ƒè§’è‰²ç±»ï¼Œè´Ÿè´£æ‰§è¡Œç­–ç•¥æ–¹æ³•ï¼Œä¸å…³æ³¨å…·ä½“çš„ç­–ç•¥ç±»ã€‚ EFNFirebaseNotificationï¼šæŠ½è±¡ç­–ç•¥ç±»ï¼ŒæŠŠå•æŽ¨ã€ç¾¤æŽ¨ã€å…¬ä¼šæŽ¨çš„åŠŸèƒ½æŠ½è±¡å‡ºæ¥ï¼Œæä¾›ç»™çŽ¯å¢ƒè§’è‰²ç›´æŽ¥è°ƒç”¨ã€‚ EFNFirebaseGroupNotificationï¼šç¾¤æŽ¨çš„å…·ä½“ç­–ç•¥ç±»ã€‚ EFNFirebaseGuildNotificationï¼šå…¬ä¼šæŽ¨çš„å…·ä½“ç­–ç•¥ç±»ã€‚ EFNFirebaseSingleNotificationï¼šå•æŽ¨çš„å…·ä½“ç­–ç•¥ç±»ã€‚ æŠ½è±¡çš„ç­–ç•¥æ–¹æ³•ä¸»è¦åŒ…æ‹¬ï¼š setupNotificationWithUnitID: - è®¾å®šæˆ–æ¢å¤æŽ¨é€å•ä½è®¢é˜…å¹¶ç¼“å­˜ï¼ŒæŽ¨é€å•ä½æ˜¯æŒ‡è´¦å·user IDæˆ–è€…è§’è‰²role IDè¿™äº›ï¼› clearLastUnitNotificationStatusInDevice - æ¸…é™¤æŽ¨é€å•ä½çš„è®¢é˜…å’Œç¼“å­˜ changeNotificationShouldSubscribe:unitID: - åˆ‡æ¢æŽ¨é€å•ä½çš„è®¢é˜…å¼€å…³ æ€»ç»“å†™äº†è¿™ä¹ˆå¤šï¼Œæ„Ÿè§‰å†™æ–‡ç« çš„æ€è·¯è¿˜æ˜¯æ¯”è¾ƒæ··ä¹±ï¼Œç‰¹åˆ«å½“å†…å®¹æ¯”è¾ƒå¤šï¼Œæƒ…å†µåˆ†ç±»å¤šï¼Œå»¶ä¼¸çš„å­æƒ…å†µä¹Ÿå¤šçš„æ—¶å€™ï¼Œå°±å‡ºçŽ°æ¥å›žä¿®æ”¹æ–‡ç« ï¼Œå¤šæ¬¡æŽ’ç‰ˆçš„é—®é¢˜ï¼Œæ®µè½åˆ’åˆ†ä¹Ÿä¸æ¸…æ™°ã€‚çœ‹æ¥è¦æ¶è¡¥ä¸€ä¸‹æŠ€æœ¯æ–‡ç« æ’°å†™çš„æŠ€å·§å’Œåæ€ä¸€ä¸‹æ–‡ç« å¸ƒå±€çš„æ€ç»´ï¼Œä¸‹æ¬¡å†™æ–‡ç« ä¸èƒ½å†å‡ºçŽ°è¿™ç§æ··ä¹±çš„æƒ…å†µï¼Œä¸‹é”®ç›˜å‰éœ€è¦æ€è€ƒä¸€ä¸‹æ•´ä½“çš„è®¡åˆ’ï¼Œé”»ç‚¼è¯­è¨€çš„ç»„ç»‡èƒ½åŠ›ã€‚ ç„¶åŽå…³äºŽæŽ¨é€ï¼Œè¿˜æœ‰å¥½ä¸€äº›åŠŸèƒ½è¿˜æ²¡ä½¿ç”¨ä¸Šï¼Œä¾‹å¦‚æŽ¨é€æ¶ˆæ¯ä¸­çš„Categoryã€å›¾ç‰‡ã€é“ƒå£°éŸ³é¢‘ï¼Œæ—¥æœŸæŽ¨é€ã€å®šä½æŽ¨é€ç­‰ç­‰ï¼ŒæœŸå¾…ä¸‹æ¬¡åº”ç”¨åˆ°çš„æ—¶å€™å†æ¬¡æ€»ç»“ï¼Œä»Žä¾§é¢æ¥çœ‹ï¼Œæœ¬ä¸åº”å¾…åº”ç”¨çš„æ—¶å€™æ‰æ€»ç»“ï¼Œå½“Appleæœ‰åŠŸèƒ½æ›´æ–°çš„æ—¶å€™å°±è¯¥è¯•çŽ©ï¼Œç„¶åŽæ€»ç»“ï¼Œèµ°åœ¨æœ€å‰ã€‚ å‚è€ƒæ–‡ç« ï¼šæ´»ä¹…è§çš„é‡æž„ - iOS 10 UserNotifications æ¡†æž¶è§£æžUIApplication Delegate launch Optionsios notification ï¼ˆä¸€ï¼‰ios æœ¬åœ°å’Œè¿œç¨‹é€šçŸ¥ï¼ˆäºŒï¼‰iOSå¼€å‘â€”â€”iOSé™é»˜æŽ¨é€ä»‹ç»åŠä½¿ç”¨åœºæ™¯How to handle remote notification with background mode enabled]]></content>
  </entry>
  <entry>
    <title><![CDATA[å¤„ç†æœåŠ¡ç«¯APIè¿”å›žJSONçš„æ€»ç»“]]></title>
    <url>%2FiOS%2F%E5%A4%84%E7%90%86%E6%9C%8D%E5%8A%A1%E7%AB%AFAPI%E8%BF%94%E5%9B%9EJSON%E7%9A%84%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[å½“æœåŠ¡ç«¯APIè¿”å›žç»™å®¢æˆ·ç«¯çš„æ•°æ®ä¸­ï¼Œæœ‰ç©ºå­—æ®µæ—¶ä¸€èˆ¬æ˜¯ä½¿ç”¨nullå¡«å……ï¼Œè¿™æ—¶è‹¥iOSå®¢æˆ·ç«¯ä¸å¯¹å­—æ®µå…ˆä½œç±»åž‹åˆ¤æ–­çš„è¯ï¼Œå°±å¾ˆå®¹æ˜“å‡ºçŽ°å´©æºƒï¼Œå› ä¸ºCocoaåœ¨JSONå¯¹è±¡è½¬æ¢æ—¶å¯¹nullè½¬ä¸ºäº†NSNullå¯¹è±¡ï¼Œè€Œä¸æ˜¯nilï¼Œä¸”nilä¹Ÿä¸èƒ½å­˜æ”¾äºŽé›†åˆå¯¹è±¡ä¸­ï¼Œä¸å…ˆä½œç±»åž‹åˆ¤æ–­ï¼Œç›´æŽ¥ä½¿ç”¨è¯¥å­—æ®µè½¬å‡ºçš„å¯¹è±¡å°±å¯èƒ½å‡ºçŽ°æ‰¾ä¸åˆ°è®¿é—®çš„selectorè€Œå´©æºƒäº†ã€‚ï¼ˆAndroidçš„ç©ºåˆ¤æ–­æœ¬æ¥å°±æ˜¯ç”¨nullä½œä¾æ®ï¼Œæ‰€ä»¥è¿™ä¸ªæƒ…å†µå¯¹å®ƒæ²¡æœ‰å½±å“ã€‚ï¼‰ æ‰€ä»¥å¼€å‘APIæ—¶ï¼Œåº”è¯¥ä¸ŽæœåŠ¡ç«¯åå•†å¥½è§„èŒƒçº¦å®šï¼Œè€Œå®¢æˆ·ç«¯ä¹Ÿåº”è¯¥åšå¥½é˜²èŒƒæŽªæ–½ã€‚ è§„èŒƒçº¦å®šå½“æ—¶ä¸ŽiOSå®¢æˆ·ç«¯åŒäº‹çº¦å®šçš„è§„åˆ™ï¼š å®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯è¿”å›žçš„JSONæ•°æ®ï¼Œå¿…é¡»è¦ä½œç±»åž‹åŠå®‰å…¨å€¼åˆ¤æ–­ï¼ˆiOSç»Ÿä¸€åŠ¨æ€åœ°å°†NSNullè°ƒç”¨æ— æ³•è¯†åˆ«çš„æ–¹æ³•æ—¶è¿”å›žnilï¼‰ï¼š ä¸ŽæœåŠ¡ç«¯çº¦å®šå­—æ®µç±»åž‹ï¼Œè‹¥ä¸ºä¸ç¡®å®šç±»åž‹çš„éœ€è¦å…ˆä½œç±»åž‹åˆ¤æ–­ï¼› å­—ç¬¦ä¸²çš„å­—æ®µï¼Œä½¿ç”¨string.length &gt; 0ï¼ˆä¸ºnilæ—¶è°ƒç”¨lengthæ˜¯å®‰å…¨çš„ï¼‰ï¼› æ•°å­—çš„å­—æ®µï¼Œä½¿ç”¨number.intValueã€number.floatValueã€number.doubleValueã€number.boolValueç­‰ï¼› é›†åˆçš„å­—æ®µï¼Œä½¿ç”¨set.count &gt; 0ï¼ˆä¸ºnilæ—¶è°ƒç”¨countæ˜¯å®‰å…¨çš„ï¼‰ã€‚ ä¸ŽæœåŠ¡ç«¯åŒäº‹çº¦å®šçš„è§„åˆ™ï¼š ä¸ŽæœåŠ¡ç«¯è®¾è®¡APIçš„çº¦å®š å¸ƒå°”å€¼çš„å­—æ®µç»Ÿä¸€ä½¿ç”¨trueã€falseï¼ˆä¸å†ä½¿ç”¨â€trueâ€ã€â€yâ€ã€â€œyesâ€ã€1ç­‰ç­‰ï¼‰ï¼› ç©ºå­—æ®µç»Ÿä¸€é‡‡ç”¨è®¾ç½®é»˜è®¤å€¼ï¼Œä¸ä½¿ç”¨nullæˆ–â€nullâ€ï¼Œæ•°å­—çš„ä½¿ç”¨0ï¼Œå­—ç¬¦ä¸²çš„ä½¿ç”¨â€â€ï¼Œæ•°ç»„ä½¿ç”¨[]ï¼Œå¯¹è±¡ä½¿ç”¨{}ã€‚ å®‰å…¨çš„NSNullä¸ºäº†å®žçŽ°â€œç»Ÿä¸€åŠ¨æ€åœ°å°†NSNullè°ƒç”¨æ— æ³•è¯†åˆ«çš„æ–¹æ³•æ—¶è¿”å›žnilâ€ï¼Œæˆ‘å‚è€ƒäº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“NullSafeåŽ»å¯¹çŽ°æœ‰çš„å®¢æˆ·ç«¯å·¥ç¨‹æ‰“äº†ä¸€ä¸‹è¡¥ä¸ï¼Œå…¶å®žä¹Ÿç®—ä¸ä¸Šä¸€ä¸ªåº“ï¼Œåªæœ‰ä¸€ä¸ªmæ–‡ä»¶ã€‚ä½¿ç”¨å‰å…ˆåˆ†æžäº†ä¸€ä¸‹å®ƒçš„å®žçŽ°åŽŸç†ã€‚ NullSafeé¦–å…ˆNullSafeæ˜¯NSNullçš„åˆ†ç±»Categoryï¼Œå…¶æ¬¡å®ƒåªæœ‰ä¸‰ä¸ªåˆ©ç”¨è¿è¡Œæ—¶å®žçŽ°çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯åˆå§‹åŒ–ç¼“å­˜æ•°æ®çš„ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯å®žçŽ°æ¶ˆæ¯è½¬å‘çš„ã€‚æ¶ˆæ¯è½¬å‘çš„æµç¨‹å¦‚ä¸‹å›¾ ç¼“å­˜ç­–ç•¥NullSafeåšäº†ä¸€ä¸ªç¼“å­˜æœºåˆ¶ï¼Œä¸»è¦ç¼“å­˜ä¸¤é¡¹å†…å®¹ æ‰€æœ‰çš„NSObjectå­ç±»ï¼› selectorå¯¹åº”ç­¾åçš„é›†åˆï¼› å› ä¸ºæŸ¥æ‰¾NSObjectå­ç±»å’Œseletorçš„å“åº”è€…æ—¶ä¼šåŽ†éé¡¹ç›®é‡Œçš„æ‰€æœ‰æ³¨å†Œç±»å’ŒNSObjectå­ç±»ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶ˆè€—å¾ˆå¤§ï¼Œç¼“å­˜æ˜¯ååˆ†å¿…è¦çš„ã€‚ ç„¶åŽNSObjectçš„å­ç±»æ˜¯ä»Žæ‰€æœ‰æ³¨å†Œç±»ä¸­ç­›é€‰å‡ºæ¥ã€‚é€šè¿‡objc_getClassListèŽ·å–æ‰€æœ‰æ³¨å†Œäº†çš„ç±»ï¼Œclass_getSuperclassèŽ·å–æ‰€æœ‰æ³¨å†Œç±»çš„çˆ¶ç±»ã€‚è¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆä¸ç›´æŽ¥ä½¿ç”¨superclassèŽ·å–çˆ¶ç±»ï¼ŒåŽŸå› æ˜¯objc_getClassListèŽ·å–åˆ°çš„ç±»ä¸ä¸€å®šéƒ½æ˜¯NSObjectçš„å­ç±»ï¼Œæ‰€ä»¥å°±ä¸ä¸€å®šéƒ½æœ‰superclassè¿™ä¸ªæ–¹æ³•ã€‚å…³äºŽæ›´å¤šçš„Objective-C Runtimeæ–¹æ³•è¯´æ˜Žå¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ ç­¾åSelector1.é‡å†™Selectorçš„ç­¾åæ–¹æ³• - (NSMethodSignature *)methodSignatureForSelector:(SEL)selector è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å‘Šè¯‰ç³»ç»Ÿè¯¥selectorçš„å‚æ•°æœ‰å¤šå°‘ä¸ªã€æ˜¯ä»€ä¹ˆç±»åž‹ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨instanceMethodSignatureForSelectorèŽ·å–æŒ‡å®šç±»çš„selectorçš„ç­¾åï¼‰ï¼Œè¿”å›žå€¼éžç©ºåˆ™é€šè¿‡forwardInvocation:è½¬å‘æ¶ˆæ¯ï¼Œè¿”å›žå€¼ä¸ºç©ºåˆ™å‘å½“å‰å¯¹è±¡å‘é€doesNotRecognizeSelector:æ¶ˆæ¯ï¼Œç¨‹åºå´©æºƒé€€å‡ºã€‚ å…ˆæ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨selectorçš„ç­¾å è‹¥å­˜åœ¨ä¸”ç­¾åæ˜¯ä¸€ä¸ªNSNullç±»å¯¹è±¡çš„è¯ï¼Œåˆ™è¿”å›žnilç»ˆæ­¢æ¶ˆæ¯è½¬å‘æµç¨‹ï¼ˆè¿™ä¸ªåˆ¤æ–­çš„æ„ä¹‰åœ¨äºŽç¼“å­˜æ²¡æœ‰æ—¶ï¼Œåˆ°NSObjectçš„æ‰€æœ‰å­ç±»ä¹Ÿæ‰¾ä¸åˆ°å“åº”è¯¥selectorçš„ç±»æˆ–è¯¥ç±»æ²¡æœ‰å¯¹åº”è¯¥selectorçš„ç­¾åï¼Œç®€å•è¯´å°±æ˜¯è°ƒç”¨äº†å…¨ç³»ç»Ÿéƒ½æœ¨æœ‰çš„æ–¹æ³•ï¼Œç†åº”ç»§ç»­å´©æºƒï¼‰ï¼› è‹¥ä¸å­˜åœ¨ä¸”ç¼“å­˜æœªåˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–ç¼“å­˜å¹¶æ”¶é›†èµ·æ‰€æœ‰NSObjectçš„å­ç±»ï¼› åŽ†éNSObjectçš„å­ç±» è‹¥å“åº”å½“å‰selectorï¼Œåˆ™å°†å…¶å¯¹selectorçš„ç­¾åè¿›è¡Œç¼“å­˜ï¼Œå¹¶è¿”å›žæ­¤ç­¾åï¼Œç³»ç»ŸæŽ¥ç€å‘é€forwardInvocationæ¶ˆæ¯; è‹¥æ‰¾ä¸åˆ°å“åº”selectorçš„ç±»æˆ–å…¶ç­¾åä¸ºç©ºï¼Œåˆ™å°†NSNullçš„nullä½œä¸ºè¯¥selectorçš„ç­¾åè¿›è¡Œç¼“å­˜ï¼Œå¹¶è¿”å›žnilï¼ˆå­˜ä¸ŠNSNullçš„nullæ˜¯ä¸ºäº†æ–¹ä¾¿åŽç»­å¯¹ç¼“å­˜ç»“æžœçš„åˆ¤æ–­ï¼Œæ˜¯å¦ä¸€ä¸ªåˆç†èŒƒå›´çš„selectorï¼‰ã€‚ æœ‰å‡ ä¸ªå®žçŽ°ç»†èŠ‚ç‚¹å€¼å¾—å­¦ä¹  çº¿ç¨‹å®‰å…¨ï¼Œåˆ©ç”¨@synchronized([NSNull class])å¯¹ç¼“å­˜çš„åˆå§‹åŒ–ã€è¯»å–å®žæ–½çº¿ç¨‹é”ï¼ŒåŒæ—¶ç¼“å­˜çš„è¯»å–åœ¨é”å‰å’Œé”åŽåˆ†åˆ«åšäº†ä¸¤æ­¥åˆ¤æ–­ï¼Œç›®çš„æ˜¯é˜²æ­¢ç­‰å¾…è§£é”çš„è¿‡ç¨‹ä¸­ç¼“å­˜æ›´æ–°çš„éƒ¨åˆ†åŒ…å«äº†ç›®æ ‡å€¼è€Œé‡æ–°æ‰§è¡Œä¸€éï¼Œé™ä½Žäº†æ•ˆçŽ‡ï¼› æ‰§è¡Œé¡ºåºï¼Œç¼“å­˜åˆå§‹åŒ–æ‰§è¡Œå‰å…ˆåˆ¤æ–­å½“å‰æ˜¯å¦åœ¨ä¸»é˜Ÿåˆ—ï¼Œæ˜¯åˆ™ç›´æŽ¥æ‰§è¡Œï¼Œå¦åˆ™åˆ©ç”¨GCDçš„dispatch_syncåŒæ­¥æ–¹æ³•åœ¨ä¸»é˜Ÿåˆ—æ‰§è¡Œï¼Œè¿™æ ·é¿å…äº†ä¸»é˜Ÿåˆ—å‡ºçŽ°æ­»é”çš„å¯èƒ½ï¼ŒåŒæ—¶ä½¿åˆå§‹åŒ–ä¸‹é¢çš„é€»è¾‘å’Œé”å¤–çš„é€»è¾‘æŒ‰é¡ºåºåœ°ç­‰åˆå§‹åŒ–å®ŒæˆåŽå†æ‰§è¡Œã€‚ 2.é‡å†™æ¶ˆæ¯è½¬å‘å¤„ç† - (void)forwardInvocation:(NSInvocation *)invocation å°†è½¬å‘çš„targetè®¾ä¸ºnilï¼Œè¿™æ ·è°ƒç”¨ä»»ä½•æ–¹æ³•å°±éƒ½æ˜¯å®‰å…¨çš„ï¼ŒåŽé¢ä¹Ÿå°±ä¸ä¼šå†å‡ºçŽ°æ¶ˆæ¯è½¬å‘ï¼Œæœ€åŽæ‰¾ä¸åˆ°æ–¹æ³•è€ŒæŠ›å‡ºå¼‚å¸¸å¯¼è‡´å´©æºƒã€‚ ä½¿ç”¨æ–¹æ³•æŠŠå”¯ä¸€çš„mæ–‡ä»¶å¼•å…¥é¡¹ç›®å°±å®Œäº†ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨åŠ è½½åŠŸèƒ½ï¼Œä¸éœ€è¦å¼•ç”¨ä»»ä½•hæ–‡ä»¶ã€‚ è‹¥æŸäº›targetæˆ–è€…schemeä¸æƒ³ä½¿ç”¨NullSafeï¼Œå¯ä»¥å†build settingsé‡Œé…ç½®é¢„ç¼–è¯‘å®NULLSAFE_ENABLED=0ï¼Œåˆæˆ–è€…åœ¨prefix.pché‡Œæ·»åŠ  #ifdef DEBUG #define NULLSAFE_ENABLED 0 #endif JSONä¸­çš„Booleanæœ€åŽï¼Œè¿˜æ¨¡æ‹Ÿç¡®è®¤äº†ä¸€ä¸‹JavaåŽç«¯APIçš„å¸ƒå°”å€¼å­—æ®µè¿”å›žtrueå’Œfalseç»™æˆ‘ä»¬çš„æ•ˆæžœ å¯ä»¥çœ‹å‡ºï¼ŒCocoaç›´æŽ¥æŠŠtrueæˆ–falseçš„Booleanè½¬æ¢ä¸ºæ•°å­—ç±»1æˆ–è€…0ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è¯¥æ•°å­—å­—æ®µå€¼è°ƒç”¨boolValueè¿™æ ·çš„æ–¹æ³•ï¼Œæ–¹ä¾¿é˜…è¯»è¯­ä¹‰ã€‚ï¼ˆæ³¨æ„è¾“å‡ºä¸­çš„json objectï¼ŒNSDictionaryçš„ç›´æŽ¥è¾“å‡ºå¹¶ä¸èƒ½ç›´æŽ¥å½“ä½œJSONçš„æ ¼å¼ï¼Œåªèƒ½ç”¨ä½œå‚è€ƒè½¬æ¢åŽŸç”Ÿå¯¹è±¡åŽçš„æ•ˆæžœï¼Œåƒå­—ç¬¦ä¸²å·²ç»ä¸å¸¦åŒå¼•å·ï¼‰ æ€»ç»“ä¸ŽæœåŠ¡ç«¯å¿…é¡»çº¦å®šå¥½äº¤äº’APIçš„æ•°æ®æ ¼å¼å’Œè§„èŒƒï¼Œé¿å…æŽ‰å‘ï¼ŒåŒæ—¶å®¢æˆ·ç«¯ä¹Ÿåº”è¯¥æœ‰è‡ªå·±çš„ä¸€å¥—é˜²å¾¡æœºåˆ¶ï¼Œä¸èƒ½å®Œæˆå€šé åˆ«äººä¸ºä½ åšå¤šå°‘ã€‚è€Œå…³äºŽæ•°æ®æ ¼å¼çš„ï¼Œé™¤äº†ä¸Šé¢æåˆ°çš„Booleanï¼Œåƒfloatã€doubleã€dateè¿™äº›éƒ½æ˜¯éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ç±»åž‹ï¼Œè¿™é‡Œå°±ä¸å±•å¼€æŽ¢è®¨ï¼Œå…ˆæŠ›å‡ºæ¥ã€‚ å‚è€ƒios runtimeæµ…æž(äºŒ)ï¼šæ¶ˆæ¯è½¬å‘APIè¿”å›žç»“æžœè®¾è®¡ç»éªŒä¸Žæ€»ç»“Objective-Cçš„â€œå¤šç»§æ‰¿â€â€”â€”æ¶ˆæ¯è½¬å‘]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>JSON</tag>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2Funcategorized%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new "My New Post" More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment]]></content>
  </entry>
  <entry>
    <title><![CDATA[Vaporä¹‹åˆä½“éªŒ]]></title>
    <url>%2F%E5%90%8E%E7%AB%AF%2FVapor%E4%B9%8B%E5%88%9D%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[æ¯”è¾ƒå‡ºåçš„Swift Webæ¡†æž¶æœ‰Vaporã€Perfectã€Kituraï¼ŒçŽ°åœ¨è¿™äº›æ¡†æž¶éƒ½è¿˜æ²¡ååˆ†æˆç†Ÿï¼Œä¸»è¦æ˜¯ç¼ºå°‘åŸºç¡€åº“ï¼Œè¿˜æœ‰Swift Package Manager(SPM)ä¸æ”¯æŒiOSã€‚ä½†åŸºäºŽè‹¹æžœçš„Swift Server APIè®¡åˆ’ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥æ”¾å¿ƒæŠ•å…¥åˆ°Swift Webå­¦ä¹ ä¸­åŽ»ã€‚è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹Vaporçš„ä¸Šæ‰‹ä½“éªŒï¼Œå¼€å§‹Swift Webçš„å…¥é—¨ä¹‹æ—…ã€‚ SwiftçŽ¯å¢ƒæ­å»ºMacOSç›´æŽ¥ä¸‹è½½Xcode8ï¼ˆSwift3ï¼‰æˆ–è€… Xcode9ï¼ˆSwift4ï¼‰ ä¸‹è½½åŽè¾“å…¥ curl -sL check.vapor.sh | bash è¾“å‡ºä¸‹é¢çš„ç¬¬ä¸€é¡¹å°±è¯æ˜ŽSwiftçŽ¯å¢ƒOKäº† {% asset_img checkVapor.png check %} Unbuntuéœ€è¦é¢å¤–å¤šå‡ ä¸ªæ­¥éª¤ è¿œç¨‹ç™»å½•æœåŠ¡å™¨ //å¡«å…¥ä½ æ¬ç“¦å·¥ç«¯å£å·å’ŒIP ssh -p 2222 root@11.11.11.11 å®‰è£…ä¾èµ–å·¥å…· sudo apt-get update sudo apt-get install clang libicu-dev binutils git libpython2.7-dev libcurl3 ä¸‹è½½Swift #Ubuntu 14.04 wget https://swift.org/builds/swift-3.0-release/ubuntu1404/swift-3.0-RELEASE/swift-3.0-RELEASE-ubuntu14.04.tar.gz #Ubuntu 15.10 wget https://swift.org/builds/swift-3.0-release/ubuntu1510/swift-3.0-RELEASE/swift-3.0-RELEASE-ubuntu15.10.tar.gz è§£åŽ‹Swift # Ubuntu 14.04 tar zxf swift-3.0-RELEASE-ubuntu14.04.tar.gz # Ubuntu 15.10 tar zxf swift-3.0-RELEASE-ubuntu15.10.tar.gz å®‰è£… # Ubuntu 14.04 mv swift-3.0-RELEASE-ubuntu14.04 /swift-3.0 # Ubuntu 15.10 mv swift-3.0-RELEASE-ubuntu15.10 /swift-3.0 è®¾ç½®è·¯å¾„ vi ~/.bashrc export PATH=/swift-3.0/usr/bin:&quot;$&#123;PATH&#125;&quot; éªŒè¯ sudo apt-get install curl curl -sL check.vapor.sh | bash Swiftenvåœ¨MacOSå’ŒUbuntué™¤äº†ä»¥ä¸Šä»‹ç»çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Swiftenvå·¥å…·å®‰è£…Swiftï¼Œå®ƒè¿˜å¯ä»¥åŒæ—¶å…¼å®¹å¤šå¥—Swiftçš„å­˜åœ¨ï¼Œæ–¹ä¾¿åœ°è¿›è¡Œåˆ‡æ¢ï¼Œç±»ä¼¼pythonçš„pyenvä¸€æ ·ã€‚è¿™é‡Œå°±ä¸ä½œå…·ä½“è¯´æ˜Žï¼ŒæŠ›å‡ºä¸€ä¸‹çŸ¥è¯†ç‚¹ã€‚ VaporçŽ¯å¢ƒæ­å»ºä¸»è¦æ˜¯å®‰è£…Vaporçš„Toolboxï¼Œå®ƒæ˜¯ä¸€ä¸ªSwiftè„šæœ¬çš„CLIï¼ˆcommand line interfaceï¼‰ï¼Œéœ€è¦Swiftçš„çŽ¯å¢ƒæ”¯æŒã€‚ å®‰è£…è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ curl -sL toolbox.vapor.sh | bash éªŒè¯ vapor --help æ›´æ–° vapor self update åˆ›å»ºVaporæ¨¡æ¿ vapor new &lt;name&gt; [--template=&lt;repo-url-or-github-path&gt;] Vaporçš„ä½¿ç”¨1.åˆ›å»º cd /Users/xxx/(é¡¹ç›®çš„è·¯å¾„) vapor new Hello åˆ›å»ºåŽæç¤ºå¦‚ä¸‹ é¡¹ç›®ç»“æž„ 2.ä¿®æ”¹ç”¨ä¾‹ å®˜æ–¹ç»™å‡ºæœ€æœ€æœ€ç®€å•çš„ç”¨ä¾‹ import Vapor let drop = try Droplet() drop.get(&quot;hello&quot;) &#123; req in return &quot;Hello, world.&quot; &#125; try drop.run() æ‹‰ä¸‹æ¥çš„æ¨¡æ¿é»˜è®¤æ²¡æœ‰GETè¯·æ±‚çš„å“åº”ï¼Œæˆ‘ä»¬é€šè¿‡æ‰¾åˆ°main.swiftæ–‡ä»¶æ·»åŠ ä¸Šå®˜æ–¹çš„è¿™ä¸ªç”¨ä¾‹ã€‚ 3.ç¼–è¯‘ åˆ°é¡¹ç›®è·¯å¾„ä¸‹æ‰§è¡Œ vapor build #å‘å¸ƒæ­£å¼ç‰ˆæ—¶ï¼Œæé«˜æ€§èƒ½ vapor build --release ç¼–è¯‘æˆåŠŸåŽè¾“å‡º å½“ä½ æŠŠèµ„æºåŒ…(Packagesæ–‡ä»¶å¤¹)ä¸‹è½½ç¼–è¯‘å®ŒæˆåŽï¼Œå¯ä»¥æŠŠèµ„æºåŒ…å†…çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶ä¸€ä»½å‡ºæ¥ï¼Œä¸‹æ¬¡æ–°å»ºé¡¹ç›®æ—¶ï¼ŒæŠŠè¿™äº›æ–‡ä»¶æ‹·å…¥Packagesæ–‡ä»¶å¤¹å¯å…åŽ»è¿™éƒ¨åˆ†æ–‡ä»¶çš„é‡å¤ä¸‹è½½ã€‚ 4.è¿è¡Œ vapor run serve #éœ€è¦æƒé™æ—¶ sudo vapor run serve #æŸäº›linuxç³»ç»Ÿä¸‹ sudo -i vapor run serve æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ http://localhost:8080/hello æˆ–è€… http://0.0.0.0:8080/helloè®¿é—®æœ¬åœ°çš„æœåŠ¡ç«¯äº†ã€‚ éƒ¨ç½²Ubuntuåœ¨è¿œç¨‹ubuntuä¸Šé¢ï¼ŒVaporçš„çŽ¯å¢ƒæ­å»ºå’Œä½¿ç”¨å’Œä¸Šé¢ä»‹ç»çš„ä¸€æ ·ã€‚ä½†åœ¨ç¼–è¯‘è¿è¡Œå‰æˆ‘ä»¬éœ€è¦å…ˆè¿›å…¥è¿œç¨‹æœåŠ¡å™¨å†…ï¼Œæ‰¾åˆ°é¡¹ç›®çš„Configæ–‡ä»¶å¤¹å†…çš„servers.jsonï¼Œæ·»åŠ è‡ªå·±æœåŠ¡å™¨çš„ipå’Œç«¯å£80è¿›åŽ» &#123; &quot;http&quot;: &#123; &quot;host&quot;: &quot;11.11.11.11&quot;, &quot;port&quot;: 80 &#125; &#125; é…ç½®å¥½åŽå†æ‰§è¡Œç¼–è¯‘å’Œè¿è¡Œã€‚è¿è¡Œèµ·æ¥åŽï¼Œæˆ‘ä»¬åœ¨æ‰¾ä¸€ä¸ªæµè§ˆå™¨ï¼Œè¾“å…¥ï¼š11.11.11.11:80/helloï¼Œå³å¯çœ‹åˆ°ç»“æžœã€‚ HerokuHerokuå¹³å°çš„çµæ´»æ€§æžé«˜ä¸”æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚è‹¥æƒ³æŠŠç¨‹åºéƒ¨ç½²åˆ°Herokuä¸Šï¼Œå¼€å‘è€…è¦ä½¿ç”¨GitæŠŠç¨‹åºæŽ¨é€åˆ°Herokuçš„GitæœåŠ¡å™¨ä¸Šã€‚åœ¨æœåŠ¡å™¨ä¸Šï¼Œgit pushå‘½ä»¤ä¼šè‡ªåŠ¨è§¦å‘å®‰è£…ã€é…ç½®å’Œéƒ¨ç½²ç¨‹åºã€‚Herokuä½¿ç”¨åä¸ºDynoçš„è®¡ç®—å•å…ƒè¡¡é‡ç”¨é‡,å¹¶ä»¥æ­¤ä¸ºä¾æ®æ”¶å–æœåŠ¡è´¹ç”¨ï¼Œä½†Herokuçš„å…è´¹ç‰ˆå·²ç»å®Œå…¨å¯ä»¥æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸ç»ƒä¹ çš„éœ€æ±‚ï¼Œå¹¶ä¸”å…¶ç®€å•å¿«æ·çš„Gitæ“ä½œæŒ‡ä»¤å¾ˆæ˜“ä¸Šæ‰‹ã€‚ åˆ›å»ºHerokuè´¦æˆ·åœ¨Herokuå®˜ç½‘åˆ›å»ºè‡ªå·±çš„å¼€å‘è€…è´¦å·ã€‚æ³¨æ„è¦è®°ä½è‡ªå·±çš„é‚®ç®±å’Œå¯†ç ï¼Œå› ä¸ºä¸€ä¼šå„¿éœ€è¦åœ¨ç»ˆç«¯è¿›è¡Œç™»å½•ã€‚ å®‰è£…Heroku CLIHeroku CLIæ˜¯ç”¨æ¥åˆ›å»ºã€ç®¡ç†Herokuä¸Šappsçš„å‘½ä»¤è¡Œå·¥å…·ã€‚ï¼ˆheroku çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯å°†è¢«å®‰è£…åˆ°/usr/local/herokuï¼ŒåŒæ—¶ï¼Œ/usr/local/heroku/binå°†è¢«æ·»åŠ åˆ°ä½ çš„PATHçŽ¯å¢ƒå˜é‡ï¼‰ brew install heroku å®‰è£…å®Œæˆä¹‹åŽæ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤æ¥ç™»å½•ï¼Œè¾“å…¥é‚®ç®±å’Œå¯†ç ï¼ˆæŠŠä½ çš„ SSH å…¬é’¥ä¸Šä¼ åˆ° Heroku è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œä¸Šä¼ åŽæ‰èƒ½ä½¿ç”¨ git push å‘½ä»¤ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œlogin å‘½ä»¤ä¼šè‡ªåŠ¨åˆ›å»ºå¹¶ä¸Šä¼  SSH å…¬é’¥ã€‚ï¼‰ heroku login Enter your Heroku credentials. Email: adam@example.com Password (typing will be hidden): Authentication successful. åˆ›å»ºGitåœ¨Githubæˆ–å…¶å®ƒGitæœåŠ¡å™¨ä¸Šåˆ›å»ºå¥½è¿œç«¯ä»“åº“ï¼Œç„¶åŽè¿›å…¥ä½ è¦éƒ¨ç½²çš„Appï¼Œæ¯”å¦‚ä¸Šæ–‡çš„Helloé¡¹ç›®ï¼Œæ‰§è¡Œ $cd Hello $git init $git remote add origin git@github.com:xxx/xxx.git $git add . $git commit -m &quot;add hello app&quot; $git push -u origin master å…³è”Gitæœ‰ä¸¤ç§æ“ä½œæ–¹å¼å…³è”é¡¹ç›®çš„Gitï¼Œä¸€ç§æ˜¯å‘½ä»¤è¡Œï¼Œä¸€ç§æ˜¯ç½‘é¡µã€‚ å‘½ä»¤è¡Œéƒ¨ç½² vapor heroku init è¿™æ—¶Heroku CLIä¼šé—®å‡ ä¸ªé—®é¢˜ï¼šWould you like to provide a custom Heroku app name? Answer â€˜nâ€™ and hit enter if you donâ€™t have a custom name.Would you like to provide a custom Heroku buildpack? Answer â€˜nâ€™ and hit enter if you would like to use the default buildpack that Heroku provides.Are you using a custom Executable name? Answer â€˜nâ€™ and hit enter here if you arenâ€™t using a custom executable name.Would you like to push to Heroku now? Answer â€˜nâ€™ and hit enter.è‹¥è¦é…ç½®åœ¨çº¿æ•°æ®åº“ï¼Œæœ€åŽä¸€ä¸ªé—®é¢˜éœ€å…ˆé€‰æ‹©â€˜nâ€™ã€‚ç„¶åŽæ·»åŠ Postgresåˆ°Heroku $ heroku addons:create heroku-postgresql:hobby-dev æ·»åŠ å®ŒæˆåŽæŸ¥çœ‹æ•°æ®åº“çš„URL $ heroku config ç„¶åŽåˆ›å»ºProcfileæ–‡ä»¶ $ vapor heroku init å¹¶ä¿®æ”¹Procfileæ–‡ä»¶çš„å†…å®¹ä¸º web: App --env=production --workdir=&quot;./&quot; web: App --env=production --workdir=./ --config:servers.default.port=$PORT --config:postgresql.url=$DATABASE_URL æœ€åŽé€šè¿‡pushåˆ°Gitå®ŒæˆHerokuçš„éƒ¨ç½² $ git push heroku master å¹³æ—¶æ›´æ–° $ git commit -am &quot;Adds new code&quot; $ git push heroku master PSï¼šåˆ›å»ºherokuåº”ç”¨å’Œå…³è”Gitçš„æ“ä½œè¿˜å¯ä»¥ç”¨ä»¥ä¸‹ä¸€æ¡æŒ‡ä»¤ä»£æ›¿ï¼Œä½†ä¼šå…³è”åˆ°herokuçš„gitä»“åº“ï¼Œè€Œä¸Šé¢æ‰§è¡Œçš„æ˜¯è‡ªå®šä¹‰å…³è”çš„Gitä»“åº“ #åˆ›å»ºapp âžœ someAccount git:(rest) âœ— heroku apps:create some-app Creating some-app... done, stack is cedar-14 https://some-app.herokuapp.com/ | https://git.heroku.com/some-app.git Git remote heroku added #æŸ¥çœ‹app âžœ someAccount git:(rest) âœ— heroku apps === My Apps some-app #æŸ¥çœ‹è¿œç«¯gitçš„URL git remote -v è¿˜æœ‰ï¼Œè‹¥æ‰§è¡Œgit push heroku masteræ—¶æŠ¥é”™No default language could be detected for this app. remote: HINT: This occurs when Heroku cannot detect the buildpack to use for this application automatically.è¿™è¯´æ˜Žherokuå®˜æ–¹æ²¡æœ‰swiftçš„buildpackï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±æ·»åŠ  heroku create --buildpack https://github.com/kylef/heroku-buildpack-swift.git heroku buildpacks:set https://github.com/kylef/heroku-buildpack-swift.git è‹¥è¿˜æ˜¯æŠ¥é”™error at=error code=H10 desc=â€App crashedâ€ method=GET path=â€/plaintextâ€è¿™æ—¶éœ€è¦æ£€æŸ¥Procfileæ–‡ä»¶æ˜¯å¦ä¿®æ”¹å¥½ï¼ŒProcfileéœ€è¦æ”¾åˆ°é¡¹ç›®çš„æ ¹ç›®å½•é‡Œ web: Run --env=production --workdir=./ --config:servers.default.port=$PORT å®˜ç½‘éƒ¨ç½²è¿™ä¸ªå°±èŠ±å¤ªå¤šç¯‡å¹…æè¿°äº†ï¼Œç®€å•è¯´ä¸€ä¸‹æµç¨‹åˆ›å»ºæ–°Appï¼Œæ‰“å¼€è®¾ç½®ï¼Œåœ¨â€œBuildpacksâ€ä¸­è¾“å…¥ https://github.com/kylef/heroku-buildpack-swift ï¼ˆç›®çš„æ˜¯å‘Šè¯‰HerokuåŒ…æ˜¯ä½¿ç”¨Swiftç¼–å†™ä¸”è¦é‡‡ç”¨Swiftç¼–è¯‘ï¼‰ï¼Œç„¶åŽæ‰“å¼€â€œDeployâ€é€‰æ‹©Githubæˆ–è®¾ç½®è‡ªå®šä¹‰çš„Gitåœ°å€ï¼Œå¹¶è¿žæŽ¥åˆ°é¡¹ç›®çš„è¿œç¨‹ä»“åº“ï¼Œæœ€åŽç‚¹å‡»â€œManual deployâ€çš„â€œDeploy Branchâ€ï¼Œç­‰Buildç»“æŸï¼Œéƒ¨ç½²æˆåŠŸåŽå¯ä»¥åœ¨â€œDomainsâ€ä¸­æŸ¥çœ‹è‡ªå·±çš„åŸŸåï¼Œç±»ä¼¼ http://appname.herokuapp.com ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡è¿™ä¸ªåŸŸååœ¨å¤–ç½‘è®¿é—®äº†ã€‚ Xcodeä¸Šè°ƒè¯•åœ¨é¡¹ç›®è·¯å¾„ä¸‹æ‰§è¡Œ vapor xcode æ‰§è¡ŒæˆåŠŸåŽä¼šç”Ÿæˆä¸€ä¸ª*.xcodeprojæ–‡ä»¶ï¼Œæ‰“å¼€å·¥ç¨‹åŽï¼Œå¯¹App.schemeçš„buildå’Œrunå°±å¦‚åŒvapor buildå’Œvapor runæŒ‡ä»¤ä¸€æ ·ï¼Œä½†æ˜¯ï¼Œåƒserveã€â€“portã€â€“releaseç­‰å‚æ•°ï¼Œéœ€è¦åœ¨schemeå¯¹åº”æ“ä½œé¡¹çš„Argumentsä¸Šè®¾ç½® å‚è€ƒSwiftæœåŠ¡ç«¯-Vaporåˆæ¬¡ä½¿ç”¨ SwiftåŽç«¯Vaporçš„å®‰è£…å’Œéƒ¨ç½² Vaporé¡¹ç›®å®žæˆ˜-ä»Žåˆ›å»ºåˆ°éƒ¨ç½²ï¼Œä¸€æ­¥æ­¥è¸å…¥æ·±å‘]]></content>
      <categories>
        <category>åŽç«¯</category>
      </categories>
      <tags>
        <tag>vapor</tag>
        <tag>swift</tag>
        <tag>heroku</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºJekins]]></title>
    <url>%2Funcategorized%2F%E6%90%AD%E5%BB%BAJekins%2F</url>
    <content type="text"><![CDATA[ä»‹ç»Jenkinsæ˜¯ä¸€ç§CIï¼ˆContinuous integrationï¼Œå³å¯æŒç»­é›†æˆï¼‰ç³»ç»Ÿå·¥å…·ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç”¨äºŽæŒç»­ã€è‡ªåŠ¨åœ°æž„å»º/æµ‹è¯•è½¯ä»¶é¡¹ç›®å’Œè¿›è¡Œç›‘æŽ§ã€‚å…·ä½“æ¥è¯´çš„è¯ï¼Œå®ƒå¯ä»¥å®žçŽ° è½¯ä»¶æž„å»ºè‡ªåŠ¨åŒ– ï¼šé…ç½®å®ŒæˆåŽï¼ŒCIç³»ç»Ÿä¼šä¾ç…§é¢„å…ˆåˆ¶å®šçš„æ—¶é—´è¡¨ï¼Œæˆ–è€…é’ˆå¯¹æŸä¸€ç‰¹å®šäº‹ä»¶ï¼Œå¯¹ç›®æ ‡è½¯ä»¶è¿›è¡Œæž„å»ºã€‚ æž„å»ºå¯æŒç»­çš„è‡ªåŠ¨åŒ–æ£€æŸ¥ ï¼šCIç³»ç»Ÿèƒ½æŒç»­åœ°èŽ·å–æ–°å¢žæˆ–ä¿®æ”¹åŽç­¾å…¥çš„æºä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è½¯ä»¶å¼€å‘å›¢é˜Ÿéœ€è¦å‘¨æœŸæ€§çš„æ£€æŸ¥æ–°å¢žæˆ–ä¿®æ”¹åŽçš„ä»£ç æ—¶ï¼ŒCIç³»ç»Ÿä¼šä¸æ–­ç¡®è®¤è¿™äº›æ–°ä»£ç æ˜¯å¦ç ´åäº†åŽŸæœ‰è½¯ä»¶çš„æˆåŠŸæž„å»ºã€‚è¿™å‡å°‘äº†å¼€å‘è€…ä»¬åœ¨æ£€æŸ¥å½¼æ­¤ç›¸äº’ä¾å­˜çš„ä»£ç ä¸­å˜åŒ–æƒ…å†µéœ€è¦èŠ±è´¹çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ æž„å»ºå¯æŒç»­çš„è‡ªåŠ¨åŒ–æµ‹è¯• ï¼šæž„å»ºæ£€æŸ¥çš„æ‰©å±•éƒ¨åˆ†ï¼Œæž„å»ºåŽæ‰§è¡Œé¢„å…ˆåˆ¶å®šçš„ä¸€å¥—æµ‹è¯•è§„åˆ™ï¼Œå®ŒæˆåŽè§¦å‘é€šçŸ¥(Email,RSSç­‰ç­‰)ç»™ç›¸å…³çš„å½“äº‹äººã€‚ ç”ŸæˆåŽåŽç»­è¿‡ç¨‹çš„è‡ªåŠ¨åŒ– :å½“è‡ªåŠ¨åŒ–æ£€æŸ¥å’Œæµ‹è¯•æˆåŠŸå®Œæˆï¼Œè½¯ä»¶æž„å»ºçš„å‘¨æœŸä¸­å¯èƒ½ä¹Ÿéœ€è¦ä¸€äº›é¢å¤–çš„ä»»åŠ¡ï¼Œè¯¸å¦‚ç”Ÿæˆæ–‡æ¡£ã€æ‰“åŒ…è½¯ä»¶ã€éƒ¨ç½²æž„ä»¶åˆ°ä¸€ä¸ªè¿è¡ŒçŽ¯å¢ƒæˆ–è€…è½¯ä»¶ä»“åº“ã€‚è¿™æ ·ï¼Œæž„ä»¶æ‰èƒ½æ›´è¿…é€Ÿåœ°æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚ Jenkinsçš„ä¸»è¦ç›®æ ‡æ˜¯ç›‘æŽ§è½¯ä»¶å¼€å‘æµç¨‹ï¼Œå¿«é€Ÿæ˜¾ç¤ºé—®é¢˜ï¼Œä¿è¯å¼€å‘äººå‘˜ä»¥åŠç›¸å…³äººå‘˜çœæ—¶çœåŠ›æé«˜å¼€å‘æ•ˆçŽ‡ï¼Œå…¶è¿˜æœ‰ä»¥ä¸‹ç‰¹æ€§ Jenkinsä¸€åˆ‡é…ç½®éƒ½å¯ä»¥åœ¨webç•Œé¢ä¸Šå®Œæˆã€‚æœ‰äº›é…ç½®å¦‚MAVEN_HOMEå’ŒEmailï¼Œåªéœ€è¦é…ç½®ä¸€æ¬¡ï¼Œæ‰€æœ‰çš„é¡¹ç›®å°±éƒ½èƒ½ç”¨ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹XMLè¿›è¡Œé…ç½®ã€‚ æ”¯æŒMavençš„æ¨¡å—(Module)ï¼ŒJenkinså¯¹Mavenåšäº†ä¼˜åŒ–ï¼Œå› æ­¤å®ƒèƒ½è‡ªåŠ¨è¯†åˆ«Moduleï¼Œæ¯ä¸ªModuleå¯ä»¥é…ç½®æˆä¸€ä¸ªjobã€‚ç›¸å½“çµæ´»ã€‚ æµ‹è¯•æŠ¥å‘Šèšåˆï¼Œæ‰€æœ‰æ¨¡å—çš„æµ‹è¯•æŠ¥å‘Šéƒ½è¢«èšåˆåœ¨ä¸€èµ·ï¼Œç»“æžœä¸€ç›®äº†ç„¶ï¼Œä½¿ç”¨å…¶ä»–CIï¼Œè¿™å‡ ä¹Žæ˜¯ä»¶ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚ æž„ä»¶æŒ‡çº¹(artifact fingerprint)ï¼Œæ¯æ¬¡buildçš„ç»“æžœæž„ä»¶éƒ½è¢«å¾ˆå¥½çš„è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€ä»»ä½•é…ç½®å°±å¯ä»¥æ–¹ä¾¿çš„æµè§ˆä¸‹è½½ã€‚ æ’ä»¶æ”¯æŒï¼Œæ”¯æŒæ‰©å±•æ’ä»¶ï¼Œä½ å¯ä»¥å¼€å‘é€‚åˆè‡ªå·±å›¢é˜Ÿä½¿ç”¨çš„å·¥å…·ã€‚ å®‰è£…JDKåœ¨å®‰è£…2.74ç‰ˆæœ¬çš„Jenkinså‰ï¼Œé¦–å…ˆéœ€è¦å®‰è£…JDK8ã€‚ 10.12çš„Macç³»ç»Ÿè‡ªæ­è½½çš„JDKç‰ˆæœ¬æ˜¯1.7.0_73ï¼ˆå³æ˜¯JDK7ï¼‰ã€‚ java -version åœ¨ç»ˆç«¯ä½¿ç”¨ä¸Šé¢æŒ‡ä»¤å¯æŸ¥çœ‹JDKçš„å…·ä½“ç‰ˆæœ¬ä¿¡æ¯ã€‚å®‰è£…å®ŒJDK8åŽï¼Œå†ä½¿ç”¨è¯¥æŒ‡ä»¤æŸ¥çœ‹ï¼Œä¼šå‘çŽ°ä»ç„¶æ˜¾ç¤ºJDK7çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¿™é‡Œå°±éœ€è¦åšä¸€ç‚¹å°çš„è°ƒæ•´æ‰èƒ½æŠŠJDKç‰ˆæœ¬ç”±å½“å‰ç³»ç»Ÿæ­è½½çš„ç‰ˆæœ¬åˆ‡æ¢åˆ°è‡ªå®šä¹‰ä¸‹è½½çš„ç‰ˆæœ¬ã€‚ which java é¦–å…ˆï¼Œä½¿ç”¨ä¸Šé¢æŒ‡ä»¤æŸ¥çœ‹çŽ°åœ¨javaè½¯ä»¶åŒ…çš„æ¥æºæ˜¯ /usr/bin/java ï¼Œåœ¨è¯¥è·¯å¾„ä¸‹å‘çŽ°è¿™javaæ˜¯ä¸€ä¸ªæ›¿èº«ï¼ŒçœŸæ­£çš„ä½ç½®æ˜¯ /System/Library/Frameworks/JavaVM.framework/Version/A/Commands/java ï¼Œè¿™ä¸ªframeworkå°±æ˜¯ç³»ç»Ÿè‡ªæ­è½½çš„JDKäº†ã€‚ ç„¶åŽï¼Œè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤è¿›è¡Œå½“å‰ä½¿ç”¨ç‰ˆæœ¬çš„åˆ‡æ¢ï¼Œç”¨lnåˆ›å»ºæ›¿èº«çš„æºå‚æ•°å°±æ˜¯è‡ªå®šä¹‰ä¸‹è½½çš„javaæ‰€åœ¨ä½ç½®ï¼Œåˆ‡æ¢å‰ä¹Ÿå¯ä»¥å…ˆéªŒè¯æ›¿æ¢çš„ç‰ˆæœ¬å·ã€‚ /Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java -version sudo rm /usr/bin/java sudo ln -s /Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java /usr/bin åŒæ—¶åœ¨~/.bashrcä¸­æ·»åŠ ä¸‹é¢ä¸€è¡Œã€‚ export PATH=/Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin:$PATH å¹¶æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œé‡è½½bashrcæ–‡ä»¶ã€‚ source ~/.bashrc å„ç§è§£å†³æ–¹æ¡ˆã€‚ ä½†æ˜¯ï¼Œåœ¨10.12çš„MacOSä¸Šï¼Œä½ å¯èƒ½æ— æ³•å®Œæˆç§»é™¤ usr/bin/java ï¼Œå› ä¸ºæ–°ç‰ˆçš„Macç³»ç»Ÿä¸ºäº†é˜²æ­¢ç³»ç»Ÿè½¯ä»¶è¢«ç¯¡æ”¹ï¼Œç¦æ­¢äº†ç›´æŽ¥å¯¹ usr/bin çš„æ“ä½œï¼Œç”šè‡³ä¹Žæ˜¯rootæƒé™ã€‚éœ€è¦å°†åˆ‡æ¢ç‰ˆæœ¬çš„æŒ‡ä»¤æ”¹ä¸º sudo ln -s /Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java /usr/local/bin è¿™æ ·å°±è¦†ç›–äº†ç³»ç»ŸåŽŸæœ‰çš„(/usr/bin/)javaç¨‹åºã€‚ /usr/bin æ˜¯ç”¨äºŽå­˜æ”¾ç³»ç»Ÿç®¡ç†çš„ç”¨æˆ·ç¨‹åºï¼Œ/usr/local/bin æ˜¯ç”¨äºŽä¸å—ç³»ç»Ÿç®¡ç†çš„æ™®é€šç”¨æˆ·ç¨‹åºï¼Œæœªæ¥çš„ç³»ç»Ÿæ›´æ–°å¯èƒ½ä¼šæ›´æ”¹ä¼šæ²¡æœ‰è­¦å‘Šåœ°åˆ é™¤ /usr/bin ä¸­çš„å†…å®¹ï¼Œè¿™å­˜æ”¾ç”¨æˆ·ç¨‹åºçš„æ–¹æ¡ˆå«Package Managementã€‚ æœ€åŽï¼Œå†æ‰§è¡Œä¸Šé¢æŸ¥çœ‹å½“å‰JDKç‰ˆæœ¬ä¿¡æ¯çš„æŒ‡ä»¤ï¼Œå°±åº”è¯¥æ˜¾ç¤ºä¸º1.8.0_144ï¼ˆmacOS Sierra 10.12.4ä¸Šï¼‰ã€‚ Jenkins2.74ç‰ˆæœ¬çš„Jenkinsï¼Œä¸‹è½½å¥½pkgåŒ…åŽï¼ŒæŒ‰æç¤ºé€æ­¥å®‰è£…ï¼Œè¿™ä¸ªè¿‡ç¨‹éžå¸¸ç®€å•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹è½½jenkins.warï¼Œè¿è¡Œ java -jar jenkins.war è¿›è¡Œå®‰è£…ã€‚ å®‰è£…å®Œæ¯•åŽï¼ŒSafariä¼šè‡ªåŠ¨æ‰“å¼€ï¼Œæˆ–è€…è‡ªå·±åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ http://localhost:8080 å³å¯è¿›å…¥Jenkinsçš„é…ç½®é¡µé¢ã€‚ å¦‚æžœè¾“å…¥åœ°å€åŽæŠ¥é”™â€œSafari canâ€™t connect to serverâ€ï¼Œé‚£å¯èƒ½æ˜¯ä¸€äº›å¯åŠ¨è®¾ç½®è¿˜æ²¡å¥½ï¼Œä¸‹é¢è¯´ä¸€ä¸‹é‡åˆ°çš„é—®é¢˜ç‚¹ã€‚ å¯åŠ¨é…ç½®æ–‡ä»¶çš„æƒé™ä¸è¶³è¿™æ˜¯é—®é¢˜æ˜¯åœ¨ä¸€å°æ­å»ºäº†Jenkinsçš„æœåŠ¡å™¨å‡çº§ç³»ç»Ÿç‰ˆæœ¬æ—¶é‡åˆ°çš„ï¼Œç³»ç»Ÿç‰ˆæœ¬ç”±10.11å‡åˆ°10.12åŽï¼ŒJenkinså°±æ— æ³•å¯åŠ¨äº†ï¼Œè§£å†³è´´åœ¨è¿™ã€‚åŽŸå› å°±æ˜¯æ–°çš„MacOS Sierraæ”¹å˜äº†Jenkinsæ–‡ä»¶å¤¹çš„æƒé™ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤è¾“å…¥æŒ‡ä»¤å³å¯æžå®šã€‚ sudo chmod u+x /Library/LaunchDaemons/org.jenkins-ci.plist sudo chown jenkins /var/log/jenkins sudo launchctl load /Library/LaunchDaemons/org.jenkins-ci.plist æœåŠ¡è¿›ç¨‹æ²¡æœ‰å¼€å¯é€šè¿‡ä»¥ä¸‹ä¸¤æ¡æŒ‡ä»¤å¯ä»¥æŽ§åˆ¶æœåŠ¡è¿›ç¨‹çš„å¼€å…³ sudo launchctl load /Library/LaunchDaemons/org.jenkins-ci.plist sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist Jenkinsä½¿ç”¨çš„JavaçŽ¯å¢ƒé…ç½®ä¸å¯¹é¦–å…ˆéœ€è¦ç³»ç»Ÿæ”¯æŒJavaå¹¶å·²ç»å®‰è£…å¥½Java8ï¼Œå…¶æ¬¡éœ€è¦åœ¨ /Library/Application Support/Jenkins/jenkins-runner.sh ä¸­æ·»åŠ ä»¥ä¸‹ä¸€è¡Œ export JAVA_HOME=â€/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Homeâ€ å’Œä¿®æ”¹æœ€åŽä¸¤è¡Œæˆ echo â€œ/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/javaâ€ $javaArgs -jar â€œ$warâ€ $argsexec â€œ/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/javaâ€ $javaArgs -jar â€œ$warâ€ $args Jenkinså®˜æ–¹çš„å¯åŠ¨æŒ‡å¼• é…ç½®è°¢å¤©è°¢åœ°ï¼Œç»ˆäºŽçœ‹è§Jenkinsçš„UIã€‚ ç”¨æˆ·å®‰è£…å®ŒJenkinsåŽï¼Œåå¥½è®¾ç½®ä¸­çš„ç”¨æˆ·ä¼šå‘çŽ°å¤šäº†ä¸€ä¸ªæ²¡æœ‰åå­—çš„ç”¨æˆ·ï¼Œå±žæ€§ä¸ºæ™®é€šæˆå‘˜ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œå°†é”è§£é™¤ï¼Œé‡æ–°è®¾ç½®è¯¥è´¦å·çš„ä¿¡æ¯ï¼ˆé¼ æ ‡å³é”®-é«˜çº§é€‰é¡¹-å…¨åï¼šè®¾ç½®ç”¨æˆ·åï¼‰ï¼Œè¿™å°±æ˜¯æ‹¥æœ‰Jenkinsæ–‡ä»¶å¤¹ç»å¯¹æƒé™çš„ç”¨æˆ·ï¼Œä¹‹åŽåœ¨æ¨¡æ‹Ÿå™¨ä¸ŠBuildé¡¹ç›®éƒ½å¿…é¡»ç™»å½•åˆ°è¯¥ç”¨æˆ·çš„è´¦å·ä¸‹æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºåœ¨åŽå°å¯ä»¥è¿è¡ŒJenkinsã€Xcodeï¼Œä½†ä¸èƒ½è¿è¡Œæ¨¡æ‹Ÿå™¨ã€‚ Serverå›žåˆ°Jenkins Serverä¸Šï¼Œé…ç½®çš„ç¬¬ä¸€é¡µè®©æˆ‘ä»¬è¾“å…¥Adminçš„åˆå§‹å¯†ç ï¼Œé¡µé¢ä¸Šæœ‰æç¤ºå¯†ç æ‰€åœ¨çš„è·¯å¾„ /Users/Shared/Jenkins/Home/secrets/initialAdminPassword ï¼Œå¦‚æžœå½“å‰ç™»å…¥è´¦å·ä¸æ˜¯Jenkinsï¼Œåˆ™ä¿®æ”¹ä¸€ä¸‹è¯¥æ–‡ä»¶çš„æƒé™ï¼Œå†æ‰“å¼€èŽ·å–å¯†ç å¡«å…¥å³å¯ã€‚ ä¹‹åŽåœ¨åˆ›å»ºAdminæ—¶æˆ–è€…è¿›å…¥åˆ°æ“ä½œç•Œé¢è®°å¾—æŠŠå¯†ç æ”¹å›žæ¥å°±æ˜¯äº†ï¼Œå› ä¸ºè¿™åˆå§‹å¯†ç ä¸æ˜¯ç»™äººè®°çš„ã€‚ æŽ¥ä¸‹æ¥ä¸€è·¯å°±æ˜¯ å®‰è£…é»˜è®¤æ’ä»¶ åˆ›å»ºAdminè´¦å·ï¼ˆç”¨æˆ·åã€å¯†ç ã€å…¨åã€é‚®ç®±ï¼‰å¦‚æžœæœ‰æ’ä»¶å®‰è£…å¤±è´¥ï¼Œå…ˆé‡è¯•ä¸€ä¸‹ã€‚ æœ€åŽæ¥åˆ°ä¸»ç•Œé¢ï¼Œæœ‰ä»¥ä¸‹èœå•é¡¹ å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ é¡¹ æ–°å»ºï¼šåˆ›å»ºæ–°çš„Itemè¿›è¡Œè‡ªåŠ¨åŒ–çš„æž„å»ºæ“ä½œï¼› ç”¨æˆ·ï¼šè®¾ç½®å¯åœ¨å½“å‰å®‰å…¨åŸŸä¸­ç™»å½•çš„ç”¨æˆ·ï¼› ä»»åŠ¡åŽ†å²ï¼šåˆ—å‡ºæž„å»ºè¿‡çš„æ‰€æœ‰è®°å½•ï¼Œå¹¶æœ‰ç”˜ç‰¹å›¾è¾…åŠ©è§‚å¯Ÿï¼› ç³»ç»Ÿç®¡ç†ï¼šç³»ç»Ÿçš„å…¨å±€è®¾ç½®ï¼Œæ’ä»¶ç®¡ç†ï¼Œç”¨æˆ·ç®¡ç†ï¼Œç³»ç»Ÿæ—¥å¿—ç­‰ç­‰éƒ½åœ¨è¿™é‡Œæ‰¾åˆ°ï¼› æˆ‘çš„è§†å›¾ï¼šå¯ä»¥å°†Itemåˆ†é…åˆ°ä¸åŒçš„è§†å›¾ä¸­è¿›è¡Œç›¸å¯¹åˆ†ç»„ï¼› å‡­è¯ä¸­å¿ƒï¼šç”¨äºŽItemä¸­ç®¡ç†æ“ä½œæ—¶ï¼Œéœ€è¦ç”¨åˆ°çš„è´¦å·ã€tokenã€è¯ä¹¦ç­‰éªŒè¯ä¿¡æ¯æ—¶ï¼Œå¯ä»¥ä»Žè¯¥å‡­è¯ä¸­å¿ƒç›´æŽ¥èŽ·å–ã€‚æ˜¯ä¸€ä¸ªç»Ÿä¸€é…ç½®å„ç§å‡­è¯çš„åœ°æ–¹ï¼Œå¯ä»¥æŸ¥çœ‹å„ä¸ªå‡­è¯æ‰€ç”¨äºŽçš„Itemã€‚ æ’ä»¶åœ¨ç³»ç»Ÿç®¡ç†ä¸‹ï¼Œå¯ä»¥è¿›è¡Œå…¨å±€çš„è®¾ç½®ã€ç®¡ç†æ’ä»¶ã€ç®¡ç†æ—¥å¿—ç­‰ é€‰æ‹©ç³»ç»Ÿç®¡ç†-&gt;ç®¡ç†æ’ä»¶-&gt;å¯é€‰æ’ä»¶ï¼Œå°±å¯ä»¥å®‰è£…ä¸€äº›è¾…åŠ©æ’ä»¶ï¼Œå½“æ—¶å®‰è£…äº†è¿™äº›ï¼š GitLab Plugin GitLab Hook Plugin Xcode integration Email Extension Plugin Itemåˆ›å»ºå¥½çš„Itemä¼šåœ¨ä¸»ç•Œé¢ä¸Šç›´æŽ¥çœ‹åˆ° åŒ…æ‹¬ S(tatus)ï¼šæœ€åŽä¸€æ¬¡æž„å»ºçš„çŠ¶æ€ï¼ŒæˆåŠŸå‘ˆè“è‰²ï¼Œå¤±è´¥å‘ˆçº¢è‰²çŠ¶ï¼› W(eather)ï¼šå¦‚æžœä¸€ç›´å¤±è´¥å°±æ˜¯ç‹‚é£Žæš´é›¨ï¼Œå¤§éƒ¨åˆ†æˆåŠŸå¶å°”å¤±è´¥åˆ™æ˜¯æ™´åˆ°å¤šäº‘ï¼Œæ¯æ¬¡éƒ½æˆåŠŸåˆ™æ˜¯æ™´å¤©ï¼› Nameï¼šItemçš„åç§°ï¼› Last Successï¼šæœ€åŽä¸€æ¬¡æž„å»ºæˆåŠŸçš„æ—¶é—´åŠç¼–å·ï¼› Last Failueï¼šæœ€åŽä¸€æ¬¡æž„å»ºå¤±è´¥çš„æ—¶é—´åŠç¼–å·ï¼› Last Persistent Timeï¼šä¸Šæ¬¡æž„å»ºæŒç»­çš„æ—¶é—´ã€‚ åœ¨Itemé‡Œï¼Œæœ‰ä»¥ä¸‹å†…å®¹ çŠ¶æ€ï¼šå¯æŸ¥çœ‹å·¥ä½œåŒºå’Œæœ€æ–°ä¿®æ”¹è®°å½•ï¼Œå’ŒåŽ†å²æž„å»ºè®°å½•çš„é“¾æŽ¥ï¼› ä¿®æ”¹è®°å½•ï¼šGitä¸Šæ–°Pushçš„ç‰ˆæœ¬ï¼› å·¥ä½œç©ºé—´ï¼šå³æ˜¯å·¥ä½œåŒºï¼Œå¯ä»¥æŸ¥çœ‹Gitä¸ŠCheck outä¸‹æ¥çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆç›¸å¯¹äºŽæœ€åŽä¸€æ¬¡æ‰§è¡Œpoll scmï¼‰çš„æ–‡ä»¶ï¼› ç«‹å³æž„å»ºï¼šæ‰‹åŠ¨æ‰§è¡Œæž„å»ºï¼› åˆ é™¤Projectï¼šå°†Itemç§»é™¤ï¼› é…ç½®ï¼šå†…å®¹åŒ…å«æž„å»ºå‰åŽçš„æ“ä½œã€æž„å»ºçš„è§¦å‘å™¨å’ŒçŽ¯å¢ƒã€æºç ç®¡ç†ç­‰ç­‰ï¼› Git Polling Logï¼šè½®è¯¢Gitçš„æ—¥å¿—ã€‚ é…ç½®Itemæ˜¯Jenkinsé‡Œæœ€é‡è¦çš„ä¸€ä¸ªçŽ¯èŠ‚ä¹‹ä¸€ï¼Œå®ƒç›´æŽ¥å½±å“æž„å»ºçš„æ‰§è¡Œï¼ŒæŽ¥ä¸‹æ¥å°±ä»¥Build Xcode Unit Testä¸ºä¾‹å­ï¼Œè¯¦ç»†è¯´ä¸€ä¸‹å¦‚ä½•é…ç½®ä¸€ä¸ªItemã€‚ åˆ›å»º é¦–å…ˆåˆ›å»ºä¸€ä¸ªfreestyleçš„è½¯ä»¶é¡¹ç›®æž„å»ºItemã€‚ å¸¸è§„è®¾ç½® ä¸¢å¼ƒæ—§çš„æž„å»ºï¼Œå‹¾é€‰äº†å°±å¯ä»¥æŽ§åˆ¶æž„å»ºä¿ç•™çš„å¤©æ•°å’Œæœ€å¤§ä¸ªæ•°ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥åœ¨é«˜çº§é‡Œé…ç½®åŒ…çš„ä¿ç•™å¤©æ•°å’Œä¸ªæ•°ï¼› å‚æ•°åŒ–æž„å»ºè¿‡ç¨‹ï¼Œç¬¬ä¸€ç§ç”¨æ³•æ˜¯ç›¸å½“äºŽé¢„è®¾çŽ¯å¢ƒå˜é‡ï¼Œç¬¬äºŒç§ç”¨æ³•æ˜¯æŒ‡å®šæ–‡ä»¶ï¼› èŠ‚åˆ¶æž„å»ºï¼ŒæŽ§åˆ¶æž„å»ºçš„é¢‘çŽ‡ï¼Œä¾‹å¦‚ä¸€ä¸ªå°æ—¶æœ€å¤šåªèƒ½æž„å»ºä¸€æ¬¡ï¼› å…³é—­æž„å»ºï¼Œé¡¾åæ€ä¹‰ï¼Œå‹¾é€‰äº†è¯¥Itemä¸‹çš„Projectå°±ä¸ä¼šæ‰§è¡Œæž„å»ºï¼› å¿…è¦æ—¶å¹¶å‘æž„å»ºï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªä¼šæœ‰ä¸€ä¸ªæž„å»ºåœ¨æ‰§è¡Œï¼Œå…¶å®ƒæž„å»ºè¯·æ±‚ä¼šåœ¨æž„å»ºé˜Ÿåˆ—ä¸­æŽ’é˜Ÿï¼Œä½†è¿™é¡¹å‹¾é€‰äº†ï¼Œåœ¨èµ„æºè¶³å¤Ÿçš„æƒ…å†µä¸‹å°±ä¼šé‡‡å–å¹¶å‘æž„å»ºã€‚ æºç è®¾ç½® Noneï¼šæ²¡æœ‰æºç æ—¶å‹¾é€‰ã€‚ Gitï¼šä½¿ç”¨Gitç®¡ç†ç‰ˆæœ¬çš„å‹¾é€‰ã€‚éœ€è¦å¡«å†™å¥½Repository URLå’ŒCredentialsã€‚Branch Specifieré»˜è®¤æ˜¯masterï¼Œå³æ˜¯åªæž„å»ºmasteråˆ†æ”¯ä¸Šçš„ç‰ˆæœ¬ï¼Œç•™ç©ºåˆ™ä¼šæž„å»ºæ‰€æœ‰åˆ†æ”¯ã€‚ç”±äºŽå½“æ—¶ä½¿ç”¨çš„GitLabæ²¡æœ‰å¼€å¯SSHåŠŸèƒ½ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰åœ¨Credentialsä¸­é…ç½®SSH Username with private keyçš„å‡­è¯ï¼Œè€Œé‡‡ç”¨åŽŸå§‹çš„Username with passwordã€‚å¦‚æžœå¡«å†™Repository URLåŽæŠ¥é”™ï¼Œè¯´æ˜Žæ²¡æœ‰è¿žé€šGitæˆ–è€…SVNï¼Œè¦å†æ£€æŸ¥ä¸€ä¸‹SSH Keyæˆ–è€…User nameå’Œpasswordã€‚ Subversionï¼šä½¿ç”¨SVNç®¡ç†ç‰ˆæœ¬çš„å‹¾é€‰ï¼Œå’ŒGitç±»ä¼¼ã€‚ è§¦å‘å™¨è®¾ç½® è§¦å‘è¿œç¨‹æž„å»ºï¼šå½“ä½ æƒ³é€šè¿‡ä¸€ä¸ªæŒ‡å®šçš„è¿œç«¯æ¥è§¦å‘ä¸€ä¸ªæ–°çš„æž„å»ºï¼Œå°±å¾—ä½¿ç”¨è¿™é¡¹å®žçŽ°ã€‚ä¾‹å¦‚åœ¨Gitè¿œç«¯é…ç½®hookï¼ŒæŽ¨é€åœ°å€æŒ‰æ ¼å¼ JENKINS_URL/job/utility/build?token=TOKEN_NAME å¡«å†™ã€‚ è¿™æ ·Jenkinså°±èƒ½èŽ·å–repositoryçš„æ‰€æœ‰commité€šçŸ¥ã€‚ Build after other projects are builtï¼šç­‰å¾…å…¶å®ƒProjectæž„å»ºå®Œå†æž„å»ºã€‚å¦‚æžœä¸Šé¢å‹¾é€‰äº†å¹¶è¡Œæž„å»ºï¼ŒåŒæ—¶å‹¾é€‰è¯¥é€‰é¡¹çš„è¯ï¼Œæ„å‘³ç€è¯¥Itemä¸‹çš„æž„å»ºä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼Œä½†å’Œå…¶å®ƒItemçš„æž„å»ºåˆ™æ˜¯å¹¶è¡Œå…³ç³»ã€‚ Build periodicallyï¼šå®šæœŸæž„å»ºï¼Œä¸ç®¡Gitä¸Šæ˜¯å¦æœ‰ç‰ˆæœ¬æ›´æ–°ã€‚æ—¶é—´æ ¼å¼å¦‚ä¸‹ ç¬¬ä¸€ä½ä»£è¡¨åˆ†é’Ÿï¼ˆ0-59ï¼‰ ç¬¬äºŒä½ä»£è¡¨å°æ—¶ï¼ˆ0-23ï¼‰ ç¬¬ä¸‰ä½ä»£è¡¨æ—¥æœŸï¼ˆ1-31ï¼‰ ç¬¬å››ä½ä»£è¡¨æœˆä»½ï¼ˆ1-12ï¼‰ ç¬¬äº”ä½ä»£è¡¨å‘¨ï¼ˆ0-7ï¼Œ0å’Œ7ä»£è¡¨å‘¨æ—¥ï¼‰å¦‚æžœä½ æƒ³æ¯5åˆ†é’Ÿæž„å»ºä¸€æ¬¡ï¼Œåˆ™*/5 * * * *ï¼ˆæ³¨æ„ç©ºæ ¼ï¼Œ/ä»£è¡¨æ¯ï¼‰ï¼Œå¦‚æžœä½ æƒ³æ¯å¤©8ç‚¹æž„å»ºï¼Œåˆ™0 8 * * *æˆ–è€…H 8 * * *ã€‚Hå’Œ0çš„åŒºåˆ«æ˜¯ï¼ŒH H * * *ä»£è¡¨æ¯å¤©æž„å»ºä¸€æ¬¡ä¸”ä¸ä¸Žå…¶å®ƒItemçš„æž„å»ºæ—¶é—´ç‚¹é”™å¼€ï¼Œå³Hä»£è¡¨ä¸€ä¸ªéšæœºå€¼ï¼Œè€Œ0 0 * * *åˆ™ä¼šæ‰Žå †åœ¨åˆå¤œ0ç‚¹çˆ†å‘ã€‚ Build when a change is pushed to GitLabï¼šå’Œç¬¬ä¸€é¡¹ä½œç”¨ä¸€æ ·ï¼Œä¸ç¡®å®šæ˜¯å¦å®‰è£…GitLab hookæ’ä»¶æ—¶ç”Ÿæˆçš„é¡¹ã€‚ GitHub hook trigger for GITScm pollingï¼šå’Œä¸Šé¢ä¸€é¡¹ä¸€æ ·ï¼Œåªæ˜¯é’ˆå¯¹GitHubè€Œå·²ã€‚ Poll SCMï¼šå®šæœŸæ£€æŸ¥æ–°ç‰ˆæœ¬ï¼Œæœ‰æ–°ç‰ˆæœ¬åˆ™check outå¹¶æ‰§è¡Œæž„å»ºï¼Œæ²¡æœ‰åˆ™ç­‰å¾…ä¸‹æ¬¡æ£€æŸ¥ã€‚æ—¶é—´æ ¼å¼å’ŒBuild periodicallyä¸­ä»‹ç»çš„ä¸€æ ·ã€‚ çŽ¯å¢ƒè®¾ç½® è¿™äº›çœ‹æ ‡é¢˜å°±èƒ½å¤§æ¦‚äº†è§£å…¶ä½œç”¨ï¼Œä¸å¤šèµ˜è¿°ã€‚ æž„å»ºè®¾ç½® æž„å»ºä¸­å¯ä»¥é€‰æ‹©ä¸åŒçš„æ“ä½œæ–¹å¼ï¼ŒåŒ…æ‹¬Xcodeã€Execute Shellç­‰ï¼Œå¦‚ä¸‹å›¾ é€‰æ‹©Xcodeçš„è¯éœ€è¦è®¾ç½®æž„å»ºçš„Targetã€Code signingã€Build optionsç­‰ã€‚è¿™é‡Œç®€å•æ¼”ç¤ºäº†Execute Shellçš„æž„å»ºæ–¹å¼ã€‚ä½ å¯ä»¥åœ¨è„šæœ¬ä¸­èŽ·å–å„ç§çŽ¯å¢ƒå˜é‡ï¼Œç‚¹å‡»Commandæ¡†ä¸‹çš„é“¾æŽ¥å°±æœ‰å‚è€ƒã€‚å› ä¸ºè¯¥shellè„šæœ¬æ‰€åœ¨çš„è·¯å¾„ä¸º /Users/Shared/Jenkins/Home/workspace/utilityï¼Œæ‰€ä»¥å…ˆcdåˆ°xcworkspaceæ‰€åœ¨çš„è·¯å¾„å†æž„å»ºã€‚ä¸‹é¢æž„å»ºçš„æ˜¯ä¸€ä¸ªUnit testçš„scheme pwd cd Example xcodebuild test -workspace EfunUtilityModule.xcworkspace -scheme EfunUtilityModule_Tests -destination &apos;platform=iOS Simulator,OS=10.3.1,name=iPhone 7&apos; é¢å¤–è¯´æ˜Žï¼Œåœ¨Itemé‡Œé¢ï¼Œæž„å»ºå¼€å§‹åŽï¼Œæž„å»ºåŽ†å²åˆ—è¡¨ä¸­ä¼šæ˜¾ç¤ºå½“å‰æž„å»ºçš„è¿›åº¦ï¼Œç‚¹å‡»ç¼–å·å¯è¿›å…¥æž„å»ºè®°å½•ã€‚åœ¨æž„å»ºè®°å½•ä¸­ï¼Œæœ€å¸¸æŸ¥çœ‹çš„æ˜¯Console Outputï¼Œå¯ä»¥è§‚å¯Ÿç»ˆç«¯çš„æ‰€æœ‰logã€‚ æž„å»ºåŽè®¾ç½® æž„å»ºåŽå¯ä»¥æ·»åŠ ä¸€äº›å¯é€‰æ€§çš„åŽç»­æ“ä½œï¼Œå¦‚ä¸‹å›¾ è¿™é‡Œæš‚æ—¶åªç”¨åˆ°äº†å‘é€é€šçŸ¥é‚®ä»¶çš„åŠŸèƒ½ Content typeï¼š HTML (text/html)Default contentï¼š ${SCRIPT, template=â€groovy-html.templateâ€} ä½¿ç”¨é‚®ç®±åŠŸèƒ½ï¼Œå…ˆåœ¨å…¨å±€è®¾ç½®é‚£å®ŒæˆåŸºæœ¬é…ç½® å…ˆç™»å½•åˆ°ä¸ªäººé‚®ç®±ï¼Œâ€œè®¾ç½®â€-&gt;â€œPOP3/SMTP/IMAPâ€è®¾ç½®æŽˆæƒç ï¼Œç„¶åŽå°†æŽˆæƒç å¡«å…¥å¯†ç é¡¹ï¼Œå› ä¸ºæœ‰äº›é‚®ç®±ä¸å…è®¸ç›´æŽ¥ä»Žç¬¬ä¸‰æ–¹ä½¿ç”¨å¸å¯†æ“ä½œï¼› è®¾ç½®SMTPæœåŠ¡å™¨ï¼Œæé†’ä¸€ä¸‹ï¼Œæœ‰äº›å®˜æ–¹æä¾›çš„æœåŠ¡å™¨åŸŸåä¹Ÿä¸ä¸€å®šå‡†ç¡®ï¼Œå¦‚æžœæ²¡æ•ˆå°±å†å¤šæ‰¾æ‰¾ç¡®è®¤ï¼› è®¾ç½®ç”¨æˆ·é»˜è®¤é‚®ä»¶åŽç¼€ï¼Œè¿™ä¸ªæç¤ºå¯é€‰ï¼Œä½†ä¸€èˆ¬éƒ½å¡«ä¸Šï¼› é€‰æ‹©SSLåè®®çš„è¯ä¸€èˆ¬å¯¹åº”465çš„SMTPç«¯å£ã€‚æœ‰äº›é‚®ç®±å¯èƒ½ä¸æ”¯æŒSSLæˆ–è€…ç«¯å£ä¸ä¸€æ ·ã€‚å¸¸è§é—®é¢˜ ç„¶åŽå›žåˆ°Itemé‡Œé¢çš„æž„å»ºåŽè®¾ç½®ï¼Œæ·»åŠ â€œé‚®ä»¶é€šçŸ¥ï¼ˆMail Notifcationï¼‰â€çš„æ“ä½œåŽï¼Œè®¾ç½®å¥½â€œæŽ¥æ”¶äººï¼ˆRecipientsï¼‰â€ï¼Œå¤šä¸ªæŽ¥æ”¶äººæ—¶ç”¨è‹±æ–‡ç©ºæ ¼åˆ†éš”ï¼ˆè¿™é‡Œè®¾ç½®äº†æŽ¥æ”¶äººå¯ä»¥ç”¨å…¨å±€å˜é‡èŽ·å–ä¹‹å‰å…¨å±€è®¾ç½®çš„æŽ¥æ”¶äººï¼Œä¹Ÿå¯ä»¥é‡æ–°æŒ‡å®šè¦†ç›–æŽ‰å…¨å±€çš„ï¼‰ï¼Œæœ€åŽå¯è®¾ç½®å‘é€çš„è§¦å‘æ¡ä»¶â€æ€»æ˜¯å‘é€â€œæˆ–è€…â€å¤±è´¥æ—¶å‘é€â€œï¼Œå¦å¤–è¿˜æœ‰ä¸¤ä¸ªé™„åŠ é€‰é¡¹ï¼š â€œæ¯æ¬¡ä¸ç¨³å®šçš„æž„å»ºéƒ½å‘é€é‚®ä»¶é€šçŸ¥â€æ˜¯é»˜è®¤é€‰é¡¹ï¼Œå½“æž„å»ºåŽç»“æžœå¤±è´¥æˆ–ä¸ç¨³å®šæ—¶å‘é‚®ä»¶ç»™Recipientsï¼› â€œå•ç‹¬å‘é€é‚®ä»¶ç»™å¯¹æž„å»ºé€ æˆä¸è‰¯å½±å“çš„è´£ä»»äººâ€ï¼Œå³æ˜¯å‘æœ€åŽæäº¤Gitç‰ˆæœ¬çš„äººå‘é€šçŸ¥ï¼ŒJenkinsä¼šæ ¹æ®è®¾ç½®çš„Recipientsçš„é»˜è®¤é‚®ç®±åŽç¼€åŠ ä¸Šæäº¤ç‰ˆæœ¬çš„ç”¨æˆ·åä½œä¸ºé‚®ç®±åœ°å€ã€‚ é—®é¢˜å°ç»“è¿™é‡Œé‡åˆ°äº†ä¸€äº›å‘ ä½¿ç”¨podçš„ä¸€äº›å·¥ç¨‹ï¼Œschemeé»˜è®¤æ˜¯ä¸åœ¨xcworkspaceä¸Šçš„ï¼Œè€Œåœ¨xcprojectä¸Šï¼Œéœ€è¦åœ¨Xcodeçš„Manage schemesä¸­æ›´æ”¹Schemeæ‰€åœ¨çš„ä½ç½®å’Œè®¾ç½®ä¸ºshareçŠ¶æ€ã€‚ workspaceå‚æ•°ä¸èƒ½ç”¨ç»å¯¹è·¯å¾„ï¼Œcdåˆ°å¯¹åº”è·¯å¾„ä¸‹ä½¿ç”¨ç›¸å¯¹è·¯å¾„å°±å¥½äº†ã€‚ ç”µè„‘ä¸€å®šè¦åœ¨Jenkinsè´¦å·ä¸‹ç™»å½•æ‰èƒ½è°ƒå‡ºæ¨¡æ‹Ÿå™¨ï¼Œå¦åˆ™æž„å»ºå¤±è´¥ã€‚ RSAåŠ è§£å¯†å’ŒèŽ·å–Bundle Seed IDçš„æµ‹è¯•ç”¨ä¾‹ä¸Šï¼ŒåŒä¸ºXcode8ï¼Œä¸åŒçš„å°ç‰ˆæœ¬å´æµ‹è¯•å‡ºä¸ä¸€æ ·çš„ç»“æžœã€‚ æœ¬æ–‡æš‚æ—¶åªä»‹ç»äº†è‡ªåŠ¨æµ‹è¯•ï¼Œåˆ†åŒ…çš„éƒ¨åˆ†æ—¥åŽå†è¡¥å……å§ã€‚ å‚è€ƒæ–‡ç« Testing with Xcodeä¸€æ­¥ä¸€æ­¥æž„å»ºiOSæŒç»­é›†æˆ:Jenkins+GitLab+è’²å…¬è‹±+FTPContinuous Integration in iOS using JENKINSJenkinså…¥é—¨ç³»åˆ—]]></content>
      <tags>
        <tag>Jenkins</tag>
        <tag>CI</tag>
        <tag>Test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ATSè¯¦è§£]]></title>
    <url>%2Funcategorized%2FATS%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[æ°é€¢æœ€è¿‘é¢è¯•çš„æ—¶å€™æœ‰è¢«é—®åˆ°è¿™ä¸€å—ï¼Œå·¥ä½œä¸­å…¶å®žä¹Ÿä¼šç»å¸¸é‡åˆ°è¿™æ–¹é¢çš„é—®é¢˜ï¼Œä½†æ˜¯åŽŸç†å¹¶æ²¡æœ‰æ˜Žæ˜Žç™½ç™½åœ°æžä¸‹æ¥ï¼ŒçŽ°åœ¨å°±æ¥è¯¦ç»†äº†è§£ä¸€ç•ªå§ã€‚ æ¥ï¼Œå…ˆä»ŽåŸºæœ¬çš„åŽŸç†å…¥æ‰‹ï¼Œé¦–å…ˆä»‹ç»ä¸€ä¸‹ä¸€äº›å®‰å…¨åè®®ã€‚ TLS(Transport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®)æ˜¯SSLçš„æ ‡å‡†åŒ–ç‰ˆæœ¬ï¼Œæœ‰1.0ã€1.1ã€1.2ã€1.3å››ä¸ªç‰ˆæœ¬ã€‚æ˜¯ä¸€ç§å¯¹åŸºäºŽç½‘ç»œçš„ä¼ è¾“çš„åŠ å¯†åè®®ï¼Œå¯ä»¥åœ¨å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹å…¬è¯åŸºç¡€ä¸ŠåšåŒæ–¹çš„èº«ä»½è®¤è¯ã€‚TLSå¯ä»¥ç”¨åœ¨TCPä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨æ— è¿žæŽ¥çš„UDPæŠ¥æ–‡ä¸Šã€‚åè®®è§„å®šäº†èº«ä»½è®¤è¯ã€ç®—æ³•åå•†ã€å¯†é’¥äº¤æ¢ç­‰çš„å®žçŽ°ã€‚è€ŒTLS 1.0å’ŒSSL 3.0å‡ ä¹Žæ²¡æœ‰åŒºåˆ«ï¼Œå°±ç›¸å½“äºŽSSL 3.1ï¼› SSLï¼ˆSecure Socket Layerï¼Œå®‰å…¨å¥—æŽ¥å­—å±‚ï¼‰ç”±ç½‘æ™¯Netscapeå…¬å¸å¼€å‘çš„ï¼Œæœ‰1ã€2ã€3ä¸‰ä¸ªç‰ˆæœ¬ï¼Œæ˜¯TLSçš„å‰èº«ï¼ŒçŽ°åœ¨å·²ä¸å†æ›´æ–°ï¼› HTTPSæ˜¯åœ¨åŸºäºŽTLS/SSLçš„å®‰å…¨å¥—æŽ¥å­—ä¸Šçš„çš„åº”ç”¨å±‚åè®®ï¼Œé™¤äº†ä¼ è¾“å±‚è¿›è¡Œäº†åŠ å¯†å¤–ï¼Œå…¶å®ƒä¸Žå¸¸è§„HTTPåè®®åŸºæœ¬ä¿æŒä¸€è‡´ï¼› è¯ä¹¦æ˜¯TLSåè®®ä¸­ç”¨æ¥å¯¹èº«ä»½è¿›è¡ŒéªŒè¯çš„æœºåˆ¶ï¼Œæ˜¯ä¸€ç§æ•°å­—ç­¾åå½¢å¼çš„æ–‡ä»¶ï¼ŒåŒ…å«è¯ä¹¦æ‹¥æœ‰è€…çš„å…¬é’¥åŠç¬¬ä¸‰æ–¹çš„è¯ä¹¦ä¿¡æ¯ã€‚ SSLå·¥ä½œåŽŸç†SSLåè®®ä½äºŽTCP/IPåè®®ä¸Žå„ç§åº”ç”¨å±‚åè®®ä¹‹é—´ï¼Œä¸ºæ•°æ®é€šè®¯æä¾›å®‰å…¨æ”¯æŒã€‚SSLåè®®å¯åˆ†ä¸ºä¸¤å±‚ï¼š SSLè®°å½•åè®®ï¼ˆSSL Record Protocolï¼‰ï¼Œå®ƒå»ºç«‹åœ¨å¯é çš„ä¼ è¾“åè®®ï¼ˆå¦‚TCPï¼‰ä¹‹ä¸Šï¼Œä¸ºé«˜å±‚åè®®æä¾›æ•°æ®å°è£…ã€åŽ‹ç¼©ã€åŠ å¯†ç­‰åŸºæœ¬åŠŸèƒ½çš„æ”¯æŒã€‚ SSLæ¡æ‰‹åè®®ï¼ˆSSL Handshake Protocolï¼‰ï¼Œå®ƒå»ºç«‹åœ¨SSLè®°å½•åè®®ä¹‹ä¸Šï¼Œç”¨äºŽåœ¨å®žé™…çš„æ•°æ®ä¼ è¾“å¼€å§‹å‰ï¼Œé€šè®¯åŒæ–¹è¿›è¡Œèº«ä»½è®¤è¯ã€åå•†åŠ å¯†ç®—æ³•ã€äº¤æ¢åŠ å¯†å¯†é’¥ç­‰ã€‚ èº«ä»½è®¤è¯çŽ°å‡è®¾Aliceè¦è®¤è¯Bobçš„èº«ä»½: Aâ€“&gt;B hello,areyou bob?Bâ€“&gt;A Alice,This Is bob{digest[Alice,This Is Bob]}bobs-private-key Bodä½¿ç”¨RSAçš„ç§é’¥åŠ å¯†ä¸€ä¸ªæ¶ˆæ¯æ‘˜è¦ï¼Œä¾‹å¦‚å¯¹æ¶ˆæ¯è¿›è¡ŒMD5 hashåŽåŠ å¯†ï¼Œç„¶åŽè¿žåŒæ¶ˆæ¯åŽŸæ–‡å‘ç»™Aliceã€‚Aliceä½¿ç”¨RSAçš„å…¬é’¥è§£å¯†ï¼Œå°†è§£å¯†çš„ä¿¡æ¯ä¸Žæ¶ˆæ¯åŽŸæ–‡çš„æ‘˜è¦å¯¹æ¯”ã€‚æ­¤ä¸ºæ•°å­—ç­¾åã€‚ ä¸ºäº†è§£å†³ä¸­é—´äººæ”»å‡»ï¼Œæ ‡å‡†åŒ–ç»„ç»‡åœ¨åˆ†å‘å…¬é’¥è¿™æ­¥åè®®ä¸Šå‘æ˜Žäº†è¯ä¹¦ã€‚è¯ä¹¦æ˜¯ç”±è¯ä¹¦é¢å‘è€…ï¼ˆå³å…¶ä¸Šä¸€çº§è¯ä¹¦ï¼‰ä½¿ç”¨å…¶ç§é’¥ç­¾åè€Œæˆï¼Œå¤–ç•Œéƒ½å¯ä»¥é€šè¿‡è¯ä¹¦çŸ¥é“é¢å‘è€…çš„å…¬é’¥ã€‚ è¿™æ ·å°±æœ‰äº†æ›´å®‰å…¨çš„ç­¾å: Aâ€“&gt;B helloBâ€“&gt;A Hi, Iâ€™m Bob, bobs-certificate(A:verify bobs-certificate)Aâ€“&gt;B prove itBâ€“&gt;A Alice, This Is bob{ digest[Alice, This Is Bob] }bobs-private-key äº¤æ¢ç§˜é’¥æœ‰äº†è¯ä¹¦çš„æ•°å­—ç­¾åè®¤è¯åŽï¼Œå°±å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–å¯†æ–‡çš„äº¤æ¢æ–¹å¼ã€‚ä¸‹é¢æ˜¯å…ˆç”¨ä¸å¯¹ç§°çš„åŠ å¯†ç®—æ³•æ³•éªŒè¯èº«ä»½ï¼Œç„¶åŽç”¨å¯¹ç§°åŠ å¯†ç®—æ³•äº’é€šå…¶ä»–ä¿¡æ¯ Aâ€“&gt;B helloBâ€“&gt;A Hi, Iâ€™m Bob, bobs-certificateAâ€“&gt;B prove itBâ€“&gt;A Alice, This Is bob{ digest[Alice, This Is Bob] }bobs-private-keyAâ€“&gt;B ok bob, here is a secret {secret-key} bobs-public-keyBâ€“&gt;A {some message}secret-key ä½†æ˜¯ä¸Šé¢è¿™ç§å…ˆè®¤è¯èº«ä»½åŽå†å¯¹ç§°åŠ å¯†ä¼ è¾“æ•°æ®çš„æ–¹å¼è¿˜æ˜¯æœ‰æ¼æ´žï¼Œä¸­é—´äººè™½ç„¶æ— æ³•ç ´è§£åŠ å¯†ä¿¡æ¯ï¼Œå´å¯ä»¥åœ¨å¾—åˆ°èº«ä»½è®¤è¯åŽç ´åå¯¹ç§°åŠ å¯†ä¿¡æ¯æ¥è¿›è¡Œæš´åŠ›ç¢°æ’žã€‚æ‰€ä»¥å†æœ‰ä¸€ç§åè®®æ¥è§£å†³ï¼Œå°±æ˜¯åŠ å…¥æ¶ˆæ¯éªŒè¯ç ï¼ˆMACï¼‰ã€‚ æ¶ˆæ¯éªŒè¯æ¶ˆæ¯éªŒè¯ç ï¼ˆMACï¼‰æ ¹æ®å¯¹ç§°ç§˜é’¥å’Œæ¶ˆæ¯åŽŸæ–‡è®¡ç®—ç”Ÿæˆä¸€ä¸ªéªŒè¯ç ï¼Œä½œä¸ºæ¶ˆæ¯çš„ä¸€éƒ¨åˆ†ä¸€å¹¶è¿›è¡Œå¯¹ç§°åŠ å¯†åŽä¼ é€’ï¼ŒæŽ¥æ”¶æ–¹è§£å¯†åŽåˆ™å°†æ¶ˆæ¯åŽŸæ–‡å’Œå¯¹ç§°ç§˜é’¥å†è¿›è¡Œä¸€æ¬¡MACåˆ¶ä½œï¼Œç„¶åŽå’ŒæŽ¥æ”¶åˆ°çš„MACå¯¹æ¯”ï¼Œä¸€è‡´å°±è®¤å®šæ¶ˆæ¯æœ‰æ•ˆã€‚ä¾‹å¦‚å¯ä»¥ä½¿ç”¨MD5å¯¹some message + secret-keyæ‘˜è¦å¼åœ°ç”Ÿæˆä¸€ä¸ªMACã€‚ Aâ€“&gt;B helloBâ€“&gt;A Hi, Iâ€™m Bob, bobs-certificateAâ€“&gt;B prove itBâ€“&gt;A Alice, This Is Bob{digest[Alice, This Is Bob] } bobs-private-keyAâ€“&gt;B ok bob, here is a secret {secret} bobs-public-key(B: MAC = Digest[some message, secret])Bâ€“&gt;A {some message,MAC}secret-key TLSTLSçš„ç»´åŸºç™¾ç§‘æœ‰æ»¡æ»¡çš„ä»‹ç»ï¼ŒåŒ…æ‹¬å„ä¸ªç‰ˆæœ¬çš„æ›´æ–°ç‚¹ã€‚ ä»ŽæŠ€æœ¯ä¸Šè®²ï¼ŒTLS 1.0ä¸ŽSSL 3.0çš„å·®å¼‚éžå¸¸å¾®å°ã€‚ä½†æ­£å¦‚RFCæ‰€è¿° the differences between this protocol and SSL 3.0 are not dramatic, but they are significant enough to preclude interoperability between TLS 1.0 and SSL 3.0. æœ¬åè®®å’ŒSSL 3.0ä¹‹é—´çš„å·®å¼‚å¹¶ä¸æ˜¯æ˜¾è‘—ï¼Œå´è¶³ä»¥æŽ’é™¤TLS 1.0å’ŒSSL 3.0ä¹‹é—´çš„äº’æ“ä½œæ€§ã€‚ TLS 1.0åŒ…æ‹¬å¯ä»¥é™çº§åˆ°SSL 3.0çš„å®žçŽ°ï¼Œè¿™å‰Šå¼±äº†è¿žæŽ¥çš„å®‰å…¨æ€§ã€‚ 2014å¹´10æœˆï¼ŒGoogleå‘å¸ƒåœ¨SSL 3.0ä¸­å‘çŽ°è®¾è®¡ç¼ºé™·ï¼Œå»ºè®®ç¦ç”¨æ­¤ä¸€åè®®ã€‚æ”»å‡»è€…å¯ä»¥å‘TLSå‘é€è™šå‡é”™è¯¯æç¤ºï¼Œç„¶åŽå°†å®‰å…¨è¿žæŽ¥å¼ºè¡Œé™çº§åˆ°è¿‡æ—¶ä¸”ä¸å®‰å…¨çš„SSL 3.0ï¼Œç„¶åŽå°±å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„è®¾è®¡æ¼æ´žçªƒå–æ•æ„Ÿä¿¡æ¯ã€‚Googleåœ¨è‡ªå·±å…¬å¸ç›¸å…³äº§å“ä¸­é™†ç»­ç¦æ­¢å‘åŽå…¼å®¹ï¼Œå¼ºåˆ¶ä½¿ç”¨TLSåè®®ã€‚Mozillaä¹Ÿåœ¨11æœˆ25æ—¥å‘å¸ƒçš„Firefox 34ä¸­å½»åº•ç¦ç”¨äº†SSL 3.0ã€‚å¾®è½¯åŒæ ·å‘å‡ºäº†å®‰å…¨é€šå‘Šã€‚ TLSä¸ŽSSLçš„å·®å¼‚ ç‰ˆæœ¬å·ï¼šTLSè®°å½•æ ¼å¼ä¸ŽSSLè®°å½•æ ¼å¼ç›¸åŒï¼Œä½†ç‰ˆæœ¬å·çš„å€¼ä¸åŒï¼ŒTLSçš„ç‰ˆæœ¬1.0ä½¿ç”¨çš„ç‰ˆæœ¬å·ä¸ºSSLv3.1ï¼› æŠ¥æ–‡é‰´åˆ«ç ï¼šSSLv3.0å’ŒTLSçš„MACç®—æ³•åŠMACè®¡ç®—çš„èŒƒå›´ä¸åŒã€‚TLSä½¿ç”¨äº†RFC-2104å®šä¹‰çš„HMACç®—æ³•ï¼›SSLv3.0ä½¿ç”¨äº†ç›¸ä¼¼çš„ç®—æ³•ï¼Œä¸¤è€…å·®åˆ«åœ¨äºŽSSLv3.0ä¸­ï¼Œå¡«å……å­—èŠ‚ä¸Žå¯†é’¥ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¿žæŽ¥è¿ç®—ï¼Œè€ŒHMACç®—æ³•é‡‡ç”¨çš„æ˜¯å¼‚æˆ–è¿ç®—ã€‚ä½†æ˜¯ä¸¤è€…çš„å®‰å…¨ç¨‹åº¦æ˜¯ç›¸åŒçš„ï¼› ä¼ªéšæœºå‡½æ•°ï¼šTLSä½¿ç”¨äº†ç§°ä¸ºPRFçš„ä¼ªéšæœºå‡½æ•°æ¥å°†å¯†é’¥æ‰©å±•æˆæ•°æ®å—ï¼Œæ˜¯æ›´å®‰å…¨çš„æ–¹å¼ï¼› æŠ¥è­¦ä»£ç ï¼šTLSæ”¯æŒå‡ ä¹Žæ‰€æœ‰çš„SSLv3.0æŠ¥è­¦ä»£ç ï¼Œè€Œä¸”TLSè¿˜è¡¥å……å®šä¹‰äº†å¾ˆå¤šæŠ¥è­¦ä»£ç ï¼Œå¦‚è§£å¯†å¤±è´¥ï¼ˆdecryption_failedï¼‰ã€è®°å½•æº¢å‡ºï¼ˆrecord_overflowï¼‰ã€æœªçŸ¥CAï¼ˆunknown_caï¼‰ã€æ‹’ç»è®¿é—®ï¼ˆaccess_deniedï¼‰ç­‰ï¼› å¯†æ–‡æ—å’Œå®¢æˆ·è¯ä¹¦ï¼šSSLv3.0å’ŒTLSå­˜åœ¨å°‘é‡å·®åˆ«ï¼Œå³TLSä¸æ”¯æŒFortezzaå¯†é’¥äº¤æ¢ã€åŠ å¯†ç®—æ³•å’Œå®¢æˆ·è¯ä¹¦ï¼› certificate_verifyå’Œfinishedæ¶ˆæ¯ï¼šSSLv3.0å’ŒTLSåœ¨ç”¨certificate_verifyå’Œfinishedæ¶ˆæ¯è®¡ç®—MD5å’ŒSHA-1æ•£åˆ—ç æ—¶ï¼Œè®¡ç®—çš„è¾“å…¥æœ‰å°‘è®¸å·®åˆ«ï¼Œä½†å®‰å…¨æ€§ç›¸å½“ï¼› åŠ å¯†è®¡ç®—ï¼šTLSä¸ŽSSLv3.0åœ¨è®¡ç®—ä¸»å¯†å€¼ï¼ˆmaster secretï¼‰æ—¶é‡‡ç”¨çš„æ–¹å¼ä¸åŒï¼› å¡«å……ï¼šç”¨æˆ·æ•°æ®åŠ å¯†ä¹‹å‰éœ€è¦å¢žåŠ çš„å¡«å……å­—èŠ‚ã€‚åœ¨SSLä¸­ï¼Œå¡«å……åŽçš„æ•°æ®é•¿åº¦è¦è¾¾åˆ°å¯†æ–‡å—é•¿åº¦çš„æœ€å°æ•´æ•°å€ã€‚è€Œåœ¨TLSä¸­ï¼Œå¡«å……åŽçš„æ•°æ®é•¿åº¦å¯ä»¥æ˜¯å¯†æ–‡å—é•¿åº¦çš„ä»»æ„æ•´æ•°å€ï¼ˆä½†å¡«å……çš„æœ€å¤§é•¿åº¦ä¸º255å­—èŠ‚ï¼‰ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é˜²æ­¢åŸºäºŽå¯¹æŠ¥æ–‡é•¿åº¦è¿›è¡Œåˆ†æžçš„æ”»å‡»ã€‚ TLSçš„ä¸»è¦ç›®æ ‡å°±æ˜¯ä½¿SSLæ›´å®‰å…¨ï¼Œå¹¶ä½¿åè®®çš„è§„èŒƒæ›´ç²¾ç¡®å’Œå®Œå–„ã€‚ æ›´å®‰å…¨çš„MACç®—æ³•ï¼› æ›´ä¸¥å¯†çš„è­¦æŠ¥ï¼› â€œç°è‰²åŒºåŸŸâ€è§„èŒƒçš„æ›´æ˜Žç¡®çš„å®šä¹‰ã€‚ TLSå¯¹äºŽå®‰å…¨æ€§çš„æ”¹è¿› å¯¹äºŽæ¶ˆæ¯è®¤è¯ä½¿ç”¨å¯†é’¥æ•£åˆ—æ³•ï¼šTLS ä½¿ç”¨â€œæ¶ˆæ¯è®¤è¯ä»£ç çš„å¯†é’¥æ•£åˆ—æ³•â€ï¼ˆHMACï¼‰ï¼Œå½“è®°å½•åœ¨å¼€æ”¾çš„ç½‘ç»œï¼ˆå¦‚å› ç‰¹ç½‘ï¼‰ä¸Šä¼ é€æ—¶ï¼Œè¯¥ä»£ç ç¡®ä¿è®°å½•ä¸ä¼šè¢«å˜æ›´ã€‚SSLv3.0è¿˜æä¾›é”®æŽ§æ¶ˆæ¯è®¤è¯ï¼Œä½†HMACæ¯”SSLv3.0ä½¿ç”¨çš„ï¼ˆæ¶ˆæ¯è®¤è¯ä»£ç ï¼‰MAC åŠŸèƒ½æ›´å®‰å…¨ï¼› å¢žå¼ºçš„ä¼ªéšæœºåŠŸèƒ½ï¼ˆPRFï¼‰ï¼šPRFç”Ÿæˆå¯†é’¥æ•°æ®ã€‚åœ¨TLSä¸­ï¼ŒHMACå®šä¹‰PRFã€‚PRFä½¿ç”¨ä¸¤ç§æ•£åˆ—ç®—æ³•ä¿è¯å…¶å®‰å…¨æ€§ã€‚å¦‚æžœä»»ä¸€ç®—æ³•æš´éœ²äº†ï¼Œåªè¦ç¬¬äºŒç§ç®—æ³•æœªæš´éœ²ï¼Œåˆ™æ•°æ®ä»ç„¶æ˜¯å®‰å…¨çš„ï¼› æ”¹è¿›çš„å·²å®Œæˆæ¶ˆæ¯éªŒè¯ï¼šTLSå’ŒSSLv3.0éƒ½å¯¹ä¸¤ä¸ªç«¯ç‚¹æä¾›å·²å®Œæˆçš„æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯è®¤è¯äº¤æ¢çš„æ¶ˆæ¯æ²¡æœ‰è¢«å˜æ›´ã€‚ç„¶è€Œï¼ŒTLSå°†æ­¤å·²å®Œæˆæ¶ˆæ¯åŸºäºŽPRFå’ŒHMACå€¼ä¹‹ä¸Šï¼Œè¿™ä¹Ÿæ¯”SSLv3.0æ›´å®‰å…¨ï¼› ä¸€è‡´è¯ä¹¦å¤„ç†ï¼šä¸ŽSSLv3.0ä¸åŒï¼ŒTLSè¯•å›¾æŒ‡å®šå¿…é¡»åœ¨TLSä¹‹é—´å®žçŽ°äº¤æ¢çš„è¯ä¹¦ç±»åž‹ï¼› ç‰¹å®šè­¦æŠ¥æ¶ˆæ¯ï¼šTLSæä¾›æ›´å¤šçš„ç‰¹å®šå’Œé™„åŠ è­¦æŠ¥ï¼Œä»¥æŒ‡ç¤ºä»»ä¸€ä¼šè¯ç«¯ç‚¹æ£€æµ‹åˆ°çš„é—®é¢˜ã€‚TLSè¿˜å¯¹ä½•æ—¶åº”è¯¥å‘é€æŸäº›è­¦æŠ¥è¿›è¡Œè®°å½•ã€‚ è¯ä¹¦è¯ä¹¦åˆ†ä¸º2ç±»ï¼š è‡ªç­¾åè¯ä¹¦ CAè¯ä¹¦ è‡ªç­¾åè¯ä¹¦ä¸€èˆ¬ä¸èƒ½ç”¨æ¥è¿›è¡Œèº«ä»½è®¤è¯ï¼Œå¦‚æžœä¸€ä¸ªserverç«¯ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œclientç«¯è¦ä¹ˆè¢«è®¾ç½®ä¸ºæ— æ¡ä»¶ä¿¡ä»»ä»»ä½•è¯ä¹¦ï¼Œè¦ä¹ˆéœ€è¦å°†è‡ªç­¾åè¯ä¹¦çš„å…¬é’¥å’Œç§é’¥åŠ å…¥å—ä¿¡ä»»åˆ—è¡¨ã€‚ CA æ ¹è¯ä¹¦ã€‚æ•°å­—è¯ä¹¦è®¤è¯æœºæž„ï¼ˆCertificate Authority, CAï¼‰ç­¾ç½²å’Œç®¡ç†çš„ CA æ ¹è¯ä¹¦ï¼Œä¼šè¢«çº³å…¥åˆ°ä½ çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿçš„å¯ä¿¡è¯ä¹¦åˆ—è¡¨ä¸­ï¼Œå¹¶ç”±è¿™ä¸ªåˆ—è¡¨åˆ¤æ–­æ ¹è¯ä¹¦æ˜¯å¦å¯ä¿¡ã€‚ä¿¡ä»»é“¾ä¸­å¦‚æžœåªå«æœ‰æœ‰æ•ˆè¯ä¹¦å¹¶ä¸”ä»¥å¯ä¿¡é”šç‚¹ï¼ˆtrusted anchorï¼‰ç»“å°¾ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯ä¹¦å°±è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚ä¾‹å¦‚ GlobalSign Root CA ã€‚ èŠ±é’±è´­ä¹°è¯ä¹¦æœºæž„çš„ç­¾åã€‚å—ä¿¡ä»»çš„æœºæž„å°±å¯ä»¥ç”¨è‡ªå·±çš„ç§é’¥(sign.key)å¯¹å…¶ä»–äººçš„è¯ä¹¦è¿›è¡Œç­¾åã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œåªéœ€è¦æŠŠè¯ä¹¦è¯·æ±‚(ssl.csr)å‘ç»™è¯ä¹¦æœºæž„ï¼Œè¯ä¹¦æœºæž„å°±å¯ä»¥ç”Ÿæˆå‡ºç­¾åè¿‡çš„è¯ä¹¦(ssl.crt)ã€‚ç›®å‰è´­ä¹°è¯ä¹¦ç­¾åæœåŠ¡çš„ä»·æ ¼å¤§çº¦ä¸º100-400å…ƒ/å¹´ã€‚ åƒæˆ‘ä»¬å¹³æ—¶åˆ›å»ºè‹¹æžœå¼€å‘è€…è¯ä¹¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¼€å‘è€…çš„ç”µè„‘ä¸Šé€šè¿‡é’¥åŒ™ä¸²ä¸­è¯ä¹¦åŠ©ç†å¤„çš„ä»Žè¯ä¹¦é¢å‘æœºæž„è¯·æ±‚è¯ä¹¦èŽ·å–.certSigningRequestï¼Œç„¶åŽä¸Šä¼ åˆ°è‹¹æžœçš„developåŽå°åŽ»ç”Ÿæˆ.cerï¼Œå…¶å®žè´¨å°±æ˜¯è¯·æ±‚è‹¹æžœä¿¡ä»»çš„ CA å¯¹å¼€å‘è€…çš„è¯ä¹¦è¿›è¡Œç­¾åï¼Œä½¿å¼€å‘è€…çš„è¯ä¹¦åˆæ³•ã€‚ è‹¹æžœdevelopåŽå°åˆ›å»º.mobileprovisionæ—¶ï¼Œä¼šå°†.cerçš„å…¬é’¥é™„å¸¦ä¸Šã€‚åœ¨æ‰“åŒ…æˆ–è€…çœŸæœºè°ƒè¯•æ—¶ï¼ŒXcodeå°±ä¼šé€šè¿‡Bundle IDæŸ¥æ‰¾å¯¹åº”çš„.mobileprovisionï¼Œç„¶åŽåˆ©ç”¨XcodeæŒ‡å®šçš„.cerçš„ç§é’¥åŠ å¯†ç”Ÿæˆä¸€ä¸ªç­¾ååŽ»ç»™.mobileprovisionçš„å…¬é’¥è§£å¯†éªŒè¯ç”µè„‘çš„åˆæ³•æ€§ã€‚è€Œ.ceræ˜¯ä¸åŒ…å«ç§é’¥çš„ï¼Œ.ceræ— æ³•è®©åˆ«çš„ç”µè„‘ä¸Šæ­£å¸¸åœ°è¿›è¡Œæ‰“åŒ…æˆ–è€…çœŸæœºè°ƒè¯•ï¼Œä½†å› ä¸ºåœ¨åˆ›å»º.certSigningRequestæ—¶ï¼Œè¯ä¹¦æºç”µè„‘æœ¬æ¥æŒæœ‰çš„å¯¹åº”çš„ç§é’¥ä¸€ç›´å­˜åœ¨äºŽå…¶keychainä¸Šï¼Œæ‰€ä»¥è¯ä¹¦æºç”µè„‘èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚è§£å†³æ–¹æ³•æ˜¯å°†.cerå¯¼æˆ.p12åŽç»™åˆ«çš„ç”µè„‘å®‰è£…ï¼Œå› ä¸º.p12é‡ŒåŒ…å«äº†å…¬é’¥å’Œç§é’¥ï¼ˆå®‰è£…äº†.p12åŽï¼Œåˆ«çš„ç”µè„‘ä¸Šçš„keychainä¸­æ˜¾ç¤ºçš„cerå°±æœ‰äº†ç§é’¥ï¼‰ã€‚ è¯ä¹¦é“¾æ•°å­—è¯ä¹¦çš„ç”Ÿæˆæ˜¯åˆ†å±‚çº§çš„ï¼Œä¸‹ä¸€çº§çš„è¯ä¹¦éœ€è¦å…¶ä¸Šä¸€çº§è¯ä¹¦çš„ç§é’¥ç­¾åçš„ã€‚æ‰€ä»¥åŽè€…æ˜¯å‰è€…çš„è¯ä¹¦é¢å‘è€…ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸Šä¸€çº§è¯ä¹¦çš„ Subject Name æ˜¯å…¶ä¸‹ä¸€çº§è¯ä¹¦çš„ Issuer Nameã€‚ serverå‘é€è¯ä¹¦ç»™clientè®¤è¯èº«ä»½ï¼› clientæ ¹æ®è¯ä¹¦ä¸­çš„é¢å‘è€…ä¿¡æ¯æ‰¾è¯¥è¯ä¹¦çš„ä¸Šä¸€çº§è¯ä¹¦ï¼Œç„¶åŽéªŒè¯è¯¥è¯ä¹¦çš„åˆæ³•æ€§ï¼ˆå³å°†è¯¥è¯ä¹¦ä¸­çš„ä¿¡æ¯æŒ‰å…¶ä¸Šçº§çš„ç­¾åç®—æ³•è®¡ç®—ç­¾åï¼Œå’Œä½¿ç”¨ä¸Šçº§è¯ä¹¦çš„å…¬é’¥è§£å¯†è¯¥è¯ä¹¦ä¸­çš„æ•°å­—ç­¾åçš„åŽŸæ–‡ä½œæ¯”è¾ƒï¼‰ï¼› è‹¥åˆæ³•ï¼Œåˆ™ç»§ç»­åŽ†ééªŒè¯è¯ä¹¦é“¾ä¸­çš„æ‰€æœ‰è¯ä¹¦ï¼Œç›´åˆ°æ•°å­—è¯ä¹¦è®¤è¯æœºæž„ï¼ˆCertificate Authority, CAï¼‰ç­¾ç½²å’Œç®¡ç†çš„ CA æ ¹è¯ä¹¦ä¸ºæ­¢ï¼Œåˆ™è®¤ä¸ºè¯ä¹¦åˆæ³•ã€‚ X.509 åº”è¯¥æ˜¯æ¯”è¾ƒæµè¡Œçš„ SSL æ•°å­—è¯ä¹¦æ ‡å‡†ï¼ŒåŒ…å«ï¼ˆä½†ä¸é™äºŽï¼‰ä»¥ä¸‹çš„å­—æ®µï¼š å­—æ®µ å€¼è¯´æ˜Ž å¯¹è±¡åç§°ï¼ˆSubject Nameï¼‰ ç”¨äºŽè¯†åˆ«è¯¥æ•°å­—è¯ä¹¦çš„ä¿¡æ¯ å…±æœ‰åç§°ï¼ˆCommon Nameï¼‰ å¯¹äºŽå®¢æˆ·è¯ä¹¦ï¼Œé€šå¸¸æ˜¯ç›¸åº”çš„åŸŸå è¯ä¹¦é¢å‘è€…ï¼ˆIssuer Nameï¼‰ å‘å¸ƒå¹¶ç­¾ç½²è¯¥è¯ä¹¦çš„å®žä½“çš„ä¿¡æ¯ ç­¾åç®—æ³•ï¼ˆSignature Algorithmï¼‰ ç­¾åæ‰€ä½¿ç”¨çš„ç®—æ³• åºåˆ—å·ï¼ˆSerial Numberï¼‰ ç”±CAç»™äºˆæ¯ä¸€ä¸ªè¯ä¹¦åˆ†é…çš„å”¯ä¸€çš„æ•°å­—åž‹ç¼–å· æ•°å­—è¯ä¹¦æœºæž„ï¼ˆCertificate Authorityï¼Œ CAï¼‰ ç»™è¯ä¹¦çš„å”¯ä¸€æ•´æ•°ï¼Œä¸€ä¸ªæ•°å­—è¯ä¹¦ä¸€ä¸ªåºåˆ—å· ç”Ÿæ•ˆæœŸï¼ˆNot Valid Beforeï¼‰ â€“ å¤±æ•ˆæœŸï¼ˆNot Valid Afterï¼‰ â€“ å…¬é’¥ï¼ˆPublic Keyï¼‰ å¯å…¬å¼€çš„å¯†é’¥ ç­¾åï¼ˆSignatureï¼‰ é€šè¿‡ç­¾åç®—æ³•è®¡ç®—è¯ä¹¦å†…å®¹åŽå¾—åˆ°çš„æ•°æ®ï¼Œç”¨äºŽéªŒè¯è¯ä¹¦æ˜¯å¦è¢«ç¯¡æ”¹ ATSï¼ˆAppTransportSecurityï¼‰ATSé»˜è®¤çš„æ¡ä»¶ æœåŠ¡å™¨TLSç‰ˆæœ¬è‡³å°‘æ˜¯1.2ç‰ˆæœ¬ è¿žæŽ¥åŠ å¯†åªå…è®¸å‡ ç§å…ˆè¿›çš„åŠ å¯† TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHATLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHATLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA è¯ä¹¦å¿…é¡»ä½¿ç”¨SHA256æˆ–è€…æ›´å¥½çš„å“ˆå¸Œç®—æ³•è¿›è¡Œç­¾åï¼Œè¦ä¹ˆæ˜¯2048ä½æˆ–è€…æ›´é•¿çš„RSAå¯†é’¥ï¼Œè¦ä¹ˆå°±æ˜¯256ä½æˆ–æ›´é•¿çš„ECCå¯†é’¥ã€‚ serveréœ€è¦æä¾›HTTPSï¼ˆTLS 1.2ï¼‰çš„æŽ¥å£ï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤éªŒè¯serverçš„APIæ˜¯å¦ç¬¦åˆATSæ ‡å‡†ã€‚ nscurl --ats-diagnostics https://www.google.com ATSçš„Clienté…ç½®åœ¨Xcode7æˆ–ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œæ–°å»ºçš„é¡¹ç›®éƒ½é»˜è®¤ä½¿ç”¨ATSï¼Œå³æ˜¯è®¿é—®çš„é“¾æŽ¥å¿…é¡»æ”¯æŒä¸”ä½¿ç”¨HTTPSå‘èµ·è¯·æ±‚ï¼Œå¦åˆ™å°†è¿”å›ž çš„é”™è¯¯ã€‚ å¦‚æžœserverè¿˜ä¸æ”¯æŒATSï¼Œåˆ™éœ€è¦åœ¨appçš„info.plistä¸­åšä¸€äº›å¦‚ä¸‹çš„è°ƒæ•´ï¼Œä½¿appèƒ½æ­£å¸¸è¯·æ±‚HTTPã€‚ ä»¥ä¸‹æ˜¯info.plisté‡Œé¢ä¸ŽATSæœ‰å…³çš„å±žæ€§ï¼ˆåˆ†å±‚çº§ï¼‰ NSAppTransportSecurity NSAllowsArbitraryLoads NSExceptionDomains &lt; domain-name-for-exception-as-string &gt; NSExceptionMinimumTLSVerion NSExceptionRequiresForwardSecrecy NSExceptionAllowsInsecureHTTPLoads NSIncludesSubdomains NSThirdPartyExceptionMinimumTLSVersion NSThirdPartyExceptionRequiresForwardSecrecy NSThirdPartyExceptionAllowsInsecureHTTPLoads NSAppTransportSecurity : ä¸€ä¸ªç”¨äºŽé…ç½®App Transport Securityè¡Œä¸ºçš„å±žæ€§ï¼Œåœ¨Info.plistä¸­æ˜¯äºŽBundle IdentifieråŒä¸€çº§åˆ«çš„å±žæ€§ã€‚ NSAllowsArbitraryLoads : ä¸€ä¸ªç”¨äºŽé’ˆå¯¹ä¸åœ¨NSExceptionDomainsä¸­çš„åŸŸçš„é…ç½®é¡¹ã€‚å¦‚æžœè®¾ç½®æˆYESï¼Œåˆ™å¯¹äºŽé‚£äº›ä¸åœ¨NSExceptionDomainsçš„åŸŸåˆ™ä¸éœ€è¦é€šè¿‡ATSçš„éªŒè¯ã€‚é»˜è®¤å€¼æ˜¯Noï¼Œè¿™æ—¶å¯¹äºŽä¸åœ¨NSExceptionDomainsé‡Œçš„åŸŸåˆ™æ˜¯éœ€è¦é€šè¿‡ATSçš„éªŒè¯ã€‚ NSExceptionDomains : ç”¨äºŽé…ç½®ä¾‹å¤–çš„é…ç½®é¡¹ã€‚ &lt; domain-name-for-exception-as-string &gt; : éœ€è¦æ·»åŠ ä¾‹å¤–çš„åŸŸåå­—ç¬¦ä¸²ï¼Œå¦‚:www.baidu.com NSExceptionMinimumTLSVerion : ç”¨äºŽæŒ‡å®šä¾‹å¤–åŸŸåçš„TSLçš„ç‰ˆæœ¬å·ï¼Œå¯ç”¨çš„é…ç½®æœ‰TLSv1.0ã€TLSv1.1ä»¥åŠTLSv1.2ä¸‰ä¸ªé…ç½®é¡¹ã€‚ NSExceptionRequiresForwardSecrecy ï¼š ç”¨äºŽæŒ‡å®šæ‰€é…ç½®çš„åŸŸåè®®æ˜¯å¦ä½¿ç”¨ATSçš„æ‰€è¦æ±‚çš„è¯ä¹¦åŠ å¯†ç®—æ³•ç­¾åï¼Œå¦‚æžœæ˜¯NOï¼Œ åˆ™åŠ å¯†ç®—æ³•å¿…é¡»æ˜¯ä»¥ä¸‹è¿™å‡ ç§ã€‚é»˜è®¤å€¼æ˜¯YESã€‚ TLS_RSA_WITH_AES_256_GCM_SHA384TLS_RSA_WITH_AES_128_GCM_SHA256TLS_RSA_WITH_AES_256_CBC_SHA256TLS_RSA_WITH_AES_256_CBC_SHATLS_RSA_WITH_AES_128_CBC_SHA256TLS_RSA_WITH_AES_128_CBC_SHA NSExceptionAllowsInsecureHTTPLoads : ç”¨äºŽæŒ‡æ˜Žæ‰€é…ç½®çš„åŸŸæ˜¯å¦HTTPSçš„æœåŠ¡å™¨ã€‚ç”¨è¿™ä¸ªé…ç½®å¯ç”¨è®¿é—®é‚£äº›æ²¡æœ‰è¯ä¹¦ã€è‡ªç­¾åè¯ä¹¦ã€è¿‡æœŸè¯ä¹¦ä»¥åŠè¯ä¹¦ä¸ŽåŸŸååŒ¹é…ä¸ä¸Šçš„æœåŠ¡å™¨ã€‚é»˜è®¤å€¼æ˜¯NOã€‚ NSIncludesSubdomains : ç”¨äºŽæŒ‡æ˜Žå­åŸŸåæ˜¯å¦ä½¿ç”¨åŒæ ·çš„é…ç½®ã€‚é»˜è®¤å€¼æ˜¯NOã€‚ NSThirdPartyExceptionMinimumTLSVersion : è¯¥å˜é‡åœ¨åŸŸåä¸ºç¬¬ä¸‰æ–¹åŸŸåæ—¶ï¼Œä¸”å¼€å‘äººå‘˜æ— æ³•æŽ§åˆ¶çš„æƒ…å†µä¸‹è¿›è¡Œé…ç½®ã€‚ NSThirdPartyExceptionRequiresForwardSecrecy : è¯¥å˜é‡åœ¨åŸŸåä¸ºç¬¬ä¸‰æ–¹åŸŸåæ—¶ï¼Œä¸”å¼€å‘äººå‘˜æ— æ³•æŽ§åˆ¶çš„æƒ…å†µä¸‹è¿›è¡Œé…ç½®ã€‚ NSThirdPartyExceptionRequiresForwardSecrecy : è¯¥å˜é‡åœ¨åŸŸåä¸ºç¬¬ä¸‰æ–¹åŸŸåæ—¶ï¼Œä¸”å¼€å‘äººå‘˜æ— æ³•æŽ§åˆ¶çš„æƒ…å†µä¸‹è¿›è¡Œé…ç½®ã€‚ ä¸¾ä¾‹ä½¿appè¯·æ±‚çš„æ‰€æœ‰HTTPé“¾æŽ¥éƒ½èƒ½åŠ è½½ï¼š &lt;key&gt;NSAppTransportSecurity&lt;/key&gt; &lt;dict&gt; &lt;!--Connect to anything (this is probably BAD)--&gt; &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;&lt;true/&gt; &lt;/dict&gt; ä½¿appè¯·æ±‚çš„éƒ¨åˆ†ï¼ˆæŒ‡å®šåŸŸåçš„ï¼‰HTTPæˆ–è€…ä½Žç‰ˆæœ¬çš„HTTPS(TLS 1.1/1.0)é“¾æŽ¥èƒ½åŠ è½½ï¼š &lt;key&gt;NSAppTransportSecurity&lt;/key&gt; &lt;dict&gt; &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;&lt;true/&gt; &lt;key&gt;NSExceptionDomains&lt;/key&gt; &lt;dict&gt; &lt;key&gt;yourserver.com&lt;/key&gt; &lt;dict&gt; &lt;!--Include to allow subdomains--&gt; &lt;key&gt;NSIncludesSubdomains&lt;/key&gt;&lt;true/&gt; &lt;!--Include to allow insecure HTTP requests--&gt; &lt;key&gt;NSTemporaryExceptionAllowsInsecureHTTPLoads&lt;/key&gt;&lt;true/&gt; &lt;!--Include to allow securecy encrypt arithmetic--&gt; &lt;key&gt;NSExceptionRequiresForwardSecrecy&lt;/key&gt;&lt;true/&gt; &lt;!--Include to specify minimum TLS version--&gt; &lt;key&gt;NSTemporaryExceptionMinimumTLSVersion&lt;/key&gt;&lt;string&gt;TLSv1.1&lt;/string&gt; &lt;/dict&gt; &lt;/dict&gt; &lt;/dict&gt; ä½¿appè¯·æ±‚çš„æŒ‡å®šåŸŸåçš„ç½‘å€è¦ç»è¿‡ATSï¼š &lt;key&gt;NSAppTransportSecurity&lt;/key&gt; &lt;dict&gt; &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;&lt;true/&gt; &lt;key&gt;NSExceptionDomains&lt;/key&gt; &lt;dict&gt; &lt;key&gt;yourserver.com&lt;/key&gt; &lt;dict&gt; &lt;!--Include to allow subdomains--&gt; &lt;key&gt;NSIncludesSubdomains&lt;/key&gt;&lt;true/&gt; &lt;!--Include to allow insecure HTTP requests--&gt; &lt;key&gt;NSTemporaryExceptionAllowsInsecureHTTPLoads&lt;/key&gt;&lt;false/&gt; &lt;/dict&gt; &lt;/dict&gt; &lt;/dict&gt; è‡ªå®šä¹‰éªŒè¯æœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯å¦‚æžœæœåŠ¡å™¨çš„ response ä¸­å¸¦æœ‰ WWW-Authenticate çš„headerä¿¡æ¯ï¼Œç½‘ç»œç³»ç»Ÿç±»å°±ä¼šè°ƒç”¨å®ƒä»¬çš„ä»£ç†å¯¹è±¡çš„ä»£ç†æ–¹æ³•åŽ»å¤„ç†challengesã€‚å…¶å®ƒè®¤è¯ç±»åž‹ï¼Œä¾‹å¦‚ proxy authentication TLS trust validation æ˜¯ä¸éœ€è¦å¸¦ä¸Šè¿™ä¸ªheaderä¹Ÿèƒ½è§¦å‘ã€‚ åœ¨ä»£ç éœ€è¦å‘è®¤è¯çš„æœåŠ¡å™¨è¯·æ±‚èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨ä¼šä½¿ç”¨httpçŠ¶æ€ç 401è¿›è¡Œå“åº”ï¼Œå³è®¿é—®è¢«æ‹’ç»éœ€è¦éªŒè¯ã€‚NSURLConnectionä¼šæŽ¥æ”¶åˆ°å“åº”å¹¶ç«‹åˆ»ä½¿ç”¨è®¤è¯challengeçš„ä¸€ä»½å‰¯æœ¬æ¥å‘é€ä¸€æ¡willSendRequestForAuthenticationChallenge:å§”æ‰˜æ¶ˆæ¯ã€‚è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š - (void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge &#123; //ä»¥å‰çš„å¤±è´¥æ¬¡æ•° if ([challenge previousFailureCount] == 0) &#123; //èº«ä»½è®¤è¯çš„ç±» NSURLCredential *newCredential; newCredential = [NSURLCredential credentialWithUser:@&quot;è´¦å·&quot; password:@&quot;å¯†ç &quot; persistence:NSURLCredentialPersistenceNone]; [[challenge sender] useCredential:newCredential forAuthenticationChallenge:challenge]; &#125; else &#123; [[challenge sender] cancelAuthenticationChallenge:challenge]; &#125; &#125; NSURLCredentialä»£è¡¨çš„æ˜¯ä¸€ä¸ªèº«ä»½éªŒè¯è¯ä¹¦ã€‚URL Loadingç³»ç»Ÿæ”¯æŒ3ç§ç±»åž‹çš„è¯ä¹¦ï¼špassword-based user credentials, certificate-based user credentials, and certificate-based server credentialsã€‚NSURLCredentialé€‚åˆå¤§å¤šæ•°çš„è®¤è¯è¯·æ±‚ï¼Œå› ä¸ºå®ƒå¯ä»¥è¡¨ç¤ºç”±ç”¨æˆ·å/å¯†ç ç»„åˆã€å®¢æˆ·ç«¯è¯ä¹¦åŠæœåŠ¡å™¨ä¿¡ä»»åˆ›å»ºçš„è®¤è¯ä¿¡æ¯ã€‚ ä¸ºäº†è®¤è¯ï¼Œè¦åˆ›å»ºä¸€ä¸ªå«æœ‰æœåŠ¡ç«¯æœŸæœ›çš„è®¤è¯ä¿¡æ¯çš„NSURLCredentialå¯¹è±¡ã€‚åœ¨ç³»ç»Ÿæä¾›çš„authentication challengeçš„protection spaceä¸Šè°ƒç”¨ authenticationMethod æ–¹æ³•ï¼Œå¯ä»¥èŽ·å–æœåŠ¡å™¨çš„è®¤è¯æ–¹æ³•ã€‚è€ŒNSURLCredentialæ”¯æŒçš„authentication methodæœ‰ä»¥ä¸‹å‡ ç§ï¼Œå¯åˆ†åˆ«ç”¨æ‹¬å·ä¸­çš„NSURLCredentialå·¥åŽ‚æ–¹æ³•åˆ›å»ºå¯¹åº”çš„NSURLCredentialå¯¹è±¡ã€‚ NSURLAuthenticationMethodHTTPBasic (credentialWithUser:password:persistence) NSURLAuthenticationMethodHTTPDigest(credentialWithUser:password:persistence) NSURLAuthenticationMethodClientCertificate(credentialWithIdentity:certificates:persistence) NSURLAuthenticationMethodServerTrust(credentialForTrust:) å®¢æˆ·ç«¯éªŒè¯æœåŠ¡ç«¯-URLSession:didReceiveChallenge:completionHandler: å›žè°ƒä¸­ä¼šæ”¶åˆ°ä¸€ä¸ª challengeï¼Œä¹Ÿå°±æ˜¯è´¨è¯¢ï¼ŒæœåŠ¡ç«¯éœ€è¦ä½ æä¾›è®¤è¯ä¿¡æ¯æ‰èƒ½å®Œæˆè¿žæŽ¥ã€‚ challenge ä¸­è¿˜åŒ…å«æœåŠ¡ç«¯æä¾›çš„å…¶è‡ªèº«çš„è¯æ˜Žï¼Œå¯ä»¥é€šè¿‡ challenge.protectionSpace.authenticationMethod å–å¾—ä¿æŠ¤ç©ºé—´è¦æ±‚æˆ‘ä»¬è®¤è¯çš„æ–¹å¼ï¼Œå¦‚æžœè¿™ä¸ªå€¼æ˜¯ NSURLAuthenticationMethodServerTrust çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ’æ‰‹ TLS æ¡æ‰‹ä¸­â€œéªŒè¯æ•°å­—è¯ä¹¦æœ‰æ•ˆæ€§â€è¿™ä¸€æ­¥ï¼Œå³æ˜¯å…ˆéªŒè¯æœåŠ¡ç«¯æä¾›çš„èº«ä»½ï¼Œå†è¿”å›žå®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯ç»™æœåŠ¡ç«¯å»ºç«‹SSLè¿žæŽ¥ã€‚ ç³»ç»Ÿçš„é»˜è®¤å®žçŽ°ï¼ˆä¹Ÿå³ä»£ç†ä¸å®žçŽ°è¿™ä¸ªæ–¹æ³•ï¼‰æ˜¯éªŒè¯è¿™ä¸ªä¿¡ä»»é“¾çš„ï¼Œç»“æžœæ˜¯æœ‰æ•ˆçš„è¯åˆ™æ ¹æ® serverTrust åˆ›å»º credential ç”¨äºŽåŒæœåŠ¡ç«¯ç¡®ç«‹ SSL è¿žæŽ¥ã€‚å¦åˆ™ä¼šå¾—åˆ° â€œThe certificate for this server is invalidâ€¦â€ è¿™æ ·çš„é”™è¯¯è€Œæ— æ³•è®¿é—®ã€‚ - (void)URLSession:(NSURLSession *)session didReceiveChallenge:(nonnull NSURLAuthenticationChallenge *)challenge completionHandler:(nonnull void (^)(NSURLSessionAuthChallengeDisposition, NSURLCredential * _Nullable))completionHandler&#123; //ä»¥å‰çš„å¤±è´¥æ¬¡æ•° if ([challenge previousFailureCount] == 0) &#123; NSURLCredential *credential = nil; NSURLSessionAuthChallengeDisposition disposition = NSURLSessionAuthChallengePerformDefaultHandling; if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) &#123; /* è°ƒç”¨è‡ªå®šä¹‰çš„éªŒè¯è¿‡ç¨‹ */ SecTrustRef trust = challenge.protectionSpace.serverTrust; if ([self myCustomValidation:trust]) &#123; credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]; if (credential) &#123; disposition = NSURLSessionAuthChallengeUseCredential; &#125; &#125; else &#123; /* æ— æ•ˆçš„è¯ï¼Œå–æ¶ˆ */ disposition = NSURLSessionAuthChallengeCancelAuthenticationChallenge &#125; !completionHandler?:completionHandler(disposition,credential) &#125; else &#123; //èº«ä»½è®¤è¯çš„ç±» credential = [NSURLCredential credentialWithUser:@&quot;è´¦å·&quot; password:@&quot;å¯†ç &quot; persistence:NSURLCredentialPersistenceNone]; //ä»¥ä¸‹è°ƒç”¨çš„æ•ˆæžœåŒæ‰§è¡ŒcompletionHandlerä¸€æ · [[challenge sender] useCredential:credential forAuthenticationChallenge:challenge]; &#125; &#125; else &#123; [[challenge sender] cancelAuthenticationChallenge:challenge]; &#125; &#125; è‡ªå®šä¹‰çš„éªŒè¯è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å…ˆè¯»å–challengeçš„protectionSpaceå±žæ€§çš„serverTrustå±žæ€§ï¼ŒserverTrust æ˜¯ä¸€ä¸ª SecTrustRef å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ç§æ‰§è¡Œä¿¡ä»»é“¾éªŒè¯çš„æŠ½è±¡å®žä½“ï¼ŒåŒ…å«ç€éªŒè¯ç­–ç•¥ï¼ˆSecPolicyRefï¼‰ä»¥åŠä¸€ç³»åˆ—å—ä¿¡ä»»çš„é”šç‚¹è¯ä¹¦ï¼Œè€Œæˆ‘ä»¬èƒ½åšçš„ä¹Ÿæ˜¯ä¿®æ”¹è¿™ä¸¤æ ·ä¸œè¥¿è€Œå·²ã€‚ static BOOL myCustomValidation(SecTrustRef trust) &#123; BOOL allowConnection = NO; // å‡è®¾éªŒè¯ç»“æžœæ˜¯æ— æ•ˆçš„ SecTrustResultType trustResult = kSecTrustResultInvalid; // å‡½æ•°çš„å†…éƒ¨é€’å½’åœ°ä»Žå¶èŠ‚ç‚¹è¯ä¹¦åˆ°æ ¹è¯ä¹¦çš„éªŒè¯ OSStatus statue = SecTrustEvaluate(trust, &amp;trustResult); if (statue == noErr) &#123; // kSecTrustResultUnspecified: ç³»ç»Ÿéšå¼åœ°ä¿¡ä»»è¿™ä¸ªè¯ä¹¦ï¼Œå³åœ¨è¯ä¹¦é“¾ä¸­æ‰¾åˆ° CA é¢å‘çš„è¯ä¹¦ // kSecTrustResultProceed: ç”¨æˆ·åŠ å…¥è‡ªå·±çš„ä¿¡ä»»é”šç‚¹ï¼Œæ˜¾å¼åœ°å‘Šè¯‰ç³»ç»Ÿè¿™ä¸ªè¯ä¹¦æ˜¯å€¼å¾—ä¿¡ä»»çš„ allowConnection = (trustResult == kSecTrustResultProceed || trustResult == kSecTrustResultUnspecified); &#125; return allowConnection; &#125; æ‰“å° policiesRef åŽï¼Œä½ ä¼šå‘çŽ°é»˜è®¤çš„éªŒè¯ç­–ç•¥å°±åŒ…å«äº†åŸŸåéªŒè¯ï¼Œå³æœåŠ¡å™¨è¯ä¹¦ä¸Šçš„åŸŸåå’Œè¯·æ±‚åŸŸåæ˜¯å¦åŒ¹é…ã€‚å¦‚æžœä½ çš„ä¸€ä¸ªè¯ä¹¦éœ€è¦ç”¨æ¥è¿žæŽ¥ä¸åŒåŸŸåçš„ä¸»æœºï¼Œæˆ–è€…ä½ ç›´æŽ¥ç”¨ IP åœ°å€åŽ»è¿žæŽ¥ï¼Œé‚£ä¹ˆä½ å¯ä»¥é‡è®¾éªŒè¯ç­–ç•¥ä»¥å¿½ç•¥åŸŸåéªŒè¯: CFArrayRef policiesRef; //æ‰“å°å‡ºCFArrayRefä¼šå‘çŽ°éªŒè¯ç­–ç•¥ä¸­é»˜è®¤æ˜¯åŒ…å«åŸŸåè®¤è¯ SecTrustCopyPolicies(trust, &amp;policiesRef); NSMutableArray *policies = [NSMutableArray array]; // BasicX509 ä¸éªŒè¯åŸŸåæ˜¯å¦ç›¸åŒ SecPolicyRef policy = SecPolicyCreateBasicX509(); [policies addObject:(__bridge_transfer id)policy]; SecTrustSetPolicies(trust, (__bridge CFArrayRef)policies); ç„¶åŽå†è°ƒç”¨ myCustomValidation() éªŒè¯ï¼ŒSecTrustEvaluateå‡½æ•°å°±ä¼šæ ¹æ®trustçš„ç­–ç•¥é‡æ–°è¯„ä¼°éªŒè¯ç»“æžœã€‚ è‡ªç­¾åè¯ä¹¦éªŒè¯æƒ³è¦ App é˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼Œå¯ä»¥å°†å…¬é’¥è¯ä¹¦æ‰“åŒ…è¿› App ä¸­ï¼Œç„¶åŽåœ¨æ”¶åˆ°æœåŠ¡ç«¯è¯ä¹¦é“¾çš„æ—¶å€™ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°éªŒè¯æœåŠ¡ç«¯æ˜¯å¦å¯ä¿¡ï¼Œè¿™ä¹Ÿæ˜¯éªŒè¯è‡ªç­¾åçš„è¯ä¹¦é“¾æ‰€å¿…é¡»åšçš„ã€‚ å‡è®¾ä½ çš„æœåŠ¡å™¨è¿”å›žï¼š[ä½ çš„è‡ªç­¾åçš„æ ¹è¯ä¹¦] â€“ [ä½ çš„äºŒçº§è¯ä¹¦] â€“ [ä½ çš„å®¢æˆ·ç«¯è¯ä¹¦]ï¼Œç³»ç»Ÿæ˜¯ä¸ä¿¡ä»»è¿™ä¸ªä¸‰ä¸ªè¯ä¹¦çš„ã€‚æ‰€ä»¥ä½ åœ¨éªŒè¯çš„æ—¶å€™éœ€è¦å°†è¿™ä¸‰ä¸ªçš„å…¶ä¸­ä¸€ä¸ªè®¾ç½®ä¸ºé”šç‚¹è¯ä¹¦ï¼Œå½“ç„¶ï¼Œå¤šä¸ªä¹Ÿè¡Œã€‚ æ¯”å¦‚å°† [ä½ çš„äºŒçº§è¯ä¹¦] ä½œä¸ºé”šç‚¹åŽï¼ŒSecTrustEvaluate() å‡½æ•°åªè¦éªŒè¯åˆ° [ä½ çš„å®¢æˆ·ç«¯è¯ä¹¦] ç¡®å®žæ˜¯ç”± [ä½ çš„äºŒçº§è¯ä¹¦] ç­¾ç½²çš„ï¼Œé‚£ä¹ˆéªŒè¯ç»“æžœä¸º kSecTrustResultUnspecifiedï¼Œè¡¨æ˜Žäº† [ä½ çš„å®¢æˆ·ç«¯è¯ä¹¦] æ˜¯å¯ä¿¡çš„ã€‚ä¸‹é¢æ˜¯è®¾ç½®é”šç‚¹è¯ä¹¦çš„åšæ³•ï¼š NSMutableArray *certificates = [NSMutableArray array]; NSDate *cerData = /* åœ¨ App Bundle ä¸­ä½ ç”¨æ¥åšé”šç‚¹çš„è¯ä¹¦æ•°æ®ï¼Œè¯ä¹¦æ˜¯ CER ç¼–ç çš„ï¼Œå¸¸è§æ‰©å±•åæœ‰ï¼šcer, crt...*/ SecCertificateRef cerRef = SecCertificateCreateWithData(NULL, (__bridge CFDataRef)cerData); [certificates addObject:(__bridge_transfer id)cerRef]; // è®¾ç½®é”šç‚¹è¯ä¹¦ã€‚ SecTrustSetAnchorCertificates(trust, (__bridge CFArrayRef)certificates); ç„¶åŽå†è°ƒç”¨ myCustomValidation() éªŒè¯ã€‚ åªè°ƒç”¨ SecTrustSetAnchorCertificates () è¿™ä¸ªå‡½æ•°çš„è¯ï¼Œé‚£ä¹ˆå°±åªæœ‰ä½œä¸ºå‚æ•°è¢«ä¼ å…¥çš„è¯ä¹¦ä½œä¸ºé”šç‚¹è¯ä¹¦ï¼Œè¿žç³»ç»Ÿæœ¬èº«ä¿¡ä»»çš„ CA è¯ä¹¦éƒ½ä¸èƒ½ä½œä¸ºé”šç‚¹éªŒè¯çš„è¯ä¹¦é“¾ã€‚è¦æƒ³æ¢å¤ç³»ç»Ÿä¸­ CA è¯ä¹¦ä½œä¸ºé”šç‚¹çš„åŠŸèƒ½ï¼Œè¿˜è¦å†è°ƒç”¨ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š // true ä»£è¡¨ä»…è¢«ä¼ å…¥çš„è¯ä¹¦ä½œä¸ºé”šç‚¹ï¼Œfalse å…è®¸ç³»ç»Ÿ CA è¯ä¹¦ä¹Ÿä½œä¸ºé”šç‚¹ SecTrustSetAnchorCertificatesOnly(trust, false); AFNçš„ç›¸å…³å±žæ€§AFSecurityPolicyï¼Œå†…éƒ¨æœ‰ä¸‰ä¸ªé‡è¦çš„å±žæ€§ï¼Œå¦‚ä¸‹ï¼š AFSSLPinningMode SSLPinningMode; //è¯¥å±žæ€§æ ‡æ˜Žäº†AFSecurityPolicyæ˜¯ä»¥ä½•ç§æ–¹å¼æ¥éªŒè¯ BOOL allowInvalidCertificates; //æ˜¯å¦å…è®¸ä¸ä¿¡ä»»çš„è¯ä¹¦é€šè¿‡éªŒè¯ï¼Œé»˜è®¤ä¸ºNO BOOL validatesDomainName; //æ˜¯å¦éªŒè¯ä¸»æœºåï¼Œé»˜è®¤ä¸ºYES AFSSLPinningModeæžšä¸¾ç±»åž‹æœ‰ä¸‰ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼š AFSSLPinningModeNoneä»£è¡¨äº†AFSecurityPolicyä¸åšæ›´ä¸¥æ ¼çš„éªŒè¯ï¼Œâ€åªè¦æ˜¯ç³»ç»Ÿä¿¡ä»»çš„è¯ä¹¦â€å°±å¯ä»¥é€šè¿‡éªŒè¯ï¼Œä¸è¿‡ï¼Œå®ƒå—åˆ°allowInvalidCertificateså’ŒvalidatesDomainNameçš„å½±å“ï¼› AFSSLPinningModePublicKeyæ˜¯é€šè¿‡æ¯”è¾ƒè¯ä¹¦å½“ä¸­å…¬é’¥(PublicKey)éƒ¨åˆ†æ¥è¿›è¡ŒéªŒè¯ï¼Œé€šè¿‡SecTrustCopyPublicKeyæ–¹æ³•èŽ·å–æœ¬åœ°è¯ä¹¦å’ŒæœåŠ¡å™¨è¯ä¹¦ï¼Œç„¶åŽè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æžœæœ‰ä¸€ä¸ªç›¸åŒï¼Œåˆ™é€šè¿‡éªŒè¯ï¼Œæ­¤æ–¹å¼ä¸»è¦é€‚ç”¨äºŽè‡ªå»ºè¯ä¹¦æ­å»ºçš„HTTPSæœåŠ¡å™¨å’Œéœ€è¦è¾ƒé«˜å®‰å…¨è¦æ±‚çš„éªŒè¯ï¼› AFSSLPinningModeCertificateåˆ™æ˜¯ç›´æŽ¥å°†æœ¬åœ°çš„è¯ä¹¦è®¾ç½®ä¸ºä¿¡ä»»çš„æ ¹è¯ä¹¦ï¼Œç„¶åŽæ¥è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¸”æ¯”è¾ƒæœ¬åœ°è¯ä¹¦çš„å†…å®¹å’ŒæœåŠ¡å™¨è¯ä¹¦å†…å®¹æ˜¯å¦ç›¸åŒï¼Œæ¥è¿›è¡ŒäºŒæ¬¡åˆ¤æ–­ï¼Œæ­¤æ–¹å¼é€‚ç”¨äºŽè¾ƒé«˜å®‰å…¨è¦æ±‚çš„éªŒè¯ã€‚ å¦‚æžœHTTPSæœåŠ¡å™¨æ»¡è¶³ATSé»˜è®¤çš„æ¡ä»¶ï¼Œè€Œä¸”SSLè¯ä¹¦æ˜¯é€šè¿‡æƒå¨çš„CAæœºæž„è®¤è¯è¿‡çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆéƒ½ä¸ç”¨åšã€‚å¦‚æžœä¸Šé¢çš„æ¡ä»¶ä¸­æœ‰ä»»ä½•ä¸€ä¸ªä¸æˆç«‹ï¼Œé‚£ä¹ˆéƒ½åªèƒ½ä¿®æ”¹ATSé…ç½®ã€‚ å°ç»“å®Œæˆè¿™ç¯‡æ–‡ç« åŽï¼Œæ‰å‘çŽ°è‡ªå·±ä¹‹å‰å¯¹ç½‘è·¯ç¼–ç¨‹çš„è®¤è¯†æœ‰å¤šæ˜¾æµ…ã€‚ä¹Ÿæ‰çœŸæ­£å‘çŽ°æ€»ç»“å‡ºä¸€ç¯‡æ–‡ç« çš„å¥½å¤„ï¼Œæ•´ç†çŸ¥è¯†æ›´ç³»ç»Ÿï¼ˆå½“ç„¶è¿˜è¦çœ‹æ–‡ç« çš„æŽ’ç‰ˆåˆ†ç±»ï¼‰ï¼Œè€Œä¸”å¤§è„‘çš„è®°å¿†æœ‰é™ï¼Œæœ‰äº†æ–‡ç« æ—¥åŽå›žé¡¾ä¹Ÿæ–¹ä¾¿ç›´æŽ¥ã€‚åæ­£æœ‰æ„ä¹‰æœ‰ä»·å€¼çš„çš„äº‹éƒ½æ¯”è¾ƒæŠ˜è…¾ï¼Œè´µåœ¨åšæŒï¼ å‚è€ƒæ–‡ç« SSLçš„å·¥ä½œåŽŸç†SSLä¸ŽTLSåŒºåˆ«iOS ä¸­å¯¹ HTTPS è¯ä¹¦é“¾çš„éªŒè¯iOS9 - NSAppTransportSecurityiOS9å¢žåŠ çš„ATSç‰¹æ€§ä»‹ç»Authentication Challenges and TLS Chain ValidationOverriding TLS Chain Validation Correctly]]></content>
      <tags>
        <tag>TLS</tag>
        <tag>SSL</tag>
        <tag>HTTPS</tag>
        <tag>ATS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºHexoåšå®¢]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%2F%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[åœ¨15å¹´çš„æ—¶å€™ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨GitHub Pageæ­å»ºåšå®¢ï¼Œä½¿ç”¨ä¸€æ¬¾åä¸ºdbllçš„ä¸»é¢˜ï¼Œä½†ä¸çŸ¥æ˜¯ä¸»é¢˜ä¸å¥½ç”¨è¿˜æ˜¯è‡ªå·±å¤ªæ‡’çš„å…³ç³»ï¼Œåªå‘å¸ƒè¿‡å¯æ€œçš„å‡ ç¯‡æ–‡ç« ã€‚ ç›´åˆ°æœ€è¿‘çœ‹äº†ä¸€äº›å…³äºŽä½œä¸ºæŠ€æœ¯äººå‘˜ä¸ºä»€ä¹ˆè¦å†™åšå®¢çš„æ–‡ç« å’Œæ–‡ç« ç­‰ï¼ŒåŒæ—¶ç½‘æ˜“é‚£è¾¹çš„é¢è¯•å¤±è´¥ï¼Œä½¿æˆ‘äº§ç”Ÿäº†é‚£ç§å¯¹çŸ¥è¯†æŽŒæ¡ä¸å¤Ÿç»†è‡´ã€ä¸å¤Ÿæ·±çš„æŒ«æŠ˜æ„Ÿä¸Žæ‚”æ™šæ„Ÿï¼ŒçŸ¥è¯†é¢ä¹Ÿæ²¡æœ‰å¹¿é˜”åˆ°ä»€ä¹ˆç¨‹åº¦åŽ»ï¼Œè€Œä¸‹å®šäº†ä»Žæ­¤ä¹‹åŽä¸€å®šè¦å†™æŠ€æœ¯åšå®¢çš„å†³å¿ƒã€‚ å¥½äº†ï¼Œä¸æ‰¯å¤ªå¤šè‡ªå·±çš„ä¸œè¥¿ï¼Œå¼€å§‹æ­£å¼ä»‹ç»ä½¿ç”¨Hexo+GitHub Pageæ­å»ºè‡ªå·±ä¸ªäººåšå®¢çš„æ•™ç¨‹ã€‚ ä¸ºä»€ä¹ˆé€‰æ‹©Hexoæ­£å¦‚å®ƒä¸»é¡µè¯´è®²çš„ï¼šå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆã€‚æ‰§è¡ŒçŸ­çŸ­äº”æ¡æŒ‡ä»¤åŽå°±èƒ½è¿è¡Œèµ·æ¥çœ‹åˆ°æ•ˆæžœ $npm install hexo-cli -g $hexo init blog $cd blog $npm install $hexo server åŠ ä¸ŠåŽæœŸçš„ä¸€ç³»åˆ—æ–¹ä¾¿çš„æ“ä½œæŒ‡ä»¤ï¼Œé™¤äº†å¼ºå¤§ï¼Œæƒ³ä¸åˆ°å…¶å®ƒå½¢å®¹è¯ï¼Œä¸‹é¢ä¼šä»‹ç»åˆ°è¿™äº›æŒ‡ä»¤ã€‚ å…¶æ¬¡æ˜¯å®ƒæ”¯æŒMarkdownè§£æžæ–‡ç« ã€‚Markdownå†™æ–‡ç« æœ‰å¾ˆå¤šå¥½å¤„ï¼Œä¾‹å¦‚ä¸å†æ‹…å¿ƒæŽ’ç‰ˆï¼Œæ ‡è®°è¯­æ³•ä¹Ÿå¾ˆæ˜“è¯»æ˜“è®°ç­‰ç­‰ã€‚è¿™é‡Œæœ‰ä¸€äº›Markdownçš„å¿…ç”¨è¯­æ³•ä»‹ç»ã€‚ çŽ¯å¢ƒæ­å»ºå®‰è£…Hexoå‰ï¼Œå¿…é¡»ç¡®è®¤å·²å®‰è£…NodeJSå’ŒGitã€‚æŸ¥çœ‹NodeJSçš„ç‰ˆæœ¬ $node -v æŸ¥çœ‹Gitçš„ç‰ˆæœ¬ $git --version è‹¥éƒ½æŸ¥ä¸åˆ°å¯¹åº”ç‰ˆæœ¬å·åˆ™è¯æ˜Žè¿˜æ²¡å®‰è£…ã€‚NodeJSå¯ä»¥é€šè¿‡nvmå®‰è£…ã€‚nvmçš„cURLå®‰è£…æ–¹å¼ $ curl https://raw.github.com/creationix/nvm/master/install.sh | sh nvmçš„Wgetå®‰è£…æ–¹å¼ $ wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh ç„¶åŽä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤å°±èƒ½å®‰è£…ä¸ŠNodeJS $ nvm install stable å¦å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨brewæ¥å®‰è£…ã€‚brewçš„å®‰è£… ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" ç„¶åŽä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤å®‰è£…NodeJS brew install node æœ€åŽå°±å¯ä»¥å®‰è£…Hexoäº† $ npm install -g hexo-cli nvmæ˜¯Node Version Managerï¼Œç”¨äºŽç®¡ç†NodeJSçš„ç‰ˆæœ¬ã€‚npmæ˜¯Node Package Managerï¼Œæ˜¯éšåŒNodeJSä¸€èµ·å®‰è£…çš„åŒ…ç®¡ç†å·¥å…·ã€‚ä¸Šé¢å®‰è£…Hexoçš„æŒ‡ä»¤åˆ™ä»£è¡¨å®‰è£…ä¸€ä¸ªå…¨å±€çš„æ¨¡å—ã€‚ å»ºç«™æ‰§è¡Œä¸‹é¢3æ¡æŒ‡ä»¤ï¼Œå°±èƒ½å°†åšå®¢ç«™ç‚¹çš„æ­å»ºèµ·æ¥ $ hexo init [folder] $ cd [folder] $ npm install hexo init [folder]ï¼šä»£è¡¨åœ¨ä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹ä¸Šå»ºç«™ï¼Œå°†Hexoç«™ç‚¹æ¨¡æ¿æ‹·è´åˆ°è¯¥ç›®å½•ä¸‹ã€‚ npm installï¼šä»£è¡¨å®‰è£…å½“å‰ç›®å½•ä¸‹ç¼–å†™å¥½çš„æ‰€æœ‰NodeJSåŒ…ã€‚ ç„¶åŽç›®å½•çœ‹èµ·æ¥å°±æ˜¯ä¸‹é¢è¿™æ ·å­ . â”œâ”€â”€ _config.yml â”œâ”€â”€ package.json â”œâ”€â”€ scaffolds â”œâ”€â”€ source | â”œâ”€â”€ _drafts | â””â”€â”€ _posts â””â”€â”€ themes _config.ymlï¼šæ˜¯ç«™ç‚¹çš„é…ç½®ä¿¡æ¯ï¼› package.jsonï¼šé‡Œé¢æœ‰æ˜¾ç¤ºå®‰è£…äº†å“ªäº›NodeJSåŒ…å’ŒHexoè¿™ä¸ªsiteçš„ä¸€äº›ä¿¡æ¯ï¼Œå¯ä»¥è‡ªç”±ç§»é™¤ï¼› scaffoldsï¼šæ¨¡ç‰ˆæ–‡ä»¶å¤¹ã€‚å½“æ‚¨æ–°å»ºæ–‡ç« æ—¶ï¼ŒHexo ä¼šæ ¹æ®scaffoldæ¥å»ºç«‹æ–‡ä»¶ã€‚Hexoçš„æ¨¡æ¿æ˜¯æŒ‡åœ¨æ–°å»ºçš„markdownæ–‡ä»¶ä¸­é»˜è®¤å¡«å……çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨ä¿®æ”¹scaffold/post.mdä¸­çš„Front-matterå†…å®¹ï¼Œé‚£ä¹ˆæ¯æ¬¡æ–°å»ºä¸€ç¯‡æ–‡ç« æ—¶éƒ½ä¼šåŒ…å«è¿™ä¸ªä¿®æ”¹ã€‚ sourceï¼šå­˜æ”¾ç”¨æˆ·èµ„æºçš„åœ°æ–¹ï¼Œâ€_â€å¼€å¤´å’Œéšè—çš„æ–‡ä»¶ä¼šè¢«å¿½ç•¥ã€‚é‡Œé¢çš„_draftsç”¨äºŽå­˜æ”¾è‰ç¨¿ï¼Œ_postsç”¨äºŽå­˜æ”¾æ­£å¼å‘å¸ƒçš„æ–‡ç« ï¼› themes é‡Œç”¨äºŽå­˜æ”¾ä¸»é¢˜åŒ…ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯Nextä¸»é¢˜ã€‚ é…ç½®GitHub Pageså› ä¸ºè¦åˆ©ç”¨GitHub Pagesæ¥å®‰æ”¾ç«™ç‚¹ï¼Œæ‰€ä»¥å…ˆè¦åœ¨è‡ªå·±çš„GitHubä¸Šæ–°å»ºä¸€ä¸ªrepositoryï¼Œå‘½åå¿…é¡»éµä»Žyourusername.github.ioè¿™æ ·çš„è§„åˆ™ï¼Œå¦åˆ™pagesé¡µé¢å°†æ— æ³•æž„å»ºç”Ÿæˆã€‚ ç„¶åŽå¯ä»¥é€‰æ‹©æ€§åœ°ç»‘å®šä¸€ä¸ªåŸŸåï¼Œå¦‚æžœä¸ç»‘å®šåŸŸåï¼Œåˆ™ä½ çš„ç«™ç‚¹åªèƒ½é€šè¿‡yourusername.github.ioè¿™æ ·çš„å½¢å¼è®¿é—®äº†ã€‚åœ¨åˆšåˆ›å»ºçš„repositoryçš„Settings-GitHub Pagesä¸Šé¢ï¼Œå°†è¦ç»‘å®šçš„åŸŸåé…ç½®åˆ°Custom Domainä¸Šï¼Œè€Œä¸”éœ€è¦é€‰æ‹©pagesé¡µé¢æž„å»ºä¾èµ–çš„åˆ†æ”¯ï¼Œå¦‚ä¸‹å›¾ åŸŸåå¯ä»¥é€šè¿‡é˜¿é‡Œäº‘ã€GoDaddyé‚£äº›å¹³å°è´­ä¹°ã€‚ç”±äºŽç½‘ç«™ä½¿ç”¨çš„æ˜¯GitHubçš„æœåŠ¡å™¨ï¼Œéƒ¨ç½²åœ¨å¤–å›½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„åŸŸåå¯ä»¥ä¸ç”¨ç”³è¯·ICPå¤‡æ¡ˆã€‚ æˆ‘çš„åŸŸåæ˜¯åœ¨é˜¿é‡Œäº‘è´­ä¹°çš„ã€‚è´­ä¹°åˆ°åŸŸååŽï¼Œè¿˜éœ€åˆ°é˜¿é‡Œäº‘æŽ§åˆ¶å°çš„åŸŸåç®¡ç†å¤„è®¾ç½®ä¸€ä¸‹ï¼Œä¸ºæ–°ä¹°çš„åŸŸåæ·»åŠ è§£æžï¼Œå¯å‚è€ƒé˜¿é‡Œäº‘å®˜æ–¹æ•™ç¨‹ï¼Œä¸»è¦æ˜¯ä¸ºåŸŸåæ·»åŠ å¦‚ä¸‹å›¾çš„3ä¸ªè§£æžï¼ŒåŒ…æ‹¬ä¸¤ä¸ªDNSå’Œä¸€ä¸ªGithub Pagesçš„åœ°å€ã€‚ è¿™é‡Œé€‰ç”¨åˆ«åCNAMEçš„æ–¹å¼ç»‘å®šï¼Œè¿™æ ·è§£æžèƒ½å…è®¸å¤šä¸ªåŸŸåæ˜ å°„åˆ°åŒä¸€å°ä¸»æœºã€‚æ³¨æ„ï¼Œæœ€åŽä¸€æ­¥ï¼Œè®°å¾—å¯¹åŸŸååšå®žåè®¤è¯ï¼Œä¼°è®¡æ˜¯å›½æƒ…è§„å®šï¼Œå¦‚æžœåˆ°GoDaddyè´­ä¹°çš„comåŸŸååº”è¯¥ä¸éœ€è®¤è¯ã€‚ ç„¶åŽï¼Œå›žåˆ°ç«™ç‚¹æ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨publicæ–‡ä»¶å¤¹é‡Œæ·»åŠ ä¸€ä¸ªCNAMEçš„æ–‡ä»¶(ä¸èƒ½æœ‰ä»»ä½•æ‰©å±•å)ï¼Œé‡Œé¢å¡«ä¸Šè‡ªå·±çš„åŸŸåï¼Œä¸å¸¦http://è¿™ç§åè®®ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨äºŽå‘Šè¯‰GitHubè¯¥pagesç»‘å®šçš„åŸŸåæ˜¯å“ªä¸ªï¼Œè€Œæ”¾åˆ°publicæ˜¯ä¸ºäº†ç»™Hexoéƒ¨ç½²ç«™ç‚¹ï¼ŒæŠŠè¯¥CNAMEæ–‡ä»¶pushåˆ°GitHubçš„æ ¹ç›®å½•ä¸Šã€‚ ç«™ç‚¹é…ç½®åœ¨ç«™ç‚¹é…ç½®ä¿¡æ¯_config.ymlé‡Œï¼Œæœ‰ä¸€äº›å‚æ•°æœ€å¥½ä¿®æ”¹ä¸€ä¸‹å†å¼€å§‹ä½¿ç”¨ï¼Œä¸ç„¶æ­£å¼ä¸Šçº¿çš„åšå®¢é‡Œé¢å¾ˆå¤šå†…å®¹éƒ½æ˜¯æ¨¡æ¿æ‰€æä¾›çš„ã€‚å…¶å®ƒå…·ä½“çš„å‚æ•°å®šä¹‰å¯åˆ°Hexoå®˜ç½‘-é…ç½®å‚è€ƒã€‚ title: Fung's Blog subtitle: description: æ ¼è¨€ author: fung fay language: zh-Hans timezone: Asia/Shanghai theme: next deploy: type: git repo: https://github.com/leo9763/leo9763.github.io ä¸»é¢˜é…ç½®åœ¨ä¸»é¢˜é…ç½®ä¿¡æ¯themes/next/_config.ymlé‡Œï¼Œä¹Ÿå¯ä»¥æŒ‰è‡ªå·±çš„éœ€è¦ä¿®æ”¹å‚æ•°ï¼Œå¯å‚è€ƒNextå®˜ç½‘-é…ç½®ã€‚ä¸‹é¢æ˜¯æˆ‘ä¿®æ”¹åˆ°çš„éƒ¨åˆ† #ä¸»é¢˜é£Žæ ¼ # scheme: Muse scheme: Mist # scheme: Pisces #ä¸»èœå•é€‰é¡¹ menu: home: / archives: /archives #about: /about #categories: /categories tags: /tags #commonweal: /404.html #ä¸ªäººèµ„æ–™ä¸­çš„é“¾æŽ¥ social: GitHub: https://github.com/leo9763 Twitter: https://twitter.com/Nero_Milk #é¡µé¢icon favicon: uploads/qgithub.jpg #ä¸ªäººå¤´åƒ avatar: uploads/qgithub.jpg #ä»£ç é«˜äº®çš„é£Žæ ¼ highlight_theme: night #ç¬¬ä¸‰æ–¹è¯„è®ºå·¥å…·hypercommentsçš„IDï¼Œè¿˜å¯ä»¥é€‰æ‹©disqusç­‰ hypercomments_id: 93415 #ç«™ç‚¹ç»Ÿè®¡åˆ†æžå·¥å…·googleAnalyticsçš„IDï¼Œè¿˜å¯ä»¥é€‰æ‹©Yandexç­‰å¹³å° google_analytics: UA-102751023-1 è¯„è®ºæ¡†è¦è¯´ä¸€ä¸‹è¯„è®ºæ¨¡å—çš„è®¾ç½®éƒ¨åˆ†ï¼ŒçŽ°åœ¨å¤šè¯´å·²ç»ç”¨ä¸äº†äº†ï¼Œç½‘æ˜“äº‘è·Ÿè´´ä¹Ÿåœ¨æœˆåº•ä¸‹çº¿ï¼Œæœ¬æ¥æ‰“ç®—ç”¨disqusçš„ï¼Œä½†æŒ‰è¶³æç¤ºæ­¥éª¤è®¾ç½®åŽè¯„è®ºæ¡†æ­»æ´»å‡ºä¸æ¥ï¼Œç„¶åŽå°±æ”¹ç”¨äº†ä¸€æ¬¾æ¥è‡ªäºŽæˆ˜æ–—æ°‘æ—çš„hypercommentsï¼Œè¿™ä¸ªå¹³å°çš„ç¼ºç‚¹æ˜¯ï¼ŒåŽå°çº¯è‹±æ–‡ï¼ˆä¹Ÿæœ‰ä¿„æ–‡- -ï¼‰ï¼Œå¥½å§ï¼Œè¿™å…¶å®žä¸ç®—ä»€ä¹ˆç¼ºç‚¹ï¼Œç„¶åŽæ˜¯å…¶åªèƒ½ä½¿ç”¨Googleçš„è´¦å·ç™»å½•è¯„è®ºï¼Œä¸èƒ½ç¿»å¢™çš„å°±byebyeå§ã€‚ä½†æ˜¯ä¼˜ç‚¹ä¹Ÿæœ‰å¾ˆå¤š å…è´¹ç‰ˆæœ¬æ”¯æŒæ¯æœˆæœ€å¤š100Kçš„åŠ è½½æ¬¡æ•°ã€‚æ¯å°æ—¶æœ€å¤š1000æ¬¡çš„è¯·æ±‚ã€‚ ç•Œé¢ç®€æ´ã€‚ æ”¯æŒå¡«å†™é‚®ç®±è¿›è¡Œå›žå¤ï¼Œä¸éœ€è¦å¼ºåˆ¶ç™»å½•ç¬¬ä¸‰æ–¹è´¦å·ã€‚ æ”¯æŒemojiå’Œå›žå¤æ·»åŠ é™„ä»¶ã€‚ è¯„è®ºæ¡†ä¸éœ€è¦è®¿å®¢ç¿»å¢™ä¹Ÿèƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚ åªè¦ä¸»é¢˜çš„hypercomments_idå‚æ•°å¼€å¯å¹¶è®¾ç½®ä¸ŠIDï¼Œåˆ™pageæ¨¡æ¿ä¸­çš„è¯„è®ºæ¡†éƒ¨åˆ†çš„é¢„è®¾ä»£ç å°±ä¼šç”Ÿæ•ˆï¼Œè¿™ä¸ªå¥½åƒæ˜¯é’ˆå¯¹æ¯”è¾ƒæ–°çš„Nextæ‰æœ‰é¢„è®¾å¥½ä»£ç ï¼Œåæ­£æˆ‘ä½¿ç”¨çš„5.1.1æ˜¯é¢„è®¾å¥½çš„ã€‚ ç«™ç‚¹ç»Ÿè®¡è¿™é‡Œä½¿ç”¨çš„æ˜¯GoogleAnalyticsï¼Œä½†å½“æˆ‘ç”Ÿæˆå¥½Analytics IDå¹¶è®¾ç½®å¥½ä»¥åŽï¼ŒGoogleAnalyticsçš„åŽå°ä¸€ç›´æ²¡æœ‰æ£€æµ‹åˆ°æ•°æ®ã€‚ å†™ä½œæ–°å»ºæ–‡ç« å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤å®Œæˆä¸€ä»½è‰ç¨¿ $ hexo new draft &lt;title&gt; #æ–°å»ºè‰ç¨¿ $ hexo publish post &lt;title&gt; #å‘å¸ƒåˆ°posté‡ŒåŽ» å½“ç„¶ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ¨¡æ¿ï¼Œåœ¨scaffoldsä¸­è®¾å®šå¥½è‡ªå®šä¹‰æ¨¡æ¿xxx.mdï¼Œç„¶åŽåœ¨æ–°å»ºæ–‡ä»¶æ—¶é€‰æ‹©è‡ªå®šä¹‰çš„æ¨¡æ¿ $ hexo new photo "gallery" è¿™æ ·æ–‡ç« å°±ä¼šæ ¹æ®æ¨¡æ¿æ¥layoutã€‚ åˆ†ç±»å’Œæ ‡ç­¾å¦‚æžœæƒ³ä¸»é¡µèœå•å’Œæ–‡ç« ä¸­çš„tagså’Œcategoriesèƒ½ç‚¹å‡»åŽæ­£å¸¸è·³è½¬é¡µé¢çš„è¯ï¼Œåˆ™éœ€è¦å…ˆæ‰§è¡Œä¸‹é¢ä¸¤ä¸ªæŒ‡ä»¤æ¥åˆ›å»ºå‡ºå¯¹åº”çš„èµ„æºæ–‡ä»¶å¤¹ $ hexo new page tags $ hexo new page categories pageè¿™ä¸ªå‚æ•°ä»£è¡¨é€‰æ‹©äº†ä¸€ä¸ªlayoutæ¨¡æ¿ï¼Œè€Œè¿™ä¸¤æ¡æŒ‡ä»¤çš„æ„æ€æ˜¯æ–°å»ºä¸€ä¸ªpageï¼Œåå«tagså’Œcategoriesï¼Œä»Žè€Œä½¿ä¸»é¢˜é…ç½®ä¸­çš„èœå•å‚æ•°tagsèƒ½è®¿é—®åˆ°/tagsã€‚æ‰§è¡ŒæŒ‡ä»¤åŽç«™ç‚¹çš„sourceç›®å½•ä¸‹ä¼šå¤šå‡ºtagså’Œcategoriesè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åˆ†åˆ«å­˜æœ‰ä¸€ä¸ªindex.mdæ–‡ä»¶ï¼ˆåˆ°éƒ¨ç½²ç«™ç‚¹çš„æ—¶å€™ï¼Œsourceç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè¢«hexoè¯†åˆ«é€‰æ‹©æ·»åŠ åˆ°siteçš„æ ¹ç›®å½•ä¸Šï¼Œå³æ˜¯publicæ–‡ä»¶å¤¹æ‰€æ¨¡æ‹Ÿçš„ç›®å½•ï¼‰ã€‚ æ–‡ç« ä¸­æŒ‡å®šåˆ†ç±»å’Œæ ‡ç­¾çš„ç¤ºä¾‹å¦‚ä¸‹ categories: - Papers - Diary tags: - PS3 - Games Hexo ä¸­æ ‡ç­¾tagå’Œåˆ†ç±»categoriesä¸¤è€…æœ‰ç€æ˜Žæ˜¾çš„å·®åˆ«ï¼šåˆ†ç±»å…·æœ‰é¡ºåºæ€§å’Œå±‚æ¬¡æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ Foo, Bar ä¸ç­‰äºŽ Bar, Fooï¼›è€Œæ ‡ç­¾æ²¡æœ‰é¡ºåºå’Œå±‚æ¬¡ã€‚ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒDiaryç›¸å½“äºŽPapersçš„ä¸€ä¸ªå­åˆ†ç±»ï¼Œè€ŒPS3å’ŒGamesè¿™ä¸¤ä¸ªæ ‡ç­¾åˆ™æ˜¯ç‹¬ç«‹å­˜åœ¨çš„ã€‚ æ’å›¾ å®˜æ–¹æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å¾ˆå®žç”¨ï¼ŒåŸºæœ¬æ»¡è¶³éœ€æ±‚ï¼Œä¸”èƒ½åœ¨é¦–é¡µä¸Šä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºæ–‡ç« çš„å›¾ç‰‡ã€‚ &#123;% asset_img example.jpg this is title %&#125; ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›ºå®šå€¼ï¼Œä»£è¡¨å¯»æ‰¾å›¾ç‰‡èµ„æºï¼Œè¿˜æœ‰asset_linkã€asset_pathè¿™äº›æŸ¥æ‰¾å…¶å®ƒç±»åž‹èµ„æºçš„å®šå€¼ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç›¸å¯¹è·¯å¾„ï¼ŒHexoä¼šåœ¨ä¸Žæ–‡ç« åŒåçš„æ–‡ä»¶å¤¹ä¸­æ‰¾å‡ºè¯¥å‚æ•°åå­—çš„å›¾ç‰‡ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å›¾ç‰‡çš„å¤‡æ³¨ï¼Œä¼šæ˜¾ç¤ºåœ¨å›¾ç‰‡çš„ä¸‹æ–¹ã€‚ ä½¿ç”¨è¿™ç§æ–¹æ³•å‰ï¼Œå…ˆåœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­å°†post_asset_folderè®¾ä¸ºtrueï¼Œè¿™æ ·å°±èƒ½åœ¨æ¯æ¬¡é€šè¿‡æŒ‡ä»¤hexo new [layout] &lt;title&gt;åˆ›å»ºæ–°æ–‡ç« æ—¶å¯¹åº”å»ºç«‹ä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œé…å¯¹å­˜æ”¾è¯¥æ–‡ç« çš„å›¾ç‰‡ã€‚ Markdownæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šéš¾äºŽç®¡ç†å›¾ç‰‡ï¼Œåœ¨é¦–é¡µä¸­è¿˜ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚å›¾ç‰‡ä¸€èˆ¬æ”¾åœ¨sourceçš„imagesæ–‡ä»¶å¤¹é‡Œå­˜æ”¾ã€‚ ![](/images/image.jpg) åœ¨çº¿å›¾ç‰‡ã€‚è¿™ä¸ªæ–¹æ³•çš„å¥½å¤„æ˜¯èŠ‚çœäº†åšå®¢æœåŠ¡å™¨çš„ç©ºé—´ï¼Œä½†ç¼ºç‚¹æ˜¯å›¾ç‰‡æ”¾åœ¨åˆ«äººçš„åœ°æ–¹ï¼Œä¸çŸ¥å“ªå¤©éšæ—¶ä¼šæœ‰ä»€ä¹ˆæƒ…å†µå½±å“æ˜¾ç¤ºï¼Œç”šè‡³æ‰¾ä¸å›žæ¥ï¼Œå¸¸ç”¨çš„æœ‰ä¸ƒç‰›ã€æžç®€å›¾åºŠã€Gimhoyå›¾åºŠã€‚ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨åŽï¼Œå°†å¾—åˆ°çš„å›¾ç‰‡é“¾æŽ¥ç”¨ä¸‹é¢çš„æ–¹å¼æ’å…¥åˆ°æ–‡ç« å³å¯ã€‚ ![](http://ifungfay.com/uploads/qgithub.jpg) æƒ³æ’å…¥æ›´å¤šå…¶å®ƒçš„å†…å®¹è¯·å‚è€ƒNextå®˜æ–¹çš„æ ‡ç­¾æ’ä»¶ä»‹ç»ï¼Œä¾‹å¦‚å¼•ç”¨å—``ä»£ç å—``æ–‡ç« ç­‰ç­‰ã€‚ å‘å¸ƒåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå°±èƒ½åœ¨http://localhost:4000/ä¸ŠæŸ¥çœ‹æ•ˆæžœ $ hexo server #ç®€å†™ hexo s å¦‚æžœæƒ³æœ¬åœ°ç«™ç‚¹çš„æ›´æ–°å‘å¸ƒåˆ°è¿œç«¯ï¼Œå³æ˜¯è®¿é—®è‡ªå·±åŸŸåçš„æ—¶å€™è¦çœ‹åˆ°æ›´æ–°ä¿¡æ¯çš„è¯ï¼Œåˆ™éœ€è¦æ‰§è¡Œä¸‹é¢æŒ‡ä»¤ $ hexo generate $ hexo deploy ``` æˆ–è€…ç®€å†™ä¸ºä¸‹é¢è¿™æ ·ï¼Œä½¿ç«™ç‚¹ç”Ÿæˆå®Œæ¯•åŽè‡ªåŠ¨éƒ¨ç½²ç½‘ç«™ ``` bash $ hexo g -d ç›´åˆ°ä¸Šé¢ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œå®Œä¸ºæ­¢ï¼Œç«™ç‚¹çš„é™æ€æ–‡ä»¶å°±ç”Ÿæˆå®Œæ¯•ï¼Œå¹¶è‡ªåŠ¨å°†é™æ€ç½‘ç«™pushåˆ°GitHub Pageçš„ä»“åº“(å³æ˜¯ä»¥ä¸Šè¯´çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­çš„deployå‚æ•°æŒ‡å®šçš„gitåœ°å€)ä¸Šé¢åŽ»ï¼Œè¿™æ—¶è‡ªå·±åŸŸåè®¿é—®åˆ°çš„å†…å®¹ä¹Ÿå°±æ›´æ–°äº†ã€‚]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>jekyll</tag>
        <tag>github</tag>
        <tag>blog</tag>
      </tags>
  </entry>
</search>
